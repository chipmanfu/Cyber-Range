-- MariaDB dump 10.19  Distrib 10.6.12-MariaDB, for Linux (x86_64)
--
-- Host: localhost    Database: bookstackapp
-- ------------------------------------------------------
-- Server version	10.6.12-MariaDB-log

/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8mb4 */;
/*!40103 SET @OLD_TIME_ZONE=@@TIME_ZONE */;
/*!40103 SET TIME_ZONE='+00:00' */;
/*!40014 SET @OLD_UNIQUE_CHECKS=@@UNIQUE_CHECKS, UNIQUE_CHECKS=0 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;

--
-- Table structure for table `activities`
--

DROP TABLE IF EXISTS `activities`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `activities` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `type` varchar(191) NOT NULL,
  `detail` text NOT NULL,
  `user_id` int(11) NOT NULL,
  `ip` varchar(45) NOT NULL,
  `entity_id` int(11) DEFAULT NULL,
  `entity_type` varchar(191) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `activities_user_id_index` (`user_id`),
  KEY `activities_entity_id_index` (`entity_id`),
  KEY `activities_key_index` (`type`),
  KEY `activities_created_at_index` (`created_at`),
  KEY `activities_ip_index` (`ip`)
) ENGINE=InnoDB AUTO_INCREMENT=255 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `activities`
--

LOCK TABLES `activities` WRITE;
/*!40000 ALTER TABLE `activities` DISABLE KEYS */;
INSERT INTO `activities` VALUES (1,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-03-28 22:06:37','2023-03-28 22:06:37'),(2,'book_create','(1) test',1,'172.20.0.2',1,'book','2023-03-28 22:06:48','2023-03-28 22:06:48'),(3,'page_create','(1) New Page',1,'172.20.0.2',1,'page','2023-03-28 22:07:12','2023-03-28 22:07:12'),(4,'bookshelf_create','(1) Grayspace',1,'172.20.0.4',1,'bookshelf','2023-03-28 22:35:13','2023-03-28 22:35:13'),(5,'bookshelf_delete','(1) Grayspace',1,'172.20.0.4',1,'bookshelf','2023-03-28 22:35:23','2023-03-28 22:35:23'),(6,'bookshelf_create','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-03-28 22:35:57','2023-03-28 22:35:57'),(7,'book_create','(2) Network Diagram',1,'172.20.0.4',2,'book','2023-03-28 22:36:18','2023-03-28 22:36:18'),(8,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-03-28 22:36:18','2023-03-28 22:36:18'),(9,'page_create','(2) Overall network diagram',1,'172.20.0.4',2,'page','2023-03-28 22:58:26','2023-03-28 22:58:26'),(10,'book_delete','(1) test',1,'172.20.0.4',1,'book','2023-03-28 23:24:32','2023-03-28 23:24:32'),(11,'page_create','(3) Network Diagram Notes',1,'172.20.0.4',3,'page','2023-03-28 23:25:21','2023-03-28 23:25:21'),(12,'book_update','(2) Network Diagram',1,'172.20.0.4',2,'book','2023-03-28 23:25:37','2023-03-28 23:25:37'),(13,'page_update','(2) Network Diagram',1,'172.20.0.4',2,'page','2023-03-28 23:26:05','2023-03-28 23:26:05'),(14,'book_update','(2) Network Overview',1,'172.20.0.4',2,'book','2023-03-28 23:26:26','2023-03-28 23:26:26'),(15,'page_update','(3) Network Diagram Notes',1,'172.20.0.4',3,'page','2023-03-28 23:57:46','2023-03-28 23:57:46'),(16,'book_create','(3) Cyber Range Systems Overview',1,'172.20.0.4',3,'book','2023-03-28 23:58:23','2023-03-28 23:58:23'),(17,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-03-28 23:58:23','2023-03-28 23:58:23'),(18,'page_create','(4) RootDNS',1,'172.20.0.4',4,'page','2023-03-29 00:43:26','2023-03-29 00:43:26'),(19,'page_update','(4) RootDNS',1,'172.20.0.4',4,'page','2023-03-29 01:05:30','2023-03-29 01:05:30'),(20,'page_create','(5) Web-Services',1,'172.20.0.4',5,'page','2023-03-29 01:21:11','2023-03-29 01:21:11'),(21,'page_create','(6) CA-Server',1,'172.20.0.4',6,'page','2023-03-29 01:21:22','2023-03-29 01:21:22'),(22,'page_update','(6) CA-Server',1,'172.20.0.4',6,'page','2023-03-29 01:32:10','2023-03-29 01:32:10'),(23,'page_create','(7) Traffic-Gen',1,'172.20.0.4',7,'page','2023-03-29 01:39:47','2023-03-29 01:39:47'),(24,'page_create','(8) Traffic-WebHost',1,'172.20.0.4',8,'page','2023-03-29 01:41:20','2023-03-29 01:41:20'),(25,'page_create','(9) NRTS',1,'172.20.0.4',9,'page','2023-03-29 01:41:30','2023-03-29 01:41:30'),(26,'page_update','(9) NRTS',1,'172.20.0.4',9,'page','2023-03-29 01:47:28','2023-03-29 01:47:28'),(27,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-03-29 16:11:29','2023-03-29 16:11:29'),(28,'page_update','(7) Traffic-Gen',1,'172.20.0.4',7,'page','2023-03-29 16:40:12','2023-03-29 16:40:12'),(29,'page_update','(9) NRTS',1,'172.20.0.4',9,'page','2023-03-29 17:34:27','2023-03-29 17:34:27'),(30,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-03-30 16:35:33','2023-03-30 16:35:33'),(31,'book_create','(4) How to Guides',1,'172.20.0.4',4,'book','2023-03-30 16:36:37','2023-03-30 16:36:37'),(32,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-03-30 16:36:37','2023-03-30 16:36:37'),(33,'book_create','(5) Register DNS',1,'172.20.0.4',5,'book','2023-03-30 17:46:16','2023-03-30 17:46:16'),(34,'page_create','(10) New Page',1,'172.20.0.4',10,'page','2023-03-30 17:48:42','2023-03-30 17:48:42'),(35,'page_update','(10) New Page',1,'172.20.0.4',10,'page','2023-03-30 18:10:12','2023-03-30 18:10:12'),(36,'page_update','(10) Three ways of registering domains',1,'172.20.0.4',10,'page','2023-03-30 18:10:46','2023-03-30 18:10:46'),(37,'page_update','(10) Three ways of registering domains',1,'172.20.0.4',10,'page','2023-03-30 18:11:30','2023-03-30 18:11:30'),(38,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 19:03:04','2023-03-30 19:03:04'),(39,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-03-30 19:43:38','2023-03-30 19:43:38'),(40,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 19:44:46','2023-03-30 19:44:46'),(41,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 19:46:00','2023-03-30 19:46:00'),(42,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 19:48:58','2023-03-30 19:48:58'),(43,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 20:01:02','2023-03-30 20:01:02'),(44,'page_move','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-03-30 20:02:13','2023-03-30 20:02:13'),(45,'book_delete','(5) Register DNS',1,'172.20.0.4',5,'book','2023-03-30 20:02:33','2023-03-30 20:02:33'),(46,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-03-31 00:25:59','2023-03-31 00:25:59'),(47,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-04-03 16:32:15','2023-04-03 16:32:15'),(48,'page_update','(4) RootDNS',1,'172.20.0.4',4,'page','2023-04-03 16:44:56','2023-04-03 16:44:56'),(49,'page_update','(6) CA-Server',1,'172.20.0.4',6,'page','2023-04-03 16:55:17','2023-04-03 16:55:17'),(50,'page_update','(7) Traffic-Gen',1,'172.20.0.4',7,'page','2023-04-03 17:03:25','2023-04-03 17:03:25'),(51,'page_update','(2) Network Diagram',1,'172.20.0.4',2,'page','2023-04-03 17:21:54','2023-04-03 17:21:54'),(52,'page_update','(2) Network Diagram',1,'172.20.0.4',2,'page','2023-04-03 17:26:13','2023-04-03 17:26:13'),(53,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-04-03 19:48:13','2023-04-03 19:48:13'),(54,'page_create','(11) Proxy All the things',1,'172.20.0.4',11,'page','2023-04-03 19:54:51','2023-04-03 19:54:51'),(55,'page_update','(11) Proxy All the things',1,'172.20.0.4',11,'page','2023-04-03 20:15:24','2023-04-03 20:15:24'),(56,'page_create','(12) Code Signing Certificates for Binaries',1,'172.20.0.4',12,'page','2023-04-03 20:18:59','2023-04-03 20:18:59'),(57,'page_create','(13) Using the NRTS server',1,'172.20.0.4',13,'page','2023-04-03 21:31:35','2023-04-03 21:31:35'),(58,'chapter_create','(1) test',1,'172.20.0.4',1,'chapter','2023-04-03 21:32:05','2023-04-03 21:32:05'),(59,'chapter_delete','(1) test',1,'172.20.0.4',1,'chapter','2023-04-03 21:32:15','2023-04-03 21:32:15'),(60,'book_create','(6) Using the NRTS',1,'172.20.0.4',6,'book','2023-04-03 21:33:04','2023-04-03 21:33:04'),(61,'page_move','(13) Using the NRTS server',1,'172.20.0.4',13,'page','2023-04-03 21:33:23','2023-04-03 21:33:23'),(62,'book_update','(6) Using the NRTS',1,'172.20.0.4',6,'book','2023-04-03 21:33:40','2023-04-03 21:33:40'),(63,'page_update','(13) Creating Cobalt Strike C2 Profiles',1,'172.20.0.4',13,'page','2023-04-03 21:34:19','2023-04-03 21:34:19'),(64,'book_update','(6) Using the NRTS',1,'172.20.0.4',6,'book','2023-04-03 21:34:31','2023-04-03 21:34:31'),(65,'page_create','(14) Starting a Cobalt Strike Teamserver',1,'172.20.0.4',14,'page','2023-04-03 21:36:18','2023-04-03 21:36:18'),(66,'page_update','(14) Starting a Cobalt Strike Teamserver',1,'172.20.0.4',14,'page','2023-04-03 22:23:02','2023-04-03 22:23:02'),(67,'page_create','(15) Starting a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-03 22:23:22','2023-04-03 22:23:22'),(68,'page_update','(14) Starting a Cobalt Strike Teamserver',1,'172.20.0.4',14,'page','2023-04-03 22:23:43','2023-04-03 22:23:43'),(69,'page_update','(15) Starting a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-03 22:27:44','2023-04-03 22:27:44'),(70,'page_update','(15) Starting a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-03 23:39:39','2023-04-03 23:39:39'),(71,'page_update','(15) Starting a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-04 00:13:12','2023-04-04 00:13:12'),(72,'page_update','(15) Making a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-04 00:13:32','2023-04-04 00:13:32'),(73,'page_create','(16) Making a NGINX Redirector',1,'172.20.0.4',16,'page','2023-04-04 00:13:47','2023-04-04 00:13:47'),(74,'page_update','(15) Making a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-04 00:14:30','2023-04-04 00:14:30'),(75,'page_update','(16) Making a NGINX Redirector',1,'172.20.0.4',16,'page','2023-04-04 01:10:33','2023-04-04 01:10:33'),(76,'page_create','(17) Building a Payload Host',1,'172.20.0.4',17,'page','2023-04-04 01:12:48','2023-04-04 01:12:48'),(77,'page_update','(15) Making a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-04 01:13:04','2023-04-04 01:13:04'),(78,'page_update','(17) Building a Payload Host',1,'172.20.0.4',17,'page','2023-04-04 01:52:13','2023-04-04 01:52:13'),(79,'page_create','(18) Setting up a Phishing Attack',1,'172.20.0.4',18,'page','2023-04-04 01:53:10','2023-04-04 01:53:10'),(80,'page_update','(17) Building a Payload Host',1,'172.20.0.4',17,'page','2023-04-04 01:53:26','2023-04-04 01:53:26'),(81,'page_update','(18) Setting up a Phishing Attack',1,'172.20.0.4',18,'page','2023-04-04 01:59:18','2023-04-04 01:59:18'),(82,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-04-04 16:02:05','2023-04-04 16:02:05'),(83,'page_update','(18) Setting up a Phishing Attack',1,'172.20.0.4',18,'page','2023-04-04 17:13:41','2023-04-04 17:13:41'),(84,'page_create','(19) Managing Services',1,'172.20.0.4',19,'page','2023-04-04 17:42:40','2023-04-04 17:42:40'),(85,'page_update','(13) Creating Cobalt Strike C2 Profiles',1,'172.20.0.4',13,'page','2023-04-04 17:58:13','2023-04-04 17:58:13'),(86,'page_update','(14) Starting a Cobalt Strike Teamserver',1,'172.20.0.4',14,'page','2023-04-04 18:00:18','2023-04-04 18:00:18'),(87,'page_update','(14) Starting a Cobalt Strike Teamserver',1,'172.20.0.4',14,'page','2023-04-04 18:14:30','2023-04-04 18:14:30'),(88,'page_update','(15) Making a HAProxy Redirector',1,'172.20.0.4',15,'page','2023-04-04 18:44:47','2023-04-04 18:44:47'),(89,'page_update','(16) Making a NGINX Redirector',1,'172.20.0.4',16,'page','2023-04-04 19:05:32','2023-04-04 19:05:32'),(90,'page_update','(17) Building a Payload Host',1,'172.20.0.4',17,'page','2023-04-04 19:24:08','2023-04-04 19:24:08'),(91,'page_update','(18) Setting up a Phishing Attack',1,'172.20.0.4',18,'page','2023-04-04 19:38:37','2023-04-04 19:38:37'),(92,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-04-04 19:41:52','2023-04-04 19:41:52'),(93,'book_update','(2) Network Overview',1,'172.20.0.4',2,'book','2023-04-04 19:52:38','2023-04-04 19:52:38'),(94,'book_update','(3) Cyber Range Systems Overview',1,'172.20.0.4',3,'book','2023-04-04 19:52:55','2023-04-04 19:52:55'),(95,'book_update','(4) How to Guides',1,'172.20.0.4',4,'book','2023-04-04 19:53:12','2023-04-04 19:53:12'),(96,'book_update','(6) Using the NRTS',1,'172.20.0.4',6,'book','2023-04-04 19:55:11','2023-04-04 19:55:11'),(97,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-04-04 19:57:43','2023-04-04 19:57:43'),(98,'page_update','(3) Network Diagram Notes',1,'172.20.0.4',3,'page','2023-04-04 20:30:23','2023-04-04 20:30:23'),(99,'page_update','(2) Network Diagram',1,'172.20.0.4',2,'page','2023-04-04 20:30:55','2023-04-04 20:30:55'),(100,'page_delete','(3) Network Diagram Notes',1,'172.20.0.4',3,'page','2023-04-04 20:31:12','2023-04-04 20:31:12'),(101,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-04-04 22:35:55','2023-04-04 22:35:55'),(102,'page_update','(10) Manual Domain Registration',1,'172.20.0.4',10,'page','2023-04-04 22:39:36','2023-04-04 22:39:36'),(103,'page_update','(13) Creating Cobalt Strike C2 Profiles (buildredteam.sh)',1,'172.20.0.4',13,'page','2023-04-04 22:40:21','2023-04-04 22:40:21'),(104,'page_update','(14) Starting a Cobalt Strike Teamserver (buildredteam.sh)',1,'172.20.0.4',14,'page','2023-04-04 22:40:39','2023-04-04 22:40:39'),(105,'page_update','(15) Making a HAProxy Redirector (buildredteam.sh)',1,'172.20.0.4',15,'page','2023-04-04 22:40:56','2023-04-04 22:40:56'),(106,'page_update','(16) Making a NGINX Redirector (buildredteam.sh)',1,'172.20.0.4',16,'page','2023-04-04 22:41:17','2023-04-04 22:41:17'),(107,'page_update','(17) Building a Payload Host (buildredteam.sh)',1,'172.20.0.4',17,'page','2023-04-04 22:41:36','2023-04-04 22:41:36'),(108,'page_update','(18) Setting up a Phishing Attack (buildredteam.sh)',1,'172.20.0.4',18,'page','2023-04-04 22:41:53','2023-04-04 22:41:53'),(109,'page_update','(19) Managing Services (buildredteam.sh)',1,'172.20.0.4',19,'page','2023-04-04 22:42:09','2023-04-04 22:42:09'),(110,'page_update','(19) Managing Services (buildredteam.sh)',1,'172.20.0.4',19,'page','2023-04-05 00:01:57','2023-04-05 00:01:57'),(111,'book_update','(6) Using the NRTS',1,'172.20.0.4',6,'book','2023-04-05 00:03:09','2023-04-05 00:03:09'),(112,'page_update','(13) Creating Cobalt Strike C2 Profiles',1,'172.20.0.4',13,'page','2023-04-05 00:04:22','2023-04-05 00:04:22'),(113,'page_create','(20) Managing DNS',1,'172.20.0.4',20,'page','2023-04-05 00:09:09','2023-04-05 00:09:09'),(114,'page_update','(20) Managing DNS',1,'172.20.0.4',20,'page','2023-04-05 00:16:02','2023-04-05 00:16:02'),(115,'page_update','(20) Managing DNS (ManageDNS.sh)',1,'172.20.0.4',20,'page','2023-04-05 00:35:13','2023-04-05 00:35:13'),(116,'page_update','(18) Phishing Attack (buildredteam.sh)',1,'172.20.0.4',18,'page','2023-04-05 00:35:38','2023-04-05 00:35:38'),(117,'page_update','(20) Managing DNS (ManageDNS.sh)',1,'172.20.0.4',20,'page','2023-04-05 00:38:36','2023-04-05 00:38:36'),(118,'page_create','(21) Reverting the NRTS',1,'172.20.0.4',21,'page','2023-04-05 00:42:15','2023-04-05 00:42:15'),(119,'user_update','(1) Admin',1,'172.20.0.4',NULL,NULL,'2023-04-05 00:45:35','2023-04-05 00:45:35'),(120,'book_create','(7) Default Creds for all the things',1,'172.20.0.4',7,'book','2023-04-05 00:46:19','2023-04-05 00:46:19'),(121,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.4',2,'bookshelf','2023-04-05 00:46:19','2023-04-05 00:46:19'),(122,'book_update','(7) Default Creds for all the things',1,'172.20.0.4',7,'book','2023-04-05 00:47:13','2023-04-05 00:47:13'),(123,'page_create','(22) Cred list',1,'172.20.0.4',22,'page','2023-04-05 00:47:39','2023-04-05 00:47:39'),(124,'page_update','(22) Cred list',1,'172.20.0.4',22,'page','2023-04-05 00:58:07','2023-04-05 00:58:07'),(125,'page_update','(22) Cred list',1,'172.20.0.4',22,'page','2023-04-05 00:58:39','2023-04-05 00:58:39'),(126,'page_update','(22) Cred list',1,'172.20.0.4',22,'page','2023-04-05 00:59:29','2023-04-05 00:59:29'),(127,'auth_login','standard; (1) Admin',1,'172.20.0.4',NULL,NULL,'2023-04-05 01:00:19','2023-04-05 01:00:19'),(128,'settings_update','features',1,'172.20.0.4',NULL,NULL,'2023-04-05 01:00:52','2023-04-05 01:00:52'),(129,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:49:20','2023-04-05 16:49:20'),(130,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:49:46','2023-04-05 16:49:46'),(131,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:49:52','2023-04-05 16:49:52'),(132,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:51:46','2023-04-05 16:51:46'),(133,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:52:38','2023-04-05 16:52:38'),(134,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:54:27','2023-04-05 16:54:27'),(135,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-05 16:54:40','2023-04-05 16:54:40'),(136,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-05 17:35:26','2023-04-05 17:35:26'),(137,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-05 17:54:02','2023-04-05 17:54:02'),(138,'page_update','(5) Web-Services',1,'172.20.0.2',5,'page','2023-04-05 18:00:46','2023-04-05 18:00:46'),(139,'page_update','(6) CA-Server',1,'172.20.0.2',6,'page','2023-04-05 18:07:23','2023-04-05 18:07:23'),(140,'page_update','(7) Traffic-Gen',1,'172.20.0.2',7,'page','2023-04-05 19:11:37','2023-04-05 19:11:37'),(141,'page_update','(9) NRTS',1,'172.20.0.2',9,'page','2023-04-05 19:28:56','2023-04-05 19:28:56'),(142,'page_update','(5) Web-Services',1,'172.20.0.2',5,'page','2023-04-05 19:30:00','2023-04-05 19:30:00'),(143,'page_update','(6) CA-Server',1,'172.20.0.2',6,'page','2023-04-05 19:30:12','2023-04-05 19:30:12'),(144,'page_update','(7) Traffic-Gen',1,'172.20.0.2',7,'page','2023-04-05 19:30:27','2023-04-05 19:30:27'),(145,'book_update','(6) Using the NRTS',1,'172.20.0.2',6,'book','2023-04-05 19:31:03','2023-04-05 19:31:03'),(146,'page_create','(23) New Page',1,'172.20.0.2',23,'page','2023-04-05 19:31:07','2023-04-05 19:31:07'),(147,'page_delete','(23) New Page',1,'172.20.0.2',23,'page','2023-04-05 19:31:11','2023-04-05 19:31:11'),(148,'page_create','(24) New Page',1,'172.20.0.2',24,'page','2023-04-05 19:31:22','2023-04-05 19:31:22'),(149,'page_delete','(24) New Page',1,'172.20.0.2',24,'page','2023-04-05 19:31:26','2023-04-05 19:31:26'),(150,'book_update','(6) Using the NRTS',1,'172.20.0.2',6,'book','2023-04-05 19:31:45','2023-04-05 19:31:45'),(151,'book_update','(6) Using the NRTS',1,'172.20.0.2',6,'book','2023-04-05 19:32:14','2023-04-05 19:32:14'),(152,'page_update','(13) Creating Cobalt Strike C2 Profiles',1,'172.20.0.2',13,'page','2023-04-05 19:39:08','2023-04-05 19:39:08'),(153,'page_update','(14) Starting a Cobalt Strike Teamserver (buildredteam.sh)',1,'172.20.0.2',14,'page','2023-04-05 19:49:09','2023-04-05 19:49:09'),(154,'page_update','(15) Making a HAProxy Redirector (buildredteam.sh)',1,'172.20.0.2',15,'page','2023-04-05 20:11:21','2023-04-05 20:11:21'),(155,'page_update','(16) Making a NGINX Redirector (buildredteam.sh)',1,'172.20.0.2',16,'page','2023-04-05 20:51:00','2023-04-05 20:51:00'),(156,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-06 01:07:06','2023-04-06 01:07:06'),(157,'page_update','(17) Building a Payload Host (buildredteam.sh)',1,'172.20.0.2',17,'page','2023-04-06 01:18:31','2023-04-06 01:18:31'),(158,'page_update','(18) Phishing Attack (buildredteam.sh)',1,'172.20.0.2',18,'page','2023-04-06 01:24:45','2023-04-06 01:24:45'),(159,'page_update','(19) Managing Services (buildredteam.sh)',1,'172.20.0.2',19,'page','2023-04-06 01:28:32','2023-04-06 01:28:32'),(160,'page_update','(21) Reverting the NRTS',1,'172.20.0.2',21,'page','2023-04-06 01:29:08','2023-04-06 01:29:08'),(161,'page_update','(10) Manual Domain Registration',1,'172.20.0.2',10,'page','2023-04-06 01:29:52','2023-04-06 01:29:52'),(162,'page_update','(11) Proxy All the things',1,'172.20.0.2',11,'page','2023-04-06 01:30:39','2023-04-06 01:30:39'),(163,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-06 16:03:24','2023-04-06 16:03:24'),(164,'book_create','(8) Target Domain Planning Guide',1,'172.20.0.2',8,'book','2023-04-06 16:17:26','2023-04-06 16:17:26'),(165,'bookshelf_update','(2) Grayspace Documentation',1,'172.20.0.2',2,'bookshelf','2023-04-06 16:17:26','2023-04-06 16:17:26'),(166,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-06 17:01:33','2023-04-06 17:01:33'),(167,'settings_update','customization',1,'172.20.0.2',NULL,NULL,'2023-04-06 17:02:28','2023-04-06 17:02:28'),(168,'book_update','(8) Target Domain Planning Guide',1,'172.20.0.2',8,'book','2023-04-06 17:18:50','2023-04-06 17:18:50'),(169,'book_update','(8) Target Domain Planning Guide',1,'172.20.0.2',8,'book','2023-04-06 17:22:26','2023-04-06 17:22:26'),(170,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-10 16:48:30','2023-04-10 16:48:30'),(171,'page_create','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 17:00:14','2023-04-10 17:00:14'),(172,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 17:01:20','2023-04-10 17:01:20'),(173,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-10 17:02:23','2023-04-10 17:02:23'),(174,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 17:02:55','2023-04-10 17:02:55'),(175,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 17:03:36','2023-04-10 17:03:36'),(176,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 18:16:12','2023-04-10 18:16:12'),(177,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-10 18:28:56','2023-04-10 18:28:56'),(178,'page_create','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-10 19:23:07','2023-04-10 19:23:07'),(179,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-10 19:28:37','2023-04-10 19:28:37'),(180,'book_update','(8) Target Domain Planning Guide',1,'172.20.0.2',8,'book','2023-04-10 19:41:33','2023-04-10 19:41:33'),(181,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 19:54:23','2023-04-10 19:54:23'),(182,'page_create','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-10 22:08:06','2023-04-10 22:08:06'),(183,'page_update','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-10 22:12:01','2023-04-10 22:12:01'),(184,'page_update','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-10 22:27:10','2023-04-10 22:27:10'),(185,'page_update','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-10 22:27:23','2023-04-10 22:27:23'),(186,'page_update','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-10 23:18:57','2023-04-10 23:18:57'),(187,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-10 23:20:11','2023-04-10 23:20:11'),(188,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-10 23:31:56','2023-04-10 23:31:56'),(189,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-10 23:45:39','2023-04-10 23:45:39'),(190,'page_create','(28) Importing CA and intermediate Certs to your Target Domain',1,'172.20.0.2',28,'page','2023-04-10 23:46:25','2023-04-10 23:46:25'),(191,'page_update','(28) Importing CA and intermediate Certs to your Target Domain',1,'172.20.0.2',28,'page','2023-04-11 00:13:59','2023-04-11 00:13:59'),(192,'page_update','(28) Importing CA and Int Certs to your Target Domain',1,'172.20.0.2',28,'page','2023-04-11 00:14:19','2023-04-11 00:14:19'),(193,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-11 00:17:03','2023-04-11 00:17:03'),(194,'page_create','(29) Connecting a Target Domain to the Cyber Range',1,'172.20.0.2',29,'page','2023-04-11 01:08:33','2023-04-11 01:08:33'),(195,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-11 01:10:28','2023-04-11 01:10:28'),(196,'page_update','(2) Network Diagram',1,'172.20.0.2',2,'page','2023-04-11 01:28:31','2023-04-11 01:28:31'),(197,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-11 16:40:14','2023-04-11 16:40:14'),(198,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-11 17:07:44','2023-04-11 17:07:44'),(199,'page_update','(5) Web-Services',1,'172.20.0.2',5,'page','2023-04-11 17:16:39','2023-04-11 17:16:39'),(200,'page_update','(6) CA-Server',1,'172.20.0.2',6,'page','2023-04-11 17:22:05','2023-04-11 17:22:05'),(201,'page_update','(7) Traffic-Gen',1,'172.20.0.2',7,'page','2023-04-11 17:32:11','2023-04-11 17:32:11'),(202,'page_update','(9) NRTS',1,'172.20.0.2',9,'page','2023-04-11 18:22:32','2023-04-11 18:22:32'),(203,'page_update','(10) Manual Domain Registration',1,'172.20.0.2',10,'page','2023-04-11 18:26:09','2023-04-11 18:26:09'),(204,'page_create','(30) Setting up the Traffic-Gen for a Target Domain',1,'172.20.0.2',30,'page','2023-04-11 19:55:18','2023-04-11 19:55:18'),(205,'page_update','(30) Setting up the Traffic-Gen for a Target Domain',1,'172.20.0.2',30,'page','2023-04-11 22:32:36','2023-04-11 22:32:36'),(206,'page_update','(30) Setting up the Traffic-Gen for a Target Domain',1,'172.20.0.2',30,'page','2023-04-11 23:08:59','2023-04-11 23:08:59'),(207,'page_update','(30) Setting up the Traffic-Gen for a Target Domain',1,'172.20.0.2',30,'page','2023-04-11 23:19:08','2023-04-11 23:19:08'),(208,'page_create','(31) Adding DNS for your Target Domain',1,'172.20.0.2',31,'page','2023-04-12 00:29:14','2023-04-12 00:29:14'),(209,'page_update','(31) Adding DNS for your Target Domain',1,'172.20.0.2',31,'page','2023-04-12 00:39:40','2023-04-12 00:39:40'),(210,'page_update','(29) Connecting a Target Domain to the Cyber Range',1,'172.20.0.2',29,'page','2023-04-12 01:12:46','2023-04-12 01:12:46'),(211,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-12 01:31:25','2023-04-12 01:31:25'),(212,'page_update','(10) OPFOR Domain Registration outside of NRTS Automation',1,'172.20.0.2',10,'page','2023-04-12 01:32:34','2023-04-12 01:32:34'),(213,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-12 01:36:34','2023-04-12 01:36:34'),(214,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-12 01:38:19','2023-04-12 01:38:19'),(215,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-12 01:48:18','2023-04-12 01:48:18'),(216,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 01:48:50','2023-04-12 01:48:50'),(217,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-12 16:02:49','2023-04-12 16:02:49'),(218,'bookshelf_update','(2) Cyber Range Documentation',1,'172.20.0.2',2,'bookshelf','2023-04-12 16:32:06','2023-04-12 16:32:06'),(219,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 17:02:51','2023-04-12 17:02:51'),(220,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 17:04:03','2023-04-12 17:04:03'),(221,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 17:06:46','2023-04-12 17:06:46'),(222,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 17:14:10','2023-04-12 17:14:10'),(223,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 17:25:33','2023-04-12 17:25:33'),(224,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-12 17:34:33','2023-04-12 17:34:33'),(225,'page_update','(5) Web-Services',1,'172.20.0.2',5,'page','2023-04-12 17:51:55','2023-04-12 17:51:55'),(226,'page_update','(6) CA-Server',1,'172.20.0.2',6,'page','2023-04-12 18:41:31','2023-04-12 18:41:31'),(227,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 18:51:29','2023-04-12 18:51:29'),(228,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 18:59:12','2023-04-12 18:59:12'),(229,'page_create','(32) Adding a Internet Access Proxy for a Target Domain',1,'172.20.0.2',32,'page','2023-04-12 20:49:06','2023-04-12 20:49:06'),(230,'page_update','(2) Cyber Range Network Diagram',1,'172.20.0.2',2,'page','2023-04-12 20:51:57','2023-04-12 20:51:57'),(231,'page_update','(4) RootDNS',1,'172.20.0.2',4,'page','2023-04-12 21:34:21','2023-04-12 21:34:21'),(232,'page_update','(7) Traffic-Gen',1,'172.20.0.2',7,'page','2023-04-12 21:43:33','2023-04-12 21:43:33'),(233,'page_update','(9) NRTS',1,'172.20.0.2',9,'page','2023-04-12 21:52:15','2023-04-12 21:52:15'),(234,'page_update','(10) OPFOR Domain Registration outside of NRTS Automation',1,'172.20.0.2',10,'page','2023-04-12 21:54:31','2023-04-12 21:54:31'),(235,'page_update','(12) Code Signing Binaries',1,'172.20.0.2',12,'page','2023-04-12 21:55:36','2023-04-12 21:55:36'),(236,'page_update','(30) Setting up the Traffic-Gen for a Target Domain',1,'172.20.0.2',30,'page','2023-04-12 22:03:06','2023-04-12 22:03:06'),(237,'page_update','(13) Creating Cobalt Strike C2 Profiles',1,'172.20.0.2',13,'page','2023-04-12 22:08:18','2023-04-12 22:08:18'),(238,'page_update','(14) Starting a Cobalt Strike Teamserver (buildredteam.sh)',1,'172.20.0.2',14,'page','2023-04-12 22:15:39','2023-04-12 22:15:39'),(239,'page_update','(15) Making a HAProxy Redirector (buildredteam.sh)',1,'172.20.0.2',15,'page','2023-04-12 22:27:00','2023-04-12 22:27:00'),(240,'page_update','(17) Building a Payload Host (buildredteam.sh)',1,'172.20.0.2',17,'page','2023-04-12 22:30:32','2023-04-12 22:30:32'),(241,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-12 22:35:28','2023-04-12 22:35:28'),(242,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-12 22:44:50','2023-04-12 22:44:50'),(243,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-13 01:06:40','2023-04-13 01:06:40'),(244,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-13 01:32:07','2023-04-13 01:32:07'),(245,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-13 01:34:28','2023-04-13 01:34:28'),(246,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-13 16:30:29','2023-04-13 16:30:29'),(247,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-13 16:38:52','2023-04-13 16:38:52'),(248,'auth_login','standard; (1) Admin',1,'172.20.0.2',NULL,NULL,'2023-04-13 20:15:19','2023-04-13 20:15:19'),(249,'page_update','(25) General Guidance',1,'172.20.0.2',25,'page','2023-04-13 20:27:12','2023-04-13 20:27:12'),(250,'page_update','(26) Ghost Traffic Generation',1,'172.20.0.2',26,'page','2023-04-13 20:35:31','2023-04-13 20:35:31'),(251,'page_update','(27) Blue Space Set up and Management Scripts',1,'172.20.0.2',27,'page','2023-04-13 20:37:54','2023-04-13 20:37:54'),(252,'page_update','(28) Importing CA and Int Certs to your Target Domain',1,'172.20.0.2',28,'page','2023-04-13 20:41:22','2023-04-13 20:41:22'),(253,'page_update','(29) Connecting a Target Domain to the Cyber Range',1,'172.20.0.2',29,'page','2023-04-13 22:40:20','2023-04-13 22:40:20'),(254,'page_update','(31) Adding DNS for your Target Domain',1,'172.20.0.2',31,'page','2023-04-13 22:46:22','2023-04-13 22:46:22');
/*!40000 ALTER TABLE `activities` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `api_tokens`
--

DROP TABLE IF EXISTS `api_tokens`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `api_tokens` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `token_id` varchar(191) NOT NULL,
  `secret` varchar(191) NOT NULL,
  `user_id` int(10) unsigned NOT NULL,
  `expires_at` date NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `api_tokens_token_id_unique` (`token_id`),
  KEY `api_tokens_user_id_index` (`user_id`),
  KEY `api_tokens_expires_at_index` (`expires_at`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `api_tokens`
--

LOCK TABLES `api_tokens` WRITE;
/*!40000 ALTER TABLE `api_tokens` DISABLE KEYS */;
/*!40000 ALTER TABLE `api_tokens` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `attachments`
--

DROP TABLE IF EXISTS `attachments`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `attachments` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `path` text NOT NULL,
  `extension` varchar(20) NOT NULL,
  `uploaded_to` int(11) NOT NULL,
  `external` tinyint(1) NOT NULL,
  `order` int(11) NOT NULL,
  `created_by` int(11) NOT NULL,
  `updated_by` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `attachments_uploaded_to_index` (`uploaded_to`)
) ENGINE=InnoDB AUTO_INCREMENT=6 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `attachments`
--

LOCK TABLES `attachments` WRITE;
/*!40000 ALTER TABLE `attachments` DISABLE KEYS */;
INSERT INTO `attachments` VALUES (1,'CleanLogs.ps1','uploads/files/2023-04-Apr/4zkx13vErY4s7aZu-ps1','ps1',27,0,1,1,1,'2023-04-10 22:11:54','2023-04-10 22:11:54'),(2,'CreateADUsers.ps1','uploads/files/2023-04-Apr/kZIplTvgUO1ER64i-ps1','ps1',27,0,1,1,1,'2023-04-10 22:11:54','2023-04-10 22:11:54'),(3,'CreateMailboxes.ps1','uploads/files/2023-04-Apr/XoHLdNG9XdWI8dMS-ps1','ps1',27,0,2,1,1,'2023-04-10 22:11:54','2023-04-10 22:11:54'),(4,'DeleteAllEmails.ps1','uploads/files/2023-04-Apr/3WnNO3Lg5Gjh4Bqt-ps1','ps1',27,0,3,1,1,'2023-04-10 22:11:54','2023-04-10 22:11:54'),(5,'Range-Management.ps1','uploads/files/2023-04-Apr/XU9YjJ61Jbr8PybV-ps1','ps1',27,0,4,1,1,'2023-04-10 23:02:47','2023-04-10 23:02:47');
/*!40000 ALTER TABLE `attachments` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `books`
--

DROP TABLE IF EXISTS `books`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `books` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `slug` varchar(191) NOT NULL,
  `description` text NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_by` int(11) NOT NULL,
  `updated_by` int(11) NOT NULL,
  `image_id` int(11) DEFAULT NULL,
  `deleted_at` timestamp NULL DEFAULT NULL,
  `owned_by` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `books_slug_index` (`slug`),
  KEY `books_created_by_index` (`created_by`),
  KEY `books_updated_by_index` (`updated_by`),
  KEY `books_owned_by_index` (`owned_by`)
) ENGINE=InnoDB AUTO_INCREMENT=9 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `books`
--

LOCK TABLES `books` WRITE;
/*!40000 ALTER TABLE `books` DISABLE KEYS */;
INSERT INTO `books` VALUES (1,'test','test','','2023-03-28 22:06:48','2023-03-28 23:24:32',1,1,NULL,'2023-03-28 23:24:32',1),(2,'Network Overview','network-overview','','2023-03-28 22:36:18','2023-04-04 19:52:38',1,1,131,NULL,1),(3,'Cyber Range Systems Overview','cyber-range-systems-overview','','2023-03-28 23:58:23','2023-04-04 19:52:55',1,1,132,NULL,1),(4,'How to Guides','how-to-guides','','2023-03-30 16:36:37','2023-04-04 19:53:12',1,1,133,NULL,1),(5,'Register DNS','register-dns','','2023-03-30 17:46:16','2023-03-30 20:02:33',1,1,NULL,'2023-03-30 20:02:33',1),(6,'Using the NRTS','using-the-nrts','The Not Red Team Server (NRTS) is the swiss army knife for building red team infrastructure.   This guide will provide step by step instructions for using it\'s key features.  For details on the file structure go to -> Cyber Range Systems Overview -> NRTS','2023-04-03 21:33:04','2023-04-05 19:32:14',1,1,134,NULL,1),(7,'Default Creds for all the things','default-creds-for-all-the-things','','2023-04-05 00:46:19','2023-04-05 00:47:13',1,1,154,NULL,1),(8,'Target Domain Planning Guide','target-domain-planning-guide','The target domain is the enterprise network that you can attach to the cyber range.  This is also commonly referred to as blue space.  The cyber range doesn\'t come with one due to the issues with windows licensing but this guide will provide some lessons learned when building these to operate in a \"fake\" internet environment.','2023-04-06 16:17:26','2023-04-10 19:41:33',1,1,162,NULL,1);
/*!40000 ALTER TABLE `books` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `bookshelves`
--

DROP TABLE IF EXISTS `bookshelves`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `bookshelves` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(180) NOT NULL,
  `slug` varchar(180) NOT NULL,
  `description` text NOT NULL,
  `created_by` int(11) DEFAULT NULL,
  `updated_by` int(11) DEFAULT NULL,
  `image_id` int(11) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `deleted_at` timestamp NULL DEFAULT NULL,
  `owned_by` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `bookshelves_slug_index` (`slug`),
  KEY `bookshelves_created_by_index` (`created_by`),
  KEY `bookshelves_updated_by_index` (`updated_by`),
  KEY `bookshelves_owned_by_index` (`owned_by`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `bookshelves`
--

LOCK TABLES `bookshelves` WRITE;
/*!40000 ALTER TABLE `bookshelves` DISABLE KEYS */;
INSERT INTO `bookshelves` VALUES (1,'Grayspace','grayspace','',1,1,NULL,'2023-03-28 22:35:13','2023-03-28 22:35:23','2023-03-28 22:35:23',1),(2,'Cyber Range Documentation','cyber-range-documentation','',1,1,135,'2023-03-28 22:35:57','2023-04-12 16:32:06',NULL,1);
/*!40000 ALTER TABLE `bookshelves` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `bookshelves_books`
--

DROP TABLE IF EXISTS `bookshelves_books`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `bookshelves_books` (
  `bookshelf_id` int(10) unsigned NOT NULL,
  `book_id` int(10) unsigned NOT NULL,
  `order` int(10) unsigned NOT NULL,
  PRIMARY KEY (`bookshelf_id`,`book_id`),
  KEY `bookshelves_books_book_id_foreign` (`book_id`),
  CONSTRAINT `bookshelves_books_book_id_foreign` FOREIGN KEY (`book_id`) REFERENCES `books` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `bookshelves_books_bookshelf_id_foreign` FOREIGN KEY (`bookshelf_id`) REFERENCES `bookshelves` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `bookshelves_books`
--

LOCK TABLES `bookshelves_books` WRITE;
/*!40000 ALTER TABLE `bookshelves_books` DISABLE KEYS */;
INSERT INTO `bookshelves_books` VALUES (2,2,0),(2,3,1),(2,4,2),(2,6,3),(2,7,4),(2,8,5);
/*!40000 ALTER TABLE `bookshelves_books` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `cache`
--

DROP TABLE IF EXISTS `cache`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `cache` (
  `key` varchar(191) NOT NULL,
  `value` text NOT NULL,
  `expiration` int(11) NOT NULL,
  UNIQUE KEY `cache_key_unique` (`key`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `cache`
--

LOCK TABLES `cache` WRITE;
/*!40000 ALTER TABLE `cache` DISABLE KEYS */;
/*!40000 ALTER TABLE `cache` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `chapters`
--

DROP TABLE IF EXISTS `chapters`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `chapters` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `book_id` int(11) NOT NULL,
  `slug` varchar(191) NOT NULL,
  `name` text NOT NULL,
  `description` text NOT NULL,
  `priority` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_by` int(11) NOT NULL,
  `updated_by` int(11) NOT NULL,
  `deleted_at` timestamp NULL DEFAULT NULL,
  `owned_by` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `chapters_slug_index` (`slug`),
  KEY `chapters_book_id_index` (`book_id`),
  KEY `chapters_priority_index` (`priority`),
  KEY `chapters_created_by_index` (`created_by`),
  KEY `chapters_updated_by_index` (`updated_by`),
  KEY `chapters_owned_by_index` (`owned_by`)
) ENGINE=InnoDB AUTO_INCREMENT=2 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `chapters`
--

LOCK TABLES `chapters` WRITE;
/*!40000 ALTER TABLE `chapters` DISABLE KEYS */;
INSERT INTO `chapters` VALUES (1,4,'test','test','',6,'2023-04-03 21:32:05','2023-04-03 21:32:15',1,1,'2023-04-03 21:32:15',1);
/*!40000 ALTER TABLE `chapters` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `comments`
--

DROP TABLE IF EXISTS `comments`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `comments` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `entity_id` int(10) unsigned NOT NULL,
  `entity_type` varchar(191) NOT NULL,
  `text` longtext DEFAULT NULL,
  `html` longtext DEFAULT NULL,
  `parent_id` int(10) unsigned DEFAULT NULL,
  `local_id` int(10) unsigned DEFAULT NULL,
  `created_by` int(10) unsigned NOT NULL,
  `updated_by` int(10) unsigned DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `comments_entity_id_entity_type_index` (`entity_id`,`entity_type`),
  KEY `comments_local_id_index` (`local_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `comments`
--

LOCK TABLES `comments` WRITE;
/*!40000 ALTER TABLE `comments` DISABLE KEYS */;
/*!40000 ALTER TABLE `comments` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `deletions`
--

DROP TABLE IF EXISTS `deletions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `deletions` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `deleted_by` int(11) NOT NULL,
  `deletable_type` varchar(100) NOT NULL,
  `deletable_id` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `deletions_deleted_by_index` (`deleted_by`),
  KEY `deletions_deletable_type_index` (`deletable_type`),
  KEY `deletions_deletable_id_index` (`deletable_id`)
) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `deletions`
--

LOCK TABLES `deletions` WRITE;
/*!40000 ALTER TABLE `deletions` DISABLE KEYS */;
INSERT INTO `deletions` VALUES (1,1,'bookshelf',1,'2023-03-28 22:35:23','2023-03-28 22:35:23'),(2,1,'book',1,'2023-03-28 23:24:32','2023-03-28 23:24:32'),(3,1,'book',5,'2023-03-30 20:02:33','2023-03-30 20:02:33'),(4,1,'chapter',1,'2023-04-03 21:32:15','2023-04-03 21:32:15'),(5,1,'page',3,'2023-04-04 20:31:12','2023-04-04 20:31:12'),(6,1,'page',23,'2023-04-05 19:31:11','2023-04-05 19:31:11'),(7,1,'page',24,'2023-04-05 19:31:26','2023-04-05 19:31:26');
/*!40000 ALTER TABLE `deletions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `email_confirmations`
--

DROP TABLE IF EXISTS `email_confirmations`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `email_confirmations` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `token` varchar(191) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `email_confirmations_user_id_index` (`user_id`),
  KEY `email_confirmations_token_index` (`token`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `email_confirmations`
--

LOCK TABLES `email_confirmations` WRITE;
/*!40000 ALTER TABLE `email_confirmations` DISABLE KEYS */;
/*!40000 ALTER TABLE `email_confirmations` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `entity_permissions`
--

DROP TABLE IF EXISTS `entity_permissions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `entity_permissions` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `entity_id` int(10) unsigned NOT NULL,
  `entity_type` varchar(25) NOT NULL,
  `role_id` int(10) unsigned NOT NULL,
  `view` tinyint(1) NOT NULL DEFAULT 0,
  `create` tinyint(1) NOT NULL DEFAULT 0,
  `update` tinyint(1) NOT NULL DEFAULT 0,
  `delete` tinyint(1) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  KEY `new_entity_permissions_entity_id_entity_type_index` (`entity_id`,`entity_type`),
  KEY `new_entity_permissions_role_id_index` (`role_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `entity_permissions`
--

LOCK TABLES `entity_permissions` WRITE;
/*!40000 ALTER TABLE `entity_permissions` DISABLE KEYS */;
/*!40000 ALTER TABLE `entity_permissions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `failed_jobs`
--

DROP TABLE IF EXISTS `failed_jobs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `failed_jobs` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `uuid` varchar(191) NOT NULL,
  `connection` text NOT NULL,
  `queue` text NOT NULL,
  `payload` longtext NOT NULL,
  `exception` longtext NOT NULL,
  `failed_at` timestamp NOT NULL DEFAULT current_timestamp(),
  PRIMARY KEY (`id`),
  UNIQUE KEY `failed_jobs_uuid_unique` (`uuid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `failed_jobs`
--

LOCK TABLES `failed_jobs` WRITE;
/*!40000 ALTER TABLE `failed_jobs` DISABLE KEYS */;
/*!40000 ALTER TABLE `failed_jobs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `favourites`
--

DROP TABLE IF EXISTS `favourites`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `favourites` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `favouritable_id` int(11) NOT NULL,
  `favouritable_type` varchar(100) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `favouritable_index` (`favouritable_id`,`favouritable_type`),
  KEY `favourites_user_id_index` (`user_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `favourites`
--

LOCK TABLES `favourites` WRITE;
/*!40000 ALTER TABLE `favourites` DISABLE KEYS */;
/*!40000 ALTER TABLE `favourites` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `images`
--

DROP TABLE IF EXISTS `images`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `images` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `url` varchar(191) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_by` int(11) NOT NULL,
  `updated_by` int(11) NOT NULL,
  `path` varchar(400) NOT NULL,
  `type` varchar(191) NOT NULL,
  `uploaded_to` int(11) NOT NULL DEFAULT 0,
  PRIMARY KEY (`id`),
  KEY `images_type_index` (`type`),
  KEY `images_uploaded_to_index` (`uploaded_to`)
) ENGINE=InnoDB AUTO_INCREMENT=184 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `images`
--

LOCK TABLES `images` WRITE;
/*!40000 ALTER TABLE `images` DISABLE KEYS */;
INSERT INTO `images` VALUES (1,'Drawing-1-1680023230.png','https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680023230.png','2023-03-28 22:07:10','2023-03-28 22:07:10',1,1,'/uploads/images/drawio/2023-03/drawing-1-1680023230.png','drawio',1),(2,'Drawing-1-1680026302.png','https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680026302.png','2023-03-28 22:58:22','2023-03-28 22:58:22',1,1,'/uploads/images/drawio/2023-03/drawing-1-1680026302.png','drawio',2),(11,'exampleDNSfile.png','https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png','2023-03-30 19:46:47','2023-03-30 19:46:47',1,1,'/uploads/images/gallery/2023-03/examplednsfile.png','gallery',10),(12,'RegisterDNS-help.png','https://redbook.com/uploads/images/gallery/2023-03/registerdns-help.png','2023-03-30 19:46:47','2023-03-30 19:46:47',1,1,'/uploads/images/gallery/2023-03/registerdns-help.png','gallery',10),(13,'registerprocess.png','https://redbook.com/uploads/images/gallery/2023-03/registerprocess.png','2023-03-30 19:46:47','2023-03-30 19:46:47',1,1,'/uploads/images/gallery/2023-03/registerprocess.png','gallery',10),(14,'Drawing-1-1680524511.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524511.png','2023-04-03 17:21:51','2023-04-03 17:21:51',1,1,'/uploads/images/drawio/2023-04/drawing-1-1680524511.png','drawio',2),(15,'Drawing-1-1680524770.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524770.png','2023-04-03 17:26:10','2023-04-03 17:26:10',1,1,'/uploads/images/drawio/2023-04/drawing-1-1680524770.png','drawio',2),(16,'image.png','https://redbook.com/uploads/images/gallery/2023-04/image.png','2023-04-03 21:45:43','2023-04-03 21:45:43',1,1,'/uploads/images/gallery/2023-04/image.png','gallery',14),(17,'image.png','https://redbook.com/uploads/images/gallery/2023-04/hGyimage.png','2023-04-03 21:49:23','2023-04-03 21:49:23',1,1,'/uploads/images/gallery/2023-04/hGyimage.png','gallery',14),(18,'image.png','https://redbook.com/uploads/images/gallery/2023-04/N1Iimage.png','2023-04-03 21:50:24','2023-04-03 21:50:24',1,1,'/uploads/images/gallery/2023-04/N1Iimage.png','gallery',14),(19,'image.png','https://redbook.com/uploads/images/gallery/2023-04/KZNimage.png','2023-04-03 21:53:25','2023-04-03 21:53:25',1,1,'/uploads/images/gallery/2023-04/KZNimage.png','gallery',14),(20,'image.png','https://redbook.com/uploads/images/gallery/2023-04/uPMimage.png','2023-04-03 21:54:45','2023-04-03 21:54:45',1,1,'/uploads/images/gallery/2023-04/uPMimage.png','gallery',14),(21,'image.png','https://redbook.com/uploads/images/gallery/2023-04/vgRimage.png','2023-04-03 21:58:48','2023-04-03 21:58:48',1,1,'/uploads/images/gallery/2023-04/vgRimage.png','gallery',14),(22,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Hlhimage.png','2023-04-03 22:00:02','2023-04-03 22:00:02',1,1,'/uploads/images/gallery/2023-04/Hlhimage.png','gallery',14),(23,'image.png','https://redbook.com/uploads/images/gallery/2023-04/0Ddimage.png','2023-04-03 22:01:32','2023-04-03 22:01:32',1,1,'/uploads/images/gallery/2023-04/0Ddimage.png','gallery',14),(24,'image.png','https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png','2023-04-03 22:03:40','2023-04-03 22:03:40',1,1,'/uploads/images/gallery/2023-04/c2Fimage.png','gallery',14),(25,'image.png','https://redbook.com/uploads/images/gallery/2023-04/iWuimage.png','2023-04-03 22:07:25','2023-04-03 22:07:25',1,1,'/uploads/images/gallery/2023-04/iWuimage.png','gallery',14),(26,'image.png','https://redbook.com/uploads/images/gallery/2023-04/JHKimage.png','2023-04-03 22:16:09','2023-04-03 22:16:09',1,1,'/uploads/images/gallery/2023-04/JHKimage.png','gallery',14),(27,'image.png','https://redbook.com/uploads/images/gallery/2023-04/3ybimage.png','2023-04-03 22:17:20','2023-04-03 22:17:20',1,1,'/uploads/images/gallery/2023-04/3ybimage.png','gallery',14),(28,'image.png','https://redbook.com/uploads/images/gallery/2023-04/JB2image.png','2023-04-03 22:19:20','2023-04-03 22:19:20',1,1,'/uploads/images/gallery/2023-04/JB2image.png','gallery',14),(29,'image.png','https://redbook.com/uploads/images/gallery/2023-04/b00image.png','2023-04-03 22:20:14','2023-04-03 22:20:14',1,1,'/uploads/images/gallery/2023-04/b00image.png','gallery',14),(30,'image.png','https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png','2023-04-03 22:22:54','2023-04-03 22:22:54',1,1,'/uploads/images/gallery/2023-04/BAHimage.png','gallery',14),(31,'image.png','https://redbook.com/uploads/images/gallery/2023-04/qoiimage.png','2023-04-03 22:35:07','2023-04-03 22:35:07',1,1,'/uploads/images/gallery/2023-04/qoiimage.png','gallery',15),(32,'image.png','https://redbook.com/uploads/images/gallery/2023-04/59Fimage.png','2023-04-03 22:44:09','2023-04-03 22:44:09',1,1,'/uploads/images/gallery/2023-04/59Fimage.png','gallery',15),(33,'image.png','https://redbook.com/uploads/images/gallery/2023-04/vq2image.png','2023-04-03 22:45:28','2023-04-03 22:45:28',1,1,'/uploads/images/gallery/2023-04/vq2image.png','gallery',15),(34,'image.png','https://redbook.com/uploads/images/gallery/2023-04/6itimage.png','2023-04-03 22:48:29','2023-04-03 22:48:29',1,1,'/uploads/images/gallery/2023-04/6itimage.png','gallery',15),(35,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Ycfimage.png','2023-04-03 22:49:48','2023-04-03 22:49:48',1,1,'/uploads/images/gallery/2023-04/Ycfimage.png','gallery',15),(36,'image.png','https://redbook.com/uploads/images/gallery/2023-04/yTwimage.png','2023-04-03 22:51:01','2023-04-03 22:51:01',1,1,'/uploads/images/gallery/2023-04/yTwimage.png','gallery',15),(37,'image.png','https://redbook.com/uploads/images/gallery/2023-04/9RIimage.png','2023-04-03 22:52:25','2023-04-03 22:52:25',1,1,'/uploads/images/gallery/2023-04/9RIimage.png','gallery',15),(38,'image.png','https://redbook.com/uploads/images/gallery/2023-04/B5bimage.png','2023-04-03 22:54:18','2023-04-03 22:54:18',1,1,'/uploads/images/gallery/2023-04/B5bimage.png','gallery',15),(39,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png','2023-04-03 22:57:03','2023-04-03 22:57:03',1,1,'/uploads/images/gallery/2023-04/Mc7image.png','gallery',15),(40,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HVYimage.png','2023-04-03 23:00:21','2023-04-03 23:00:21',1,1,'/uploads/images/gallery/2023-04/HVYimage.png','gallery',15),(41,'image.png','https://redbook.com/uploads/images/gallery/2023-04/jRdimage.png','2023-04-03 23:01:27','2023-04-03 23:01:27',1,1,'/uploads/images/gallery/2023-04/jRdimage.png','gallery',15),(42,'image.png','https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png','2023-04-03 23:03:19','2023-04-03 23:03:19',1,1,'/uploads/images/gallery/2023-04/gjaimage.png','gallery',15),(43,'image.png','https://redbook.com/uploads/images/gallery/2023-04/pYCimage.png','2023-04-03 23:05:36','2023-04-03 23:05:36',1,1,'/uploads/images/gallery/2023-04/pYCimage.png','gallery',15),(44,'image.png','https://redbook.com/uploads/images/gallery/2023-04/XMHimage.png','2023-04-03 23:10:01','2023-04-03 23:10:01',1,1,'/uploads/images/gallery/2023-04/XMHimage.png','gallery',15),(45,'image.png','https://redbook.com/uploads/images/gallery/2023-04/6goimage.png','2023-04-03 23:11:36','2023-04-03 23:11:36',1,1,'/uploads/images/gallery/2023-04/6goimage.png','gallery',15),(46,'image.png','https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png','2023-04-03 23:13:03','2023-04-03 23:13:03',1,1,'/uploads/images/gallery/2023-04/hXTimage.png','gallery',15),(47,'image.png','https://redbook.com/uploads/images/gallery/2023-04/uJUimage.png','2023-04-03 23:15:43','2023-04-03 23:15:43',1,1,'/uploads/images/gallery/2023-04/uJUimage.png','gallery',15),(48,'image.png','https://redbook.com/uploads/images/gallery/2023-04/0XSimage.png','2023-04-03 23:18:20','2023-04-03 23:18:20',1,1,'/uploads/images/gallery/2023-04/0XSimage.png','gallery',15),(49,'image.png','https://redbook.com/uploads/images/gallery/2023-04/pRdimage.png','2023-04-03 23:20:18','2023-04-03 23:20:18',1,1,'/uploads/images/gallery/2023-04/pRdimage.png','gallery',15),(50,'image.png','https://redbook.com/uploads/images/gallery/2023-04/hfkimage.png','2023-04-03 23:22:55','2023-04-03 23:22:55',1,1,'/uploads/images/gallery/2023-04/hfkimage.png','gallery',15),(51,'image.png','https://redbook.com/uploads/images/gallery/2023-04/pxYimage.png','2023-04-03 23:25:16','2023-04-03 23:25:16',1,1,'/uploads/images/gallery/2023-04/pxYimage.png','gallery',15),(52,'image.png','https://redbook.com/uploads/images/gallery/2023-04/cKAimage.png','2023-04-03 23:28:19','2023-04-03 23:28:19',1,1,'/uploads/images/gallery/2023-04/cKAimage.png','gallery',15),(53,'image.png','https://redbook.com/uploads/images/gallery/2023-04/mYQimage.png','2023-04-03 23:29:45','2023-04-03 23:29:45',1,1,'/uploads/images/gallery/2023-04/mYQimage.png','gallery',15),(54,'image.png','https://redbook.com/uploads/images/gallery/2023-04/TjEimage.png','2023-04-03 23:32:23','2023-04-03 23:32:23',1,1,'/uploads/images/gallery/2023-04/TjEimage.png','gallery',15),(55,'image.png','https://redbook.com/uploads/images/gallery/2023-04/2l6image.png','2023-04-03 23:33:10','2023-04-03 23:33:10',1,1,'/uploads/images/gallery/2023-04/2l6image.png','gallery',15),(56,'image.png','https://redbook.com/uploads/images/gallery/2023-04/mx6image.png','2023-04-03 23:34:32','2023-04-03 23:34:32',1,1,'/uploads/images/gallery/2023-04/mx6image.png','gallery',15),(57,'image.png','https://redbook.com/uploads/images/gallery/2023-04/tvzimage.png','2023-04-03 23:35:32','2023-04-03 23:35:32',1,1,'/uploads/images/gallery/2023-04/tvzimage.png','gallery',15),(58,'image.png','https://redbook.com/uploads/images/gallery/2023-04/dhEimage.png','2023-04-03 23:39:21','2023-04-03 23:39:21',1,1,'/uploads/images/gallery/2023-04/dhEimage.png','gallery',15),(59,'image.png','https://redbook.com/uploads/images/gallery/2023-04/B4Aimage.png','2023-04-03 23:46:43','2023-04-03 23:46:43',1,1,'/uploads/images/gallery/2023-04/B4Aimage.png','gallery',15),(60,'image.png','https://redbook.com/uploads/images/gallery/2023-04/iTDimage.png','2023-04-03 23:47:40','2023-04-03 23:47:40',1,1,'/uploads/images/gallery/2023-04/iTDimage.png','gallery',15),(61,'image.png','https://redbook.com/uploads/images/gallery/2023-04/pGyimage.png','2023-04-03 23:48:41','2023-04-03 23:48:41',1,1,'/uploads/images/gallery/2023-04/pGyimage.png','gallery',15),(62,'image.png','https://redbook.com/uploads/images/gallery/2023-04/2I5image.png','2023-04-03 23:50:21','2023-04-03 23:50:21',1,1,'/uploads/images/gallery/2023-04/2I5image.png','gallery',15),(63,'image.png','https://redbook.com/uploads/images/gallery/2023-04/3UBimage.png','2023-04-03 23:51:24','2023-04-03 23:51:24',1,1,'/uploads/images/gallery/2023-04/3UBimage.png','gallery',15),(64,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Nxsimage.png','2023-04-03 23:52:03','2023-04-03 23:52:03',1,1,'/uploads/images/gallery/2023-04/Nxsimage.png','gallery',15),(65,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Dj9image.png','2023-04-03 23:52:50','2023-04-03 23:52:50',1,1,'/uploads/images/gallery/2023-04/Dj9image.png','gallery',15),(66,'image.png','https://redbook.com/uploads/images/gallery/2023-04/h7Iimage.png','2023-04-03 23:53:21','2023-04-03 23:53:21',1,1,'/uploads/images/gallery/2023-04/h7Iimage.png','gallery',15),(67,'image.png','https://redbook.com/uploads/images/gallery/2023-04/vleimage.png','2023-04-04 00:12:47','2023-04-04 00:12:47',1,1,'/uploads/images/gallery/2023-04/vleimage.png','gallery',15),(68,'image.png','https://redbook.com/uploads/images/gallery/2023-04/CBYimage.png','2023-04-04 00:19:16','2023-04-04 00:19:16',1,1,'/uploads/images/gallery/2023-04/CBYimage.png','gallery',16),(69,'image.png','https://redbook.com/uploads/images/gallery/2023-04/ApVimage.png','2023-04-04 00:20:15','2023-04-04 00:20:15',1,1,'/uploads/images/gallery/2023-04/ApVimage.png','gallery',16),(70,'image.png','https://redbook.com/uploads/images/gallery/2023-04/RStimage.png','2023-04-04 00:36:57','2023-04-04 00:36:57',1,1,'/uploads/images/gallery/2023-04/RStimage.png','gallery',16),(71,'image.png','https://redbook.com/uploads/images/gallery/2023-04/VBWimage.png','2023-04-04 00:37:52','2023-04-04 00:37:52',1,1,'/uploads/images/gallery/2023-04/VBWimage.png','gallery',16),(72,'image.png','https://redbook.com/uploads/images/gallery/2023-04/6Qhimage.png','2023-04-04 00:39:06','2023-04-04 00:39:06',1,1,'/uploads/images/gallery/2023-04/6Qhimage.png','gallery',16),(73,'image.png','https://redbook.com/uploads/images/gallery/2023-04/mZUimage.png','2023-04-04 00:40:32','2023-04-04 00:40:32',1,1,'/uploads/images/gallery/2023-04/mZUimage.png','gallery',16),(74,'image.png','https://redbook.com/uploads/images/gallery/2023-04/bTcimage.png','2023-04-04 00:41:43','2023-04-04 00:41:43',1,1,'/uploads/images/gallery/2023-04/bTcimage.png','gallery',16),(75,'image.png','https://redbook.com/uploads/images/gallery/2023-04/X3Rimage.png','2023-04-04 00:43:21','2023-04-04 00:43:21',1,1,'/uploads/images/gallery/2023-04/X3Rimage.png','gallery',16),(76,'image.png','https://redbook.com/uploads/images/gallery/2023-04/hdjimage.png','2023-04-04 00:46:31','2023-04-04 00:46:31',1,1,'/uploads/images/gallery/2023-04/hdjimage.png','gallery',16),(77,'image.png','https://redbook.com/uploads/images/gallery/2023-04/jJGimage.png','2023-04-04 00:47:54','2023-04-04 00:47:54',1,1,'/uploads/images/gallery/2023-04/jJGimage.png','gallery',16),(78,'image.png','https://redbook.com/uploads/images/gallery/2023-04/rocimage.png','2023-04-04 00:49:13','2023-04-04 00:49:13',1,1,'/uploads/images/gallery/2023-04/rocimage.png','gallery',16),(79,'image.png','https://redbook.com/uploads/images/gallery/2023-04/rtkimage.png','2023-04-04 00:53:08','2023-04-04 00:53:08',1,1,'/uploads/images/gallery/2023-04/rtkimage.png','gallery',16),(80,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Dp2image.png','2023-04-04 00:54:27','2023-04-04 00:54:27',1,1,'/uploads/images/gallery/2023-04/Dp2image.png','gallery',16),(81,'image.png','https://redbook.com/uploads/images/gallery/2023-04/LCiimage.png','2023-04-04 00:57:10','2023-04-04 00:57:10',1,1,'/uploads/images/gallery/2023-04/LCiimage.png','gallery',16),(82,'image.png','https://redbook.com/uploads/images/gallery/2023-04/CtSimage.png','2023-04-04 00:58:55','2023-04-04 00:58:55',1,1,'/uploads/images/gallery/2023-04/CtSimage.png','gallery',16),(83,'image.png','https://redbook.com/uploads/images/gallery/2023-04/nkAimage.png','2023-04-04 01:00:29','2023-04-04 01:00:29',1,1,'/uploads/images/gallery/2023-04/nkAimage.png','gallery',16),(84,'image.png','https://redbook.com/uploads/images/gallery/2023-04/J49image.png','2023-04-04 01:02:10','2023-04-04 01:02:10',1,1,'/uploads/images/gallery/2023-04/J49image.png','gallery',16),(85,'image.png','https://redbook.com/uploads/images/gallery/2023-04/sbaimage.png','2023-04-04 01:03:51','2023-04-04 01:03:51',1,1,'/uploads/images/gallery/2023-04/sbaimage.png','gallery',16),(86,'image.png','https://redbook.com/uploads/images/gallery/2023-04/i8Nimage.png','2023-04-04 01:05:33','2023-04-04 01:05:33',1,1,'/uploads/images/gallery/2023-04/i8Nimage.png','gallery',16),(87,'image.png','https://redbook.com/uploads/images/gallery/2023-04/xo4image.png','2023-04-04 01:06:40','2023-04-04 01:06:40',1,1,'/uploads/images/gallery/2023-04/xo4image.png','gallery',16),(88,'image.png','https://redbook.com/uploads/images/gallery/2023-04/ROCimage.png','2023-04-04 01:07:59','2023-04-04 01:07:59',1,1,'/uploads/images/gallery/2023-04/ROCimage.png','gallery',16),(89,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HDTimage.png','2023-04-04 01:09:13','2023-04-04 01:09:13',1,1,'/uploads/images/gallery/2023-04/HDTimage.png','gallery',16),(90,'image.png','https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png','2023-04-04 01:10:26','2023-04-04 01:10:26',1,1,'/uploads/images/gallery/2023-04/4KAimage.png','gallery',16),(91,'image.png','https://redbook.com/uploads/images/gallery/2023-04/jICimage.png','2023-04-04 01:16:01','2023-04-04 01:16:01',1,1,'/uploads/images/gallery/2023-04/jICimage.png','gallery',17),(92,'image.png','https://redbook.com/uploads/images/gallery/2023-04/E0aimage.png','2023-04-04 01:17:21','2023-04-04 01:17:21',1,1,'/uploads/images/gallery/2023-04/E0aimage.png','gallery',17),(93,'image.png','https://redbook.com/uploads/images/gallery/2023-04/hzximage.png','2023-04-04 01:18:53','2023-04-04 01:18:53',1,1,'/uploads/images/gallery/2023-04/hzximage.png','gallery',17),(94,'image.png','https://redbook.com/uploads/images/gallery/2023-04/UQkimage.png','2023-04-04 01:20:38','2023-04-04 01:20:38',1,1,'/uploads/images/gallery/2023-04/UQkimage.png','gallery',17),(95,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Pysimage.png','2023-04-04 01:21:41','2023-04-04 01:21:41',1,1,'/uploads/images/gallery/2023-04/Pysimage.png','gallery',17),(96,'image.png','https://redbook.com/uploads/images/gallery/2023-04/iqfimage.png','2023-04-04 01:23:09','2023-04-04 01:23:09',1,1,'/uploads/images/gallery/2023-04/iqfimage.png','gallery',17),(97,'image.png','https://redbook.com/uploads/images/gallery/2023-04/3Qyimage.png','2023-04-04 01:25:32','2023-04-04 01:25:32',1,1,'/uploads/images/gallery/2023-04/3Qyimage.png','gallery',17),(98,'image.png','https://redbook.com/uploads/images/gallery/2023-04/qstimage.png','2023-04-04 01:27:39','2023-04-04 01:27:39',1,1,'/uploads/images/gallery/2023-04/qstimage.png','gallery',17),(99,'image.png','https://redbook.com/uploads/images/gallery/2023-04/GViimage.png','2023-04-04 01:30:58','2023-04-04 01:30:58',1,1,'/uploads/images/gallery/2023-04/GViimage.png','gallery',17),(100,'image.png','https://redbook.com/uploads/images/gallery/2023-04/EYoimage.png','2023-04-04 01:32:48','2023-04-04 01:32:48',1,1,'/uploads/images/gallery/2023-04/EYoimage.png','gallery',17),(101,'image.png','https://redbook.com/uploads/images/gallery/2023-04/9nzimage.png','2023-04-04 01:34:05','2023-04-04 01:34:05',1,1,'/uploads/images/gallery/2023-04/9nzimage.png','gallery',17),(102,'image.png','https://redbook.com/uploads/images/gallery/2023-04/TOTimage.png','2023-04-04 01:36:08','2023-04-04 01:36:08',1,1,'/uploads/images/gallery/2023-04/TOTimage.png','gallery',17),(103,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HNlimage.png','2023-04-04 01:37:54','2023-04-04 01:37:54',1,1,'/uploads/images/gallery/2023-04/HNlimage.png','gallery',17),(104,'image.png','https://redbook.com/uploads/images/gallery/2023-04/h9Rimage.png','2023-04-04 01:39:08','2023-04-04 01:39:08',1,1,'/uploads/images/gallery/2023-04/h9Rimage.png','gallery',17),(105,'image.png','https://redbook.com/uploads/images/gallery/2023-04/6Mtimage.png','2023-04-04 01:40:27','2023-04-04 01:40:27',1,1,'/uploads/images/gallery/2023-04/6Mtimage.png','gallery',17),(106,'image.png','https://redbook.com/uploads/images/gallery/2023-04/aUSimage.png','2023-04-04 01:42:48','2023-04-04 01:42:48',1,1,'/uploads/images/gallery/2023-04/aUSimage.png','gallery',17),(107,'image.png','https://redbook.com/uploads/images/gallery/2023-04/YcJimage.png','2023-04-04 01:44:28','2023-04-04 01:44:28',1,1,'/uploads/images/gallery/2023-04/YcJimage.png','gallery',17),(108,'image.png','https://redbook.com/uploads/images/gallery/2023-04/i6Timage.png','2023-04-04 01:48:11','2023-04-04 01:48:11',1,1,'/uploads/images/gallery/2023-04/i6Timage.png','gallery',17),(109,'image.png','https://redbook.com/uploads/images/gallery/2023-04/dj1image.png','2023-04-04 01:50:24','2023-04-04 01:50:24',1,1,'/uploads/images/gallery/2023-04/dj1image.png','gallery',17),(110,'image.png','https://redbook.com/uploads/images/gallery/2023-04/2LTimage.png','2023-04-04 01:55:07','2023-04-04 01:55:07',1,1,'/uploads/images/gallery/2023-04/2LTimage.png','gallery',18),(111,'image.png','https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png','2023-04-04 01:55:56','2023-04-04 01:55:56',1,1,'/uploads/images/gallery/2023-04/pOSimage.png','gallery',18),(112,'image.png','https://redbook.com/uploads/images/gallery/2023-04/zhIimage.png','2023-04-04 01:57:19','2023-04-04 01:57:19',1,1,'/uploads/images/gallery/2023-04/zhIimage.png','gallery',18),(113,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HOIimage.png','2023-04-04 01:59:11','2023-04-04 01:59:11',1,1,'/uploads/images/gallery/2023-04/HOIimage.png','gallery',18),(114,'image.png','https://redbook.com/uploads/images/gallery/2023-04/PKKimage.png','2023-04-04 16:03:46','2023-04-04 16:03:46',1,1,'/uploads/images/gallery/2023-04/PKKimage.png','gallery',18),(115,'image.png','https://redbook.com/uploads/images/gallery/2023-04/ntHimage.png','2023-04-04 16:08:05','2023-04-04 16:08:05',1,1,'/uploads/images/gallery/2023-04/ntHimage.png','gallery',18),(116,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HqFimage.png','2023-04-04 16:09:42','2023-04-04 16:09:42',1,1,'/uploads/images/gallery/2023-04/HqFimage.png','gallery',18),(117,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Zjsimage.png','2023-04-04 16:12:42','2023-04-04 16:12:42',1,1,'/uploads/images/gallery/2023-04/Zjsimage.png','gallery',18),(118,'image.png','https://redbook.com/uploads/images/gallery/2023-04/sLCimage.png','2023-04-04 16:16:08','2023-04-04 16:16:08',1,1,'/uploads/images/gallery/2023-04/sLCimage.png','gallery',18),(119,'image.png','https://redbook.com/uploads/images/gallery/2023-04/ABNimage.png','2023-04-04 16:17:12','2023-04-04 16:17:12',1,1,'/uploads/images/gallery/2023-04/ABNimage.png','gallery',18),(120,'image.png','https://redbook.com/uploads/images/gallery/2023-04/KPPimage.png','2023-04-04 16:20:36','2023-04-04 16:20:36',1,1,'/uploads/images/gallery/2023-04/KPPimage.png','gallery',18),(121,'image.png','https://redbook.com/uploads/images/gallery/2023-04/0yJimage.png','2023-04-04 16:21:12','2023-04-04 16:21:12',1,1,'/uploads/images/gallery/2023-04/0yJimage.png','gallery',18),(122,'image.png','https://redbook.com/uploads/images/gallery/2023-04/7saimage.png','2023-04-04 16:24:43','2023-04-04 16:24:43',1,1,'/uploads/images/gallery/2023-04/7saimage.png','gallery',18),(123,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Bxbimage.png','2023-04-04 16:57:55','2023-04-04 16:57:55',1,1,'/uploads/images/gallery/2023-04/Bxbimage.png','gallery',18),(124,'image.png','https://redbook.com/uploads/images/gallery/2023-04/6tXimage.png','2023-04-04 17:04:10','2023-04-04 17:04:10',1,1,'/uploads/images/gallery/2023-04/6tXimage.png','gallery',18),(125,'image.png','https://redbook.com/uploads/images/gallery/2023-04/qcBimage.png','2023-04-04 17:07:36','2023-04-04 17:07:36',1,1,'/uploads/images/gallery/2023-04/qcBimage.png','gallery',18),(126,'image.png','https://redbook.com/uploads/images/gallery/2023-04/xITimage.png','2023-04-04 17:08:06','2023-04-04 17:08:06',1,1,'/uploads/images/gallery/2023-04/xITimage.png','gallery',18),(127,'image.png','https://redbook.com/uploads/images/gallery/2023-04/eUlimage.png','2023-04-04 17:11:32','2023-04-04 17:11:32',1,1,'/uploads/images/gallery/2023-04/eUlimage.png','gallery',18),(128,'image.png','https://redbook.com/uploads/images/gallery/2023-04/b0Yimage.png','2023-04-04 17:40:41','2023-04-04 17:40:41',1,1,'/uploads/images/gallery/2023-04/b0Yimage.png','gallery',19),(129,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HCCimage.png','2023-04-04 17:41:45','2023-04-04 17:41:45',1,1,'/uploads/images/gallery/2023-04/HCCimage.png','gallery',19),(130,'image.png','https://redbook.com/uploads/images/gallery/2023-04/dDwimage.png','2023-04-04 19:23:11','2023-04-04 19:23:11',1,1,'/uploads/images/gallery/2023-04/dDwimage.png','gallery',17),(131,'networkoverview.jpeg','https://redbook.com/uploads/images/cover_book/2023-04/networkoverview.jpeg','2023-04-04 19:52:38','2023-04-04 19:52:38',1,1,'/uploads/images/cover_book/2023-04/networkoverview.jpeg','cover_book',2),(132,'sysoverview.jpeg','https://redbook.com/uploads/images/cover_book/2023-04/sysoverview.jpeg','2023-04-04 19:52:55','2023-04-04 19:52:55',1,1,'/uploads/images/cover_book/2023-04/sysoverview.jpeg','cover_book',3),(133,'howto.png','https://redbook.com/uploads/images/cover_book/2023-04/howto.png','2023-04-04 19:53:12','2023-04-04 19:53:12',1,1,'/uploads/images/cover_book/2023-04/howto.png','cover_book',4),(134,'hacker.jpeg','https://redbook.com/uploads/images/cover_book/2023-04/hacker.jpeg','2023-04-04 19:55:11','2023-04-04 19:55:11',1,1,'/uploads/images/cover_book/2023-04/hacker.jpeg','cover_book',6),(135,'grayspace2.jpeg','https://redbook.com/uploads/images/cover_bookshelf/2023-04/grayspace2.jpeg','2023-04-04 19:57:43','2023-04-04 19:57:43',1,1,'/uploads/images/cover_bookshelf/2023-04/grayspace2.jpeg','cover_bookshelf',2),(136,'image.png','https://redbook.com/uploads/images/gallery/2023-04/llJimage.png','2023-04-04 22:46:15','2023-04-04 22:46:15',1,1,'/uploads/images/gallery/2023-04/llJimage.png','gallery',19),(137,'image.png','https://redbook.com/uploads/images/gallery/2023-04/tHEimage.png','2023-04-04 22:52:39','2023-04-04 22:52:39',1,1,'/uploads/images/gallery/2023-04/tHEimage.png','gallery',19),(138,'image.png','https://redbook.com/uploads/images/gallery/2023-04/s1Nimage.png','2023-04-04 22:53:34','2023-04-04 22:53:34',1,1,'/uploads/images/gallery/2023-04/s1Nimage.png','gallery',19),(139,'image.png','https://redbook.com/uploads/images/gallery/2023-04/oIPimage.png','2023-04-04 22:54:07','2023-04-04 22:54:07',1,1,'/uploads/images/gallery/2023-04/oIPimage.png','gallery',19),(140,'image.png','https://redbook.com/uploads/images/gallery/2023-04/wRNimage.png','2023-04-04 22:59:32','2023-04-04 22:59:32',1,1,'/uploads/images/gallery/2023-04/wRNimage.png','gallery',19),(141,'image.png','https://redbook.com/uploads/images/gallery/2023-04/roTimage.png','2023-04-04 23:02:09','2023-04-04 23:02:09',1,1,'/uploads/images/gallery/2023-04/roTimage.png','gallery',19),(142,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Kb5image.png','2023-04-04 23:47:39','2023-04-04 23:47:39',1,1,'/uploads/images/gallery/2023-04/Kb5image.png','gallery',19),(143,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HB3image.png','2023-04-04 23:58:45','2023-04-04 23:58:45',1,1,'/uploads/images/gallery/2023-04/HB3image.png','gallery',19),(144,'image.png','https://redbook.com/uploads/images/gallery/2023-04/ziwimage.png','2023-04-05 00:00:19','2023-04-05 00:00:19',1,1,'/uploads/images/gallery/2023-04/ziwimage.png','gallery',19),(145,'image.png','https://redbook.com/uploads/images/gallery/2023-04/gLFimage.png','2023-04-05 00:00:44','2023-04-05 00:00:44',1,1,'/uploads/images/gallery/2023-04/gLFimage.png','gallery',19),(146,'image.png','https://redbook.com/uploads/images/gallery/2023-04/X9Ximage.png','2023-04-05 00:11:52','2023-04-05 00:11:52',1,1,'/uploads/images/gallery/2023-04/X9Ximage.png','gallery',20),(147,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Uiqimage.png','2023-04-05 00:13:06','2023-04-05 00:13:06',1,1,'/uploads/images/gallery/2023-04/Uiqimage.png','gallery',20),(148,'image.png','https://redbook.com/uploads/images/gallery/2023-04/HfLimage.png','2023-04-05 00:13:43','2023-04-05 00:13:43',1,1,'/uploads/images/gallery/2023-04/HfLimage.png','gallery',20),(149,'image.png','https://redbook.com/uploads/images/gallery/2023-04/NWzimage.png','2023-04-05 00:29:12','2023-04-05 00:29:12',1,1,'/uploads/images/gallery/2023-04/NWzimage.png','gallery',20),(150,'image.png','https://redbook.com/uploads/images/gallery/2023-04/buTimage.png','2023-04-05 00:31:19','2023-04-05 00:31:19',1,1,'/uploads/images/gallery/2023-04/buTimage.png','gallery',20),(151,'image.png','https://redbook.com/uploads/images/gallery/2023-04/TFUimage.png','2023-04-05 00:33:44','2023-04-05 00:33:44',1,1,'/uploads/images/gallery/2023-04/TFUimage.png','gallery',20),(152,'image.png','https://redbook.com/uploads/images/gallery/2023-04/8awimage.png','2023-04-05 00:35:01','2023-04-05 00:35:01',1,1,'/uploads/images/gallery/2023-04/8awimage.png','gallery',20),(153,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Awbimage.png','2023-04-05 00:41:09','2023-04-05 00:41:09',1,1,'/uploads/images/gallery/2023-04/Awbimage.png','gallery',21),(154,'creds.jpeg','https://redbook.com/uploads/images/cover_book/2023-04/creds.jpeg','2023-04-05 00:47:13','2023-04-05 00:47:13',1,1,'/uploads/images/cover_book/2023-04/creds.jpeg','cover_book',7),(156,'CRicon.png','https://redbook.com/uploads/images/system/2023-04/cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46',1,1,'/uploads/images/system/2023-04/cricon.png','system',0),(157,'CRicon.png','https://redbook.com/uploads/images/system/2023-04/Zx6cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46',1,1,'/uploads/images/system/2023-04/Zx6cricon.png','system',0),(158,'CRicon.png','https://redbook.com/uploads/images/system/2023-04/ML7cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46',1,1,'/uploads/images/system/2023-04/ML7cricon.png','system',0),(159,'CRicon.png','https://redbook.com/uploads/images/system/2023-04/6qWcricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46',1,1,'/uploads/images/system/2023-04/6qWcricon.png','system',0),(160,'CRicon.png','https://redbook.com/uploads/images/system/2023-04/QV0cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46',1,1,'/uploads/images/system/2023-04/QV0cricon.png','system',0),(161,'cyber-range-low-resolution-logo-color-on-transparent-background.png','https://redbook.com/uploads/images/system/2023-04/cyber-range-low-resolution-logo-color-on-transparent-background.png','2023-04-06 17:01:33','2023-04-06 17:01:33',1,1,'/uploads/images/system/2023-04/cyber-range-low-resolution-logo-color-on-transparent-background.png','system',0),(162,'planning.jpeg','https://redbook.com/uploads/images/cover_book/2023-04/planning.jpeg','2023-04-06 17:18:50','2023-04-06 17:18:50',1,1,'/uploads/images/cover_book/2023-04/planning.jpeg','cover_book',8),(163,'Drawing-1-1681151514.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png','2023-04-10 23:31:54','2023-04-10 23:31:54',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681151514.png','drawio',2),(164,'Drawing-1-1681155792.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155792.png','2023-04-11 00:43:12','2023-04-11 00:43:12',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681155792.png','drawio',29),(165,'Drawing-1-1681155829.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155829.png','2023-04-11 00:43:49','2023-04-11 00:43:49',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681155829.png','drawio',29),(166,'image.png','https://redbook.com/uploads/images/gallery/2023-04/A2limage.png','2023-04-11 17:20:50','2023-04-11 17:20:50',1,1,'/uploads/images/gallery/2023-04/A2limage.png','gallery',6),(167,'image.png','https://redbook.com/uploads/images/gallery/2023-04/oMfimage.png','2023-04-11 20:52:00','2023-04-11 20:52:00',1,1,'/uploads/images/gallery/2023-04/oMfimage.png','gallery',30),(168,'image.png','https://redbook.com/uploads/images/gallery/2023-04/8wximage.png','2023-04-11 20:54:37','2023-04-11 20:54:37',1,1,'/uploads/images/gallery/2023-04/8wximage.png','gallery',30),(169,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Hkdimage.png','2023-04-11 20:57:16','2023-04-11 20:57:16',1,1,'/uploads/images/gallery/2023-04/Hkdimage.png','gallery',30),(170,'image.png','https://redbook.com/uploads/images/gallery/2023-04/GJgimage.png','2023-04-11 23:04:03','2023-04-11 23:04:03',1,1,'/uploads/images/gallery/2023-04/GJgimage.png','gallery',30),(171,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Iz8image.png','2023-04-11 23:06:57','2023-04-11 23:06:57',1,1,'/uploads/images/gallery/2023-04/Iz8image.png','gallery',30),(172,'image.png','https://redbook.com/uploads/images/gallery/2023-04/JBlimage.png','2023-04-11 23:08:25','2023-04-11 23:08:25',1,1,'/uploads/images/gallery/2023-04/JBlimage.png','gallery',30),(173,'image.png','https://redbook.com/uploads/images/gallery/2023-04/eZVimage.png','2023-04-11 23:55:33','2023-04-11 23:55:33',1,1,'/uploads/images/gallery/2023-04/eZVimage.png','gallery',31),(174,'image.png','https://redbook.com/uploads/images/gallery/2023-04/KSvimage.png','2023-04-11 23:56:44','2023-04-11 23:56:44',1,1,'/uploads/images/gallery/2023-04/KSvimage.png','gallery',31),(175,'image.png','https://redbook.com/uploads/images/gallery/2023-04/sY0image.png','2023-04-12 00:02:32','2023-04-12 00:02:32',1,1,'/uploads/images/gallery/2023-04/sY0image.png','gallery',31),(176,'image.png','https://redbook.com/uploads/images/gallery/2023-04/Bj5image.png','2023-04-12 00:06:00','2023-04-12 00:06:00',1,1,'/uploads/images/gallery/2023-04/Bj5image.png','gallery',31),(177,'image.png','https://redbook.com/uploads/images/gallery/2023-04/2pHimage.png','2023-04-12 00:08:34','2023-04-12 00:08:34',1,1,'/uploads/images/gallery/2023-04/2pHimage.png','gallery',31),(178,'Drawing-1-1681243904.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681243904.png','2023-04-12 01:11:44','2023-04-12 01:11:44',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681243904.png','drawio',29),(179,'Drawing-1-1681243955.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681243955.png','2023-04-12 01:12:35','2023-04-12 01:12:35',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681243955.png','drawio',29),(180,'Drawing-1-1681300960.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681300960.png','2023-04-12 17:02:40','2023-04-12 17:02:40',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681300960.png','drawio',2),(181,'Drawing-1-1681301037.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301037.png','2023-04-12 17:03:57','2023-04-12 17:03:57',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681301037.png','drawio',2),(182,'Drawing-1-1681301203.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301203.png','2023-04-12 17:06:43','2023-04-12 17:06:43',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681301203.png','drawio',2),(183,'Drawing-1-1681301764.png','https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png','2023-04-12 17:16:04','2023-04-12 17:16:04',1,1,'/uploads/images/drawio/2023-04/drawing-1-1681301764.png','drawio',2);
/*!40000 ALTER TABLE `images` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `jobs`
--

DROP TABLE IF EXISTS `jobs`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `jobs` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `queue` varchar(191) NOT NULL,
  `payload` longtext NOT NULL,
  `attempts` tinyint(3) unsigned NOT NULL,
  `reserved_at` int(10) unsigned DEFAULT NULL,
  `available_at` int(10) unsigned NOT NULL,
  `created_at` int(10) unsigned NOT NULL,
  PRIMARY KEY (`id`),
  KEY `jobs_queue_index` (`queue`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `jobs`
--

LOCK TABLES `jobs` WRITE;
/*!40000 ALTER TABLE `jobs` DISABLE KEYS */;
/*!40000 ALTER TABLE `jobs` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `joint_permissions`
--

DROP TABLE IF EXISTS `joint_permissions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `joint_permissions` (
  `role_id` int(11) NOT NULL,
  `entity_type` varchar(191) NOT NULL,
  `entity_id` int(11) NOT NULL,
  `status` tinyint(3) unsigned NOT NULL,
  `owner_id` int(10) unsigned DEFAULT NULL,
  PRIMARY KEY (`role_id`,`entity_type`,`entity_id`),
  KEY `joint_permissions_entity_id_entity_type_index` (`entity_id`,`entity_type`),
  KEY `joint_permissions_role_id_index` (`role_id`),
  KEY `joint_permissions_status_index` (`status`),
  KEY `joint_permissions_owner_id_index` (`owner_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `joint_permissions`
--

LOCK TABLES `joint_permissions` WRITE;
/*!40000 ALTER TABLE `joint_permissions` DISABLE KEYS */;
INSERT INTO `joint_permissions` VALUES (1,'book',1,3,1),(1,'book',2,3,1),(1,'book',3,3,1),(1,'book',4,3,1),(1,'book',5,3,1),(1,'book',6,3,1),(1,'book',7,3,1),(1,'book',8,3,1),(1,'bookshelf',1,3,1),(1,'bookshelf',2,3,1),(1,'chapter',1,3,1),(1,'page',1,3,1),(1,'page',2,3,1),(1,'page',3,3,1),(1,'page',4,3,1),(1,'page',5,3,1),(1,'page',6,3,1),(1,'page',7,3,1),(1,'page',8,3,1),(1,'page',9,3,1),(1,'page',10,3,1),(1,'page',11,3,1),(1,'page',12,3,1),(1,'page',13,3,1),(1,'page',14,3,1),(1,'page',15,3,1),(1,'page',16,3,1),(1,'page',17,3,1),(1,'page',18,3,1),(1,'page',19,3,1),(1,'page',20,3,1),(1,'page',21,3,1),(1,'page',22,3,1),(1,'page',23,3,1),(1,'page',24,3,1),(1,'page',25,3,1),(1,'page',26,3,1),(1,'page',27,3,1),(1,'page',28,3,1),(1,'page',29,3,1),(1,'page',30,3,1),(1,'page',31,3,1),(1,'page',32,3,1),(2,'book',1,1,1),(2,'book',2,1,1),(2,'book',3,1,1),(2,'book',4,1,1),(2,'book',5,1,1),(2,'book',6,1,1),(2,'book',7,1,1),(2,'book',8,1,1),(2,'bookshelf',1,1,1),(2,'bookshelf',2,1,1),(2,'chapter',1,1,1),(2,'page',1,1,1),(2,'page',2,1,1),(2,'page',3,1,1),(2,'page',4,1,1),(2,'page',5,1,1),(2,'page',6,1,1),(2,'page',7,1,1),(2,'page',8,1,1),(2,'page',9,1,1),(2,'page',10,1,1),(2,'page',11,1,1),(2,'page',12,1,1),(2,'page',13,1,1),(2,'page',14,1,1),(2,'page',15,1,1),(2,'page',16,1,1),(2,'page',17,1,1),(2,'page',18,1,1),(2,'page',19,1,1),(2,'page',20,1,1),(2,'page',21,1,1),(2,'page',22,1,1),(2,'page',23,1,1),(2,'page',24,1,1),(2,'page',25,1,1),(2,'page',26,1,1),(2,'page',27,1,1),(2,'page',28,1,1),(2,'page',29,1,1),(2,'page',30,1,1),(2,'page',31,1,1),(2,'page',32,1,1),(3,'book',1,1,1),(3,'book',2,1,1),(3,'book',3,1,1),(3,'book',4,1,1),(3,'book',5,1,1),(3,'book',6,1,1),(3,'book',7,1,1),(3,'book',8,1,1),(3,'bookshelf',1,1,1),(3,'bookshelf',2,1,1),(3,'chapter',1,1,1),(3,'page',1,1,1),(3,'page',2,1,1),(3,'page',3,1,1),(3,'page',4,1,1),(3,'page',5,1,1),(3,'page',6,1,1),(3,'page',7,1,1),(3,'page',8,1,1),(3,'page',9,1,1),(3,'page',10,1,1),(3,'page',11,1,1),(3,'page',12,1,1),(3,'page',13,1,1),(3,'page',14,1,1),(3,'page',15,1,1),(3,'page',16,1,1),(3,'page',17,1,1),(3,'page',18,1,1),(3,'page',19,1,1),(3,'page',20,1,1),(3,'page',21,1,1),(3,'page',22,1,1),(3,'page',23,1,1),(3,'page',24,1,1),(3,'page',25,1,1),(3,'page',26,1,1),(3,'page',27,1,1),(3,'page',28,1,1),(3,'page',29,1,1),(3,'page',30,1,1),(3,'page',31,1,1),(3,'page',32,1,1),(4,'book',1,1,1),(4,'book',2,1,1),(4,'book',3,1,1),(4,'book',4,1,1),(4,'book',5,1,1),(4,'book',6,1,1),(4,'book',7,1,1),(4,'book',8,1,1),(4,'bookshelf',1,1,1),(4,'bookshelf',2,1,1),(4,'chapter',1,1,1),(4,'page',1,1,1),(4,'page',2,1,1),(4,'page',3,1,1),(4,'page',4,1,1),(4,'page',5,1,1),(4,'page',6,1,1),(4,'page',7,1,1),(4,'page',8,1,1),(4,'page',9,1,1),(4,'page',10,1,1),(4,'page',11,1,1),(4,'page',12,1,1),(4,'page',13,1,1),(4,'page',14,1,1),(4,'page',15,1,1),(4,'page',16,1,1),(4,'page',17,1,1),(4,'page',18,1,1),(4,'page',19,1,1),(4,'page',20,1,1),(4,'page',21,1,1),(4,'page',22,1,1),(4,'page',23,1,1),(4,'page',24,1,1),(4,'page',25,1,1),(4,'page',26,1,1),(4,'page',27,1,1),(4,'page',28,1,1),(4,'page',29,1,1),(4,'page',30,1,1),(4,'page',31,1,1),(4,'page',32,1,1);
/*!40000 ALTER TABLE `joint_permissions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `mfa_values`
--

DROP TABLE IF EXISTS `mfa_values`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `mfa_values` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `method` varchar(20) NOT NULL,
  `value` text NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `mfa_values_user_id_index` (`user_id`),
  KEY `mfa_values_method_index` (`method`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `mfa_values`
--

LOCK TABLES `mfa_values` WRITE;
/*!40000 ALTER TABLE `mfa_values` DISABLE KEYS */;
/*!40000 ALTER TABLE `mfa_values` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `migrations`
--

DROP TABLE IF EXISTS `migrations`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `migrations` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `migration` varchar(191) NOT NULL,
  `batch` int(11) NOT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB AUTO_INCREMENT=75 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `migrations`
--

LOCK TABLES `migrations` WRITE;
/*!40000 ALTER TABLE `migrations` DISABLE KEYS */;
INSERT INTO `migrations` VALUES (1,'2014_10_12_000000_create_users_table',1),(2,'2014_10_12_100000_create_password_resets_table',1),(3,'2015_07_12_114933_create_books_table',1),(4,'2015_07_12_190027_create_pages_table',1),(5,'2015_07_13_172121_create_images_table',1),(6,'2015_07_27_172342_create_chapters_table',1),(7,'2015_08_08_200447_add_users_to_entities',1),(8,'2015_08_09_093534_create_page_revisions_table',1),(9,'2015_08_16_142133_create_activities_table',1),(10,'2015_08_29_105422_add_roles_and_permissions',1),(11,'2015_08_30_125859_create_settings_table',1),(12,'2015_08_31_175240_add_search_indexes',1),(13,'2015_09_04_165821_create_social_accounts_table',1),(14,'2015_09_05_164707_add_email_confirmation_table',1),(15,'2015_11_21_145609_create_views_table',1),(16,'2015_11_26_221857_add_entity_indexes',1),(17,'2015_12_05_145049_fulltext_weighting',1),(18,'2015_12_07_195238_add_image_upload_types',1),(19,'2015_12_09_195748_add_user_avatars',1),(20,'2016_01_11_210908_add_external_auth_to_users',1),(21,'2016_02_25_184030_add_slug_to_revisions',1),(22,'2016_02_27_120329_update_permissions_and_roles',1),(23,'2016_02_28_084200_add_entity_access_controls',1),(24,'2016_03_09_203143_add_page_revision_types',1),(25,'2016_03_13_082138_add_page_drafts',1),(26,'2016_03_25_123157_add_markdown_support',1),(27,'2016_04_09_100730_add_view_permissions_to_roles',1),(28,'2016_04_20_192649_create_joint_permissions_table',1),(29,'2016_05_06_185215_create_tags_table',1),(30,'2016_07_07_181521_add_summary_to_page_revisions',1),(31,'2016_09_29_101449_remove_hidden_roles',1),(32,'2016_10_09_142037_create_attachments_table',1),(33,'2017_01_21_163556_create_cache_table',1),(34,'2017_01_21_163602_create_sessions_table',1),(35,'2017_03_19_091553_create_search_index_table',1),(36,'2017_04_20_185112_add_revision_counts',1),(37,'2017_07_02_152834_update_db_encoding_to_ut8mb4',1),(38,'2017_08_01_130541_create_comments_table',1),(39,'2017_08_29_102650_add_cover_image_display',1),(40,'2018_07_15_173514_add_role_external_auth_id',1),(41,'2018_08_04_115700_create_bookshelves_table',1),(42,'2019_07_07_112515_add_template_support',1),(43,'2019_08_17_140214_add_user_invites_table',1),(44,'2019_12_29_120917_add_api_auth',1),(45,'2020_08_04_111754_drop_joint_permissions_id',1),(46,'2020_08_04_131052_remove_role_name_field',1),(47,'2020_09_19_094251_add_activity_indexes',1),(48,'2020_09_27_210059_add_entity_soft_deletes',1),(49,'2020_09_27_210528_create_deletions_table',1),(50,'2020_11_07_232321_simplify_activities_table',1),(51,'2020_12_30_173528_add_owned_by_field_to_entities',1),(52,'2021_01_30_225441_add_settings_type_column',1),(53,'2021_03_08_215138_add_user_slug',1),(54,'2021_05_15_173110_create_favourites_table',1),(55,'2021_06_30_173111_create_mfa_values_table',1),(56,'2021_07_03_085038_add_mfa_enforced_to_roles_table',1),(57,'2021_08_28_161743_add_export_role_permission',1),(58,'2021_09_26_044614_add_activities_ip_column',1),(59,'2021_11_26_070438_add_index_for_user_ip',1),(60,'2021_12_07_111343_create_webhooks_table',1),(61,'2021_12_13_152024_create_jobs_table',1),(62,'2021_12_13_152120_create_failed_jobs_table',1),(63,'2022_01_03_154041_add_webhooks_timeout_error_columns',1),(64,'2022_04_17_101741_add_editor_change_field_and_permission',1),(65,'2022_04_25_140741_update_polymorphic_types',1),(66,'2022_07_16_170051_drop_joint_permission_type',1),(67,'2022_08_17_092941_create_references_table',1),(68,'2022_09_02_082910_fix_shelf_cover_image_types',1),(69,'2022_10_07_091406_flatten_entity_permissions_table',1),(70,'2022_10_08_104202_drop_entity_restricted_field',1),(71,'2023_01_24_104625_refactor_joint_permissions_storage',1),(72,'2023_01_28_141230_copy_color_settings_for_dark_mode',1),(73,'2023_02_20_093655_increase_attachments_path_length',1),(74,'2023_02_23_200227_add_updated_at_index_to_pages',1);
/*!40000 ALTER TABLE `migrations` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `page_revisions`
--

DROP TABLE IF EXISTS `page_revisions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `page_revisions` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `page_id` int(11) NOT NULL,
  `name` varchar(191) NOT NULL,
  `html` longtext NOT NULL,
  `text` longtext NOT NULL,
  `created_by` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `slug` varchar(191) NOT NULL,
  `book_slug` varchar(191) NOT NULL,
  `type` varchar(191) NOT NULL DEFAULT 'version',
  `markdown` longtext NOT NULL DEFAULT '',
  `summary` varchar(191) DEFAULT NULL,
  `revision_number` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `page_revisions_page_id_index` (`page_id`),
  KEY `page_revisions_slug_index` (`slug`),
  KEY `page_revisions_book_slug_index` (`book_slug`),
  KEY `page_revisions_type_index` (`type`),
  KEY `page_revisions_revision_number_index` (`revision_number`)
) ENGINE=InnoDB AUTO_INCREMENT=287 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `page_revisions`
--

LOCK TABLES `page_revisions` WRITE;
/*!40000 ALTER TABLE `page_revisions` DISABLE KEYS */;
INSERT INTO `page_revisions` VALUES (1,1,'New Page','<div drawio-diagram=\"1\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680023230.png\"></div>','',1,'2023-03-28 22:07:12','2023-03-28 22:07:12','new-page','test','version','','Initial publish',1),(2,1,'New Page','<div drawio-diagram=\"1\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680023230.png\"></div>','',1,'2023-03-28 22:11:16','2023-03-28 22:11:16','new-page','test','update_draft','',NULL,0),(3,2,'Overall network diagram','<div drawio-diagram=\"2\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680026302.png\"></div>','',1,'2023-03-28 22:58:26','2023-03-28 22:58:26','overall-network-diagram','network-diagram','version','','Initial publish',1),(4,3,'Network Diagram Notes','','',1,'2023-03-28 23:25:21','2023-03-28 23:25:21','network-diagram-notes','network-diagram','version','','Initial publish',1),(5,2,'Network Diagram','<div drawio-diagram=\"2\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680026302.png\"></div>','',1,'2023-03-28 23:26:05','2023-03-28 23:26:05','network-diagram','network-diagram','version','','',2),(7,3,'Network Diagram Notes','<p id=\"bkmrk-si-router---this-is-\">SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\">ServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\">Grayspace - The SI-Router will router apprx 1500 IP subnets.&nbsp; These subnets are organized by geo-locations on the NRTS server.&nbsp; To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.</li>\r\n<li class=\"null\">AdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet</li>\r\n<li class=\"null\">RangeWAN - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\">ServiceNet - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\">RootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.</li>\r\n<li class=\"null\">Web-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">Redbook.com - This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\">dropbox.com - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.&nbsp; See the OPFOR section for some methods.</li>\r\n<li class=\"null\">pastebin.com - This is a haste bin server to simulated the real world pastebin.&nbsp; This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\">diagrams.net - This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signing binarys, see CA-Server details.</li>\r\n<li class=\"null\">Traffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.&nbsp; See Traffic-Gen details for more information on this.</li>\r\n<li class=\"null\">Traffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\">Grayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp;</p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\">AdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\">Adminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\">IA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to <a href=\"http://172.30.0.2:9999\">http://172.30.0.2:9999</a></li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\">RangeWAN - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details are explained in the target range planning section</p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will router apprx 1500 IP subnets.  These subnets are organized by geo-locations on the NRTS server.  To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nRedbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.  See the OPFOR section for some methods.\r\npastebin.com - This is a haste bin server to simulated the real world pastebin.  This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.\r\n\r\n\r\nCA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signing binarys, see CA-Server details.\r\nTraffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.  See Traffic-Gen details for more information on this.\r\nTraffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want. \r\n\r\nNRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details are explained in the target range planning section\r\n ',1,'2023-03-28 23:57:46','2023-03-28 23:57:46','network-diagram-notes','network-overview','version','','',2),(8,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - simulated Googles recursive DNS server</li>\r\n<li class=\"null\">198.41.0.4 - simulates the real world A-root server</li>\r\n<li class=\"null\">192.228.79.59 - simulates the real world B-root server</li>\r\n<li class=\"null\">192.33.4.12- simulates the real world C-root server</li>\r\n<li class=\"null\">128.8.10.90- simulates the real world D-root server</li>\r\n<li class=\"null\">192.203.230.10- simulates the real world E-root server</li>\r\n<li class=\"null\">195.5.5.241- simulates the real world F-root server</li>\r\n<li class=\"null\">192.112.36.4- simulates the real world G-root server</li>\r\n<li class=\"null\">128.63.2.53- simulates the real world H-root server</li>\r\n<li class=\"null\">192.36.148.17- simulates the real world I-root server</li>\r\n<li class=\"null\">192.58.128.30- simulates the real world J-root server</li>\r\n<li class=\"null\">193.0.15.129- simulates the real world K-root server</li>\r\n<li class=\"null\">199.7.83.42- simulates the real world L-root server</li>\r\n<li class=\"null\">202.12.27.33- simulates the real world M-root server</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server in the Cyber Range handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server&nbsp; and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then create a zone file for each domain, add it to the OPFOR directory and create a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy, restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as the section in the named.conf.OPFOR.&nbsp; This tag is a user added value when the user request DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting its tag.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair it to IPs in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use <a href=\"https://www.microsoft.com\">www.microsoft.com</a> for their C2 would it.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the list.&nbsp; This is for when you\'d deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p style=\"padding-left: 40px;\" id=\"bkmrk-%C2%A0\">&nbsp;</p>\r\n<p style=\"padding-left: 40px;\" id=\"bkmrk-%C2%A0-1\">&nbsp;</p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - simulated Googles recursive DNS server\r\n198.41.0.4 - simulates the real world A-root server\r\n192.228.79.59 - simulates the real world B-root server\r\n192.33.4.12- simulates the real world C-root server\r\n128.8.10.90- simulates the real world D-root server\r\n192.203.230.10- simulates the real world E-root server\r\n195.5.5.241- simulates the real world F-root server\r\n192.112.36.4- simulates the real world G-root server\r\n128.63.2.53- simulates the real world H-root server\r\n192.36.148.17- simulates the real world I-root server\r\n192.58.128.30- simulates the real world J-root server\r\n193.0.15.129- simulates the real world K-root server\r\n199.7.83.42- simulates the real world L-root server\r\n202.12.27.33- simulates the real world M-root server\r\n\r\nThe RootDNS server in the Cyber Range handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server  and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then create a zone file for each domain, add it to the OPFOR directory and create a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy, restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as the section in the named.conf.OPFOR.  This tag is a user added value when the user request DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting its tag.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair it to IPs in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2 would it.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.txt\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the list.  This is for when you\'d deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\n\r\n \r\n ',1,'2023-03-29 00:43:26','2023-03-29 00:43:26','rootdns','cyber-range-systems-overview','version','','Initial publish',1),(10,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - simulated Googles recursive DNS server</li>\r\n<li class=\"null\">198.41.0.4 - simulates the real world A-root server</li>\r\n<li class=\"null\">192.228.79.59 - simulates the real world B-root server</li>\r\n<li class=\"null\">192.33.4.12- simulates the real world C-root server</li>\r\n<li class=\"null\">128.8.10.90- simulates the real world D-root server</li>\r\n<li class=\"null\">192.203.230.10- simulates the real world E-root server</li>\r\n<li class=\"null\">195.5.5.241- simulates the real world F-root server</li>\r\n<li class=\"null\">192.112.36.4- simulates the real world G-root server</li>\r\n<li class=\"null\">128.63.2.53- simulates the real world H-root server</li>\r\n<li class=\"null\">192.36.148.17- simulates the real world I-root server</li>\r\n<li class=\"null\">192.58.128.30- simulates the real world J-root server</li>\r\n<li class=\"null\">193.0.15.129- simulates the real world K-root server</li>\r\n<li class=\"null\">199.7.83.42- simulates the real world L-root server</li>\r\n<li class=\"null\">202.12.27.33- simulates the real world M-root server</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server in the Cyber Range handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server&nbsp; and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then create a zone file for each domain, add it to the OPFOR directory and create a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy, restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as the section in the named.conf.OPFOR.&nbsp; This tag is a user added value when the user request DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting its tag.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair it to IPs in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use <a href=\"https://www.microsoft.com\">www.microsoft.com</a> for their C2 would it.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the list.&nbsp; This is for when you\'d deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE: the other half of DNS automation references on the NRTS, /root/scripts/buildredteam.sh and /root/scripts/ManageDNS.sh are explained on the NRTS overview.</li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check if you messed up adding the reference run.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - simulated Googles recursive DNS server\r\n198.41.0.4 - simulates the real world A-root server\r\n192.228.79.59 - simulates the real world B-root server\r\n192.33.4.12- simulates the real world C-root server\r\n128.8.10.90- simulates the real world D-root server\r\n192.203.230.10- simulates the real world E-root server\r\n195.5.5.241- simulates the real world F-root server\r\n192.112.36.4- simulates the real world G-root server\r\n128.63.2.53- simulates the real world H-root server\r\n192.36.148.17- simulates the real world I-root server\r\n192.58.128.30- simulates the real world J-root server\r\n193.0.15.129- simulates the real world K-root server\r\n199.7.83.42- simulates the real world L-root server\r\n202.12.27.33- simulates the real world M-root server\r\n\r\nThe RootDNS server in the Cyber Range handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server  and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then create a zone file for each domain, add it to the OPFOR directory and create a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy, restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as the section in the named.conf.OPFOR.  This tag is a user added value when the user request DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting its tag.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair it to IPs in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2 would it.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.txt\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the list.  This is for when you\'d deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE: the other half of DNS automation references on the NRTS, /root/scripts/buildredteam.sh and /root/scripts/ManageDNS.sh are explained on the NRTS overview.\r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check if you messed up adding the reference run.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\n\r\n\r\n',1,'2023-03-29 01:05:30','2023-03-29 01:05:30','rootdns','cyber-range-systems-overview','version','','',2),(11,5,'Web-Services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documenation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This could be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">In each directory are any config files need for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documenation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This could be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nIn each directory are any config files need for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',1,'2023-03-29 01:21:11','2023-03-29 01:21:11','web-services','cyber-range-systems-overview','version','','Initial publish',1),(12,6,'CA-Server','','',1,'2023-03-29 01:21:22','2023-03-29 01:21:22','ca-server','cyber-range-systems-overview','version','','Initial publish',1),(14,6,'CA-Server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is build on ubuntu 22.01 and uses openSSL to create Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using a domain of globalcerts.com.&nbsp; To create new SSL certs or to sign binaries, you can use scripts that exist on this server.&nbsp; The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload host services it builds.&nbsp; More on that is explained in the NRTS server overview.&nbsp; That said, if you want do generate these manually, below is an overview of these scripts on the server to all you to.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs.&nbsp; The script has a help menu that is pretty self explanitory.&nbsp; below is the help menu that list the various flags.</li>\r\n<li class=\"null\">REQUIRED Flags<br>&nbsp; &nbsp; &nbsp; &nbsp; -d or --domain FQDN, &nbsp;ex. -d www.example.com<br>&nbsp; &nbsp; &nbsp; &nbsp; -r or --random, this will randomize Country, City, State, and organization info<br>&nbsp; &nbsp; &nbsp; &nbsp; -q or --quiet, will built the certs without showing settings and asking for confirmation<br>OPTIONAL Flags - random values will be used if not set<br>&nbsp; &nbsp; &nbsp; &nbsp; -C or --country 2LetterAbbrv, ex. -C US<br>&nbsp; &nbsp; &nbsp; &nbsp; -ST or --state &nbsp;State, ex -ST \'New York\' NOTE: single quotes need if spaces<br>&nbsp; &nbsp; &nbsp; &nbsp; -L or --locality, ex -L \'New York City\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -O or --organization, ex -O \'example LTD\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -CN or --commonname, ex -CN \'www.example.com\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -A or --alias, ex -A \'example-server\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS1 or --SAN1 &nbsp;Subject Alt Name 1<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS2 or --SAN2 &nbsp;Subject Alt Name 2<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS3 or --SAN3 &nbsp;Subject Alt Name 3<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS4 or --SAN4 &nbsp;Subject Alt Name 4<br></li>\r\n<li class=\"null\">Below is example syntax for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 <a href=\"https://www.humanzoo.com\">www.humanzoo.com</a> -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','The CA server is build on ubuntu 22.01 and uses openSSL to create Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using a domain of globalcerts.com.  To create new SSL certs or to sign binaries, you can use scripts that exist on this server.  The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload host services it builds.  More on that is explained in the NRTS server overview.  That said, if you want do generate these manually, below is an overview of these scripts on the server to all you to.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs.  The script has a help menu that is pretty self explanitory.  below is the help menu that list the various flags.\r\nREQUIRED Flags        -d or --domain FQDN,  ex. -d www.example.com        -r or --random, this will randomize Country, City, State, and organization info        -q or --quiet, will built the certs without showing settings and asking for confirmationOPTIONAL Flags - random values will be used if not set        -C or --country 2LetterAbbrv, ex. -C US        -ST or --state  State, ex -ST \'New York\' NOTE: single quotes need if spaces        -L or --locality, ex -L \'New York City\'        -O or --organization, ex -O \'example LTD\'        -CN or --commonname, ex -CN \'www.example.com\'        -A or --alias, ex -A \'example-server\'        -DNS1 or --SAN1  Subject Alt Name 1        -DNS2 or --SAN2  Subject Alt Name 2        -DNS3 or --SAN3  Subject Alt Name 3        -DNS4 or --SAN4  Subject Alt Name 4\r\nBelow is example syntax for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n ',1,'2023-03-29 01:32:10','2023-03-29 01:32:10','ca-server','cyber-range-systems-overview','version','','',2),(15,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was build on ubuntu 22.01 and uses a customized docker container that will use postfix and mutt to send emails to a given list of users.&nbsp; The email context was pulled using the Enron data dump, if you don\'t know, several years ago due the FCC force Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into a database.&nbsp; It\'s decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.&nbsp; The functionality of this is very customizable.&nbsp; Here is an overview of how this functions.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">/root/buildcompose.sh</li>\r\n</ul>','The Traffic-gen server was build on ubuntu 22.01 and uses a customized docker container that will use postfix and mutt to send emails to a given list of users.  The email context was pulled using the Enron data dump, if you don\'t know, several years ago due the FCC force Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into a database.  It\'s decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.  The functionality of this is very customizable.  Here is an overview of how this functions.\r\nFILE STRUCTURE\r\n\r\n/root/buildcompose.sh\r\n',1,'2023-03-29 01:39:47','2023-03-29 01:39:47','traffic-gen','cyber-range-systems-overview','version','','Initial publish',1),(16,8,'Traffic-WebHost','<p id=\"bkmrk-this-hosts-several-w\">This hosts several websites that can be used by Ghost to create outbound http and https traffic from within a target domain.</p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','This hosts several websites that can be used by Ghost to create outbound http and https traffic from within a target domain.\r\n ',1,'2023-03-29 01:41:20','2023-03-29 01:41:20','traffic-webhost','cyber-range-systems-overview','version','','Initial publish',1),(17,9,'NRTS','','',1,'2023-03-29 01:41:30','2023-03-29 01:41:30','nrts','cyber-range-systems-overview','version','','Initial publish',1),(19,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The not red team server (NRTS) is build on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; I have had 3 teamservers, 3 redirectors, and 3 payloads host running successfully simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.</p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','The not red team server (NRTS) is build on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  I have had 3 teamservers, 3 redirectors, and 3 payloads host running successfully simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.\r\n ',1,'2023-03-29 01:47:28','2023-03-29 01:47:28','nrts','cyber-range-systems-overview','version','','',2),(21,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was build on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email context was pulled using the Enron data dump, if you don\'t know, several years ago due the FCC force Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into a database.&nbsp; It\'s decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.&nbsp; The functionality of this is very customization.&nbsp; Here is an overview of how this functions.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/killtrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the buildcompose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from old Enron emails that the FCC made publicly available.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain email list.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; for example, if I made a target domain called widgets.com, I would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory I would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that I want the email traffic generator to send emails to.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs and endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was build on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email context was pulled using the Enron data dump, if you don\'t know, several years ago due the FCC force Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into a database.  It\'s decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.  The functionality of this is very customization.  Here is an overview of how this functions.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/killtrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the buildcompose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from old Enron emails that the FCC made publicly available.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain email list.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  for example, if I made a target domain called widgets.com, I would make a directory at /root/TG/SendTo/widgets.  Then in that directory I would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that I want the email traffic generator to send emails to.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs and endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',1,'2023-03-29 16:40:12','2023-03-29 16:40:12','traffic-gen','cyber-range-systems-overview','version','','',2),(23,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The not red team server (NRTS) is build on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; I have had 3 teamservers, 3 redirectors, and 3 payloads host running successfully simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.&nbsp; There is a lot going on in this VM, below is a description of the folder structure, for more details on how to use this VM, see the \"NRTS\" in the How to\" section.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace esxi switch.&nbsp; Its structure by geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.&nbsp; &nbsp;This folder structure is used by other scripts on the NRTS to generator IP addresses.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, see the \"NRTS\" section in the \"How to\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of cobaltstrike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your cobalt strike profiles, this is where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildreadteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infastructure, it will create redirectors, payload hosts, phishing hosts, and teamservers in docker containers.&nbsp; See the how to section for more information.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage DNS records that get added to the rootDNS server.&nbsp; See the how to section for more information.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new DNS records that will get added to the rootDNS server.&nbsp; See the how to section for more information.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.</li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul>\r\n<li class=\"null\">This is another tool for generating Cobalt Strike profiles, see the \"how to\" section.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The not red team server (NRTS) is build on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  I have had 3 teamservers, 3 redirectors, and 3 payloads host running successfully simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.  There is a lot going on in this VM, below is a description of the folder structure, for more details on how to use this VM, see the \"NRTS\" in the How to\" section.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace esxi switch.  Its structure by geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, see the \"NRTS\" section in the \"How to\"\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of cobaltstrike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your cobalt strike profiles, this is where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildreadteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infastructure, it will create redirectors, payload hosts, phishing hosts, and teamservers in docker containers.  See the how to section for more information.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage DNS records that get added to the rootDNS server.  See the how to section for more information.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new DNS records that will get added to the rootDNS server.  See the how to section for more information.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike profiles, see the \"how to\" section.\r\n\r\n\r\n\r\n',1,'2023-03-29 17:34:27','2023-03-29 17:34:27','nrts','cyber-range-systems-overview','version','','',3),(24,10,'New Page','<h1 id=\"bkmrk-register-domains\">Register Domains</h1>\n<h1 id=\"bkmrk-registering-dns\">Registering DNS</h1>\n<h1 id=\"bkmrk-three-ways-of-regist\">Three ways of registering domains</h1>\n<h2 id=\"bkmrk-rts-server-ip%27s-only\">RTS server IP\'s only (Manually entered Domains)</h2>\n<p id=\"bkmrk-if-you-are-using-an-\">If you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.</p>\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records</p>\n<p id=\"bkmrk-\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsmain.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\n<p id=\"bkmrk-step2.-select-option\">Step2. Select option 1 - Manually create domain name/s.</p>\n<p id=\"bkmrk--1\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmain.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\n<p id=\"bkmrk-step3.-on-this-scree\">Step3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.</p>\n<p id=\"bkmrk--2\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanual.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanual.png\" alt=\"dnsaddmanual.png\"></a></p>\n<p id=\"bkmrk-step4.-enter-in-a-fq\">Step4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.</p>\n<p id=\"bkmrk--3\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualentry.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualentry.png\" alt=\"dnsaddmanualentry.png\"></a></p>\n<p id=\"bkmrk-step5.-you-will-see-\">Step5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.</p>\n<p id=\"bkmrk--4\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualresult.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualresult.png\" alt=\"dnsaddmanualresult.png\"></a></p>\n<p id=\"bkmrk-below-is-the-complet\">Below is the completion screen, your domains have now been registered.</p>\n<p id=\"bkmrk--5\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualcompletion.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualcompletion.png\" alt=\"dnsaddmanualcompletion.png\"></a></p>\n<h2 id=\"bkmrk-rts-server-ip%27s-only-1\">RTS server IP\'s Only (Randomly generated Domains)</h2>\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr-1\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.</p>\n<p id=\"bkmrk--6\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsmain.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\n<p id=\"bkmrk-step2.-select-option-1\">Step2. Select Option 2 - Use randomly generated one/s.</p>\n<p id=\"bkmrk--7\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmain.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\n<p id=\"bkmrk-step3.-enter-y-and-p\">Step3. Enter y and press enter to continue</p>\n<p id=\"bkmrk--8\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsrandom.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsrandom.png\" alt=\"dnsrandom.png\"></a></p>\n<p id=\"bkmrk-below-is-the-complet-1\">Below is the completion screen, your domains have now been registered.</p>\n<p id=\"bkmrk--9\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/dnsrandomcompletion.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsrandomcompletion.png\" alt=\"dnsrandomcompletion.png\"></a></p>\n<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.</p>\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\n       \n\n</code></pre>\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>\n','Register Domains\nRegistering DNS\nThree ways of registering domains\nRTS server IP\'s only (Manually entered Domains)\nIf you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\n\nStep2. Select option 1 - Manually create domain name/s.\n\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\n\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\n\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\n\nBelow is the completion screen, your domains have now been registered.\n\nRTS server IP\'s Only (Randomly generated Domains)\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\n\nStep2. Select Option 2 - Use randomly generated one/s.\n\nStep3. Enter y and press enter to continue\n\nBelow is the completion screen, your domains have now been registered.\n\nAdd Domains based on User created file\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\nssh-copy-id root@198.41.0.4   - the password is : toor\n       \n\n\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\n\nStep4. Create a DNS file according to the scripts usage. Below is an example.\n\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\n\n',1,'2023-03-30 17:48:42','2023-03-30 17:48:42','new-page','register-dns','version','# Register Domains\r\n\r\n# Registering DNS\r\n\r\n# Three ways of registering domains\r\n\r\n## RTS server IP\'s only (Manually entered Domains)\r\n\r\nIf you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\r\n\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\r\n\r\n[![dnsmain.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsmain.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsmain.png)\r\n\r\nStep2. Select option 1 - Manually create domain name/s.\r\n\r\n[![dnsaddmain.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmain.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmain.png)\r\n\r\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\r\n\r\n[![dnsaddmanual.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanual.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanual.png)\r\n\r\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\r\n\r\n[![dnsaddmanualentry.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualentry.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualentry.png)\r\n\r\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\r\n\r\n[![dnsaddmanualresult.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualresult.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualresult.png)\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\n[![dnsaddmanualcompletion.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmanualcompletion.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmanualcompletion.png)\r\n\r\n## RTS server IP\'s Only (Randomly generated Domains)\r\n\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\r\n\r\n[![dnsmain.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsmain.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsmain.png)\r\n\r\nStep2. Select Option 2 - Use randomly generated one/s.\r\n\r\n[![dnsaddmain.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsaddmain.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsaddmain.png)\r\n\r\nStep3. Enter y and press enter to continue\r\n\r\n[![dnsrandom.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsrandom.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsrandom.png)\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\n[![dnsrandomcompletion.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/dnsrandomcompletion.png)](http://www.redbook.com/uploads/images/gallery/2022-04/dnsrandomcompletion.png)\r\n\r\n## Add Domains based on User created file\r\n\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\r\n\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\n\r\n```\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n```\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\n[![registerdnshelp.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png)](http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png)\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\n[![registerdns-dnsfileex.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png)](http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png)\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\\\RegisterDNS.sh mydns.txt\r\n\r\n[![registerdnsran.png](http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png)](http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png)','Initial publish',1),(26,10,'New Page','<h1 id=\"bkmrk-register-domains\">Register Domains</h1>\r\n<h1 id=\"bkmrk-registering-dns\">Registering DNS</h1>\r\n<h1 id=\"bkmrk-three-ways-of-regist\">Three ways of registering domains</h1>\r\n<h2 id=\"bkmrk-rts-server-ip%27s-only\">RTS server IP\'s only (Manually entered Domains)</h2>\r\n<p id=\"bkmrk-if-you-are-using-an-\">If you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.</p>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option\">Step2. Select option 1 - Manually create domain name/s.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-on-this-scree\">Step3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanual.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanual.png\" alt=\"dnsaddmanual.png\"></a></p>\r\n<p id=\"bkmrk-step4.-enter-in-a-fq\">Step4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualentry.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualentry.png\" alt=\"dnsaddmanualentry.png\"></a></p>\r\n<p id=\"bkmrk-step5.-you-will-see-\">Step5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualresult.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualresult.png\" alt=\"dnsaddmanualresult.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualcompletion.png\" alt=\"dnsaddmanualcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-rts-server-ip%27s-only-1\">RTS server IP\'s Only (Randomly generated Domains)</h2>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr-1\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.</p>\r\n<p id=\"bkmrk--6\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option-1\">Step2. Select Option 2 - Use randomly generated one/s.</p>\r\n<p id=\"bkmrk--7\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-enter-y-and-p\">Step3. Enter y and press enter to continue</p>\r\n<p id=\"bkmrk--8\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandom.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandom.png\" alt=\"dnsrandom.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet-1\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--9\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandomcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandomcompletion.png\" alt=\"dnsrandomcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','Register Domains\r\nRegistering DNS\r\nThree ways of registering domains\r\nRTS server IP\'s only (Manually entered Domains)\r\nIf you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\r\n\r\nStep2. Select option 1 - Manually create domain name/s.\r\n\r\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\r\n\r\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\r\n\r\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nRTS server IP\'s Only (Randomly generated Domains)\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\r\n\r\nStep2. Select Option 2 - Use randomly generated one/s.\r\n\r\nStep3. Enter y and press enter to continue\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nAdd Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 18:10:12','2023-03-30 18:10:12','new-page','register-dns','version','','',2),(27,10,'Three ways of registering domains','<h2 id=\"bkmrk-rts-server-ip%27s-only\">RTS server IP\'s only (Manually entered Domains)</h2>\r\n<p id=\"bkmrk-if-you-are-using-an-\">If you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.</p>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option\">Step2. Select option 1 - Manually create domain name/s.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-on-this-scree\">Step3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanual.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanual.png\" alt=\"dnsaddmanual.png\"></a></p>\r\n<p id=\"bkmrk-step4.-enter-in-a-fq\">Step4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualentry.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualentry.png\" alt=\"dnsaddmanualentry.png\"></a></p>\r\n<p id=\"bkmrk-step5.-you-will-see-\">Step5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualresult.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualresult.png\" alt=\"dnsaddmanualresult.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualcompletion.png\" alt=\"dnsaddmanualcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-rts-server-ip%27s-only-1\">RTS server IP\'s Only (Randomly generated Domains)</h2>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr-1\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.</p>\r\n<p id=\"bkmrk--6\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option-1\">Step2. Select Option 2 - Use randomly generated one/s.</p>\r\n<p id=\"bkmrk--7\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-enter-y-and-p\">Step3. Enter y and press enter to continue</p>\r\n<p id=\"bkmrk--8\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandom.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandom.png\" alt=\"dnsrandom.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet-1\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--9\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandomcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandomcompletion.png\" alt=\"dnsrandomcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','RTS server IP\'s only (Manually entered Domains)\r\nIf you are using an RTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\r\n\r\nStep2. Select option 1 - Manually create domain name/s.\r\n\r\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\r\n\r\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\r\n\r\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nRTS server IP\'s Only (Randomly generated Domains)\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\r\n\r\nStep2. Select Option 2 - Use randomly generated one/s.\r\n\r\nStep3. Enter y and press enter to continue\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nAdd Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 18:10:46','2023-03-30 18:10:46','three-ways-of-registering-domains','register-dns','version','','',3),(29,10,'Three ways of registering domains','<h2 id=\"bkmrk-rts-server-ip%27s-only\">NRTS server IP\'s only (Manually entered Domains)</h2>\r\n<p id=\"bkmrk-if-you-are-using-an-\">If you are using an NRTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.</p>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option\">Step2. Select option 1 - Manually create domain name/s.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-on-this-scree\">Step3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanual.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanual.png\" alt=\"dnsaddmanual.png\"></a></p>\r\n<p id=\"bkmrk-step4.-enter-in-a-fq\">Step4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualentry.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualentry.png\" alt=\"dnsaddmanualentry.png\"></a></p>\r\n<p id=\"bkmrk-step5.-you-will-see-\">Step5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualresult.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualresult.png\" alt=\"dnsaddmanualresult.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualcompletion.png\" alt=\"dnsaddmanualcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-rts-server-ip%27s-only-1\">RTS server IP\'s Only (Randomly generated Domains)</h2>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr-1\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.</p>\r\n<p id=\"bkmrk--6\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option-1\">Step2. Select Option 2 - Use randomly generated one/s.</p>\r\n<p id=\"bkmrk--7\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-enter-y-and-p\">Step3. Enter y and press enter to continue</p>\r\n<p id=\"bkmrk--8\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandom.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandom.png\" alt=\"dnsrandom.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet-1\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--9\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandomcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandomcompletion.png\" alt=\"dnsrandomcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','NRTS server IP\'s only (Manually entered Domains)\r\nIf you are using an NRTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\r\n\r\nStep2. Select option 1 - Manually create domain name/s.\r\n\r\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\r\n\r\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\r\n\r\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nRTS server IP\'s Only (Randomly generated Domains)\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\r\n\r\nStep2. Select Option 2 - Use randomly generated one/s.\r\n\r\nStep3. Enter y and press enter to continue\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nAdd Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 18:11:30','2023-03-30 18:11:30','three-ways-of-registering-domains','register-dns','version','','',4),(30,10,'Manual Domain Registration','<h2 id=\"bkmrk-rts-server-ip%27s-only\">NRTS server IP\'s only (Manually entered Domains)</h2>\r\n<p id=\"bkmrk-if-you-are-using-an-\">If you are using an NRTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.</p>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option\">Step2. Select option 1 - Manually create domain name/s.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-on-this-scree\">Step3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanual.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanual.png\" alt=\"dnsaddmanual.png\"></a></p>\r\n<p id=\"bkmrk-step4.-enter-in-a-fq\">Step4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualentry.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualentry.png\" alt=\"dnsaddmanualentry.png\"></a></p>\r\n<p id=\"bkmrk-step5.-you-will-see-\">Step5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualresult.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualresult.png\" alt=\"dnsaddmanualresult.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmanualcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmanualcompletion.png\" alt=\"dnsaddmanualcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-rts-server-ip%27s-only-1\">RTS server IP\'s Only (Randomly generated Domains)</h2>\r\n<p id=\"bkmrk-step1.-run-%2Froot%2Fscr-1\">Step1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.</p>\r\n<p id=\"bkmrk--6\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsmain.png\" alt=\"dnsmain.png\"></a></p>\r\n<p id=\"bkmrk-step2.-select-option-1\">Step2. Select Option 2 - Use randomly generated one/s.</p>\r\n<p id=\"bkmrk--7\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsaddmain.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsaddmain.png\" alt=\"dnsaddmain.png\"></a></p>\r\n<p id=\"bkmrk-step3.-enter-y-and-p\">Step3. Enter y and press enter to continue</p>\r\n<p id=\"bkmrk--8\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandom.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandom.png\" alt=\"dnsrandom.png\"></a></p>\r\n<p id=\"bkmrk-below-is-the-complet-1\">Below is the completion screen, your domains have now been registered.</p>\r\n<p id=\"bkmrk--9\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/dnsrandomcompletion.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/dnsrandomcompletion.png\" alt=\"dnsrandomcompletion.png\"></a></p>\r\n<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','NRTS server IP\'s only (Manually entered Domains)\r\nIf you are using an NRTS server, then after you\'ve used the /root/scripts/buildredteam.sh to use as a redirector, teamserver, or payload host. You can add domains to the IP\'s that get built using /root/scripts/ManageDNS.sh.\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records\r\n\r\nStep2. Select option 1 - Manually create domain name/s.\r\n\r\nStep3. On this screen, you can select which IP you want to add a domain for. You can select one or all of them. For this example, I\'ll select option 1 to set a domain for the first IP in the list.\r\n\r\nStep4. Enter in a FQDN at the \"Here:\" prompt and press enter. NOTE: www will be added as a A record for your domains automatically. So for this example, adding widgetking.com will create an A record for widgetking.com as well as www.widgetking.com.\r\n\r\nStep5. You will see your newly added domain to the right of the IP, repeat steps 3 and 4 to add domains to other IPs. When you are done, select option D for done.\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nRTS server IP\'s Only (Randomly generated Domains)\r\nStep1. Run /root/scripts/ManageDNS.sh, then select Option 1 Add DNS records.\r\n\r\nStep2. Select Option 2 - Use randomly generated one/s.\r\n\r\nStep3. Enter y and press enter to continue\r\n\r\nBelow is the completion screen, your domains have now been registered.\r\n\r\nAdd Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any RTS server at /root/scripts. You can use it from the RTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 19:03:04','2023-03-30 19:03:04','manual-domain-registration','register-dns','version','','',5),(32,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.</p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnshelp.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnshelp.png\" alt=\"registerdnshelp.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','Add Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 19:44:46','2023-03-30 19:44:46','manual-domain-registration','register-dns','version','','',6),(34,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since this ssh keys are set up on the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdns-dnsfileex.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdns-dnsfileex.png\" alt=\"registerdns-dnsfileex.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"http://www.redbook.com/uploads/images/gallery/2022-04/registerdnsran.png\"><img src=\"http://www.redbook.com/uploads/images/gallery/2022-04/scaled-1680-/registerdnsran.png\" alt=\"registerdnsran.png\"></a></p>','Add Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since this ssh keys are set up on the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 19:46:00','2023-03-30 19:46:00','manual-domain-registration','register-dns','version','','',7),(36,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since this ssh keys are set up on the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerdns-help.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerprocess.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></a></p>','Add Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since this ssh keys are set up on the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 19:48:58','2023-03-30 19:48:58','manual-domain-registration','register-dns','version','','',8),(37,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on User created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\">Step1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\">Step2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code>ssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\">Step3. Look at Register.sh\'s usage. Run the script without passing a file or argument</p>\r\n<p id=\"bkmrk--10\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerdns-help.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\">Step4. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\">Step5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt</p>\r\n<p id=\"bkmrk--12\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerprocess.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></a></p>','Add Domains based on User created file\r\nStep1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   - the password is : toor\r\n       \r\n\r\n\r\nStep3. Look at Register.sh\'s usage. Run the script without passing a file or argument\r\n\r\nStep4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\n',1,'2023-03-30 20:01:02','2023-03-30 20:01:02','manual-domain-registration','register-dns','version','','',9),(39,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - simulated Googles recursive DNS server</li>\r\n<li class=\"null\">198.41.0.4 - simulates the real world A-root server</li>\r\n<li class=\"null\">192.228.79.59 - simulates the real world B-root server</li>\r\n<li class=\"null\">192.33.4.12- simulates the real world C-root server</li>\r\n<li class=\"null\">128.8.10.90- simulates the real world D-root server</li>\r\n<li class=\"null\">192.203.230.10- simulates the real world E-root server</li>\r\n<li class=\"null\">195.5.5.241- simulates the real world F-root server</li>\r\n<li class=\"null\">192.112.36.4- simulates the real world G-root server</li>\r\n<li class=\"null\">128.63.2.53- simulates the real world H-root server</li>\r\n<li class=\"null\">192.36.148.17- simulates the real world I-root server</li>\r\n<li class=\"null\">192.58.128.30- simulates the real world J-root server</li>\r\n<li class=\"null\">193.0.15.129- simulates the real world K-root server</li>\r\n<li class=\"null\">199.7.83.42- simulates the real world L-root server</li>\r\n<li class=\"null\">202.12.27.33- simulates the real world M-root server</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server in the Cyber Range handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server&nbsp; and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, addd it to the OPFOR directory and created a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy smf restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting its tag.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the list.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE: the other half of DNS automation references on the NRTS, /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh are explained on the NRTS overview.</li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check if you messed up adding the reference run.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - simulated Googles recursive DNS server\r\n198.41.0.4 - simulates the real world A-root server\r\n192.228.79.59 - simulates the real world B-root server\r\n192.33.4.12- simulates the real world C-root server\r\n128.8.10.90- simulates the real world D-root server\r\n192.203.230.10- simulates the real world E-root server\r\n195.5.5.241- simulates the real world F-root server\r\n192.112.36.4- simulates the real world G-root server\r\n128.63.2.53- simulates the real world H-root server\r\n192.36.148.17- simulates the real world I-root server\r\n192.58.128.30- simulates the real world J-root server\r\n193.0.15.129- simulates the real world K-root server\r\n199.7.83.42- simulates the real world L-root server\r\n202.12.27.33- simulates the real world M-root server\r\n\r\nThe RootDNS server in the Cyber Range handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server  and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores all domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores all domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores all domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, addd it to the OPFOR directory and created a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-check-conf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy smf restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS records from the OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting its tag.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the list.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE: the other half of DNS automation references on the NRTS, /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh are explained on the NRTS overview.\r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check if you messed up adding the reference run.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\n\r\n\r\n',1,'2023-04-03 16:44:56','2023-04-03 16:44:56','rootdns','cyber-range-systems-overview','version','','',3),(41,6,'CA-Server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is build on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using the domain of globalcerts.com.&nbsp; To create new SSL certs or to sign binaries, you can use scripts that exist on this server.&nbsp; The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.&nbsp; More on that is explained in the NRTS server overview.&nbsp; That said, if you want do generate these manually, below is an overview of scripts on the CA-server.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs.&nbsp; The script has a help menu that is pretty self explanatory.&nbsp; below is the help menu that lists the various flags.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p style=\"padding-left: 40px;\" id=\"bkmrk-required-flags%C2%A0-%C2%A0-%C2%A0-\">REQUIRED Flags<br>&nbsp; &nbsp; &nbsp; &nbsp; -d or --domain FQDN, &nbsp;ex. -d www.example.com<br>OPTIONAL Flags - random values will be used if not set<br>&nbsp; &nbsp; &nbsp; &nbsp; -r or --random, this will randomize Country, City, State, and organization info<br>&nbsp; &nbsp; &nbsp; &nbsp; -q or --quiet, will built the certs without showing settings and asking for confirmation<br>&nbsp; &nbsp; &nbsp; &nbsp; -C or --country 2LetterAbbrv, ex. -C US<br>&nbsp; &nbsp; &nbsp; &nbsp; -ST or --state &nbsp;State, ex -ST \'New York\' NOTE: single quotes need if spaces<br>&nbsp; &nbsp; &nbsp; &nbsp; -L or --locality, ex -L \'New York City\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -O or --organization, ex -O \'example LTD\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -CN or --commonname, ex -CN \'www.example.com\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -A or --alias, ex -A \'example-server\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS1 or --SAN1 &nbsp;Subject Alt Name 1<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS2 or --SAN2 &nbsp;Subject Alt Name 2<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS3 or --SAN3 &nbsp;Subject Alt Name 3<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS4 or --SAN4 &nbsp;Subject Alt Name 4<br></p>\r\n<ul id=\"bkmrk-below-is-an-example-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is an example for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 <a href=\"https://www.humanzoo.com\">www.humanzoo.com</a> -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The CA server is build on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using the domain of globalcerts.com.  To create new SSL certs or to sign binaries, you can use scripts that exist on this server.  The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.  More on that is explained in the NRTS server overview.  That said, if you want do generate these manually, below is an overview of scripts on the CA-server.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs.  The script has a help menu that is pretty self explanatory.  below is the help menu that lists the various flags.\r\n\r\n\r\n\r\nREQUIRED Flags        -d or --domain FQDN,  ex. -d www.example.comOPTIONAL Flags - random values will be used if not set        -r or --random, this will randomize Country, City, State, and organization info        -q or --quiet, will built the certs without showing settings and asking for confirmation        -C or --country 2LetterAbbrv, ex. -C US        -ST or --state  State, ex -ST \'New York\' NOTE: single quotes need if spaces        -L or --locality, ex -L \'New York City\'        -O or --organization, ex -O \'example LTD\'        -CN or --commonname, ex -CN \'www.example.com\'        -A or --alias, ex -A \'example-server\'        -DNS1 or --SAN1  Subject Alt Name 1        -DNS2 or --SAN2  Subject Alt Name 2        -DNS3 or --SAN3  Subject Alt Name 3        -DNS4 or --SAN4  Subject Alt Name 4\r\n\r\n\r\n\r\nBelow is an example for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n',1,'2023-04-03 16:55:17','2023-04-03 16:55:17','ca-server','cyber-range-systems-overview','version','','',3),(43,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was build on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email context was pulled using the Enron data dump.&nbsp; About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into databases.&nbsp; It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.&nbsp; The functionality of this is very customization.&nbsp; Here is an overview of how this server is used to generate email traffic.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/killtrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the build-compose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from publicly available databases of the Enron data mentioned earlier.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain that you connect to the Cyber Range.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; For example, if I made a target domain called widgets.com, I would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory I would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that I want the email traffic generator to send emails to.&nbsp; Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hardcoded in the email sending script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs and endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was build on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email context was pulled using the Enron data dump.  About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into databases.  It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from the user provide list and send an email.  The functionality of this is very customization.  Here is an overview of how this server is used to generate email traffic.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/killtrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the build-compose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from publicly available databases of the Enron data mentioned earlier.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain that you connect to the Cyber Range.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  For example, if I made a target domain called widgets.com, I would make a directory at /root/TG/SendTo/widgets.  Then in that directory I would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that I want the email traffic generator to send emails to.  Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hardcoded in the email sending script.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs and endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',1,'2023-04-03 17:03:25','2023-04-03 17:03:25','traffic-gen','cyber-range-systems-overview','version','','',3),(45,2,'Network Diagram','<div drawio-diagram=\"14\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524511.png\"></div>','',1,'2023-04-03 17:21:54','2023-04-03 17:21:54','network-diagram','network-overview','version','','',3),(47,2,'Network Diagram','<div drawio-diagram=\"15\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524770.png\"></div>','',1,'2023-04-03 17:26:13','2023-04-03 17:26:13','network-diagram','network-overview','version','','',4),(48,11,'Proxy All the things','','',1,'2023-04-03 19:54:51','2023-04-03 19:54:51','proxy-all-the-things','how-to-guides','version','','Initial publish',1),(50,11,'Proxy All the things','<p id=\"bkmrk-note%3A-the-proxy-is-a\">NOTE: The proxy is at http://172.30.0.2:9999</p>\r\n<h3 id=\"bkmrk-setting-up-docker-in\">Setting up Docker in linux</h3>\r\n<ul id=\"bkmrk-add-folder-for-the-d\">\r\n<li class=\"null\">Add folder for the docker service if it doesn\'t exist and add a proxy conf file&nbsp; &nbsp; &nbsp;&nbsp; <br></li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fsystemd%2Fsyst\"><code class=\"language-bash\">cd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in\">\r\n<li class=\"null\">Put the following in the http-proxy.conf</li>\r\n</ul>\r\n<pre id=\"bkmrk-%5Bservice%5D-environmen\"><code class=\"language-bash\">[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"</code></pre>\r\n<ul id=\"bkmrk-lastly%2C-reload-daemo\">\r\n<li class=\"null\">Lastly, reload daemon and restart the docker service<br></li>\r\n</ul>\r\n<pre id=\"bkmrk-systemctl-daemon-rel\"><code class=\"language-\">systemctl daemon-reload\r\nsystemctl restart docker</code></pre>\r\n<h4 id=\"bkmrk-adding-proxy-to-a-do\">Adding Proxy to a Dockerfile</h4>\r\n<ul id=\"bkmrk-edit-your-dockerfile\">\r\n<li class=\"null\">edit your dockerfile in your favorite linux text editor and add these variables.</li>\r\n</ul>\r\n<pre id=\"bkmrk-env-http_proxy-http%3A\"><code class=\"language-\">ENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999</code></pre>\r\n<h3 id=\"bkmrk-add-proxy-to-apt\">Add Proxy to Apt</h3>\r\n<ul id=\"bkmrk-go-to-the-apt.conf.d\">\r\n<li class=\"null\">Go to the apt.conf.d directory and create a proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fapt%2Fapt.conf\"><code class=\"language-bash\">cd /etc/apt/apt.conf.d\r\nvi proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in-1\">\r\n<li class=\"null\">Put the following in the proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-acquire%3A%3Ahttp%3A%3Aproxy\"><code class=\"language-\">Acquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";</code></pre>\r\n<h3 id=\"bkmrk-add-proxy-for-wget\">Add proxy for wget</h3>\r\n<ul id=\"bkmrk-edit-the-%2Fetc%2Fwgetrc\">\r\n<li class=\"null\">Edit the /etc/wgetrc file.&nbsp; Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.</li>\r\n</ul>\r\n<pre id=\"bkmrk-use_proxy%3Dyes-http_p\"><code class=\"language-\">use_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999</code></pre>\r\n<h3 id=\"bkmrk-cobalt-strike-update\">Cobalt Strike Update script</h3>\r\n<ul id=\"bkmrk-in-order-to-run-the-\">\r\n<li class=\"null\">In order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.&nbsp; Below is the additional flags you need to add.</li>\r\n</ul>\r\n<pre id=\"bkmrk-java--dhttp.proxyhos\"><code class=\"language-\">java -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999</code></pre>\r\n<h3 id=\"bkmrk-using-git-via-proxy\">Using git via proxy</h3>\r\n<ul id=\"bkmrk-git-can-use-your-env\">\r\n<li class=\"null\">git can use your environment variables to use a proxy, wget can to depending on the version of linux.&nbsp; To use git through the proxy, set the following environment variables with the following command.</li>\r\n</ul>\r\n<pre id=\"bkmrk-export-http_proxy%3Dht\"><code class=\"language-\">export http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999</code></pre>\r\n<h3 id=\"bkmrk-pip3-install-via-pro\">PIP3 install via proxy</h3>\r\n<ul id=\"bkmrk-on-occasion-pip3-ins\">\r\n<li class=\"null\">On occasion pip3 installs on ubuntu runs into issues.&nbsp; The following has worked to resolve it.</li>\r\n</ul>\r\n<pre id=\"bkmrk-apt-remove---purge-p\"><code class=\"language-\">apt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py</code></pre>','NOTE: The proxy is at http://172.30.0.2:9999\r\nSetting up Docker in linux\r\n\r\nAdd folder for the docker service if it doesn\'t exist and add a proxy conf file       \r\n\r\ncd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf\r\n\r\nPut the following in the http-proxy.conf\r\n\r\n[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"\r\n\r\nLastly, reload daemon and restart the docker service\r\n\r\nsystemctl daemon-reload\r\nsystemctl restart docker\r\nAdding Proxy to a Dockerfile\r\n\r\nedit your dockerfile in your favorite linux text editor and add these variables.\r\n\r\nENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999\r\nAdd Proxy to Apt\r\n\r\nGo to the apt.conf.d directory and create a proxy.conf file\r\n\r\ncd /etc/apt/apt.conf.d\r\nvi proxy.conf\r\n\r\nPut the following in the proxy.conf file\r\n\r\nAcquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";\r\nAdd proxy for wget\r\n\r\nEdit the /etc/wgetrc file.  Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.\r\n\r\nuse_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999\r\nCobalt Strike Update script\r\n\r\nIn order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.  Below is the additional flags you need to add.\r\n\r\njava -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999\r\nUsing git via proxy\r\n\r\ngit can use your environment variables to use a proxy, wget can to depending on the version of linux.  To use git through the proxy, set the following environment variables with the following command.\r\n\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\nPIP3 install via proxy\r\n\r\nOn occasion pip3 installs on ubuntu runs into issues.  The following has worked to resolve it.\r\n\r\napt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py',1,'2023-04-03 20:15:24','2023-04-03 20:15:24','proxy-all-the-things','how-to-guides','version','','',2),(51,12,'Code Signing Certificates for Binaries','<p id=\"bkmrk-using-the-ca-server-\">Using the CA-server to sign binaries.</p>\r\n<ul id=\"bkmrk-ssh-into-globalcerts\">\r\n<li class=\"null\">SSH into globalcerts.com.&nbsp;&nbsp; Creds: root&nbsp; password: toor</li>\r\n<li class=\"null\">\r\n</ul>','Using the CA-server to sign binaries.\r\n\r\nSSH into globalcerts.com.   Creds: root  password: toor\r\n\r\n',1,'2023-04-03 20:18:59','2023-04-03 20:18:59','code-signing-certificates-for-binaries','how-to-guides','version','','Initial publish',1),(52,13,'Using the NRTS server','<p id=\"bkmrk-the-not-red-team-ser\">The Not Red Team Server (NRTS) is the swiss army knife for building red team infrastructure.&nbsp;&nbsp; This guide will provide step by step instructions for using it\'s key features.</p>\r\n<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues I\'ve seen is very slow transfer rates, there is something in the profile that can make exfilling large files down right painful.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So I would also advice testing this on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer excepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; I believe the max number of variants is 10, but I\'d advise setting this to 0.&nbsp; The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select SSL, the NRTS build redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a Keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a randomly generated named.profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set a teamserver on an NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using Sourcepoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">Sourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.</li>\r\n<li class=\"null\">Sourepoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.</li>\r\n<li class=\"null\">Required Sourcepoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server varable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthly option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good Idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','The Not Red Team Server (NRTS) is the swiss army knife for building red team infrastructure.   This guide will provide step by step instructions for using it\'s key features.\r\nScript generated Cobalt Strike Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues I\'ve seen is very slow transfer rates, there is something in the profile that can make exfilling large files down right painful.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So I would also advice testing this on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer excepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  I believe the max number of variants is 10, but I\'d advise setting this to 0.  The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select SSL, the NRTS build redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a Keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a randomly generated named.profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set a teamserver on an NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing Sourcepoint\r\n\r\nSourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\nSourepoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.\r\nRequired Sourcepoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server varable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthly option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good Idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n ',1,'2023-04-03 21:31:35','2023-04-03 21:31:35','using-the-nrts-server','how-to-guides','version','','Initial publish',1),(53,13,'Creating Cobalt Strike C2 Profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues I\'ve seen is very slow transfer rates, there is something in the profile that can make exfilling large files down right painful.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So I would also advice testing this on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer excepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; I believe the max number of variants is 10, but I\'d advise setting this to 0.&nbsp; The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select SSL, the NRTS build redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a Keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a randomly generated named.profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set a teamserver on an NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using Sourcepoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">Sourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.</li>\r\n<li class=\"null\">Sourepoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.</li>\r\n<li class=\"null\">Required Sourcepoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server varable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthly option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good Idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues I\'ve seen is very slow transfer rates, there is something in the profile that can make exfilling large files down right painful.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So I would also advice testing this on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer excepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  I believe the max number of variants is 10, but I\'d advise setting this to 0.  The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select SSL, the NRTS build redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a Keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a randomly generated named.profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set a teamserver on an NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing Sourcepoint\r\n\r\nSourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\nSourepoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.\r\nRequired Sourcepoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server varable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthly option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good Idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-03 21:34:19','2023-04-03 21:34:19','creating-cobalt-strike-c2-profiles','using-the-nrts','version','','',2),(54,14,'Starting a Cobalt Strike Teamserver','','',1,'2023-04-03 21:36:18','2023-04-03 21:36:18','starting-a-cobalt-strike-teamserver','using-the-nrts','version','','Initial publish',1),(56,14,'Starting a Cobalt Strike Teamserver','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a cobalt strike profile that you want to use, for this guide, it will use humanzoo.profile in it\'s examples.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hGyimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/N1Iimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/KZNimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want randomly generated IPs or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/uPMimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; Below is a screenshot of when you selected option 1.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vgRimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips---option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP.&nbsp;</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.&nbsp; From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JHKimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JB2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/b00image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.\r\nAlso this guide is assuming that you have already created a cobalt strike profile that you want to use, for this guide, it will use humanzoo.profile in it\'s examples.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n           \r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n  \r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.\r\n\r\n            \r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.\r\n\r\n              \r\n\r\nThen it will ask if you want randomly generated IPs or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n              \r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  Below is a screenshot of when you selected option 1.\r\n\r\n\r\n\r\n                    \r\n\r\n\r\n\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP. \r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nAfter I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.  From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.\r\n\r\n\r\n\r\n                \r\n\r\nNext, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n           \r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n            \r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n           \r\n\r\nBelow is what the build process looks like.\r\n\r\n          \r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n ',1,'2023-04-03 22:23:02','2023-04-03 22:23:02','starting-a-cobalt-strike-teamserver','using-the-nrts','version','','',2),(57,15,'Starting a HAProxy Redirector','','',1,'2023-04-03 22:23:22','2023-04-03 22:23:22','starting-a-haproxy-redirector','using-the-nrts','version','','Initial publish',1),(58,14,'Starting a Cobalt Strike Teamserver','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a cobalt strike profile that you want to use, for this guide, it will use humanzoo.profile in it\'s examples.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hGyimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/N1Iimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/KZNimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want randomly generated IPs or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/uPMimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; Below is a screenshot of when you selected option 1.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vgRimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips---option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP.&nbsp;</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.&nbsp; From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JHKimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JB2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/b00image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.\r\nAlso this guide is assuming that you have already created a cobalt strike profile that you want to use, for this guide, it will use humanzoo.profile in it\'s examples.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n           \r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n  \r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.\r\n\r\n            \r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.\r\n\r\n              \r\n\r\nThen it will ask if you want randomly generated IPs or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n              \r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  Below is a screenshot of when you selected option 1.\r\n\r\n\r\n\r\n                    \r\n\r\n\r\n\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP. \r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nAfter I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.  From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.\r\n\r\n\r\n\r\n                \r\n\r\nNext, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n           \r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n            \r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n           \r\n\r\nBelow is what the build process looks like.\r\n\r\n          \r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-03 22:23:43','2023-04-03 22:23:43','starting-a-cobalt-strike-teamserver','using-the-nrts','version','','',3),(60,15,'Starting a HAProxy Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\n',1,'2023-04-03 22:27:44','2023-04-03 22:27:44','starting-a-haproxy-redirector','using-the-nrts','version','','',2),(62,15,'Starting a HAProxy Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a tag to used for identifying the service.&nbsp; This will also be the name of the directory the script will make for storing container files and will also be the name of the container.&nbsp; By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.&nbsp; For this example, we\'ll just use the default of RD1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/vq2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP address from.&nbsp; For this example we\'ll use the UK.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).&nbsp; Not much to see, it just goes on to the next option.&nbsp; The script will pull 5 random IPs from the geo-location based IP subnet file.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9RIimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28manual%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Manual) Below is the menu when you select manual IP selection.&nbsp; Here you can look at available subnets by entering \"s\".&nbsp; Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.&nbsp; You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.&nbsp; Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/jRdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-1\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.&nbsp; This part of the redirector will accommodate this if needed.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for http, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirect should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This need to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to insureme.com, this is a site hosted on the webhost-traffic server.&nbsp; We\'ll leave the default for this example.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0XSimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/pRdimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pRdimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (option 1 - use randomly generated one/s).&nbsp; If we select option 1, the script moves on to asking for a DNS tag.&nbsp; It will randomly generate domains at the end when it\'s building the redirector.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hfkimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (Option2 - Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.82</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pxYimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.82</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/cKAimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Press enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/mYQimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2l6image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/mx6image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/tvzimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/tvzimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.&nbsp; You can validate your redirector is running by looking at docker.&nbsp; Run docker ps.&nbsp; You should see a RD1 up and running.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/dhEimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></a></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"\r\n\r\n      \r\n\r\nNext it will ask for a tag to used for identifying the service.  This will also be the name of the directory the script will make for storing container files and will also be the name of the container.  By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.  For this example, we\'ll just use the default of RD1.\r\n\r\n       \r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n      \r\n\r\nThen it will ask for a Geo-location to pull IP address from.  For this example we\'ll use the UK.\r\n\r\n     \r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n     \r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n     \r\n\r\n\r\n\r\nSetting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).  Not much to see, it just goes on to the next option.  The script will pull 5 random IPs from the geo-location based IP subnet file.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nSetting IPs (Manual) Below is the menu when you select manual IP selection.  Here you can look at available subnets by entering \"s\".  Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.\r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\nUsing the \"s\" option to see available subnets.  This shows the available IP subnets based on the geo-location selections you made previously.  The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.  You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.  Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nAfter pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.  \r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.\r\n\r\n\r\n\r\n\r\n\r\n             \r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS\r\n\r\n        \r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.  This part of the redirector will accommodate this if needed.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n         \r\n\r\nNext it will ask about changing the bind port for http, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n         \r\n\r\nNext it will ask what IP the redirect should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10\r\n\r\n        \r\n\r\nThen it will ask which Cobalt Strike profile to use.  This need to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n        \r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to insureme.com, this is a site hosted on the webhost-traffic server.  We\'ll leave the default for this example.\r\n\r\n         \r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n        \r\n\r\n\r\n\r\nAssigning Domains (option 1 - use randomly generated one/s).  If we select option 1, the script moves on to asking for a DNS tag.  It will randomly generate domains at the end when it\'s building the redirector.\r\n\r\n\r\n\r\n                \r\n\r\n\r\n\r\nAssigning Domains (Option2 - Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.82\r\n\r\n\r\n\r\n               \r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.82\r\n\r\n\r\n\r\n               \r\n\r\n\r\n\r\nPress enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n             \r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\"\r\n\r\n           \r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n       \r\n\r\nBelow is a screenshot of the build process.\r\n\r\n         \r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.  You can validate your redirector is running by looking at docker.  Run docker ps.  You should see a RD1 up and running.\r\n\r\n',1,'2023-04-03 23:39:39','2023-04-03 23:39:39','starting-a-haproxy-redirector','using-the-nrts','version','','',3),(64,15,'Starting a HAProxy Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a tag to used for identifying the service.&nbsp; This will also be the name of the directory the script will make for storing container files and will also be the name of the container.&nbsp; By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.&nbsp; For this example, we\'ll just use the default of RD1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/vq2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP address from.&nbsp; For this example we\'ll use the UK.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).&nbsp; Not much to see, it just goes on to the next option.&nbsp; The script will pull 5 random IPs from the geo-location based IP subnet file.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9RIimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28manual%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Manual) Below is the menu when you select manual IP selection.&nbsp; Here you can look at available subnets by entering \"s\".&nbsp; Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.&nbsp; You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.&nbsp; Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/jRdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-1\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.&nbsp; This part of the redirector will accommodate this if needed.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for http, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirect should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This need to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br></li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/B4Aimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (option 1 - use randomly generated one/s).&nbsp; If we select option 1, the script moves on to asking for a DNS tag.&nbsp; It will randomly generate domains at the end when it\'s building the redirector.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pGyimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (Option2 - Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57. <br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Press enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-1\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.&nbsp; You can validate your redirector is running by looking at docker.&nbsp; Run docker ps.&nbsp; You should see a RD1 up and running.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/dhEimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></a></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"\r\n\r\n      \r\n\r\nNext it will ask for a tag to used for identifying the service.  This will also be the name of the directory the script will make for storing container files and will also be the name of the container.  By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.  For this example, we\'ll just use the default of RD1.\r\n\r\n       \r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n      \r\n\r\nThen it will ask for a Geo-location to pull IP address from.  For this example we\'ll use the UK.\r\n\r\n     \r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n     \r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n     \r\n\r\n\r\n\r\nSetting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).  Not much to see, it just goes on to the next option.  The script will pull 5 random IPs from the geo-location based IP subnet file.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nSetting IPs (Manual) Below is the menu when you select manual IP selection.  Here you can look at available subnets by entering \"s\".  Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.\r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\nUsing the \"s\" option to see available subnets.  This shows the available IP subnets based on the geo-location selections you made previously.  The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.  You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.  Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nAfter pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.  \r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.\r\n\r\n\r\n\r\n\r\n\r\n             \r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS\r\n\r\n        \r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.  This part of the redirector will accommodate this if needed.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n         \r\n\r\nNext it will ask about changing the bind port for http, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n         \r\n\r\nNext it will ask what IP the redirect should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10\r\n\r\n        \r\n\r\nThen it will ask which Cobalt Strike profile to use.  This need to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n        \r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.         \r\n\r\n          \r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n         \r\n\r\n\r\n\r\nAssigning Domains (option 1 - use randomly generated one/s).  If we select option 1, the script moves on to asking for a DNS tag.  It will randomly generate domains at the end when it\'s building the redirector.\r\n\r\n\r\n\r\n                \r\n\r\n\r\n\r\nAssigning Domains (Option2 - Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57. \r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nPress enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n                \r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\"\r\n\r\n           \r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n          \r\n\r\nBelow is a screenshot of the build process.\r\n\r\n          \r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.  You can validate your redirector is running by looking at docker.  Run docker ps.  You should see a RD1 up and running.\r\n\r\n',1,'2023-04-04 00:13:12','2023-04-04 00:13:12','starting-a-haproxy-redirector','using-the-nrts','version','','',4),(65,15,'Making a HAProxy Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a tag to used for identifying the service.&nbsp; This will also be the name of the directory the script will make for storing container files and will also be the name of the container.&nbsp; By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.&nbsp; For this example, we\'ll just use the default of RD1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/vq2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP address from.&nbsp; For this example we\'ll use the UK.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).&nbsp; Not much to see, it just goes on to the next option.&nbsp; The script will pull 5 random IPs from the geo-location based IP subnet file.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9RIimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28manual%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (Manual) Below is the menu when you select manual IP selection.&nbsp; Here you can look at available subnets by entering \"s\".&nbsp; Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.&nbsp; You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.&nbsp; Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/jRdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-1\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.&nbsp; This part of the redirector will accommodate this if needed.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for http, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirect should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This need to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <br></li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/B4Aimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (option 1 - use randomly generated one/s).&nbsp; If we select option 1, the script moves on to asking for a DNS tag.&nbsp; It will randomly generate domains at the end when it\'s building the redirector.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pGyimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-%28o-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains (Option2 - Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57. <br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Press enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-1\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.&nbsp; You can validate your redirector is running by looking at docker.&nbsp; Run docker ps.&nbsp; You should see a RD1 up and running.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/dhEimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></a></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\"\r\n\r\n      \r\n\r\nNext it will ask for a tag to used for identifying the service.  This will also be the name of the directory the script will make for storing container files and will also be the name of the container.  By default it will generate a RD1 name, this will increment if it already has one build, ie RD2, etc.  For this example, we\'ll just use the default of RD1.\r\n\r\n       \r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n      \r\n\r\nThen it will ask for a Geo-location to pull IP address from.  For this example we\'ll use the UK.\r\n\r\n     \r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n     \r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n     \r\n\r\n\r\n\r\nSetting IPs (Random) Below is a screenshot when option 1 is selected from above (Set random IPs).  Not much to see, it just goes on to the next option.  The script will pull 5 random IPs from the geo-location based IP subnet file.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nSetting IPs (Manual) Below is the menu when you select manual IP selection.  Here you can look at available subnets by entering \"s\".  Then when you know what IP\'s you want to use, you will select a IP slot and enter the IP.\r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\nUsing the \"s\" option to see available subnets.  This shows the available IP subnets based on the geo-location selections you made previously.  The list is typically long, you can hit the spacebar to scroll down and press \"q\", when you want to exit out of the subnet view and go back to the menu.  You can pick IPs from any of these subnets, so for this example, well us 12.9.80.129/25.  Note you can pick IPs from other subnets from the list, you don\'t have to use just one subnet.\r\n\r\n\r\n\r\n            \r\n\r\n\r\n\r\nAfter pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.  \r\n\r\n\r\n\r\n             \r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu, but now you will see your entered IP, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three.\r\n\r\n\r\n\r\n\r\n\r\n             \r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS\r\n\r\n        \r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure it to do so.  This part of the redirector will accommodate this if needed.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n         \r\n\r\nNext it will ask about changing the bind port for http, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n         \r\n\r\nNext it will ask what IP the redirect should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10\r\n\r\n        \r\n\r\nThen it will ask which Cobalt Strike profile to use.  This need to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n        \r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains to if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.         \r\n\r\n          \r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n         \r\n\r\n\r\n\r\nAssigning Domains (option 1 - use randomly generated one/s).  If we select option 1, the script moves on to asking for a DNS tag.  It will randomly generate domains at the end when it\'s building the redirector.\r\n\r\n\r\n\r\n                \r\n\r\n\r\n\r\nAssigning Domains (Option2 - Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list it it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  I\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57. \r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nPress enter on the above it and it takes you back to the original menu, but now you will see a domain is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n                \r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a TAG for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\"\r\n\r\n           \r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n          \r\n\r\nBelow is a screenshot of the build process.\r\n\r\n          \r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  IT will have you DNS information, IP information, where it\'s redirecting to, the C2 profile used for ACLs.  You can validate your redirector is running by looking at docker.  Run docker ps.  You should see a RD1 up and running.\r\n\r\n',1,'2023-04-04 00:13:32','2023-04-04 00:13:32','making-a-haproxy-redirector','using-the-nrts','version','','',5),(66,16,'Making a NGINX Redirector','','',1,'2023-04-04 00:13:47','2023-04-04 00:13:47','making-a-nginx-redirector','using-the-nrts','version','','Initial publish',1),(68,16,'Making a NGINX Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.<br></p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a NGINX redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 1 \"Set up a NGINX redirector (http,https, DNS)\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, this take will create a folder in /root/services to place container config files and it will also be used as the container name.&nbsp; It generators a default in the form of RDx, starting with 1 and incrementing.&nbsp; The script will automatically find an available number.&nbsp; For example if you already had a redirector running, it would show a default of RD2 the next time you run it.&nbsp; For this example, we\'ll leave the default of RD1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CBYimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-asks-for-the\">\r\n<li class=\"null\">Next it asks for the number of IPs.&nbsp; For the example we\'ll use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ApVimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a geo-location base for your setting your IP\'s the first menu, shown below asks for a country of origin, for this example we\'ll use option 4 Canada.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/RStimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-narrows-it-d\">\r\n<li class=\"null\">Then it narrows it down by city, for this example we\'ll use Toronto.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/VBWimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP manually or randomly.&nbsp; This guide will walk through both options.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Qhimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%281-set-r\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs (1 Set random IPs)&nbsp; For this the script will randomly select IPs from the available IP subnets based on the geo-location you selected.&nbsp; It will do this during processing, so it just moves on to the next menu.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/mZUimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips-%28-2-set-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs ( 2 Set IPs manually)&nbsp; When you select this option you get the following menu screen.&nbsp; Here you have a list of blank slots, this is where you would add IPs.&nbsp; Select \"s\" to see a list of available IP subnets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\", you can use this information to select your IPs from.&nbsp; This list can be long, use spacebar to page forward and \"q\" to exit out and get back to the previous menu.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X3Rimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-using-the-list-of-av\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.&nbsp; I\'ve press \"q\" to get out of that view and back at the manual IP menu I\'ve select 1 for the first blank space.&nbsp; This brings up the menu to enter an IP as shown below.&nbsp; I\'m manually putting in 72.3.244.20 for the first slot.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hdjimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-i-press-enter%2C-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once I press enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jJGimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-i-have\">\r\n<li class=\"null\">At this point I have either set IPs randomly or manually set IPs and select \"d\", which brings us to the next menu that asks what ports to redirect as shown below.&nbsp;&nbsp; For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rocimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if I want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set to \"bind to\" a different port.&nbsp; The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.&nbsp; You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.&nbsp; For this example we will leave it at the default.&nbsp; The screenshoot shows it asks this for each port being redirected.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rtkimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for the IP to redirect to.&nbsp; This should be your C2 server\'s IP.&nbsp; For this example we are using a Cobalt Strike teamserver running on 54.88.220.10.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dp2image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-want-to\">\r\n<li class=\"null\">Next it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.&nbsp; This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.&nbsp; The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.&nbsp; This guide will walk through both Random and manually domain options.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/LCiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domains-na\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domains names (1 Using randomly generated one/s).&nbsp; When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.&nbsp;&nbsp;&nbsp;&nbsp;</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CtSimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assigning-domain-nam\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domain names (2 Manually create domain names/s) Option.&nbsp; This will take you to the menu below.&nbsp; Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.&nbsp; For this example, we\'ll set option 1 (205.225.141.68)</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/nkAimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-this-will-show-the-m\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This will show the menu below where it asks for the domain name.&nbsp; Enter the domain you want to use for that IP and press enter.&nbsp; For this example, we\'ll use goatfarmer.com.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-4\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/J49image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-you%27ve-entered-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-5\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sbaimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either selected randomly generated domain names or completed adding domain names manual.&nbsp; Next the script will ask you to set a tag for your DNS.&nbsp; This is used to identify the domains later when you want to remove them.&nbsp; For this example, we\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xo4image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-now-the-script-has-a\">\r\n<li class=\"null\">Now the script has all the information it needs to build your NGINX redirector.&nbsp; Review the settings and if you are happy with it press enter to start the docker container build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/ROCimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ROCimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-below-shows-the-buil\">\r\n<li class=\"null\">Below shows the build process, you should now have a NGINX redirector.&nbsp; You can get information about it from the /root/services/RD1 folder.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/HDTimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HDTimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-to-check-that-your-c\">\r\n<li class=\"null\">To check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/4KAimage.png\" alt=\"image.png\"></a></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10\r\n\r\nUse the following script to start a NGINX redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 1 \"Set up a NGINX redirector (http,https, DNS)\"\r\n\r\n      \r\n\r\nNext it will ask for a service tag, this take will create a folder in /root/services to place container config files and it will also be used as the container name.  It generators a default in the form of RDx, starting with 1 and incrementing.  The script will automatically find an available number.  For example if you already had a redirector running, it would show a default of RD2 the next time you run it.  For this example, we\'ll leave the default of RD1.\r\n\r\n       \r\n\r\nNext it asks for the number of IPs.  For the example we\'ll use 5.\r\n\r\n      \r\n\r\nNext it will ask for a geo-location base for your setting your IP\'s the first menu, shown below asks for a country of origin, for this example we\'ll use option 4 Canada.\r\n\r\n       \r\n\r\nThen it narrows it down by city, for this example we\'ll use Toronto.\r\n\r\n     \r\n\r\nNext, it will ask if you want to set IP manually or randomly.  This guide will walk through both options.\r\n\r\n      \r\n\r\n\r\n\r\nSetting IPs (1 Set random IPs)  For this the script will randomly select IPs from the available IP subnets based on the geo-location you selected.  It will do this during processing, so it just moves on to the next menu.\r\n\r\n\r\n\r\n                \r\n\r\n\r\n\r\nSetting IPs ( 2 Set IPs manually)  When you select this option you get the following menu screen.  Here you have a list of blank slots, this is where you would add IPs.  Select \"s\" to see a list of available IP subnets.\r\n\r\n\r\n\r\n                \r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\", you can use this information to select your IPs from.  This list can be long, use spacebar to page forward and \"q\" to exit out and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\n\r\n\r\nUsing the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.  I\'ve press \"q\" to get out of that view and back at the manual IP menu I\'ve select 1 for the first blank space.  This brings up the menu to enter an IP as shown below.  I\'m manually putting in 72.3.244.20 for the first slot.\r\n\r\n\r\n\r\n\r\n\r\n                     \r\n\r\n\r\n\r\n\r\n\r\nOnce I press enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point I have either set IPs randomly or manually set IPs and select \"d\", which brings us to the next menu that asks what ports to redirect as shown below.   For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.\r\n\r\n          \r\n\r\nNext it will ask if I want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set to \"bind to\" a different port.  The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.  You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.  For this example we will leave it at the default.  The screenshoot shows it asks this for each port being redirected.\r\n\r\n         \r\n\r\nNext it will ask for the IP to redirect to.  This should be your C2 server\'s IP.  For this example we are using a Cobalt Strike teamserver running on 54.88.220.10.\r\n\r\n         \r\n\r\nNext it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.  This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.  The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.  This guide will walk through both Random and manually domain options.\r\n\r\n          \r\n\r\n\r\n\r\n\r\n\r\nAssigning domains names (1 Using randomly generated one/s).  When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.    \r\n\r\n\r\n\r\n\r\n\r\n                      \r\n\r\n\r\n\r\n\r\n\r\nAssigning domain names (2 Manually create domain names/s) Option.  This will take you to the menu below.  Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.  For this example, we\'ll set option 1 (205.225.141.68)\r\n\r\n\r\n\r\n\r\n\r\n                        \r\n\r\n\r\n\r\n\r\n\r\nThis will show the menu below where it asks for the domain name.  Enter the domain you want to use for that IP and press enter.  For this example, we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point we have either selected randomly generated domain names or completed adding domain names manual.  Next the script will ask you to set a tag for your DNS.  This is used to identify the domains later when you want to remove them.  For this example, we\'ll use \"test-DNS\"\r\n\r\n          \r\n\r\nNow the script has all the information it needs to build your NGINX redirector.  Review the settings and if you are happy with it press enter to start the docker container build process.\r\n\r\n        \r\n\r\nBelow shows the build process, you should now have a NGINX redirector.  You can get information about it from the /root/services/RD1 folder.\r\n\r\n          \r\n\r\nTo check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.\r\n\r\n',1,'2023-04-04 01:10:33','2023-04-04 01:10:33','making-a-nginx-redirector','using-the-nrts','version','','',2),(69,17,'Building a Payload Host','','',1,'2023-04-04 01:12:48','2023-04-04 01:12:48','building-a-payload-host','using-the-nrts','version','','Initial publish',1),(71,17,'Building a Payload Host','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">This will then ask you to create a service tag.&nbsp; This is used by the script to set up a /root/services folder for the docker configuration files and it will also be used as the docker container name.&nbsp; By default it will provide a name of P1, the number will increment if you already have a payload host running on the NRTS, for example the next time it would set the default to P2.&nbsp; For this example, we\'ll keep the default of P1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a geo-location for your IPs.&nbsp; The script has a library of geo-location based IP subnets on the NRTS located at /root/backbonerouters.&nbsp; For this example, we\'ll set our geolocation to option 7 - France.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example france only has one, so we\'ll select 1 -Paris since there isn\'t another option.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Pysimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s Option 1 (Set random IPs).&nbsp; When you select this option the script will move on to the next step.&nbsp; It will use the geo-location you select to randomly pull IP\'s from the list of IP subnets associated with that location.&nbsp; The next step is show below, but we\'ll get back to that after showing the manual IP path option.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/iqfimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iqfimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ip%27s-option--1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s Option 2 (Set manual IPs).&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page forward and enter \"q\" to exit out of the subnet view and get back to the previous menu.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, I\'m selecting option 1 for the first blank spot and putting in 184.84.181.201.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">When I press enter for the IP I just entered, it will take me back to the manual IP menu, only now the blank at option one is populated with the IP I entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-4\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected Random IPs or have completed entering manual IPs and selected \"d\".&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/9nzimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assign DNS Option 1 (use randomly generated one/s).&nbsp; When you select this, the script will move on to the next step and assign random DNS during the build process.&nbsp; Below is that screenshot, but we\'ll get back to this after walking through the manual process.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-5\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/TOTimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assign-dns-option-2-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assign DNS Option 2 (Manually create domain name/s).&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-6\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-7\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"D\" when complete.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-8\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected Random DNS or have completed the manual DNS process and selected \"D\" for done.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.&nbsp;&nbsp; NOTE: on occassion you will see this \"RTNETLINK answers: File exists\" just ignore it.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/i6Timage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom Docker service tag go there, ex.&nbsp; /root/services/&lt;docker service tag&gt;/WWW.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>\r\n<p id=\"bkmrk-%C2%A0-1\">&nbsp;</p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"\r\n\r\n      \r\n\r\nThis will then ask you to create a service tag.  This is used by the script to set up a /root/services folder for the docker configuration files and it will also be used as the docker container name.  By default it will provide a name of P1, the number will increment if you already have a payload host running on the NRTS, for example the next time it would set the default to P2.  For this example, we\'ll keep the default of P1.\r\n\r\n         \r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n          \r\n\r\nThen it will ask for a geo-location for your IPs.  The script has a library of geo-location based IP subnets on the NRTS located at /root/backbonerouters.  For this example, we\'ll set our geolocation to option 7 - France.\r\n\r\n         \r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example france only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n          \r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n          \r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s Option 1 (Set random IPs).  When you select this option the script will move on to the next step.  It will use the geo-location you select to randomly pull IP\'s from the list of IP subnets associated with that location.  The next step is show below, but we\'ll get back to that after showing the manual IP path option.\r\n\r\n\r\n\r\n\r\n\r\n                        \r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s Option 2 (Set manual IPs).  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n                     \r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page forward and enter \"q\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n                      \r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, I\'m selecting option 1 for the first blank spot and putting in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nWhen I press enter for the IP I just entered, it will take me back to the manual IP menu, only now the blank at option one is populated with the IP I entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point you have either selected Random IPs or have completed entering manual IPs and selected \"d\".  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.\r\n\r\n           \r\n\r\n\r\n\r\n\r\n\r\nAssign DNS Option 1 (use randomly generated one/s).  When you select this, the script will move on to the next step and assign random DNS during the build process.  Below is that screenshot, but we\'ll get back to this after walking through the manual process.\r\n\r\n\r\n\r\n\r\n\r\n                        \r\n\r\n\r\n\r\n\r\n\r\nAssign DNS Option 2 (Manually create domain name/s).  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"D\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point you have either selected Random DNS or have completed the manual DNS process and selected \"D\" for done.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\"\r\n\r\n           \r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n           \r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.   NOTE: on occassion you will see this \"RTNETLINK answers: File exists\" just ignore it.\r\n\r\n       \r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom Docker service tag go there, ex.  /root/services/<docker service tag>/WWW.\r\n\r\n \r\n ',1,'2023-04-04 01:52:13','2023-04-04 01:52:13','building-a-payload-host','using-the-nrts','version','','',2),(72,18,'Setting up a Phishing Attack','','',1,'2023-04-04 01:53:10','2023-04-04 01:53:10','setting-up-a-phishing-attack','using-the-nrts','version','','Initial publish',1),(73,17,'Building a Payload Host','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">This will then ask you to create a service tag.&nbsp; This is used by the script to set up a /root/services folder for the docker configuration files and it will also be used as the docker container name.&nbsp; By default it will provide a name of P1, the number will increment if you already have a payload host running on the NRTS, for example the next time it would set the default to P2.&nbsp; For this example, we\'ll keep the default of P1.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a geo-location for your IPs.&nbsp; The script has a library of geo-location based IP subnets on the NRTS located at /root/backbonerouters.&nbsp; For this example, we\'ll set our geolocation to option 7 - France.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example france only has one, so we\'ll select 1 -Paris since there isn\'t another option.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Pysimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s Option 1 (Set random IPs).&nbsp; When you select this option the script will move on to the next step.&nbsp; It will use the geo-location you select to randomly pull IP\'s from the list of IP subnets associated with that location.&nbsp; The next step is show below, but we\'ll get back to that after showing the manual IP path option.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/iqfimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iqfimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ip%27s-option--1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s Option 2 (Set manual IPs).&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page forward and enter \"q\" to exit out of the subnet view and get back to the previous menu.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, I\'m selecting option 1 for the first blank spot and putting in 184.84.181.201.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-3\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">When I press enter for the IP I just entered, it will take me back to the manual IP menu, only now the blank at option one is populated with the IP I entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-4\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected Random IPs or have completed entering manual IPs and selected \"d\".&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/9nzimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assign DNS Option 1 (use randomly generated one/s).&nbsp; When you select this, the script will move on to the next step and assign random DNS during the build process.&nbsp; Below is that screenshot, but we\'ll get back to this after walking through the manual process.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-5\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/TOTimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-assign-dns-option-2-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assign DNS Option 2 (Manually create domain name/s).&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-6\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-7\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"D\" when complete.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-8\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected Random DNS or have completed the manual DNS process and selected \"D\" for done.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-2\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.&nbsp;&nbsp; NOTE: on occassion you will see this \"RTNETLINK answers: File exists\" just ignore it.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/i6Timage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom Docker service tag go there, ex.&nbsp; /root/services/&lt;docker service tag&gt;/WWW.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"\r\n\r\n      \r\n\r\nThis will then ask you to create a service tag.  This is used by the script to set up a /root/services folder for the docker configuration files and it will also be used as the docker container name.  By default it will provide a name of P1, the number will increment if you already have a payload host running on the NRTS, for example the next time it would set the default to P2.  For this example, we\'ll keep the default of P1.\r\n\r\n         \r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n          \r\n\r\nThen it will ask for a geo-location for your IPs.  The script has a library of geo-location based IP subnets on the NRTS located at /root/backbonerouters.  For this example, we\'ll set our geolocation to option 7 - France.\r\n\r\n         \r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example france only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n          \r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n          \r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s Option 1 (Set random IPs).  When you select this option the script will move on to the next step.  It will use the geo-location you select to randomly pull IP\'s from the list of IP subnets associated with that location.  The next step is show below, but we\'ll get back to that after showing the manual IP path option.\r\n\r\n\r\n\r\n\r\n\r\n                        \r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s Option 2 (Set manual IPs).  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n                     \r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page forward and enter \"q\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n                      \r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, I\'m selecting option 1 for the first blank spot and putting in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nWhen I press enter for the IP I just entered, it will take me back to the manual IP menu, only now the blank at option one is populated with the IP I entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point you have either selected Random IPs or have completed entering manual IPs and selected \"d\".  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.\r\n\r\n           \r\n\r\n\r\n\r\n\r\n\r\nAssign DNS Option 1 (use randomly generated one/s).  When you select this, the script will move on to the next step and assign random DNS during the build process.  Below is that screenshot, but we\'ll get back to this after walking through the manual process.\r\n\r\n\r\n\r\n\r\n\r\n                        \r\n\r\n\r\n\r\n\r\n\r\nAssign DNS Option 2 (Manually create domain name/s).  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"D\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n                       \r\n\r\nAt this point you have either selected Random DNS or have completed the manual DNS process and selected \"D\" for done.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\"\r\n\r\n           \r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n           \r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.   NOTE: on occassion you will see this \"RTNETLINK answers: File exists\" just ignore it.\r\n\r\n       \r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom Docker service tag go there, ex.  /root/services/<docker service tag>/WWW.\r\n\r\n\r\n',1,'2023-04-04 01:53:26','2023-04-04 01:53:26','building-a-payload-host','using-the-nrts','version','','',3),(75,18,'Setting up a Phishing Attack','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Set IPs - Option 1 (set random IPs).&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; The next menu is pictured below, but we\'ll get back to it later, after looking at the manual process.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/HOIimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HOIimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"\r\n\r\n      \r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.\r\n\r\n         \r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.\r\n\r\n        \r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.\r\n\r\n          \r\n\r\n\r\n\r\n\r\n\r\nSet IPs - Option 1 (set random IPs).  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  The next menu is pictured below, but we\'ll get back to it later, after looking at the manual process.\r\n\r\n\r\n\r\n\r\n\r\n                      \r\n ',1,'2023-04-04 01:59:18','2023-04-04 01:59:18','setting-up-a-phishing-attack','using-the-nrts','version','','',2),(77,18,'Setting up a Phishing Attack','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Set IPs - Option 1 (set random IPs).&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; The next menu is pictured below, but we\'ll get back to it later, after looking at the manual process.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/HOIimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HOIimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-2-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Set IPs - Option 2 (set IPs manually).&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what the is in the IP range based on the Geo-location you seleted.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets to select an IP from. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30 &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP&nbsp; that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our IP either manually or randomly and have the next menu screen asking about how we want to assign DNS.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assign DNS (Option 1) Randomly - this option will assign random domain names during processing and will move on to the next step.</li>\r\n<li class=\"null\">Assign DNS (Option 2) Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; Here it asks for the domain you want to use, for this example we\'ll use goatfarmer.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have assigned DNS, next the script will want a Tag to use to help identify your DNS later, like say after an engagement and you want to remove the DNS you had previously set up.&nbsp; For this example, we\'ll use \"test-DNS\" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Press enter.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/Bxbimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are;<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modifed for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/eUlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/xITimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; However, the only difference here is that you don\'t add the email addess of your target in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"      \r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.         \r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.        \r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.          \r\n\r\n\r\n\r\n\r\n\r\n\r\nSet IPs - Option 1 (set random IPs).  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  The next menu is pictured below, but we\'ll get back to it later, after looking at the manual process.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSet IPs - Option 2 (set IPs manually).  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what the is in the IP range based on the Geo-location you seleted.  Enter \"s\" at the menu below to see a list of IP subnets to select an IP from.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30                  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP  that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our IP either manually or randomly and have the next menu screen asking about how we want to assign DNS.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.                             \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssign DNS (Option 1) Randomly - this option will assign random domain names during processing and will move on to the next step.\r\nAssign DNS (Option 2) Manually create domain name/s.   Selecting this option will bring up  the following menu.  Here it asks for the domain you want to use, for this example we\'ll use goatfarmer.com                \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have assigned DNS, next the script will want a Tag to use to help identify your DNS later, like say after an engagement and you want to remove the DNS you had previously set up.  For this example, we\'ll use \"test-DNS\"          \r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\n\r\nPress enter.                           \r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are;\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modifed for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.                          \r\n\r\n\r\nThen the last line in the script is the phish.  Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  However, the only difference here is that you don\'t add the email addess of your target in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n ',1,'2023-04-04 17:13:41','2023-04-04 17:13:41','setting-up-a-phishing-attack','using-the-nrts','version','','',3),(78,19,'Managing Services','<p id=\"bkmrk-then-nrts-builds-red\">Then NRTS builds red team infrastructure in docker containers.&nbsp; These containers and services can be managed using the /root/scripts/buildredteam.sh.&nbsp; NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks.&nbsp;</p>\r\n<ul id=\"bkmrk-to-view%2C-restart-or-\">\r\n<li class=\"null\">To View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b0Yimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Then select option 6 - Container management.&nbsp; From this menu you can view, delete or start a saved container.&nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/HCCimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HCCimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>','Then NRTS builds red team infrastructure in docker containers.  These containers and services can be managed using the /root/scripts/buildredteam.sh.  NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks. \r\n\r\nTo View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.                                                                                                                                                            \r\nThen select option 6 - Container management.  From this menu you can view, delete or start a saved container. \r\n\r\n\r\n',1,'2023-04-04 17:42:40','2023-04-04 17:42:40','managing-services','using-the-nrts','version','','Initial publish',1),(80,13,'Creating Cobalt Strike C2 Profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So I would also advice testing this on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; I believe the max number of variants is 10, but I\'d advise setting this to 0.&nbsp; The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using Sourcepoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">Sourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.</li>\r\n<li class=\"null\">Sourepoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.</li>\r\n<li class=\"null\">Required Sourcepoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So I would also advice testing this on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  I believe the max number of variants is 10, but I\'d advise setting this to 0.  The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing Sourcepoint\r\n\r\nSourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\nSourepoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.\r\nRequired Sourcepoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-04 17:58:13','2023-04-04 17:58:13','creating-cobalt-strike-c2-profiles','using-the-nrts','version','','',3),(82,14,'Starting a Cobalt Strike Teamserver','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a cobalt strike profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/hGyimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/N1Iimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/KZNimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want randomly generated IPs or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/uPMimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; Below is a screenshot of when you selected option 1.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0-%C2%A0\">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vgRimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-setting-ips---option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP.&nbsp;</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.&nbsp; From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0-%C2%A0-%C2%A0-%C2%A0%C2%A0-%C2%A0%C2%A0%C2%A0%C2%A0\">&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JHKimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0-1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JB2image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/b00image.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.\r\nAlso this guide is assuming that you have already created a cobalt strike profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n           \r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n  \r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.\r\n\r\n            \r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.\r\n\r\n              \r\n\r\nThen it will ask if you want randomly generated IPs or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n              \r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  Below is a screenshot of when you selected option 1.\r\n\r\n\r\n\r\n                    \r\n\r\n\r\n\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP. \r\n\r\n\r\n\r\n                 \r\n\r\n\r\n\r\nAfter I\'ve decided what subnet I want to use from the list above, I\'ll write it down or memorize it and then press \"q\" to exit out of the IP subnet view screen.  From the list above for this example, I\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.\r\n\r\n\r\n\r\n                \r\n\r\nNext, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n           \r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n            \r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n           \r\n\r\nBelow is what the build process looks like.\r\n\r\n          \r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-04 18:00:18','2023-04-04 18:00:18','starting-a-cobalt-strike-teamserver','using-the-nrts','version','','',4),(84,14,'Starting a Cobalt Strike Teamserver','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a cobalt strike profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.&nbsp; For instructions on how to create Cobalt Strike C2 profiles go to -&gt; Using the NRTS -&gt; Creating Cobalt Strike C2 Profiles.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want a randomly generated IP or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add a random IP during processing so the menu will move to the next step.&nbsp; This will be shown after going through the manual process.</li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.&nbsp; This will take you back to the previous menu.&nbsp; From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">At this point you have either selected to randomly set an IP or set one manually.&nbsp; Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile. &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/b00image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.\r\nAlso this guide is assuming that you have already created a cobalt strike profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.  For instructions on how to create Cobalt Strike C2 profiles go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n\r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.                       \r\n\r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.              \r\n\r\n\r\nThen it will ask if you want a randomly generated IP or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add a random IP during processing so the menu will move to the next step.  This will be shown after going through the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.  \r\n\r\n\r\n\r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP.                                                                                                                \r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.  This will take you back to the previous menu.  From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet. \r\n\r\n\r\n\r\n\r\nAt this point you have either selected to randomly set an IP or set one manually.  Next, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.      \r\n\r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n\r\nBelow is what the build process looks like.\r\n\r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-04 18:14:30','2023-04-04 18:14:30','starting-a-cobalt-strike-teamserver','using-the-nrts','version','','',5),(86,15,'Making a HAProxy Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\" <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default name or add own own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default of RD1. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\">&nbsp; <br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going through the manual process.<br></li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp; Below is the menu when you select Set Ips manually.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.&nbsp; The blank menu items will store IPs as you add them in.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Use the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.&nbsp; You can pick IPs from any of these subnets, so for this example, well use 12.9.80.129/25.&nbsp; Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.&nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-then-enter-the-ip.\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Then enter the IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.&nbsp; You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. <a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for http, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirect should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This need to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/B4Aimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options. &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains - Option 1 - (use randomly generated one/s).&nbsp; If we select option 1, the script moves will add these during processing and move on to the next step.&nbsp; We\'ll cover that after going through the manual process.<br></li>\r\n<li class=\"null\">Assigning Domains - Option 2 - (Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list and&nbsp; it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu, but now you will see the domain you entered is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a Tag for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .&nbsp; You can validate if your redirector is running by looking at docker.&nbsp; Run docker ps and you should see RD1 up and running.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\" \r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.  You can keep the default name or add own own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default of RD1.                                                                                                                                  \r\n\r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n\r\nThen it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.  \r\n\r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes. \r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going through the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.  Below is the menu when you select Set Ips manually.  At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.  The blank menu items will store IPs as you add them in.                                                                                                       \r\n\r\n\r\n\r\n\r\n\r\n\r\nUse the \"s\" option to see available subnets.  This shows the available IP subnets based on the geo-location selections you made previously.  The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.  You can pick IPs from any of these subnets, so for this example, well use 12.9.80.129/25.  Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet.                                                                                                                           \r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot. \r\n\r\n\r\n\r\n\r\n\r\n\r\nThen enter the IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.  You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS \r\n\r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.                      \r\n\r\n\r\nNext it will ask about changing the bind port for http, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n\r\nNext it will ask what IP the redirect should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10.\r\n\r\n\r\nThen it will ask which Cobalt Strike profile to use.  This need to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.          \r\n\r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.          \r\n\r\n\r\n\r\n\r\nAssigning Domains - Option 1 - (use randomly generated one/s).  If we select option 1, the script moves will add these during processing and move on to the next step.  We\'ll cover that after going through the manual process.\r\nAssigning Domains - Option 2 - (Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list and  it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.  \r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu, but now you will see the domain you entered is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.           \r\n\r\n\r\n\r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a Tag for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\"\r\n\r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n\r\nBelow is a screenshot of the build process.\r\n\r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .  You can validate if your redirector is running by looking at docker.  Run docker ps and you should see RD1 up and running.\r\n',1,'2023-04-04 18:44:47','2023-04-04 18:44:47','making-a-haproxy-redirector','using-the-nrts','version','','',8),(88,16,'Making a NGINX Redirector','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.<br></p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike or other team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a teamserver running at 54.88.220.10<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a NGINX redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default or set your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave the default of RD1.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CBYimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-asks-for-the\">\r\n<li class=\"null\">Next it asks for the number of IPs.&nbsp; For the example we\'ll use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ApVimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a geo-location base for your setting your IP\'s.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. &nbsp; For this example we\'ll use option 4 Canada.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/RStimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-narrows-it-d\">\r\n<li class=\"null\">Then it narrows it down by city, for this example we\'ll use Toronto.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/VBWimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP manually or randomly.&nbsp; This guide will walk through both options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Qhimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%281-set-r\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the Manual IP option.</li>\r\n<li class=\"null\">Setting IPs&nbsp; - Option 2 set IPs Manually.&nbsp; Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.&nbsp; This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out and get back to the previous menu.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X3Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-list-of-av\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.&nbsp; Press \"q\" then \"enter\" to exit the IP subnet view and back at the manual IP menu.&nbsp; For this example, we\'ll select 1 for the first blank space.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-brings-up-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This brings up the IP entry menu, for this example we\'ll use 72.3.244.20.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hdjimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-i-press-enter%2C-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jJGimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-i-have\">\r\n<li class=\"null\">At this point I have either selected to IPs randomly or manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.&nbsp;&nbsp; For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rocimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set the \"bind to\" a different port.&nbsp; The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.&nbsp; You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.&nbsp; For this example we will leave it at the default.&nbsp; The screenshoot shows it asks this for each port being redirected.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rtkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for the IP to redirect to.&nbsp; This should be your C2 server\'s IP.&nbsp; For this example we are using a teamserver running on 54.88.220.10.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dp2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-want-to\">\r\n<li class=\"null\">Next it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.&nbsp; This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.&nbsp; The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.&nbsp; This guide will walk through both Random and manually domain options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/LCiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-na\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domains - Option 1 (Use randomly generated one/s).&nbsp; When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.&nbsp; This will be shown after going over the Manual domain name option. &nbsp;&nbsp; <br></li>\r\n<li class=\"null\">Assigning domains - Option 2 (Manually create domain names/s).&nbsp; This will take you to the menu below.&nbsp; Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.&nbsp; For this example, we\'ll set option 1 (205.225.141.68)<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/nkAimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-show-the-m\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This will show the menu below where it asks for the domain name.&nbsp; Enter the domain you want to use for that IP and press enter.&nbsp; For this example, we\'ll use goatfarmer.com.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/J49image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-entered-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sbaimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either selected randomly generated domain names or completed adding domain names manual.&nbsp; Next the script will ask you to set a tag for your DNS.&nbsp; This is used to identify the domains later when you want to remove them.&nbsp; For this example, we\'ll use \"test-DNS\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xo4image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-now-the-script-has-a\">\r\n<li class=\"null\">Now the script has all the information it needs to build your NGINX redirector.&nbsp; Review the settings and if you are happy with it press enter to start the docker container build process. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ROCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-shows-the-buil\">\r\n<li class=\"null\">Below shows the build process, you should now have a NGINX redirector.&nbsp; You can get information about it from the /root/services/RD1 folder. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HDTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-to-check-that-your-c\">\r\n<li class=\"null\">To check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/4KAimage.png\" alt=\"image.png\"></a></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.\r\nNOTE: This guide is assuming you already have a Cobalt Strike or other team server running.  \r\nFor this example, we\'ll assume we have a teamserver running at 54.88.220.10\r\n\r\nUse the following script to start a NGINX redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.  You can keep the default or set your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave the default of RD1.\r\n\r\n\r\nNext it asks for the number of IPs.  For the example we\'ll use 5.\r\n\r\n\r\nNext it will ask for a geo-location base for your setting your IP\'s.  The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.   For this example we\'ll use option 4 Canada.\r\n\r\n\r\nThen it narrows it down by city, for this example we\'ll use Toronto.\r\n\r\n\r\nNext, it will ask if you want to set IP manually or randomly.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the Manual IP option.\r\nSetting IPs  - Option 2 set IPs Manually.  Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.  At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.  This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out and get back to the previous menu.                                                                                                                                                 \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUsing the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.  Press \"q\" then \"enter\" to exit the IP subnet view and back at the manual IP menu.  For this example, we\'ll select 1 for the first blank space.  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis brings up the IP entry menu, for this example we\'ll use 72.3.244.20.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point I have either selected to IPs randomly or manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.   For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.\r\n\r\n\r\nNext it will ask if you want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set the \"bind to\" a different port.  The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.  You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.  For this example we will leave it at the default.  The screenshoot shows it asks this for each port being redirected.\r\n\r\n\r\nNext it will ask for the IP to redirect to.  This should be your C2 server\'s IP.  For this example we are using a teamserver running on 54.88.220.10.\r\n\r\n\r\nNext it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.  This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.  The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.  This guide will walk through both Random and manually domain options.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning domains - Option 1 (Use randomly generated one/s).  When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.  This will be shown after going over the Manual domain name option.    \r\nAssigning domains - Option 2 (Manually create domain names/s).  This will take you to the menu below.  Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.  For this example, we\'ll set option 1 (205.225.141.68)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis will show the menu below where it asks for the domain name.  Enter the domain you want to use for that IP and press enter.  For this example, we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected randomly generated domain names or completed adding domain names manual.  Next the script will ask you to set a tag for your DNS.  This is used to identify the domains later when you want to remove them.  For this example, we\'ll use \"test-DNS\"\r\n\r\n\r\nNow the script has all the information it needs to build your NGINX redirector.  Review the settings and if you are happy with it press enter to start the docker container build process. \r\n\r\n\r\nBelow shows the build process, you should now have a NGINX redirector.  You can get information about it from the /root/services/RD1 folder.                     \r\n\r\n\r\nTo check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.\r\n\r\n',1,'2023-04-04 19:05:32','2023-04-04 19:05:32','making-a-nginx-redirector','using-the-nrts','version','','',3),(90,17,'Building a Payload Host','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.&nbsp; For this example, we\'ll leave it as the default of P1.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a geo-location for your IPs.&nbsp; The NRTS has a list of IP Subnets stored in a Geo-location folder structure at /root/backbonerouters.&nbsp; For this example, we\'ll set our geolocation to option 7 - France. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the script will move on to the next step.&nbsp; We\'ll cover that after going over the manual IP process.</li>\r\n<li class=\"null\">Setting IP\'s - Option 2 Set IPs manually.&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page down then&nbsp; press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, we\'ll select option 1 for the first blank spot.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-%C2%A0then-at-the-ip-entr\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">&nbsp;Then at the IP entry menu below we\'ll&nbsp; put in 184.84.181.201.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu, only now the blank at option one is populated with the IP you just entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected to set IP\'s Randomly or have completed entering manual IPs.&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"> &nbsp;</li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 1 use randomly generated one/s.&nbsp; When you select this, the script will generate random domains during processing and it will move on to the next step.&nbsp; This will be covered after walking through the manual DNS option.<br></li>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 2 Manually create domain name/s.&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"d\" when complete.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected to have domain names created Randomly&nbsp; or have completed the manual domain name process.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\".<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dDwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom service tag go there, ex.&nbsp; /root/services/&lt;docker service tag&gt;/WWW.</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.  For this example, we\'ll leave it as the default of P1.\r\n\r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n\r\nThen it will ask for a geo-location for your IPs.  The NRTS has a list of IP Subnets stored in a Geo-location folder structure at /root/backbonerouters.  For this example, we\'ll set our geolocation to option 7 - France. \r\n\r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the script will move on to the next step.  We\'ll cover that after going over the manual IP process.\r\nSetting IP\'s - Option 2 Set IPs manually.  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page down then  press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, we\'ll select option 1 for the first blank spot.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n Then at the IP entry menu below we\'ll  put in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu, only now the blank at option one is populated with the IP you just entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to set IP\'s Randomly or have completed entering manual IPs.  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.                                           \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains -  Option 1 use randomly generated one/s.  When you select this, the script will generate random domains during processing and it will move on to the next step.  This will be covered after walking through the manual DNS option.\r\nAssigning Domains -  Option 2 Manually create domain name/s.  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"d\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have domain names created Randomly  or have completed the manual domain name process.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\".\r\n\r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.                                                                               \r\n\r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom service tag go there, ex.  /root/services/<docker service tag>/WWW.\r\n',1,'2023-04-04 19:24:08','2023-04-04 19:24:08','building-a-payload-host','using-the-nrts','version','','',4),(92,18,'Setting up a Phishing Attack','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The Phishing attack option doesn\'t build a docker container.&nbsp; Instead it sets up the NRTS host to perform the phishing attack.&nbsp; This step is just preparing the NRTS to mimic a domain for sending the phish.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; This will be shown after going over the set IPs manually process.</li>\r\n<li class=\"null\">Setting&nbsp; IPs - Option 2 Set IPs manually.&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30 &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our selected to get a randomly generated IP or set it manually.&nbsp; The next menu screen asks how we want to assign our Domain name.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domain names -&nbsp; Option 1 Use randomly generated one/s.&nbsp; This option will assign random domain names during processing and will move on to the next step.&nbsp; We\'ll cover that after going over the manual domain name option.<br></li>\r\n<li class=\"null\">Assigning Domain names - Option 2 Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have either selected to have a domain name generated randomly or we manually set a domain name.&nbsp; The script will then want a Tag for your DNS.&nbsp; This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.&nbsp; For this example, we\'ll use \"test-DNS\" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Below is a screenshot of the phish preparation build.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are phish.sh and spam.sh.&nbsp; Below is some information on what to modify in these scripts for your attack.<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modified for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/eUlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/xITimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; The only difference here is that you don\'t add the target email address in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The Phishing attack option doesn\'t build a docker container.  Instead it sets up the NRTS host to perform the phishing attack.  This step is just preparing the NRTS to mimic a domain for sending the phish.\r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"      \r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.         \r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.        \r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.          \r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  This will be shown after going over the set IPs manually process.\r\nSetting  IPs - Option 2 Set IPs manually.  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.  Enter \"s\" at the menu below to see a list of IP subnets.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30                                                                                                                                    \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our selected to get a randomly generated IP or set it manually.  The next menu screen asks how we want to assign our Domain name.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.                             \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domain names -  Option 1 Use randomly generated one/s.  This option will assign random domain names during processing and will move on to the next step.  We\'ll cover that after going over the manual domain name option.\r\nAssigning Domain names - Option 2 Manually create domain name/s.   Selecting this option will bring up  the following menu.  It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected to have a domain name generated randomly or we manually set a domain name.  The script will then want a Tag for your DNS.  This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.  For this example, we\'ll use \"test-DNS\"          \r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\n\r\nBelow is a screenshot of the phish preparation build.\r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are phish.sh and spam.sh.  Below is some information on what to modify in these scripts for your attack.\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modified for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.                          \r\n\r\n\r\nThen the last line in the script is the phish.  Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  The only difference here is that you don\'t add the target email address in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n',1,'2023-04-04 19:38:37','2023-04-04 19:38:37','setting-up-a-phishing-attack','using-the-nrts','version','','',4),(94,3,'Network Diagram Notes','<p id=\"bkmrk-si-router---this-is-\">SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\">ServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\">Grayspace - The SI-Router will router apprx 1500 IP subnets.&nbsp; These subnets are organized by geo-locations on the NRTS server.&nbsp; To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.</li>\r\n<li class=\"null\">AdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet</li>\r\n<li class=\"null\">RangeWAN - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\">ServiceNet - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\">RootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.</li>\r\n<li class=\"null\">Web-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">Redbook.com - This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\">dropbox.com - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.&nbsp; See the OPFOR section for some methods.</li>\r\n<li class=\"null\">pastebin.com - This is a haste bin server to simulated the real world pastebin.&nbsp; This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\">diagrams.net - This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signing binarys, see CA-Server details.</li>\r\n<li class=\"null\">Traffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.&nbsp; See Traffic-Gen details for more information on this.</li>\r\n<li class=\"null\">Traffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\">Grayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp;</p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\">AdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\">Adminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\">IA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to <a href=\"http://172.30.0.2:9999\">http://172.30.0.2:9999</a></li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\">RangeWAN - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details are explained in the target range planning section</p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will router apprx 1500 IP subnets.  These subnets are organized by geo-locations on the NRTS server.  To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nRedbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.  See the OPFOR section for some methods.\r\npastebin.com - This is a haste bin server to simulated the real world pastebin.  This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.\r\n\r\n\r\nCA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signing binarys, see CA-Server details.\r\nTraffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.  See Traffic-Gen details for more information on this.\r\nTraffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want. \r\n\r\nNRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details are explained in the target range planning section\r\n',1,'2023-04-04 20:30:23','2023-04-04 20:30:23','network-diagram-notes','network-overview','version','','',3),(95,2,'Network Diagram','<div drawio-diagram=\"15\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524770.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\">SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\">ServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\">Grayspace - The SI-Router will router apprx 1500 IP subnets.&nbsp; These subnets are organized by geo-locations on the NRTS server.&nbsp; To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.</li>\r\n<li class=\"null\">AdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet</li>\r\n<li class=\"null\">RangeWAN - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\">ServiceNet - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\">RootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.</li>\r\n<li class=\"null\">Web-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">Redbook.com - This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\">dropbox.com - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.&nbsp; See the OPFOR section for some methods.</li>\r\n<li class=\"null\">pastebin.com - This is a haste bin server to simulated the real world pastebin.&nbsp; This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\">diagrams.net - This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signing binarys, see CA-Server details.</li>\r\n<li class=\"null\">Traffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.&nbsp; See Traffic-Gen details for more information on this.</li>\r\n<li class=\"null\">Traffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\">Grayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp;</p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\">AdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\">Adminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\">IA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to <a href=\"http://172.30.0.2:9999\">http://172.30.0.2:9999</a></li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\">RangeWAN - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details are explained in the target range planning section</p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will router apprx 1500 IP subnets.  These subnets are organized by geo-locations on the NRTS server.  To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nRedbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.  See the OPFOR section for some methods.\r\npastebin.com - This is a haste bin server to simulated the real world pastebin.  This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.\r\n\r\n\r\nCA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signing binarys, see CA-Server details.\r\nTraffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.  See Traffic-Gen details for more information on this.\r\nTraffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want. \r\n\r\nNRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details are explained in the target range planning section\r\n',1,'2023-04-04 20:30:55','2023-04-04 20:30:55','network-diagram','network-overview','version','','',5),(97,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerdns-help.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerprocess.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></a></p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt',1,'2023-04-04 22:35:55','2023-04-04 22:35:55','manual-domain-registration','how-to-guides','version','','',10),(99,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerdns-help.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></a></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<a href=\"https://redbook.com/uploads/images/gallery/2023-03/registerprocess.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></a></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; ManageDNS.sh</p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> ManageDNS.sh',1,'2023-04-04 22:39:36','2023-04-04 22:39:36','manual-domain-registration','how-to-guides','version','','',11),(100,13,'Creating Cobalt Strike C2 Profiles (buildredteam.sh)','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So I would also advice testing this on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; I believe the max number of variants is 10, but I\'d advise setting this to 0.&nbsp; The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using Sourcepoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">Sourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.</li>\r\n<li class=\"null\">Sourepoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.</li>\r\n<li class=\"null\">Required Sourcepoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So I would also advice testing this on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  I believe the max number of variants is 10, but I\'d advise setting this to 0.  The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing Sourcepoint\r\n\r\nSourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\nSourepoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.\r\nRequired Sourcepoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-04 22:40:21','2023-04-04 22:40:21','creating-cobalt-strike-c2-profiles-buildredteamsh','using-the-nrts','version','','',4),(101,14,'Starting a Cobalt Strike Teamserver (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a cobalt strike profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.&nbsp; For instructions on how to create Cobalt Strike C2 profiles go to -&gt; Using the NRTS -&gt; Creating Cobalt Strike C2 Profiles.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want a randomly generated IP or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add a random IP during processing so the menu will move to the next step.&nbsp; This will be shown after going through the manual process.</li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;<a href=\"https://redbook.com/uploads/images/gallery/2023-04/c2Fimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.&nbsp; This will take you back to the previous menu.&nbsp; From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">At this point you have either selected to randomly set an IP or set one manually.&nbsp; Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile. &nbsp; &nbsp; &nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/b00image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of cobalt strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a cobalt strike teamserver.\r\nAlso this guide is assuming that you have already created a cobalt strike profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.  For instructions on how to create Cobalt Strike C2 profiles go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n\r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.                       \r\n\r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.              \r\n\r\n\r\nThen it will ask if you want a randomly generated IP or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add a random IP during processing so the menu will move to the next step.  This will be shown after going through the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.  \r\n\r\n\r\n\r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is long, use space bar to page down, and \"q\" to quit and get back to the screen where you will enter an IP.                                                                                                                \r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.  This will take you back to the previous menu.  From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet. \r\n\r\n\r\n\r\n\r\nAt this point you have either selected to randomly set an IP or set one manually.  Next, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.      \r\n\r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n\r\nBelow is what the build process looks like.\r\n\r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-04 22:40:39','2023-04-04 22:40:39','starting-a-cobalt-strike-teamserver-buildredteamsh','using-the-nrts','version','','',6),(102,15,'Making a HAProxy Redirector (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\" <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default name or add own own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default of RD1. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\">&nbsp; <br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going through the manual process.<br></li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp; Below is the menu when you select Set Ips manually.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.&nbsp; The blank menu items will store IPs as you add them in.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Use the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.&nbsp; You can pick IPs from any of these subnets, so for this example, well use 12.9.80.129/25.&nbsp; Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/Mc7image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot.&nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-then-enter-the-ip.\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Then enter the IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.&nbsp; You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. <a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for http, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirect should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/hXTimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This need to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.&nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp; <a href=\"https://redbook.com/uploads/images/gallery/2023-04/B4Aimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options. &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains - Option 1 - (use randomly generated one/s).&nbsp; If we select option 1, the script moves will add these during processing and move on to the next step.&nbsp; We\'ll cover that after going through the manual process.<br></li>\r\n<li class=\"null\">Assigning Domains - Option 2 - (Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list and&nbsp; it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu, but now you will see the domain you entered is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a Tag for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .&nbsp; You can validate if your redirector is running by looking at docker.&nbsp; Run docker ps and you should see RD1 up and running.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the cobalt strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a cobalt strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\" \r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.  You can keep the default name or add own own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default of RD1.                                                                                                                                  \r\n\r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n\r\nThen it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.  \r\n\r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes. \r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going through the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.  Below is the menu when you select Set Ips manually.  At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.  The blank menu items will store IPs as you add them in.                                                                                                       \r\n\r\n\r\n\r\n\r\n\r\n\r\nUse the \"s\" option to see available subnets.  This shows the available IP subnets based on the geo-location selections you made previously.  The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.  You can pick IPs from any of these subnets, so for this example, well use 12.9.80.129/25.  Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet.                                                                                                                           \r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter pressing \"q\" and back at the menu, we\'ll select 1 from the previous menu to put in an IP for the first IP slot. \r\n\r\n\r\n\r\n\r\n\r\n\r\nThen enter the IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.  You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS \r\n\r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirect to use port 8443 for https instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a return on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.                      \r\n\r\n\r\nNext it will ask about changing the bind port for http, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n\r\nNext it will ask what IP the redirect should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10.\r\n\r\n\r\nThen it will ask which Cobalt Strike profile to use.  This need to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.          \r\n\r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.          \r\n\r\n\r\n\r\n\r\nAssigning Domains - Option 1 - (use randomly generated one/s).  If we select option 1, the script moves will add these during processing and move on to the next step.  We\'ll cover that after going through the manual process.\r\nAssigning Domains - Option 2 - (Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list and  it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.  \r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu, but now you will see the domain you entered is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.           \r\n\r\n\r\n\r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of you\'re IPs, the next thing the script will ask for is a Tag for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\"\r\n\r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n\r\nBelow is a screenshot of the build process.\r\n\r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .  You can validate if your redirector is running by looking at docker.  Run docker ps and you should see RD1 up and running.\r\n',1,'2023-04-04 22:40:56','2023-04-04 22:40:56','making-a-haproxy-redirector-buildredteamsh','using-the-nrts','version','','',9),(103,16,'Making a NGINX Redirector (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">&nbsp;NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.<br></p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike or other team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a teamserver running at 54.88.220.10<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a NGINX redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default or set your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave the default of RD1.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CBYimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-asks-for-the\">\r\n<li class=\"null\">Next it asks for the number of IPs.&nbsp; For the example we\'ll use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ApVimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a geo-location base for your setting your IP\'s.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. &nbsp; For this example we\'ll use option 4 Canada.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/RStimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-narrows-it-d\">\r\n<li class=\"null\">Then it narrows it down by city, for this example we\'ll use Toronto.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/VBWimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP manually or randomly.&nbsp; This guide will walk through both options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Qhimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%281-set-r\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the Manual IP option.</li>\r\n<li class=\"null\">Setting IPs&nbsp; - Option 2 set IPs Manually.&nbsp; Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.&nbsp; This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out and get back to the previous menu.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X3Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-list-of-av\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.&nbsp; Press \"q\" then \"enter\" to exit the IP subnet view and back at the manual IP menu.&nbsp; For this example, we\'ll select 1 for the first blank space.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-brings-up-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This brings up the IP entry menu, for this example we\'ll use 72.3.244.20.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hdjimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-i-press-enter%2C-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jJGimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-i-have\">\r\n<li class=\"null\">At this point I have either selected to IPs randomly or manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.&nbsp;&nbsp; For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rocimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set the \"bind to\" a different port.&nbsp; The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.&nbsp; You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.&nbsp; For this example we will leave it at the default.&nbsp; The screenshoot shows it asks this for each port being redirected.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rtkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for the IP to redirect to.&nbsp; This should be your C2 server\'s IP.&nbsp; For this example we are using a teamserver running on 54.88.220.10.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dp2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-want-to\">\r\n<li class=\"null\">Next it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.&nbsp; This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.&nbsp; The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.&nbsp; This guide will walk through both Random and manually domain options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/LCiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-na\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domains - Option 1 (Use randomly generated one/s).&nbsp; When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.&nbsp; This will be shown after going over the Manual domain name option. &nbsp;&nbsp; <br></li>\r\n<li class=\"null\">Assigning domains - Option 2 (Manually create domain names/s).&nbsp; This will take you to the menu below.&nbsp; Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.&nbsp; For this example, we\'ll set option 1 (205.225.141.68)<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/nkAimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-show-the-m\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This will show the menu below where it asks for the domain name.&nbsp; Enter the domain you want to use for that IP and press enter.&nbsp; For this example, we\'ll use goatfarmer.com.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/J49image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-entered-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sbaimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either selected randomly generated domain names or completed adding domain names manual.&nbsp; Next the script will ask you to set a tag for your DNS.&nbsp; This is used to identify the domains later when you want to remove them.&nbsp; For this example, we\'ll use \"test-DNS\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xo4image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-now-the-script-has-a\">\r\n<li class=\"null\">Now the script has all the information it needs to build your NGINX redirector.&nbsp; Review the settings and if you are happy with it press enter to start the docker container build process. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ROCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-shows-the-buil\">\r\n<li class=\"null\">Below shows the build process, you should now have a NGINX redirector.&nbsp; You can get information about it from the /root/services/RD1 folder. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HDTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-to-check-that-your-c\">\r\n<li class=\"null\">To check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/4KAimage.png\" alt=\"image.png\"></a></p>',' NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.\r\nNOTE: This guide is assuming you already have a Cobalt Strike or other team server running.  \r\nFor this example, we\'ll assume we have a teamserver running at 54.88.220.10\r\n\r\nUse the following script to start a NGINX redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.  You can keep the default or set your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave the default of RD1.\r\n\r\n\r\nNext it asks for the number of IPs.  For the example we\'ll use 5.\r\n\r\n\r\nNext it will ask for a geo-location base for your setting your IP\'s.  The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.   For this example we\'ll use option 4 Canada.\r\n\r\n\r\nThen it narrows it down by city, for this example we\'ll use Toronto.\r\n\r\n\r\nNext, it will ask if you want to set IP manually or randomly.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the Manual IP option.\r\nSetting IPs  - Option 2 set IPs Manually.  Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.  At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.  This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out and get back to the previous menu.                                                                                                                                                 \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUsing the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.1/25 - but you can use multiple subnets from the list.  Press \"q\" then \"enter\" to exit the IP subnet view and back at the manual IP menu.  For this example, we\'ll select 1 for the first blank space.  \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis brings up the IP entry menu, for this example we\'ll use 72.3.244.20.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and now you see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point I have either selected to IPs randomly or manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.   For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.\r\n\r\n\r\nNext it will ask if you want to set a different port for the \"bind to\" this is related to a cobalt strike feature where you can have a listener set the \"bind to\" a different port.  The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.  You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.  For this example we will leave it at the default.  The screenshoot shows it asks this for each port being redirected.\r\n\r\n\r\nNext it will ask for the IP to redirect to.  This should be your C2 server\'s IP.  For this example we are using a teamserver running on 54.88.220.10.\r\n\r\n\r\nNext it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.  This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.  The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.  This guide will walk through both Random and manually domain options.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning domains - Option 1 (Use randomly generated one/s).  When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.  This will be shown after going over the Manual domain name option.    \r\nAssigning domains - Option 2 (Manually create domain names/s).  This will take you to the menu below.  Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.  For this example, we\'ll set option 1 (205.225.141.68)\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis will show the menu below where it asks for the domain name.  Enter the domain you want to use for that IP and press enter.  For this example, we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu, now you should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected randomly generated domain names or completed adding domain names manual.  Next the script will ask you to set a tag for your DNS.  This is used to identify the domains later when you want to remove them.  For this example, we\'ll use \"test-DNS\"\r\n\r\n\r\nNow the script has all the information it needs to build your NGINX redirector.  Review the settings and if you are happy with it press enter to start the docker container build process. \r\n\r\n\r\nBelow shows the build process, you should now have a NGINX redirector.  You can get information about it from the /root/services/RD1 folder.                     \r\n\r\n\r\nTo check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.\r\n\r\n',1,'2023-04-04 22:41:17','2023-04-04 22:41:17','making-a-nginx-redirector-buildredteamsh','using-the-nrts','version','','',4),(104,17,'Building a Payload Host (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.&nbsp; For this example, we\'ll leave it as the default of P1.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a geo-location for your IPs.&nbsp; The NRTS has a list of IP Subnets stored in a Geo-location folder structure at /root/backbonerouters.&nbsp; For this example, we\'ll set our geolocation to option 7 - France. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the script will move on to the next step.&nbsp; We\'ll cover that after going over the manual IP process.</li>\r\n<li class=\"null\">Setting IP\'s - Option 2 Set IPs manually.&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page down then&nbsp; press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, we\'ll select option 1 for the first blank spot.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-%C2%A0then-at-the-ip-entr\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">&nbsp;Then at the IP entry menu below we\'ll&nbsp; put in 184.84.181.201.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu, only now the blank at option one is populated with the IP you just entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected to set IP\'s Randomly or have completed entering manual IPs.&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"> &nbsp;</li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 1 use randomly generated one/s.&nbsp; When you select this, the script will generate random domains during processing and it will move on to the next step.&nbsp; This will be covered after walking through the manual DNS option.<br></li>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 2 Manually create domain name/s.&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"d\" when complete.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected to have domain names created Randomly&nbsp; or have completed the manual domain name process.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\".<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dDwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom service tag go there, ex.&nbsp; /root/services/&lt;docker service tag&gt;/WWW.</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\"\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.  For this example, we\'ll leave it as the default of P1.\r\n\r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n\r\nThen it will ask for a geo-location for your IPs.  The NRTS has a list of IP Subnets stored in a Geo-location folder structure at /root/backbonerouters.  For this example, we\'ll set our geolocation to option 7 - France. \r\n\r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the script will move on to the next step.  We\'ll cover that after going over the manual IP process.\r\nSetting IP\'s - Option 2 Set IPs manually.  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page down then  press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.180.1/22 to pick IPs from.  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, we\'ll select option 1 for the first blank spot.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n Then at the IP entry menu below we\'ll  put in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu, only now the blank at option one is populated with the IP you just entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to set IP\'s Randomly or have completed entering manual IPs.  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.                                           \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains -  Option 1 use randomly generated one/s.  When you select this, the script will generate random domains during processing and it will move on to the next step.  This will be covered after walking through the manual DNS option.\r\nAssigning Domains -  Option 2 Manually create domain name/s.  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"d\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have domain names created Randomly  or have completed the manual domain name process.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\".\r\n\r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.                                                                               \r\n\r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom service tag go there, ex.  /root/services/<docker service tag>/WWW.\r\n',1,'2023-04-04 22:41:36','2023-04-04 22:41:36','building-a-payload-host-buildredteamsh','using-the-nrts','version','','',5),(105,18,'Setting up a Phishing Attack (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The Phishing attack option doesn\'t build a docker container.&nbsp; Instead it sets up the NRTS host to perform the phishing attack.&nbsp; This step is just preparing the NRTS to mimic a domain for sending the phish.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; This will be shown after going over the set IPs manually process.</li>\r\n<li class=\"null\">Setting&nbsp; IPs - Option 2 Set IPs manually.&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30 &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our selected to get a randomly generated IP or set it manually.&nbsp; The next menu screen asks how we want to assign our Domain name.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domain names -&nbsp; Option 1 Use randomly generated one/s.&nbsp; This option will assign random domain names during processing and will move on to the next step.&nbsp; We\'ll cover that after going over the manual domain name option.<br></li>\r\n<li class=\"null\">Assigning Domain names - Option 2 Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have either selected to have a domain name generated randomly or we manually set a domain name.&nbsp; The script will then want a Tag for your DNS.&nbsp; This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.&nbsp; For this example, we\'ll use \"test-DNS\" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Below is a screenshot of the phish preparation build.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are phish.sh and spam.sh.&nbsp; Below is some information on what to modify in these scripts for your attack.<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modified for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/eUlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/xITimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; The only difference here is that you don\'t add the target email address in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The Phishing attack option doesn\'t build a docker container.  Instead it sets up the NRTS host to perform the phishing attack.  This step is just preparing the NRTS to mimic a domain for sending the phish.\r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"      \r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.         \r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.        \r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.          \r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  This will be shown after going over the set IPs manually process.\r\nSetting  IPs - Option 2 Set IPs manually.  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.  Enter \"s\" at the menu below to see a list of IP subnets.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30                                                                                                                                    \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our selected to get a randomly generated IP or set it manually.  The next menu screen asks how we want to assign our Domain name.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.                             \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domain names -  Option 1 Use randomly generated one/s.  This option will assign random domain names during processing and will move on to the next step.  We\'ll cover that after going over the manual domain name option.\r\nAssigning Domain names - Option 2 Manually create domain name/s.   Selecting this option will bring up  the following menu.  It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected to have a domain name generated randomly or we manually set a domain name.  The script will then want a Tag for your DNS.  This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.  For this example, we\'ll use \"test-DNS\"          \r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\n\r\nBelow is a screenshot of the phish preparation build.\r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are phish.sh and spam.sh.  Below is some information on what to modify in these scripts for your attack.\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modified for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.                          \r\n\r\n\r\nThen the last line in the script is the phish.  Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  The only difference here is that you don\'t add the target email address in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n',1,'2023-04-04 22:41:53','2023-04-04 22:41:53','setting-up-a-phishing-attack-buildredteamsh','using-the-nrts','version','','',5),(106,19,'Managing Services (buildredteam.sh)','<p id=\"bkmrk-then-nrts-builds-red\">Then NRTS builds red team infrastructure in docker containers.&nbsp; These containers and services can be managed using the /root/scripts/buildredteam.sh.&nbsp; NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks.&nbsp;</p>\r\n<ul id=\"bkmrk-to-view%2C-restart-or-\">\r\n<li class=\"null\">To View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b0Yimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Then select option 6 - Container management.&nbsp; From this menu you can view, delete or start a saved container.&nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/HCCimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HCCimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>','Then NRTS builds red team infrastructure in docker containers.  These containers and services can be managed using the /root/scripts/buildredteam.sh.  NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks. \r\n\r\nTo View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.                                                                                                                                                            \r\nThen select option 6 - Container management.  From this menu you can view, delete or start a saved container. \r\n\r\n\r\n',1,'2023-04-04 22:42:09','2023-04-04 22:42:09','managing-services-buildredteamsh','using-the-nrts','version','','',2),(108,19,'Managing Services (buildredteam.sh)','<p id=\"bkmrk-then-nrts-builds-red\">Then NRTS builds red team infrastructure in docker containers.&nbsp; These containers and services can be managed using the /root/scripts/buildredteam.sh.&nbsp; NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks.&nbsp;</p>\r\n<ul id=\"bkmrk-to-view%2C-restart-or-\">\r\n<li class=\"null\">To View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b0Yimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Then select option 6 - Container management.&nbsp; From this menu you can view, delete, start or stop a saved container.&nbsp;\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Kb5image.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">The <strong>View Container Menu </strong>will show you the status of the various service containers.&nbsp; Below is and example.&nbsp; NOTE: This view will show if the container is currently running or stopped.&nbsp; You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.&nbsp; This is because the phish set up doesn\'t create a docker container.&nbsp; Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.&nbsp; For more on phishing attacks goto -&gt; Using the NRTS -&gt; Setting up Phishing attacks\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/llJimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">From the View Menu, you can select a service to see more information about it.&nbsp; It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n<ul id=\"bkmrk-%C2%A0payload-host-servic\">\r\n<li class=\"null\">&nbsp;payload host service (P1)\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/tHEimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">phish set up (phish)\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/wRNimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">redirector (RD1)\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/s1Nimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Cobalt strike teamserver (TS1)\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oIPimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The <strong>Delete Container Menu</strong> option shows the following.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/roTimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-from-the-delete-menu\">\r\n<li class=\"null\">From the delete menu you can select a service to delete whether it is running or not.&nbsp; This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/&lt;servicetag&gt; directory.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The&nbsp;<strong>Start Container menu</strong> option allows you to start a stopped container.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HB3image.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">The&nbsp;<strong>Stop Container menu&nbsp;</strong>option allows you to stop a running container.&nbsp; This will just kill and remove the container, it can be restarted later with no lose in functionality.\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/gLFimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gLFimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','Then NRTS builds red team infrastructure in docker containers.  These containers and services can be managed using the /root/scripts/buildredteam.sh.  NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks. \r\n\r\nTo View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.                                                                                                                                                            \r\nThen select option 6 - Container management.  From this menu you can view, delete, start or stop a saved container. \r\n\r\n\r\nThe View Container Menu will show you the status of the various service containers.  Below is and example.  NOTE: This view will show if the container is currently running or stopped.  You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.  This is because the phish set up doesn\'t create a docker container.  Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.  For more on phishing attacks goto -> Using the NRTS -> Setting up Phishing attacks\r\n\r\n\r\nFrom the View Menu, you can select a service to see more information about it.  It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n\r\n payload host service (P1)\r\n\r\n\r\nphish set up (phish)\r\n\r\n\r\nredirector (RD1)\r\n\r\n\r\nCobalt strike teamserver (TS1)\r\n\r\n\r\n\r\n\r\nThe Delete Container Menu option shows the following.\r\n\r\n\r\nFrom the delete menu you can select a service to delete whether it is running or not.  This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/<servicetag> directory.  \r\n\r\n\r\nThe Start Container menu option allows you to start a stopped container.\r\n\r\n\r\nThe Stop Container menu option allows you to stop a running container.  This will just kill and remove the container, it can be restarted later with no lose in functionality.\r\n\r\n\r\n\r\n ',1,'2023-04-05 00:01:57','2023-04-05 00:01:57','managing-services-buildredteamsh','using-the-nrts','version','','',3),(109,13,'Creating Cobalt Strike C2 Profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So I would also advice testing this on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; I believe the max number of variants is 10, but I\'d advise setting this to 0.&nbsp; The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using Sourcepoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">Sourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.</li>\r\n<li class=\"null\">Sourepoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.</li>\r\n<li class=\"null\">Required Sourcepoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues I\'ve seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So I would also advice testing this on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  I believe the max number of variants is 10, but I\'d advise setting this to 0.  The script will test it\'s profile against Cobalt Strikes c2lint script and the more variants you provide the great the chance that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing Sourcepoint\r\n\r\nSourcepoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\nSourepoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./Sourcepoint -h.\r\nRequired Sourcepoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-05 00:04:22','2023-04-05 00:04:22','creating-cobalt-strike-c2-profiles','using-the-nrts','version','','',5),(110,20,'Managing DNS','<p id=\"bkmrk-the-cyber-range-is-d\">The Cyber range is designed for Red Team domain name registration via the NRTS server.&nbsp; The various service scripts interact with the RootDNS server to create and register domains.&nbsp; To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.&nbsp; To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.&nbsp; Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.&nbsp; The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh</p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','The Cyber range is designed for Red Team domain name registration via the NRTS server.  The various service scripts interact with the RootDNS server to create and register domains.  To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.  To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.  Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.  The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh\r\n ',1,'2023-04-05 00:09:09','2023-04-05 00:09:09','managing-dns','using-the-nrts','version','','Initial publish',1),(112,20,'Managing DNS','<p id=\"bkmrk-the-cyber-range-is-d\">The Cyber range is designed for Red Team domain name registration via the NRTS server.&nbsp; The various service scripts interact with the RootDNS server to create and register domains.&nbsp; To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.&nbsp; To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.&nbsp; Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.&nbsp; The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh</p>\r\n<ul id=\"bkmrk-launch-the-script-fr\">\r\n<li class=\"null\">Launch the script from the NRTS server</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fm\"><code class=\"language-bash\">cd /root/scripts\r\n./ManageDNS.sh</code></pre>\r\n<ul id=\"bkmrk-this-will-bring-up-t\">\r\n<li class=\"null\">This will bring up the text based menu below.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X9Ximage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Option 1 - View DNS records, will bring up a list of Tags, as shown below\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HfLimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">From the View menu you can pick an option to see the domains that have been registered for the selected tag.&nbsp; For example, below is option 2 for \"OPFOR-chip-test\".</li>\r\n</ul>','The Cyber range is designed for Red Team domain name registration via the NRTS server.  The various service scripts interact with the RootDNS server to create and register domains.  To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.  To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.  Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.  The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh\r\n\r\nLaunch the script from the NRTS server\r\n\r\ncd /root/scripts\r\n./ManageDNS.sh\r\n\r\nThis will bring up the text based menu below.\r\nOption 1 - View DNS records, will bring up a list of Tags, as shown below\r\n\r\n\r\nFrom the View menu you can pick an option to see the domains that have been registered for the selected tag.  For example, below is option 2 for \"OPFOR-chip-test\".\r\n',1,'2023-04-05 00:16:02','2023-04-05 00:16:02','managing-dns','using-the-nrts','version','','',2),(114,20,'Managing DNS (ManageDNS.sh)','<p id=\"bkmrk-the-cyber-range-is-d\">The Cyber range is designed for Red Team domain name registration via the NRTS server.&nbsp; The various service scripts interact with the RootDNS server to create and register domains.&nbsp; To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.&nbsp; To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.&nbsp; Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.&nbsp; The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh</p>\r\n<ul id=\"bkmrk-launch-the-script-fr\">\r\n<li class=\"null\">Launch the script from the NRTS server</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fm\"><code class=\"language-bash\">cd /root/scripts\r\n./ManageDNS.sh</code></pre>\r\n<ul id=\"bkmrk-this-will-bring-up-t\">\r\n<li class=\"null\">This will bring up the text based menu below.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X9Ximage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Option 1 - View DNS records, will bring up a list of Tags, as shown below\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HfLimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">From the View menu you can pick an option to see the domains that have been registered for the selected tag.&nbsp; For example, below is option 2 for \"OPFOR-chip-test\".\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/NWzimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Option 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/buTimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">When you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.&nbsp; If a user selects delete all it adds a 30 second delay for the same reason.&nbsp; Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/TFUimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Here is what it shows when you enter y to continue.\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8awimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8awimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>','The Cyber range is designed for Red Team domain name registration via the NRTS server.  The various service scripts interact with the RootDNS server to create and register domains.  To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.  To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.  Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.  The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh\r\n\r\nLaunch the script from the NRTS server\r\n\r\ncd /root/scripts\r\n./ManageDNS.sh\r\n\r\nThis will bring up the text based menu below.\r\nOption 1 - View DNS records, will bring up a list of Tags, as shown below\r\n\r\n\r\nFrom the View menu you can pick an option to see the domains that have been registered for the selected tag.  For example, below is option 2 for \"OPFOR-chip-test\".\r\n\r\n\r\nOption 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n\r\n\r\nWhen you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.  If a user selects delete all it adds a 30 second delay for the same reason.  Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n\r\n\r\nHere is what it shows when you enter y to continue.\r\n\r\n\r\n',1,'2023-04-05 00:35:13','2023-04-05 00:35:13','managing-dns-managednssh','using-the-nrts','version','','',3),(115,18,'Phishing Attack (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The Phishing attack option doesn\'t build a docker container.&nbsp; Instead it sets up the NRTS host to perform the phishing attack.&nbsp; This step is just preparing the NRTS to mimic a domain for sending the phish.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"&nbsp; &nbsp; &nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.<a href=\"https://redbook.com/uploads/images/gallery/2023-04/pOSimage.png\" target=\"_blank\" rel=\"noopener\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; This will be shown after going over the set IPs manually process.</li>\r\n<li class=\"null\">Setting&nbsp; IPs - Option 2 Set IPs manually.&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30 &nbsp;&nbsp;&nbsp;&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our selected to get a randomly generated IP or set it manually.&nbsp; The next menu screen asks how we want to assign our Domain name.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domain names -&nbsp; Option 1 Use randomly generated one/s.&nbsp; This option will assign random domain names during processing and will move on to the next step.&nbsp; We\'ll cover that after going over the manual domain name option.<br></li>\r\n<li class=\"null\">Assigning Domain names - Option 2 Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have either selected to have a domain name generated randomly or we manually set a domain name.&nbsp; The script will then want a Tag for your DNS.&nbsp; This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.&nbsp; For this example, we\'ll use \"test-DNS\" &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.<br>\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Below is a screenshot of the phish preparation build.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are phish.sh and spam.sh.&nbsp; Below is some information on what to modify in these scripts for your attack.<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modified for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/eUlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/xITimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></a></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; The only difference here is that you don\'t add the target email address in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The Phishing attack option doesn\'t build a docker container.  Instead it sets up the NRTS host to perform the phishing attack.  This step is just preparing the NRTS to mimic a domain for sending the phish.\r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\"      \r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.         \r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.        \r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.          \r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  This will be shown after going over the set IPs manually process.\r\nSetting  IPs - Option 2 Set IPs manually.  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.  Enter \"s\" at the menu below to see a list of IP subnets.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30                                                                                                                                    \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.                      \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our selected to get a randomly generated IP or set it manually.  The next menu screen asks how we want to assign our Domain name.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.                             \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domain names -  Option 1 Use randomly generated one/s.  This option will assign random domain names during processing and will move on to the next step.  We\'ll cover that after going over the manual domain name option.\r\nAssigning Domain names - Option 2 Manually create domain name/s.   Selecting this option will bring up  the following menu.  It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com. \r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected to have a domain name generated randomly or we manually set a domain name.  The script will then want a Tag for your DNS.  This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.  For this example, we\'ll use \"test-DNS\"          \r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\n\r\nBelow is a screenshot of the phish preparation build.\r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are phish.sh and spam.sh.  Below is some information on what to modify in these scripts for your attack.\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modified for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.                          \r\n\r\n\r\nThen the last line in the script is the phish.  Place your subject in, edit /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  The only difference here is that you don\'t add the target email address in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n',1,'2023-04-05 00:35:38','2023-04-05 00:35:38','phishing-attack-buildredteamsh','using-the-nrts','version','','',6),(117,20,'Managing DNS (ManageDNS.sh)','<p id=\"bkmrk-the-cyber-range-is-d\">The Cyber range is designed for Red Team domain name registration via the NRTS server.&nbsp; The various service scripts interact with the RootDNS server to create and register domains.&nbsp; To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.&nbsp; To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.&nbsp; Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.&nbsp; The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh</p>\r\n<p id=\"bkmrk-note%3A-if-you-want-to\">NOTE: if you want to register DNS outside of the automation built into the buildredteam.sh, there is another script on the NRTS called RegisterDNS.sh.&nbsp; For usage of this go to -&gt; How to guides -&gt; Manual Domain Registration.</p>\r\n<ul id=\"bkmrk-launch-the-script-fr\">\r\n<li class=\"null\">Launch the script from the NRTS server</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fm\"><code class=\"language-bash\">cd /root/scripts\r\n./ManageDNS.sh</code></pre>\r\n<ul id=\"bkmrk-this-will-bring-up-t\">\r\n<li class=\"null\">This will bring up the text based menu below.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X9Ximage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Option 1 - View DNS records, will bring up a list of Tags, as shown below\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HfLimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">From the View menu you can pick an option to see the domains that have been registered for the selected tag.&nbsp; For example, below is option 2 for \"OPFOR-chip-test\".\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/NWzimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Option 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/buTimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">When you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.&nbsp; If a user selects delete all it adds a 30 second delay for the same reason.&nbsp; Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/TFUimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Here is what it shows when you enter y to continue.\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8awimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8awimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>','The Cyber range is designed for Red Team domain name registration via the NRTS server.  The various service scripts interact with the RootDNS server to create and register domains.  To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.  To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.  Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.  The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh\r\nNOTE: if you want to register DNS outside of the automation built into the buildredteam.sh, there is another script on the NRTS called RegisterDNS.sh.  For usage of this go to -> How to guides -> Manual Domain Registration.\r\n\r\nLaunch the script from the NRTS server\r\n\r\ncd /root/scripts\r\n./ManageDNS.sh\r\n\r\nThis will bring up the text based menu below.\r\nOption 1 - View DNS records, will bring up a list of Tags, as shown below\r\n\r\n\r\nFrom the View menu you can pick an option to see the domains that have been registered for the selected tag.  For example, below is option 2 for \"OPFOR-chip-test\".\r\n\r\n\r\nOption 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n\r\n\r\nWhen you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.  If a user selects delete all it adds a 30 second delay for the same reason.  Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n\r\n\r\nHere is what it shows when you enter y to continue.\r\n\r\n\r\n',1,'2023-04-05 00:38:36','2023-04-05 00:38:36','managing-dns-managednssh','using-the-nrts','version','','',4),(118,21,'Reverting the NRTS','<p id=\"bkmrk-if-you-want-to-wipe-\">If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.&nbsp; It\'s located on the NRTS at /root/scripts/revert.sh</p>\r\n<p id=\"bkmrk-below-is-usage\">below is usage</p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fr\"><code class=\"language-bash\">cd /root/scripts\r\n./revert.sh</code></pre>\r\n<ul id=\"bkmrk-when-you-run-this%2C-i\">\r\n<li class=\"null\">When you run this, it will make sure you want to by making you confirm.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Awbimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n</ul>','If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.  It\'s located on the NRTS at /root/scripts/revert.sh\r\nbelow is usage\r\ncd /root/scripts\r\n./revert.sh\r\n\r\nWhen you run this, it will make sure you want to by making you confirm.\r\n\r\n\r\n',1,'2023-04-05 00:42:15','2023-04-05 00:42:15','reverting-the-nrts','using-the-nrts','version','','Initial publish',1),(119,22,'Cred list','','',1,'2023-04-05 00:47:39','2023-04-05 00:47:39','cred-list','default-creds-for-all-the-things','version','','Initial publish',1),(121,22,'Cred list','<table style=\"border-collapse: collapse; width: 100%;\" border=\"1\" id=\"bkmrk-system-username-pass\"><colgroup><col style=\"width: 33.3745%;\"><col style=\"width: 33.3745%;\"><col style=\"width: 33.3745%;\"></colgroup>\r\n<tbody>\r\n<tr>\r\n<td>System<br></td>\r\n<td>Username<br></td>\r\n<td>Password<br></td>\r\n</tr>\r\n<tr>\r\n<td>IA-Proxy<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>CA-Server<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>rootDNS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>web-services<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-Gen<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-WebHost<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>NRTS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Adminnet-DHCP<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>SI-router<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>redbook.com web GUI (bookstack)<br></td>\r\n<td>admin@admin.com<br></td>\r\n<td>toortoor</td>\r\n</tr>\r\n<tr>\r\n<td>dropbox.com web GUI (owncloud)<br></td>\r\n<td>admin<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n</tbody>\r\n</table>','\r\n\r\n\r\nSystem\r\nUsername\r\nPassword\r\n\r\n\r\nIA-Proxy\r\nuser & root\r\ntoor\r\n\r\n\r\nCA-Server\r\nuser & root\r\ntoor\r\n\r\n\r\nrootDNS\r\nuser & root\r\ntoor\r\n\r\n\r\nweb-services\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-Gen\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-WebHost\r\nuser & root\r\ntoor\r\n\r\n\r\nNRTS\r\nuser & root\r\ntoor\r\n\r\n\r\nAdminnet-DHCP\r\nvyos\r\ntoor\r\n\r\n\r\nSI-router\r\nvyos\r\ntoor\r\n\r\n\r\nredbook.com web GUI (bookstack)\r\nadmin@admin.com\r\ntoortoor\r\n\r\n\r\ndropbox.com web GUI (owncloud)\r\nadmin\r\ntoor\r\n\r\n\r\n',1,'2023-04-05 00:58:07','2023-04-05 00:58:07','cred-list','default-creds-for-all-the-things','version','','',2),(122,22,'Cred list','<table id=\"bkmrk-system-username-pass\" style=\"border-collapse: collapse; width: 100%;\" border=\"1\"><colgroup><col style=\"width: 33.3745%;\"><col style=\"width: 33.3745%;\"><col style=\"width: 33.3745%;\"></colgroup>\r\n<tbody>\r\n<tr>\r\n<td><strong>System</strong><br></td>\r\n<td><strong>Username</strong><br></td>\r\n<td><strong>Password</strong><br></td>\r\n</tr>\r\n<tr>\r\n<td>IA-Proxy<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>CA-Server<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>rootDNS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>web-services<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-Gen<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-WebHost<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>NRTS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Adminnet-DHCP<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>SI-router<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>redbook.com web GUI (bookstack)<br></td>\r\n<td>admin@admin.com<br></td>\r\n<td>toortoor</td>\r\n</tr>\r\n<tr>\r\n<td>dropbox.com web GUI (owncloud)<br></td>\r\n<td>admin<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n</tbody>\r\n</table>','\r\n\r\n\r\nSystem\r\nUsername\r\nPassword\r\n\r\n\r\nIA-Proxy\r\nuser & root\r\ntoor\r\n\r\n\r\nCA-Server\r\nuser & root\r\ntoor\r\n\r\n\r\nrootDNS\r\nuser & root\r\ntoor\r\n\r\n\r\nweb-services\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-Gen\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-WebHost\r\nuser & root\r\ntoor\r\n\r\n\r\nNRTS\r\nuser & root\r\ntoor\r\n\r\n\r\nAdminnet-DHCP\r\nvyos\r\ntoor\r\n\r\n\r\nSI-router\r\nvyos\r\ntoor\r\n\r\n\r\nredbook.com web GUI (bookstack)\r\nadmin@admin.com\r\ntoortoor\r\n\r\n\r\ndropbox.com web GUI (owncloud)\r\nadmin\r\ntoor\r\n\r\n\r\n',1,'2023-04-05 00:58:39','2023-04-05 00:58:39','cred-list','default-creds-for-all-the-things','version','','',3),(124,22,'Cred list','<table id=\"bkmrk-system-username-pass\" style=\"border-collapse: collapse; width: 61.2346%;\" border=\"1\"><colgroup><col style=\"width: 47.0516%;\"><col style=\"width: 29.5141%;\"><col style=\"width: 23.4343%;\"></colgroup>\r\n<tbody>\r\n<tr>\r\n<td><strong>System</strong><br></td>\r\n<td><strong>Username</strong><br></td>\r\n<td><strong>Password</strong><br></td>\r\n</tr>\r\n<tr>\r\n<td>IA-Proxy<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>CA-Server<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td class=\"align-left\">rootDNS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>web-services<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-Gen<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-WebHost<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>NRTS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Adminnet-DHCP<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>SI-router<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>redbook.com web GUI (bookstack)<br></td>\r\n<td>admin@admin.com<br></td>\r\n<td>toortoor</td>\r\n</tr>\r\n<tr>\r\n<td>dropbox.com web GUI (owncloud)<br></td>\r\n<td>admin<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n</tbody>\r\n</table>','\r\n\r\n\r\nSystem\r\nUsername\r\nPassword\r\n\r\n\r\nIA-Proxy\r\nuser & root\r\ntoor\r\n\r\n\r\nCA-Server\r\nuser & root\r\ntoor\r\n\r\n\r\nrootDNS\r\nuser & root\r\ntoor\r\n\r\n\r\nweb-services\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-Gen\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-WebHost\r\nuser & root\r\ntoor\r\n\r\n\r\nNRTS\r\nuser & root\r\ntoor\r\n\r\n\r\nAdminnet-DHCP\r\nvyos\r\ntoor\r\n\r\n\r\nSI-router\r\nvyos\r\ntoor\r\n\r\n\r\nredbook.com web GUI (bookstack)\r\nadmin@admin.com\r\ntoortoor\r\n\r\n\r\ndropbox.com web GUI (owncloud)\r\nadmin\r\ntoor\r\n\r\n\r\n',1,'2023-04-05 00:59:29','2023-04-05 00:59:29','cred-list','default-creds-for-all-the-things','version','','',4),(126,2,'Network Diagram','<div drawio-diagram=\"15\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1680524770.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span> - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span> - The SI-Router will route approx 1500 IP subnets.&nbsp; These subnets are organized by Geo-locations on the NRTS server.&nbsp; To see a list of available subnets and corresponding Geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various red team infrastructure services.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span> - This is used as a network to allow all Cyber Range VMs access to the real internet using a squid proxy on the IA-Proxy server.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span> - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServiceNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration to to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an&nbsp; openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; How to Guides -&gt; Importing CA certificates in a target domain.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; How to Guides - Target Domain Planning and Connection.<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will route approx 1500 IP subnets.  These subnets are organized by Geo-locations on the NRTS server.  To see a list of available subnets and corresponding Geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various red team infrastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet using a squid proxy on the IA-Proxy server.\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration to to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an  openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> How to Guides -> Importing CA certificates in a target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> How to Guides - Target Domain Planning and Connection.\r\n',1,'2023-04-05 17:35:26','2023-04-05 17:35:26','network-diagram','network-overview','version','','',6),(128,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - simulated Googles recursive DNS server</li>\r\n<li class=\"null\">198.41.0.4 - simulates the real world A-root server</li>\r\n<li class=\"null\">192.228.79.59 - simulates the real world B-root server</li>\r\n<li class=\"null\">192.33.4.12- simulates the real world C-root server</li>\r\n<li class=\"null\">128.8.10.90- simulates the real world D-root server</li>\r\n<li class=\"null\">192.203.230.10- simulates the real world E-root server</li>\r\n<li class=\"null\">195.5.5.241- simulates the real world F-root server</li>\r\n<li class=\"null\">192.112.36.4- simulates the real world G-root server</li>\r\n<li class=\"null\">128.63.2.53- simulates the real world H-root server</li>\r\n<li class=\"null\">192.36.148.17- simulates the real world I-root server</li>\r\n<li class=\"null\">192.58.128.30- simulates the real world J-root server</li>\r\n<li class=\"null\">193.0.15.129- simulates the real world K-root server</li>\r\n<li class=\"null\">199.7.83.42- simulates the real world L-root server</li>\r\n<li class=\"null\">202.12.27.33- simulates the real world M-root server</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server in the Cyber Range handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creats a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE:&nbsp; For more information on using the scripts referenced above that reside on the NRTS; /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a><br></li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check you modification of the named.conf.RANGE file.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - simulated Googles recursive DNS server\r\n198.41.0.4 - simulates the real world A-root server\r\n192.228.79.59 - simulates the real world B-root server\r\n192.33.4.12- simulates the real world C-root server\r\n128.8.10.90- simulates the real world D-root server\r\n192.203.230.10- simulates the real world E-root server\r\n195.5.5.241- simulates the real world F-root server\r\n192.112.36.4- simulates the real world G-root server\r\n128.63.2.53- simulates the real world H-root server\r\n192.36.148.17- simulates the real world I-root server\r\n192.58.128.30- simulates the real world J-root server\r\n193.0.15.129- simulates the real world K-root server\r\n199.7.83.42- simulates the real world L-root server\r\n202.12.27.33- simulates the real world M-root server\r\n\r\nThe RootDNS server in the Cyber Range handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen systems.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a dns file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the dns file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creats a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE:  For more information on using the scripts referenced above that reside on the NRTS; /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh, go to -> Using the NRTS \r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check you modification of the named.conf.RANGE file.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\n\r\n\r\n',1,'2023-04-05 17:54:02','2023-04-05 17:54:02','rootdns','cyber-range-systems-overview','version','','',4),(130,5,'Web-Services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documenation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">These directories contain config files need for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n<li class=\"null\">docker cp bookstack:/app/www/public/uploads/images .<br></li>\r\n<li class=\"null\">tar -czxf redbook-files-backup.tar.gz images</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n<li class=\"null\">tar -xvzf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp images bookstack:/app/www/public/uploads/</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documenation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nThese directories contain config files need for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\ndocker cp bookstack:/app/www/public/uploads/images .\r\ntar -czxf redbook-files-backup.tar.gz images\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\ntar -xvzf redbook-files-backup.tar.gz\r\ndocker cp images bookstack:/app/www/public/uploads/\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',1,'2023-04-05 18:00:46','2023-04-05 18:00:46','web-services','cyber-range-systems-overview','version','','',2),(132,6,'CA-Server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using the domain of globalcerts.com.&nbsp; To create new SSL certs or to sign binaries, you can use scripts that exist on this server.&nbsp; The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.&nbsp; For more information on this go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a>.&nbsp; That said, if you want to generate these manually, below is an overview of scripts on the CA-server.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs.&nbsp; The script has a help menu that is pretty self explanatory.&nbsp; below is the help menu that lists the various flags.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-required-flags%C2%A0-%C2%A0-%C2%A0-\" style=\"padding-left: 40px;\">REQUIRED Flags<br>&nbsp; &nbsp; &nbsp; &nbsp; -d or --domain FQDN, &nbsp;ex. -d www.example.com<br>OPTIONAL Flags - random values will be used if not set<br>&nbsp; &nbsp; &nbsp; &nbsp; -r or --random, this will randomize Country, City, State, and organization info<br>&nbsp; &nbsp; &nbsp; &nbsp; -q or --quiet, will built the certs without showing settings and asking for confirmation<br>&nbsp; &nbsp; &nbsp; &nbsp; -C or --country 2LetterAbbrv, ex. -C US<br>&nbsp; &nbsp; &nbsp; &nbsp; -ST or --state &nbsp;State, ex -ST \'New York\' NOTE: single quotes need if spaces<br>&nbsp; &nbsp; &nbsp; &nbsp; -L or --locality, ex -L \'New York City\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -O or --organization, ex -O \'example LTD\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -CN or --commonname, ex -CN \'www.example.com\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -A or --alias, ex -A \'example-server\'<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS1 or --SAN1 &nbsp;Subject Alt Name 1<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS2 or --SAN2 &nbsp;Subject Alt Name 2<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS3 or --SAN3 &nbsp;Subject Alt Name 3<br>&nbsp; &nbsp; &nbsp; &nbsp; -DNS4 or --SAN4 &nbsp;Subject Alt Name 4<br></p>\r\n<ul id=\"bkmrk-below-is-an-example-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is an example for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using the domain of globalcerts.com.  To create new SSL certs or to sign binaries, you can use scripts that exist on this server.  The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.  For more information on this go to -> Cyber Range Systems Overview -> NRTS.  That said, if you want to generate these manually, below is an overview of scripts on the CA-server.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs.  The script has a help menu that is pretty self explanatory.  below is the help menu that lists the various flags.\r\n\r\n\r\n\r\nREQUIRED Flags        -d or --domain FQDN,  ex. -d www.example.comOPTIONAL Flags - random values will be used if not set        -r or --random, this will randomize Country, City, State, and organization info        -q or --quiet, will built the certs without showing settings and asking for confirmation        -C or --country 2LetterAbbrv, ex. -C US        -ST or --state  State, ex -ST \'New York\' NOTE: single quotes need if spaces        -L or --locality, ex -L \'New York City\'        -O or --organization, ex -O \'example LTD\'        -CN or --commonname, ex -CN \'www.example.com\'        -A or --alias, ex -A \'example-server\'        -DNS1 or --SAN1  Subject Alt Name 1        -DNS2 or --SAN2  Subject Alt Name 2        -DNS3 or --SAN3  Subject Alt Name 3        -DNS4 or --SAN4  Subject Alt Name 4\r\n\r\n\r\n\r\nBelow is an example for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n',1,'2023-04-05 18:07:23','2023-04-05 18:07:23','ca-server','cyber-range-systems-overview','version','','',4),(134,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email context was pulled using the Enron data dump.&nbsp; About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into databases.&nbsp; It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.&nbsp; The functionality of this is very customization.&nbsp; Here is an overview of how this server is used to generate email traffic.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/stoptrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the build-compose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from publicly available databases of the Enron data mentioned earlier.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain that you connect to the Cyber Range.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.&nbsp; Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email context was pulled using the Enron data dump.  About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into databases.  It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.  The functionality of this is very customization.  Here is an overview of how this server is used to generate email traffic.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/stoptrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the build-compose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from publicly available databases of the Enron data mentioned earlier.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain that you connect to the Cyber Range.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.  Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.  Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',1,'2023-04-05 19:11:37','2023-04-05 19:11:37','traffic-gen','cyber-range-systems-overview','version','','',4),(136,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The not red team server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; In testing the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.&nbsp; There is a lot going on in this VM, below is a description of the folder structure, for more details on how to use this VM, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a>.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.&nbsp; Its structure by Geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.&nbsp; &nbsp;This folder structure is used by other scripts on the NRTS to generator IP addresses.&nbsp; NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul id=\"bkmrk-this-is-another-tool\">\r\n<li class=\"null\">This is another tool for generating Cobalt&nbsp;Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.&nbsp; NOTE: don\'t launch cobalt strike teamservers directly from this fold, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your cobalt strike profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildredteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.&nbsp; The script can also be used to set up the NRTS for phishing attacks.&nbsp; Go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a>for guides on how to set up all of these services.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage DNS records that get added to the rootDNS server.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS </a>for a guide on how use this script.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new DNS records that will get added to the rootDNS server.&nbsp; Go to -&gt; How to guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/manual-domain-registration\">Manual Domain Registration</a> for instructions on this script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/phishing-attack-buildredteamsh\">Phishing Attack</a> for instructions on the scripts below.<br></li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The not red team server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, cobalt strike teamserver, payload host, or multiple of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems significantly.  There is a lot going on in this VM, below is a description of the folder structure, for more details on how to use this VM, go to -> Using the NRTS.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structure by Geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch cobalt strike teamservers directly from this fold, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your cobalt strike profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildredteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -> Using the NRTS for guides on how to set up all of these services.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage DNS records that get added to the rootDNS server.  Go to -> Using the NRTS -> Managing DNS for a guide on how use this script.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new DNS records that will get added to the rootDNS server.  Go to -> How to guides -> Manual Domain Registration for instructions on this script.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.  Go to -> Using the NRTS -> Phishing Attack for instructions on the scripts below.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n\r\n',1,'2023-04-05 19:28:56','2023-04-05 19:28:56','nrts','cyber-range-systems-overview','version','','',4),(137,5,'Web-Services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">These directories contain config files need for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n<li class=\"null\">docker cp bookstack:/app/www/public/uploads/images .<br></li>\r\n<li class=\"null\">tar -czxf redbook-files-backup.tar.gz images</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n<li class=\"null\">tar -xvzf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp images bookstack:/app/www/public/uploads/</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nThese directories contain config files need for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\ndocker cp bookstack:/app/www/public/uploads/images .\r\ntar -czxf redbook-files-backup.tar.gz images\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\ntar -xvzf redbook-files-backup.tar.gz\r\ndocker cp images bookstack:/app/www/public/uploads/\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',1,'2023-04-05 19:30:00','2023-04-05 19:30:00','web-services','cyber-range-systems-overview','version','','',3),(138,23,'New Page','','',1,'2023-04-05 19:31:07','2023-04-05 19:31:07','new-page','using-the-nrts','version','','Initial publish',1),(139,24,'New Page','','',1,'2023-04-05 19:31:22','2023-04-05 19:31:22','new-page','using-the-nrts','version','','Initial publish',1),(141,13,'Creating Cobalt Strike C2 Profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike C2 Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So you should also testing this functionality on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; The max number of variants is 10, but it\'s a good idea to set this to 0.&nbsp; The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are;</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.&nbsp; Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using SourcePoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">SourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n<ul id=\"bkmrk-path-for-the-executa\">\r\n<li class=\"null\">Path for the executable is /root/SourcePoint/SourcePoint</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">SourePoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.</li>\r\n<li class=\"null\">Required SourcePoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike C2 Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So you should also testing this functionality on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  The max number of variants is 10, but it\'s a good idea to set this to 0.  The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are;\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike - check the Cobalt Strike keystore how to guide for this.  Or you select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing SourcePoint\r\n\r\nSourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n\r\nPath for the executable is /root/SourcePoint/SourcePoint\r\n\r\n\r\nSourePoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.\r\nRequired SourcePoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-05 19:39:08','2023-04-05 19:39:08','creating-cobalt-strike-c2-profiles','using-the-nrts','version','','',6),(143,14,'Starting a Cobalt Strike Teamserver (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.&nbsp; For instructions on how to create Cobalt Strike C2 profiles go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, I\'ll leave it as the default.<br>\r\n<p>&nbsp;</p>\r\n</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use USA.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use Seattle.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want a randomly generated IP or to set one manually.&nbsp; The guide will walk through screenshots for both options.&nbsp; For a randomly set IP, the script will randomly select a IP subnet from the Geo-location based IP table and then randomly select an IP within that subnet.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add a random IP during processing so the menu will move to the next step.&nbsp; This will be shown after going over the manual process.</li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; Then next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Here is what option \"s\" looks like.&nbsp; This list is can be long or short depending on the Geo-location you selected.&nbsp; Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu. &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.&nbsp; This will take you back to the previous menu.&nbsp; From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.&nbsp; NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.<br></li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">At this point you have either selected to randomly set an IP or set one manually.&nbsp; Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.\r\nAlso this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.  For instructions on how to create Cobalt Strike C2 profiles go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, I\'ll leave it as the default.\r\n \r\n\r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use USA.\r\n\r\n\r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use Seattle.\r\n\r\n\r\n\r\nThen it will ask if you want a randomly generated IP or to set one manually.  The guide will walk through screenshots for both options.  For a randomly set IP, the script will randomly select a IP subnet from the Geo-location based IP table and then randomly select an IP within that subnet.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add a random IP during processing so the menu will move to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  Then next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nHere is what option \"s\" looks like.  This list is can be long or short depending on the Geo-location you selected.  Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu.     \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.  This will take you back to the previous menu.  From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.  NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to randomly set an IP or set one manually.  Next, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n\r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n\r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n\r\n\r\nBelow is what the build process looks like.\r\n\r\n\r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-05 19:49:09','2023-04-05 19:49:09','starting-a-cobalt-strike-teamserver-buildredteamsh','using-the-nrts','version','','',7),(145,15,'Making a HAProxy Redirector (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default name or add own own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default of RD1. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\">&nbsp; <br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select London.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the manual process.<br></li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp; Below is the menu when you select Set IPs manually.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.&nbsp; The blank menu items will store IPs as you add them in.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Use the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the Geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.&nbsp; You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.129/25.&nbsp; Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.</li>\r\n<li class=\"null\">&nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-then-enter-the-ip.\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Then enter the IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.&nbsp; You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. <a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.&nbsp; This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a returns on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirector should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This needs to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains - Option 1 - (use randomly generated one/s).&nbsp; If we select option 1, the script will add these during processing and move on to the next step.&nbsp; We\'ll cover that after going over the manual process.<br></li>\r\n<li class=\"null\">Assigning Domains - Option 2 - (Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list and&nbsp; it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.&nbsp; You will see the domain you entered is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .&nbsp; You can validate if your redirector is running by looking at docker.&nbsp; Run docker ps and you should see RD1 up and running.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.  You can keep the default name or add own own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default of RD1.                                                                                                                               \r\n  \r\n\r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the UK.\r\n\r\n\r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select London.\r\n\r\n\r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.  Below is the menu when you select Set IPs manually.  At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.  The blank menu items will store IPs as you add them in.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUse the \"s\" option to see available subnets.  This shows the available IP subnets based on the Geo-location selections you made previously.  The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.  You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.129/25.  Note you can pick IPs from multiple IP subnets from the list, you don\'t have to use just one IP subnet.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\nThen enter the IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.  You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. \r\n\r\n\r\n\r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS.\r\n\r\n\r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.  This only changes the bind to on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but will listen for a returns on 8443 if you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n\r\n\r\nNext it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n\r\n\r\nNext it will ask what IP the redirector should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10.\r\n\r\n\r\n\r\nThen it will ask which Cobalt Strike profile to use.  This needs to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n\r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.\r\n\r\n\r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains - Option 1 - (use randomly generated one/s).  If we select option 1, the script will add these during processing and move on to the next step.  We\'ll cover that after going over the manual process.\r\nAssigning Domains - Option 2 - (Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list and  it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.  You will see the domain you entered is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n\r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.\r\n\r\n\r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  This directory will have you DNS information, IP information, where it\'s redirecting to, and the name of the C2 profile used .  You can validate if your redirector is running by looking at docker.  Run docker ps and you should see RD1 up and running.\r\n',1,'2023-04-05 20:11:21','2023-04-05 20:11:21','making-a-haproxy-redirector-buildredteamsh','using-the-nrts','version','','',10),(147,16,'Making a NGINX Redirector (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">&nbsp;NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.<br></p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike or other team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a teamserver running at 54.88.220.10.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a NGINX redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default or set your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave the default of RD1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CBYimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-asks-for-the\">\r\n<li class=\"null\">Next it asks for the number of IPs.&nbsp; For the example we\'ll use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ApVimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a Geo-location base for your setting your IP\'s.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. &nbsp; For this example we\'ll use option 4 Canada.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/RStimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-narrows-it-d\">\r\n<li class=\"null\">Then it narrows it down by city, for this example we\'ll use Toronto.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/VBWimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP manually or randomly.&nbsp; This guide will walk through both options.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Qhimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%281-set-r\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the Manual IP option.</li>\r\n<li class=\"null\">Setting IPs&nbsp; - Option 2 set IPs Manually.&nbsp; Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.&nbsp; This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out of the IP subnet view and get back to the previous menu.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X3Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-list-of-av\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.20 out of the 72.3.244.1/25 IP subnet, but you can use multiple subnets from the list.&nbsp; Press \"q\" then \"enter\" to exit the IP subnet view to get&nbsp; back at the manual IP menu.&nbsp; For this example, we\'ll select 1 for the first blank space.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-brings-up-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This brings up the IP entry menu, for this example we\'ll use 72.3.244.20.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hdjimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-enter-th\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and you will see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jJGimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-i-have\">\r\n<li class=\"null\">At this point you have either selected to have IPs generated randomly or have manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.&nbsp;&nbsp; For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rocimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to set a different port for the \"bind to\" this is related to a Cobalt Strike feature where you can have a listener set the \"bind to\" to a different port.&nbsp; The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.&nbsp; You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.&nbsp; For this example we will leave it at the default.&nbsp; The screenshoot shows that it will asks this for each port being redirected.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rtkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for the IP to redirect to.&nbsp; This should be your C2 server\'s IP.&nbsp; For this example we are using a teamserver running on 54.88.220.10</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dp2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-want-to\">\r\n<li class=\"null\">Next it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.&nbsp; This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.&nbsp; The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.&nbsp; This guide will walk through both Random and manually domain options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/LCiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-na\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domains - Option 1 (Use randomly generated one/s).&nbsp; When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.&nbsp; This will be shown after going over the Manual domain name option. &nbsp;&nbsp; <br></li>\r\n<li class=\"null\">Assigning domains - Option 2 (Manually create domain names/s).&nbsp; This will take you to the menu below.&nbsp; Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.&nbsp; For this example, we\'ll set option 1 (205.225.141.68).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/nkAimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-show-the-m\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This will show the menu below where it asks for the domain name.&nbsp; Enter the domain you want to use for that IP and press enter.&nbsp; For this example, we\'ll use goatfarmer.com.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/J49image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-entered-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu.&nbsp; You should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sbaimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point you have either selected randomly generated domain names or completed adding domain names manual.&nbsp; Next the script will ask you to set a tag for your DNS.&nbsp; This is used to identify the domains later when you want to remove them.&nbsp; For this example, we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xo4image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-now-the-script-has-a\">\r\n<li class=\"null\">Now the script has all the information it needs to build your NGINX redirector.&nbsp; Review the settings and if you are happy with it press enter to start the docker container build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ROCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-shows-the-buil\">\r\n<li class=\"null\">Below shows the build process, you should now have a NGINX redirector.&nbsp; You can get information about it from the /root/services/RD1 folder.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HDTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-to-check-that-your-c\">\r\n<li class=\"null\">To check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/4KAimage.png\" alt=\"image.png\"></a></p>',' NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.\r\nNOTE: This guide is assuming you already have a Cobalt Strike or other team server running.  \r\nFor this example, we\'ll assume we have a teamserver running at 54.88.220.10.\r\n\r\nUse the following script to start a NGINX redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.  You can keep the default or set your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave the default of RD1.\r\n\r\n\r\n\r\nNext it asks for the number of IPs.  For the example we\'ll use 5.\r\n\r\n\r\n\r\nNext it will ask for a Geo-location base for your setting your IP\'s.  The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.   For this example we\'ll use option 4 Canada.\r\n\r\n\r\n\r\nThen it narrows it down by city, for this example we\'ll use Toronto.\r\n\r\n\r\n\r\nNext, it will ask if you want to set IP manually or randomly.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the Manual IP option.\r\nSetting IPs  - Option 2 set IPs Manually.  Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.  At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.  This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out of the IP subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUsing the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.20 out of the 72.3.244.1/25 IP subnet, but you can use multiple subnets from the list.  Press \"q\" then \"enter\" to exit the IP subnet view to get  back at the manual IP menu.  For this example, we\'ll select 1 for the first blank space.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis brings up the IP entry menu, for this example we\'ll use 72.3.244.20.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and you will see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have IPs generated randomly or have manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.   For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.\r\n\r\n\r\n\r\nNext it will ask if you want to set a different port for the \"bind to\" this is related to a Cobalt Strike feature where you can have a listener set the \"bind to\" to a different port.  The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.  You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.  For this example we will leave it at the default.  The screenshoot shows that it will asks this for each port being redirected.\r\n\r\n\r\n\r\nNext it will ask for the IP to redirect to.  This should be your C2 server\'s IP.  For this example we are using a teamserver running on 54.88.220.10\r\n\r\n\r\n\r\nNext it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.  This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.  The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.  This guide will walk through both Random and manually domain options.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning domains - Option 1 (Use randomly generated one/s).  When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.  This will be shown after going over the Manual domain name option.    \r\nAssigning domains - Option 2 (Manually create domain names/s).  This will take you to the menu below.  Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.  For this example, we\'ll set option 1 (205.225.141.68).\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis will show the menu below where it asks for the domain name.  Enter the domain you want to use for that IP and press enter.  For this example, we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu.  You should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected randomly generated domain names or completed adding domain names manual.  Next the script will ask you to set a tag for your DNS.  This is used to identify the domains later when you want to remove them.  For this example, we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nNow the script has all the information it needs to build your NGINX redirector.  Review the settings and if you are happy with it press enter to start the docker container build process.\r\n\r\n\r\n\r\nBelow shows the build process, you should now have a NGINX redirector.  You can get information about it from the /root/services/RD1 folder.\r\n\r\n\r\n\r\nTo check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.\r\n\r\n',1,'2023-04-05 20:51:00','2023-04-05 20:51:00','making-a-nginx-redirector-buildredteamsh','using-the-nrts','version','','',5),(149,17,'Building a Payload Host (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.&nbsp; For this example, we\'ll leave it as the default of P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location for your IPs.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.&nbsp; For this example, we\'ll set our Geo-location to option 7 - France.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the script will move on to the next step.&nbsp; We\'ll cover that after going over the manual IP process.</li>\r\n<li class=\"null\">Setting IP\'s - Option 2 Set IPs manually.&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page down then&nbsp; press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, we\'ll select option 1 for the first blank spot.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-%C2%A0then-at-the-ip-entr\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">&nbsp;Then at the IP entry menu below we\'ll&nbsp; put in 184.84.181.201.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.&nbsp; You will see the blank at option 1 is populated with the IP you just entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"> &nbsp;</li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 1 use randomly generated one/s.&nbsp; When you select this, the script will generate random domains during processing and it will move on to the next step.&nbsp; This will be covered after walking through the manual DNS option.<br></li>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 2 Manually create domain name/s.&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"d\" when complete.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected to have domain names created Randomly or have completed the manual domain name process.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dDwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom service tag go there, ex.&nbsp; /root/services/&lt;docker service tag&gt;/WWW.</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.  For this example, we\'ll leave it as the default of P1.\r\n\r\n\r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location for your IPs.  The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.  For this example, we\'ll set our Geo-location to option 7 - France.\r\n\r\n\r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n\r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the script will move on to the next step.  We\'ll cover that after going over the manual IP process.\r\nSetting IP\'s - Option 2 Set IPs manually.  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page down then  press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, we\'ll select option 1 for the first blank spot.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n Then at the IP entry menu below we\'ll  put in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.  You will see the blank at option 1 is populated with the IP you just entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains -  Option 1 use randomly generated one/s.  When you select this, the script will generate random domains during processing and it will move on to the next step.  This will be covered after walking through the manual DNS option.\r\nAssigning Domains -  Option 2 Manually create domain name/s.  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"d\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have domain names created Randomly or have completed the manual domain name process.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.\r\n\r\n\r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom service tag go there, ex.  /root/services/<docker service tag>/WWW.\r\n',1,'2023-04-06 01:18:31','2023-04-06 01:18:31','building-a-payload-host-buildredteamsh','using-the-nrts','version','','',6),(151,18,'Phishing Attack (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The Phishing attack option doesn\'t build a docker container.&nbsp; Instead it sets up the NRTS host to perform the phishing attack.&nbsp; This step is just preparing the NRTS to mimic a domain for sending the phish.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; This will be shown after going over the set IPs manually process.</li>\r\n<li class=\"null\">Setting&nbsp; IPs - Option 2 Set IPs manually.&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the Geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our selected to get a randomly generated IP or set it manually.&nbsp; The next menu screen asks how we want to assign our Domain name.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domain names -&nbsp; Option 1 Use randomly generated one/s.&nbsp; This option will assign random domain names during processing and will move on to the next step.&nbsp; We\'ll cover that after going over the manual domain name option.<br></li>\r\n<li class=\"null\">Assigning Domain names - Option 2 Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have either selected to have a domain name generated randomly or we manually set a domain name.&nbsp; The script will then want a Tag for your DNS.&nbsp; This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.&nbsp; For this example, we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Below is a screenshot of the phish preparation build.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are phish.sh and spam.sh.&nbsp; Below is some information on what to modify in these scripts for your attack.<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modified for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p>&nbsp;</p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, then edit the /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; The only difference here is that you don\'t add the target email address in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The Phishing attack option doesn\'t build a docker container.  Instead it sets up the NRTS host to perform the phishing attack.  This step is just preparing the NRTS to mimic a domain for sending the phish.\r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\".\r\n\r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.\r\n\r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.\r\n\r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  This will be shown after going over the set IPs manually process.\r\nSetting  IPs - Option 2 Set IPs manually.  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.  Enter \"s\" at the menu below to see a list of IP subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the Geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our selected to get a randomly generated IP or set it manually.  The next menu screen asks how we want to assign our Domain name.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domain names -  Option 1 Use randomly generated one/s.  This option will assign random domain names during processing and will move on to the next step.  We\'ll cover that after going over the manual domain name option.\r\nAssigning Domain names - Option 2 Manually create domain name/s.   Selecting this option will bring up  the following menu.  It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected to have a domain name generated randomly or we manually set a domain name.  The script will then want a Tag for your DNS.  This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.  For this example, we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\nBelow is a screenshot of the phish preparation build.\r\n\r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are phish.sh and spam.sh.  Below is some information on what to modify in these scripts for your attack.\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modified for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.\r\n                      \r\n \r\n\r\nThen the last line in the script is the phish.  Place your subject in, then edit the /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  The only difference here is that you don\'t add the target email address in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n',1,'2023-04-06 01:24:45','2023-04-06 01:24:45','phishing-attack-buildredteamsh','using-the-nrts','version','','',7),(153,19,'Managing Services (buildredteam.sh)','<p id=\"bkmrk-then-nrts-builds-red\">Then NRTS builds red team infrastructure in docker containers.&nbsp; These containers and services can be managed using the /root/scripts/buildredteam.sh.&nbsp; NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks.&nbsp;</p>\r\n<ul id=\"bkmrk-to-view%2C-restart-or-\">\r\n<li class=\"null\">To View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b0Yimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Then select option 6 - Container management.&nbsp; From this menu you can view, delete, start or stop a saved container.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Kb5image.png\" alt=\"image.png\">\r\n<p><br></p>\r\n</li>\r\n<li class=\"null\">The <strong>View Container Menu </strong>will show you the status of the various service containers.&nbsp; Below is and example.&nbsp; NOTE: This view will show if the container is currently running or stopped.&nbsp; You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.&nbsp; This is because the phish set up doesn\'t create a docker container.&nbsp; Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.&nbsp; For more on phishing attacks goto -&gt; Using the NRTS -&gt; Setting up Phishing attacks.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/llJimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">From the View Menu, you can select a service to see more information about it.&nbsp; It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n<ul id=\"bkmrk-%C2%A0payload-host-servic\">\r\n<li class=\"null\">&nbsp;payload host service (P1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/tHEimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">phish set up (phish).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/wRNimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">redirector (RD1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/s1Nimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Cobalt strike teamserver (TS1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oIPimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The <strong>Delete Container Menu</strong> option shows the following.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/roTimage.png\" alt=\"image.png\">\r\n<ul id=\"bkmrk-from-the-delete-menu\">\r\n<li class=\"null\">From the delete menu you can select a service to delete whether it is running or not.&nbsp; This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/&lt;servicetag&gt; directory.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The&nbsp;<strong>Start Container menu</strong> option allows you to start a stopped container.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HB3image.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">The&nbsp;<strong>Stop Container menu&nbsp;</strong>option allows you to stop a running container.&nbsp; This will just kill and remove the container, it can be restarted later with no lose in functionality.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gLFimage.png\" alt=\"image.png\">\r\n<p>&nbsp;</p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Then NRTS builds red team infrastructure in docker containers.  These containers and services can be managed using the /root/scripts/buildredteam.sh.  NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks. \r\n\r\nTo View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.\r\n\r\nThen select option 6 - Container management.  From this menu you can view, delete, start or stop a saved container.\r\n\r\n\r\n\r\nThe View Container Menu will show you the status of the various service containers.  Below is and example.  NOTE: This view will show if the container is currently running or stopped.  You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.  This is because the phish set up doesn\'t create a docker container.  Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.  For more on phishing attacks goto -> Using the NRTS -> Setting up Phishing attacks.\r\n\r\nFrom the View Menu, you can select a service to see more information about it.  It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n\r\n payload host service (P1).\r\n\r\nphish set up (phish).\r\n\r\nredirector (RD1).\r\n\r\nCobalt strike teamserver (TS1).\r\n\r\n\r\n\r\nThe Delete Container Menu option shows the following.\r\n\r\n\r\nFrom the delete menu you can select a service to delete whether it is running or not.  This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/<servicetag> directory.  \r\n\r\n\r\nThe Start Container menu option allows you to start a stopped container.\r\n\r\nThe Stop Container menu option allows you to stop a running container.  This will just kill and remove the container, it can be restarted later with no lose in functionality.\r\n\r\n \r\n\r\n\r\n',1,'2023-04-06 01:28:32','2023-04-06 01:28:32','managing-services-buildredteamsh','using-the-nrts','version','','',4),(154,21,'Reverting the NRTS','<p id=\"bkmrk-if-you-want-to-wipe-\">If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.&nbsp; It\'s located on the NRTS at /root/scripts/revert.sh</p>\r\n<p id=\"bkmrk-below-is-usage\">below is usage</p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fr\"><code class=\"language-bash\">cd /root/scripts\r\n./revert.sh</code></pre>\r\n<ul id=\"bkmrk-when-you-run-this%2C-i\">\r\n<li class=\"null\">When you run this, it will make sure you want to by making you confirm.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Awbimage.png\" alt=\"image.png\"></li>\r\n</ul>','If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.  It\'s located on the NRTS at /root/scripts/revert.sh\r\nbelow is usage\r\ncd /root/scripts\r\n./revert.sh\r\n\r\nWhen you run this, it will make sure you want to by making you confirm.\r\n\r\n',1,'2023-04-06 01:29:08','2023-04-06 01:29:08','reverting-the-nrts','using-the-nrts','version','','',2),(155,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; ManageDNS.sh</p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the main DNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> ManageDNS.sh',1,'2023-04-06 01:29:52','2023-04-06 01:29:52','manual-domain-registration','how-to-guides','version','','',12),(157,11,'Proxy All the things','<p id=\"bkmrk-note%3A-the-proxy-is-a\">NOTE: The proxy is at http://172.30.0.2:9999</p>\r\n<h4 id=\"bkmrk-setting-up-docker-in\">Setting up Docker in linux</h4>\r\n<ul id=\"bkmrk-add-folder-for-the-d\">\r\n<li class=\"null\">Add folder for the docker service if it doesn\'t exist and add a proxy conf file&nbsp; &nbsp; &nbsp;&nbsp; <br></li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fsystemd%2Fsyst\"><code class=\"language-bash\">cd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in\">\r\n<li class=\"null\">Put the following in the http-proxy.conf</li>\r\n</ul>\r\n<pre id=\"bkmrk-%5Bservice%5D-environmen\"><code class=\"language-bash\">[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"</code></pre>\r\n<ul id=\"bkmrk-lastly%2C-reload-daemo\">\r\n<li class=\"null\">Lastly, reload daemon and restart the docker service<br></li>\r\n</ul>\r\n<pre id=\"bkmrk-systemctl-daemon-rel\"><code class=\"language-\">systemctl daemon-reload\r\nsystemctl restart docker</code></pre>\r\n<h4 id=\"bkmrk-adding-proxy-to-a-do\">Adding Proxy to a Dockerfile</h4>\r\n<ul id=\"bkmrk-edit-your-dockerfile\">\r\n<li class=\"null\">edit your dockerfile in your favorite linux text editor and add these variables.</li>\r\n</ul>\r\n<pre id=\"bkmrk-env-http_proxy-http%3A\"><code class=\"language-\">ENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-add-proxy-to-apt\">Add Proxy to Apt</h4>\r\n<ul id=\"bkmrk-go-to-the-apt.conf.d\">\r\n<li class=\"null\">Go to the apt.conf.d directory and create a proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fapt%2Fapt.conf\"><code class=\"language-bash\">cd /etc/apt/apt.conf.d\r\nvi proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in-1\">\r\n<li class=\"null\">Put the following in the proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-acquire%3A%3Ahttp%3A%3Aproxy\"><code class=\"language-\">Acquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";</code></pre>\r\n<h4 id=\"bkmrk-add-proxy-for-wget\">Add proxy for wget</h4>\r\n<ul id=\"bkmrk-edit-the-%2Fetc%2Fwgetrc\">\r\n<li class=\"null\">Edit the /etc/wgetrc file.&nbsp; Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.</li>\r\n</ul>\r\n<pre id=\"bkmrk-use_proxy%3Dyes-http_p\"><code class=\"language-\">use_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-cobalt-strike-update\">Cobalt Strike Update script</h4>\r\n<ul id=\"bkmrk-in-order-to-run-the-\">\r\n<li class=\"null\">In order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.&nbsp; Below is the additional flags you need to add.</li>\r\n</ul>\r\n<pre id=\"bkmrk-java--dhttp.proxyhos\"><code class=\"language-\">java -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999</code></pre>\r\n<h4 id=\"bkmrk-using-git-via-proxy\">Using git via proxy</h4>\r\n<ul id=\"bkmrk-git-can-use-your-env\">\r\n<li class=\"null\">git can use your environment variables to use a proxy, wget can to depending on the version of linux.&nbsp; To use git through the proxy, set the following environment variables with the following command.</li>\r\n</ul>\r\n<pre id=\"bkmrk-export-http_proxy%3Dht\"><code class=\"language-\">export http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-pip3-install-via-pro\">PIP3 install via proxy</h4>\r\n<ul id=\"bkmrk-on-occasion-pip3-ins\">\r\n<li class=\"null\">On occasion pip3 installs on ubuntu runs into issues.&nbsp; The following has worked to resolve it.</li>\r\n</ul>\r\n<pre id=\"bkmrk-apt-remove---purge-p\"><code class=\"language-\">apt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py</code></pre>','NOTE: The proxy is at http://172.30.0.2:9999\r\nSetting up Docker in linux\r\n\r\nAdd folder for the docker service if it doesn\'t exist and add a proxy conf file       \r\n\r\ncd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf\r\n\r\nPut the following in the http-proxy.conf\r\n\r\n[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"\r\n\r\nLastly, reload daemon and restart the docker service\r\n\r\nsystemctl daemon-reload\r\nsystemctl restart docker\r\nAdding Proxy to a Dockerfile\r\n\r\nedit your dockerfile in your favorite linux text editor and add these variables.\r\n\r\nENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999\r\nAdd Proxy to Apt\r\n\r\nGo to the apt.conf.d directory and create a proxy.conf file\r\n\r\ncd /etc/apt/apt.conf.d\r\nvi proxy.conf\r\n\r\nPut the following in the proxy.conf file\r\n\r\nAcquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";\r\nAdd proxy for wget\r\n\r\nEdit the /etc/wgetrc file.  Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.\r\n\r\nuse_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999\r\nCobalt Strike Update script\r\n\r\nIn order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.  Below is the additional flags you need to add.\r\n\r\njava -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999\r\nUsing git via proxy\r\n\r\ngit can use your environment variables to use a proxy, wget can to depending on the version of linux.  To use git through the proxy, set the following environment variables with the following command.\r\n\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\nPIP3 install via proxy\r\n\r\nOn occasion pip3 installs on ubuntu runs into issues.  The following has worked to resolve it.\r\n\r\napt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py',1,'2023-04-06 01:30:39','2023-04-06 01:30:39','proxy-all-the-things','how-to-guides','version','','',3),(158,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-user-accounts---crea\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; This is just a script to use as an example, you can change all of it of course.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-dns---i-use-the-acti\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - I use the Active directory server to manage blue space DNS requests.&nbsp; I configure all of the&nbsp; workstations DNS to poin to the IP of the Active Directory server.&nbsp; Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.&nbsp; We have a custom solution, but Carnegie Mellon has a simulated internet software solution.&nbsp; We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.&nbsp; For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-email-support---ther\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.&nbsp; However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.&nbsp; I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-group-policies---i-w\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-disable-cortana---ap\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.&nbsp; Complex to explain but a windows system admin should know how to do this.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust stores on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-a-few-more-th\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use a few more than this, but it depends on what the cyber blue space is.&nbsp; However, Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-file-server%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-just-install-a-windo\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different network maps for users based on groups when they login.</span></p>\r\n<p id=\"bkmrk--1\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-exchange%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-this-is-probably-the\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; That said, I want to talk about setting up the VM for Exchange.&nbsp; When I make one, I give it 16 GB of RAM and two harddrives.&nbsp; One that’s 60GB and one that’s 100GB.&nbsp; I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.&nbsp; I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.&nbsp; The powershell scripts to clear logs and delete emails is in the scripts folder.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-workstations%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-make-sure-you-instal\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; I’ll add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.&nbsp; Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.&nbsp; I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.&nbsp; Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.&nbsp; We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.&nbsp; It would be unrealistic if there wasn’t some sort of built in remote management.&nbsp; Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk--2\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-firewalls%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-pfsense%2C-typi\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.&nbsp; Maybe you want to set up a SMTP relay.&nbsp; Whatever.&nbsp; We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.&nbsp; For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.</span></p>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-routers%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-vyos---these-\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Vyos - these are set up to route various internal Subnets.&nbsp; There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-snapshotting\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTTING</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-i-always-create-powe\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; I’ll typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.</span></p>\r\n<p id=\"bkmrk--5\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-powering-on-and-off\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-powering-on%2C-i-start\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, I reverse the order.&nbsp; If you get an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.&nbsp; In the scripts folder I have a range management powercli script you can use.&nbsp; You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk--6\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-internal-traffic-gen\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-ghosts---its-\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Ghosts - its a free product from Carnegie Mellon, the github is here </span><a style=\"text-decoration: none;\" href=\"https://github.com/cmu-sei/GHOSTS\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://github.com/cmu-sei/GHOSTS</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-install-this-on-a\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk--7\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-external-traffic-gen\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-whats-built-i\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.&nbsp; However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.&nbsp; It’s been years since we did this and I’ve lost that script.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  This is just a script to use as an example, you can change all of it of course.   \r\nDNS - I use the Active directory server to manage blue space DNS requests.  I configure all of the  workstations DNS to poin to the IP of the Active Directory server.  Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.  We have a custom solution, but Carnegie Mellon has a simulated internet software solution.  We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.  For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.\r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.  However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.  I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.\r\nGroup Policies - I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.  Complex to explain but a windows system admin should know how to do this.\r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.  This script imports the root and intermediary Certificates into the trust stores on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nWe use a few more than this, but it depends on what the cyber blue space is.  However, Group Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\n\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different network maps for users based on groups when they login.\r\n\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  That said, I want to talk about setting up the VM for Exchange.  When I make one, I give it 16 GB of RAM and two harddrives.  One that’s 60GB and one that’s 100GB.  I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.  I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.  The powershell scripts to clear logs and delete emails is in the scripts folder.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  I’ll add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.  Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.  I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.  Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.  We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.  It would be unrealistic if there wasn’t some sort of built in remote management.  Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\n\r\nFirewalls \r\nWe use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.  Maybe you want to set up a SMTP relay.  Whatever.  We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.  For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.\r\n\r\nRouters \r\nWe use Vyos - these are set up to route various internal Subnets.  There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.\r\n\r\nSNAPSHOTTING\r\nI always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  I’ll typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.\r\n\r\nPowering On and Off\r\nPowering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, I reverse the order.  If you get an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.  In the scripts folder I have a range management powercli script you can use.  You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\n\r\nInternal Traffic Generation\r\nWe use Ghosts - its a free product from Carnegie Mellon, the github is here https://github.com/cmu-sei/GHOSTS   \r\nWe install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\n\r\nExternal Traffic Generation\r\nWe use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.  However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.  It’s been years since we did this and I’ve lost that script.',1,'2023-04-10 17:00:14','2023-04-10 17:00:14','general-guidance','target-domain-planning-guide','version','','Initial publish',1),(159,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: rgb(236, 240, 241); background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; This is just a script to use as an example, you can change all of it of course.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - I use the Active directory server to manage blue space DNS requests.&nbsp; I configure all of the&nbsp; workstations DNS to poin to the IP of the Active Directory server.&nbsp; Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.&nbsp; We have a custom solution, but Carnegie Mellon has a simulated internet software solution.&nbsp; We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.&nbsp; For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.</span></p>\r\n<p id=\"bkmrk-email-support---ther\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.&nbsp; However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.&nbsp; I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.</span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.</span></p>\r\n<ul id=\"bkmrk-disable-cortana---ap\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.&nbsp; Complex to explain but a windows system admin should know how to do this.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust stores on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-we-use-a-few-more-th\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use a few more than this, but it depends on what the cyber blue space is.&nbsp; However, Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-\"><br></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different network maps for users based on groups when they login.</span></p>\r\n<p id=\"bkmrk--1\"><br></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; That said, I want to talk about setting up the VM for Exchange.&nbsp; When I make one, I give it 16 GB of RAM and two harddrives.&nbsp; One that’s 60GB and one that’s 100GB.&nbsp; I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.&nbsp; I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.&nbsp; The powershell scripts to clear logs and delete emails is in the scripts folder.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; I’ll add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.&nbsp; Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.&nbsp; I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.&nbsp; Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.&nbsp; We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.&nbsp; It would be unrealistic if there wasn’t some sort of built in remote management.&nbsp; Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk--2\"><br></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.&nbsp; Maybe you want to set up a SMTP relay.&nbsp; Whatever.&nbsp; We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.&nbsp; For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.</span></p>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Vyos - these are set up to route various internal Subnets.&nbsp; There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTTING</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; I’ll typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.</span></p>\r\n<p id=\"bkmrk--5\"><br></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, I reverse the order.&nbsp; If you get an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.&nbsp; In the scripts folder I have a range management powercli script you can use.&nbsp; You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk--6\"><br></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Ghosts - its a free product from Carnegie Mellon, the github is here </span><a style=\"text-decoration: none;\" href=\"https://github.com/cmu-sei/GHOSTS\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://github.com/cmu-sei/GHOSTS</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk-we-install-this-on-a\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk--7\"><br></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.&nbsp; However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.&nbsp; It’s been years since we did this and I’ve lost that script.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  This is just a script to use as an example, you can change all of it of course.   \r\nDNS - I use the Active directory server to manage blue space DNS requests.  I configure all of the  workstations DNS to poin to the IP of the Active Directory server.  Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.  We have a custom solution, but Carnegie Mellon has a simulated internet software solution.  We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.  For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.\r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.  However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.  I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.\r\nGroup Policies - I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.  Complex to explain but a windows system admin should know how to do this.\r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.  This script imports the root and intermediary Certificates into the trust stores on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nWe use a few more than this, but it depends on what the cyber blue space is.  However, Group Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\n\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different network maps for users based on groups when they login.\r\n\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  That said, I want to talk about setting up the VM for Exchange.  When I make one, I give it 16 GB of RAM and two harddrives.  One that’s 60GB and one that’s 100GB.  I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.  I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.  The powershell scripts to clear logs and delete emails is in the scripts folder.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  I’ll add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.  Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.  I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.  Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.  We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.  It would be unrealistic if there wasn’t some sort of built in remote management.  Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\n\r\nFirewalls \r\nWe use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.  Maybe you want to set up a SMTP relay.  Whatever.  We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.  For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.\r\n\r\nRouters \r\nWe use Vyos - these are set up to route various internal Subnets.  There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.\r\n\r\nSNAPSHOTTING\r\nI always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  I’ll typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.\r\n\r\nPowering On and Off\r\nPowering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, I reverse the order.  If you get an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.  In the scripts folder I have a range management powercli script you can use.  You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\n\r\nInternal Traffic Generation\r\nWe use Ghosts - its a free product from Carnegie Mellon, the github is here https://github.com/cmu-sei/GHOSTS   \r\nWe install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\n\r\nExternal Traffic Generation\r\nWe use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.  However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.  It’s been years since we did this and I’ve lost that script.',1,'2023-04-10 17:01:20','2023-04-10 17:01:20','general-guidance','target-domain-planning-guide','version','','',2),(160,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-user-accounts---crea\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; This is just a script to use as an example, you can change all of it of course.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-dns---i-use-the-acti\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - I use the Active directory server to manage blue space DNS requests.&nbsp; I configure all of the&nbsp; workstations DNS to poin to the IP of the Active Directory server.&nbsp; Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.&nbsp; We have a custom solution, but Carnegie Mellon has a simulated internet software solution.&nbsp; We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.&nbsp; For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-email-support---ther\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.&nbsp; However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.&nbsp; I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-group-policies---i-w\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-disable-cortana---ap\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.&nbsp; Complex to explain but a windows system admin should know how to do this.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust stores on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-a-few-more-th\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use a few more than this, but it depends on what the cyber blue space is.&nbsp; However, Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-file-server%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-just-install-a-windo\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different network maps for users based on groups when they login.</span></p>\r\n<p id=\"bkmrk--1\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-exchange%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-this-is-probably-the\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; That said, I want to talk about setting up the VM for Exchange.&nbsp; When I make one, I give it 16 GB of RAM and two harddrives.&nbsp; One that’s 60GB and one that’s 100GB.&nbsp; I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.&nbsp; I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.&nbsp; The powershell scripts to clear logs and delete emails is in the scripts folder.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-workstations%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-make-sure-you-instal\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; I’ll add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.&nbsp; Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.&nbsp; I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.&nbsp; Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.&nbsp; We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.&nbsp; It would be unrealistic if there wasn’t some sort of built in remote management.&nbsp; Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk--2\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-firewalls%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-pfsense%2C-typi\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.&nbsp; Maybe you want to set up a SMTP relay.&nbsp; Whatever.&nbsp; We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.&nbsp; For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.</span></p>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-routers%C2%A0\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-vyos---these-\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Vyos - these are set up to route various internal Subnets.&nbsp; There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-snapshotting\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTTING</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-i-always-create-powe\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; I’ll typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.</span></p>\r\n<p id=\"bkmrk--5\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-powering-on-and-off\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-powering-on%2C-i-start\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, I reverse the order.&nbsp; If you get an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.&nbsp; In the scripts folder I have a range management powercli script you can use.&nbsp; You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk--6\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-internal-traffic-gen\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-ghosts---its-\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Ghosts - its a free product from Carnegie Mellon, the github is here </span><a style=\"text-decoration: none;\" href=\"https://github.com/cmu-sei/GHOSTS\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://github.com/cmu-sei/GHOSTS</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-install-this-on-a\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; color: #1155cc; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; -webkit-text-decoration-skip: none; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk--7\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-external-traffic-gen\"><span style=\"font-size: 13pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-we-use-whats-built-i\"><span style=\"font-size: 11pt; font-family: Arial; color: #000000; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.&nbsp; However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.&nbsp; It’s been years since we did this and I’ve lost that script.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  This is just a script to use as an example, you can change all of it of course.   \r\nDNS - I use the Active directory server to manage blue space DNS requests.  I configure all of the  workstations DNS to poin to the IP of the Active Directory server.  Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.  We have a custom solution, but Carnegie Mellon has a simulated internet software solution.  We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.  For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.\r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.  However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.  I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.\r\nGroup Policies - I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.  Complex to explain but a windows system admin should know how to do this.\r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.  This script imports the root and intermediary Certificates into the trust stores on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nWe use a few more than this, but it depends on what the cyber blue space is.  However, Group Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\n\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different network maps for users based on groups when they login.\r\n\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  That said, I want to talk about setting up the VM for Exchange.  When I make one, I give it 16 GB of RAM and two harddrives.  One that’s 60GB and one that’s 100GB.  I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.  I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.  The powershell scripts to clear logs and delete emails is in the scripts folder.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  I’ll add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.  Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.  I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.  Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.  We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.  It would be unrealistic if there wasn’t some sort of built in remote management.  Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\n\r\nFirewalls \r\nWe use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.  Maybe you want to set up a SMTP relay.  Whatever.  We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.  For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.\r\n\r\nRouters \r\nWe use Vyos - these are set up to route various internal Subnets.  There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.\r\n\r\nSNAPSHOTTING\r\nI always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  I’ll typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.\r\n\r\nPowering On and Off\r\nPowering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, I reverse the order.  If you get an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.  In the scripts folder I have a range management powercli script you can use.  You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\n\r\nInternal Traffic Generation\r\nWe use Ghosts - its a free product from Carnegie Mellon, the github is here https://github.com/cmu-sei/GHOSTS   \r\nWe install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\n\r\nExternal Traffic Generation\r\nWe use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.  However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.  It’s been years since we did this and I’ve lost that script.',1,'2023-04-10 17:02:55','2023-04-10 17:02:55','general-guidance','target-domain-planning-guide','version','','',3);
INSERT INTO `page_revisions` VALUES (161,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; This is just a script to use as an example, you can change all of it of course.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - I use the Active directory server to manage blue space DNS requests.&nbsp; I configure all of the&nbsp; workstations DNS to poin to the IP of the Active Directory server.&nbsp; Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.&nbsp; We have a custom solution, but Carnegie Mellon has a simulated internet software solution.&nbsp; We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.&nbsp; For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.</span></p>\r\n<p id=\"bkmrk-email-support---ther\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.&nbsp; However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.&nbsp; I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.</span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.</span></p>\r\n<ul id=\"bkmrk-disable-cortana---ap\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.&nbsp; Complex to explain but a windows system admin should know how to do this.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust stores on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-we-use-a-few-more-th\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use a few more than this, but it depends on what the cyber blue space is.&nbsp; However, Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-\"><br></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different network maps for users based on groups when they login.</span></p>\r\n<p id=\"bkmrk--1\"><br></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; That said, I want to talk about setting up the VM for Exchange.&nbsp; When I make one, I give it 16 GB of RAM and two harddrives.&nbsp; One that’s 60GB and one that’s 100GB.&nbsp; I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.&nbsp; I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.&nbsp; The powershell scripts to clear logs and delete emails is in the scripts folder.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; I’ll add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.&nbsp; Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.&nbsp; I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.&nbsp; Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.&nbsp; We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.&nbsp; It would be unrealistic if there wasn’t some sort of built in remote management.&nbsp; Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk--2\"><br></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.&nbsp; Maybe you want to set up a SMTP relay.&nbsp; Whatever.&nbsp; We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.&nbsp; For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.</span></p>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Vyos - these are set up to route various internal Subnets.&nbsp; There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTTING</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; I’ll typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.</span></p>\r\n<p id=\"bkmrk--5\"><br></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, I reverse the order.&nbsp; If you get an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.&nbsp; In the scripts folder I have a range management powercli script you can use.&nbsp; You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk--6\"><br></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use Ghosts - its a free product from Carnegie Mellon, the github is here </span><a style=\"text-decoration: none;\" href=\"https://github.com/cmu-sei/GHOSTS\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://github.com/cmu-sei/GHOSTS</span></a><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;</span></p>\r\n<p id=\"bkmrk-we-install-this-on-a\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk--7\"><br></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.&nbsp; However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.&nbsp; It’s been years since we did this and I’ve lost that script.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass, for example, if I added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  I found it useful to have some standardized easy to remember passwords so that while I was working with the blue space I could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  I also avoided using the exact same password for every user account, this is so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that I want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  This is just a script to use as an example, you can change all of it of course.   \r\nDNS - I use the Active directory server to manage blue space DNS requests.  I configure all of the  workstations DNS to poin to the IP of the Active Directory server.  Then I set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space.  We have a custom solution, but Carnegie Mellon has a simulated internet software solution.  We’ve never implemented it, but if you do that and figure it out, you’d set your Active directory Forwarders to point to whatever they use for a Recursive DNS server.  For the folks with an RGI or VITE, you are looking for the “recursive DNS” server in the gray space.\r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. I don’t have a guide for setting up Exchange, but you can typically follow online guides.  However, I’d advise snapshotting the DC before starting, if something goes wrong, it’s hard to reverse the modifications made to the DC during the Exchange installation process.  I don’t install it on the DC, it’s on its own server, but part of the install requires modifications to the DC.\r\nGroup Policies - I won’t get into the details for setting up all of these group policies, but here is a list of ones we set up for a blue space to help run a blue space.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it out to automatically Map the network drive based on user login groups.  Complex to explain but a windows system admin should know how to do this.\r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet, then use this to issue certificates to the various https sites on the range.  This script imports the root and intermediary Certificates into the trust stores on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nWe use a few more than this, but it depends on what the cyber blue space is.  However, Group Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\n\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different network maps for users based on groups when they login.\r\n\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: I always take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  That said, I want to talk about setting up the VM for Exchange.  When I make one, I give it 16 GB of RAM and two harddrives.  One that’s 60GB and one that’s 100GB.  I install windows server on the 60GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server.  I have a few scripts that will delete emails and logs that I’ll set up as a scheduled task to run weekly to prevent it from filling up the drive.  The powershell scripts to clear logs and delete emails is in the scripts folder.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  I’ll add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment.  Typically I’ll also look at recently exploited software, so third party software that have privilege exploitation vulnerabilities.  I’ll typically look for things that are less than a year old, make sure there is a metasploit module or better yet a Proof of Concept exploit and use that as a way to give the Red team a method for PrivEsc.  Then make sure you enable through the firewall whatever services you want to use for management by the “blue space” admins.  We always use powershell since it can do a lot of things and we use powershell ourselves for managing the bluespace, but you can set up other things like Remote Desktop.  It would be unrealistic if there wasn’t some sort of built in remote management.  Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\n\r\nFirewalls \r\nWe use PFSense, typically just three interfaces, one for a WAN connection, aka the connection to whatever you end up using for a simulated internet, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server, like the flight status board from the MWCKE exercise, but it could be anything that makes sense.  Maybe you want to set up a SMTP relay.  Whatever.  We also use the firewall to set up a port forward, to set the public IP of whatever public facing services you have to reach internal or DMZ systems.  For example we had a port forward for the flight status website in the DMZ and a port forward to the exchange on the LAN to allow for OWA.\r\n\r\nRouters \r\nWe use Vyos - these are set up to route various internal Subnets.  There are too many scenarios to provide a sample of this, but this should be a straightforward task for your network engineers.\r\n\r\nSNAPSHOTTING\r\nI always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once I have a solid working range and everything is working like I want it to, I power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  I’ll typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you make powered off snapshots.\r\n\r\nPowering On and Off\r\nPowering on, I start all networking devices, aka firewall, routers, then the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, I reverse the order.  If you get an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but I prefer PowerCLI since I can also script out Reverting to snapshots.  In the scripts folder I have a range management powercli script you can use.  You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\n\r\nInternal Traffic Generation\r\nWe use Ghosts - its a free product from Carnegie Mellon, the github is here https://github.com/cmu-sei/GHOSTS   \r\nWe install this on all workstations and set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, and send emails.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\n\r\nExternal Traffic Generation\r\nWe use whats built into the Range Global Internet (RGI) system, the same thing is built into the VITE LM if you don’t have a RGI.  However, if you don’t have either of these systems, in the past we’ve used a simple ubuntu server running on our simulated internet that have several public IP assigned, then wrote a bash script to send emails to blue space employees, and used the curl command to hit the blue space public facing webserver.  It’s been years since we did this and I’ve lost that script.',1,'2023-04-10 17:03:36','2023-04-10 17:03:36','general-guidance','target-domain-planning-guide','version','','',4),(163,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; The CreateADAccounts.ps1 script is provided as an example, edit it however you wish.&nbsp;&nbsp; </span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNZ to point to the rootDNS server.&nbsp; </span></p>\r\n<p id=\"bkmrk-email-support---ther\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.&nbsp; </span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.</span></p>\r\n<ul id=\"bkmrk-disable-cortana---ap\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp; </span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-we-use-a-few-more-th\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</span></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two harddrives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails inbetween engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the clearlogs.ps1 and deleteallemails.ps1.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. </span></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</span></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTS</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. </span></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp; </span></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Carnegie Mellon, provides a opensource solution called Ghosts. The github is here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"text-decoration: underline;\">https://github.com/cmu-sei/GHOSTS</span>. This can be </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">install a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  The CreateADAccounts.ps1 script is provided as an example, edit it however you wish.   \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNZ to point to the rootDNS server.  \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.  \r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.  \r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two harddrives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails inbetween engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the clearlogs.ps1 and deleteallemails.ps1.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls \r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. \r\nRouters \r\nVyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. \r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a opensource solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be install a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-10 18:16:12','2023-04-10 18:16:12','general-guidance','target-domain-planning-guide','version','','',5),(165,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-traffic-genera\" dir=\"ltr\" style=\"line-height: 1.38; text-align: center; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 15pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost traffic generator</span></p>\r\n<p id=\"bkmrk-\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-ghost-is-a-traffic-g\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but they also provide pre-compiled binaries.&nbsp; If you just want to download and go, the binary zip can be found</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-https%3A%2F%2Fgithub.com%2Fc\"><a style=\"text-decoration: none;\" href=\"https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries</span></a></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-then%2C-under-windows-\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then, under windows client for the link that says “download the current 32-bit client zip file”.</span></p>\r\n<p id=\"bkmrk--1\"><br><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-ghost-set-up.\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-you-need-to-put-the-\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, I typically just put it at c:\\ghosts.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk--2\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-then-you-need-to-con\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-config-files-%28ghosts\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management API sucks, so I disable a lot of these settings.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled&nbsp;</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><a style=\"text-decoration: none;\" href=\"http://ghosts-c2/api/%E2%80%A6\"><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span></a><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.”</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”&nbsp; set this to -1</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of sis.uk</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"5\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=sis,DC=UK’ -properties mail | Select -expand mail”</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I’m not sure what this is used for.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv&nbsp;</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re domain users emails, you have to make this</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses.&nbsp; This depends on your range environment, with the Range Global Internet platform from ByLight, we have several email domains, we can just make up emails for these domains and the environment will accept the emails and it doesn’t matter what we use.&nbsp; The RGI SMTP servers accept it and deletes it.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of works that it uses for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json&nbsp;</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, we don’t use their management site and we disable health in the application.json, so this doesn’t matter.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample configs for how to use.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder.</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 108pt; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-note%3A-on-the-latest-\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: on the latest binary release 4.0 the redemption.dll was already there.</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-logs-%28ghosts%2Flogs%29-a\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-starting-and-stoppin\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-to-start-ghost%2C-just\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-notes%3A%C2%A0\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\" id=\"bkmrk-ghost-can-be-resourc\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, especially if its throwing errors in the app.log log.&nbsp; Working on getting the configuration files right so this log is basically empty.&nbsp; For a reference, mine has only one entry after running work weeks.&nbsp; Once you’ve tested it and have it working well, copy it over to other workstations.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost traffic generator\r\n\r\nGhost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but they also provide pre-compiled binaries.  If you just want to download and go, the binary zip can be found\r\nhttps://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries\r\nThen, under windows client for the link that says “download the current 32-bit client zip file”.\r\n\r\nGhost set up.\r\n\r\n\r\nYou need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, I typically just put it at c:\\ghosts.\r\n\r\n\r\n\r\nThen you need to config it.\r\n\r\n\r\nConfig files (Ghosts/config)\r\n\r\n\r\n\r\nApplication.json\r\n\r\n\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management API sucks, so I disable a lot of these settings.\r\n\r\n\r\nChange the following variables to false\r\n\r\n\r\n\r\nIdEnabled - at the top\r\n\r\n\r\nIsEnabled - under ClientResults\r\n\r\n\r\nIsEnabled  - under ClientUpdates\r\n\r\n\r\nIsEnabled - under Survey\r\n\r\n\r\nHealthIsEnabled \r\n\r\n\r\n\r\nMake sure the following variable is true\r\n\r\n\r\n\r\nHandlersIsEnabled\r\n\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….”\r\n\r\n\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”  set this to -1\r\n\r\n\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\n\r\n\r\n\r\nThere is a “EmailDomainSearchString”, set this to match your domain, you can test your command to make sure it works.  Here’s and example for a domain of sis.uk\r\n\r\n\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=sis,DC=UK’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\n\r\n\r\nI’m not sure what this is used for.\r\n\r\n\r\n\r\nEmail-content.csv \r\n\r\n\r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\n\r\nEmail-reply.csv\r\n\r\n\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\n\r\nEmails-domain.json\r\n\r\n\r\n\r\nThis is a list of all you’re domain users emails, you have to make this\r\n\r\n\r\n\r\nEmails-outside.json\r\n\r\n\r\n\r\nList of external email addresses.  This depends on your range environment, with the Range Global Internet platform from ByLight, we have several email domains, we can just make up emails for these domains and the environment will accept the emails and it doesn’t matter what we use.  The RGI SMTP servers accept it and deletes it.\r\n\r\n\r\n\r\nFilenames.json\r\n\r\n\r\n\r\nList of works that it uses for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\n\r\nHealth.json \r\n\r\n\r\n\r\nIt will check a URL and for reporting health status, we don’t use their management site and we disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\n\r\nTimeline.json\r\n\r\n\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at the sample configs for how to use.\r\n\r\n\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\n\r\n\r\nIf you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.\r\n\r\n\r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder.\r\n\r\n\r\n\r\n\r\nNOTE: on the latest binary release 4.0 the redemption.dll was already there.\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\n\r\n\r\nApp.log\r\n\r\n\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\n\r\n\r\n\r\nClientupdates.log\r\n\r\n\r\n\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n            To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\n\r\nNOTES: \r\n\r\n\r\nGhost can be resource intensive, especially if its throwing errors in the app.log log.  Working on getting the configuration files right so this log is basically empty.  For a reference, mine has only one entry after running work weeks.  Once you’ve tested it and have it working well, copy it over to other workstations.\r\n\r\n\r\nIf you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.\r\n\r\n\r\n',1,'2023-04-10 19:23:07','2023-04-10 19:23:07','ghost-traffic-generation','target-domain-planning-guide','version','','Initial publish',1),(167,26,'Ghost Traffic Generation','<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-ghost-is-a-traffic-g\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you jut want to download and go, the binary zip can be found at https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries. </span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-%C2%A0\">&nbsp;</p>\r\n<p id=\"bkmrk-then%2C-under-windows-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then, under windows client for the link that says “download the current 32-bit client zip file”.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-%C2%A0-1\">&nbsp;</p>\r\n<p id=\"bkmrk-ghost-set-up.\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul id=\"bkmrk-you-need-to-put-the-\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, I usually place it at c:\\Ghosts.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0-2\">&nbsp;</p>\r\n<p id=\"bkmrk-then-you-need-to-con\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul id=\"bkmrk-config-files-%28ghosts\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management API sucks, so I disable a lot of these settings.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled&nbsp;</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><a style=\"text-decoration: none;\" href=\"http://ghosts-c2/api/%E2%80%A6\"><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span></a><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.”</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”&nbsp; set this to -1</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"4\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of sis.uk</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"5\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=sis,DC=UK’ -properties mail | Select -expand mail”</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">I’m not sure what this is used for.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv&nbsp;</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re domain users emails, you have to make this</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses.&nbsp; This depends on your range environment, with the Range Global Internet platform from ByLight, we have several email domains, we can just make up emails for these domains and the environment will accept the emails and it doesn’t matter what we use.&nbsp; The RGI SMTP servers accept it and deletes it.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of works that it uses for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json&nbsp;</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, we don’t use their management site and we disable health in the application.json, so this doesn’t matter.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample configs for how to use.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><a style=\"text-decoration: none;\" href=\"https://www.dimastr.com/redemption/download.htm\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span></a><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder.</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<p id=\"bkmrk-note%3A-on-the-latest-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 108pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: on the latest binary release 4.0 the redemption.dll was already there.</span></p>\r\n<ul id=\"bkmrk-logs-%28ghosts%2Flogs%29-a\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></p>\r\n</li>\r\n</ul>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"2\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></p>\r\n</li>\r\n<ul style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre;\" aria-level=\"3\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span></p>\r\n</li>\r\n</ul>\r\n</ul>\r\n</ul>\r\n<p id=\"bkmrk--3\"><br></p>\r\n<p id=\"bkmrk-starting-and-stoppin\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p id=\"bkmrk--4\"><br></p>\r\n<p id=\"bkmrk-notes%3A%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul id=\"bkmrk-ghost-can-be-resourc\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, especially if its throwing errors in the app.log log.&nbsp; Working on getting the configuration files right so this log is basically empty.&nbsp; For a reference, mine has only one entry after running work weeks.&nbsp; Once you’ve tested it and have it working well, copy it over to other workstations.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you jut want to download and go, the binary zip can be found at https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries. \r\n \r\nThen, under windows client for the link that says “download the current 32-bit client zip file”.\r\n \r\nGhost set up.\r\n\r\n\r\nYou need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, I usually place it at c:\\Ghosts.\r\n\r\n\r\n \r\nThen you need to config it.\r\n\r\n\r\nConfig files (Ghosts/config)\r\n\r\n\r\n\r\nApplication.json\r\n\r\n\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management API sucks, so I disable a lot of these settings.\r\n\r\n\r\nChange the following variables to false\r\n\r\n\r\n\r\nIdEnabled - at the top\r\n\r\n\r\nIsEnabled - under ClientResults\r\n\r\n\r\nIsEnabled  - under ClientUpdates\r\n\r\n\r\nIsEnabled - under Survey\r\n\r\n\r\nHealthIsEnabled \r\n\r\n\r\n\r\nMake sure the following variable is true\r\n\r\n\r\n\r\nHandlersIsEnabled\r\n\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….”\r\n\r\n\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”  set this to -1\r\n\r\n\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\n\r\n\r\n\r\nThere is a “EmailDomainSearchString”, set this to match your domain, you can test your command to make sure it works.  Here’s and example for a domain of sis.uk\r\n\r\n\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=sis,DC=UK’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\n\r\n\r\nI’m not sure what this is used for.\r\n\r\n\r\n\r\nEmail-content.csv \r\n\r\n\r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\n\r\nEmail-reply.csv\r\n\r\n\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\n\r\nEmails-domain.json\r\n\r\n\r\n\r\nThis is a list of all you’re domain users emails, you have to make this\r\n\r\n\r\n\r\nEmails-outside.json\r\n\r\n\r\n\r\nList of external email addresses.  This depends on your range environment, with the Range Global Internet platform from ByLight, we have several email domains, we can just make up emails for these domains and the environment will accept the emails and it doesn’t matter what we use.  The RGI SMTP servers accept it and deletes it.\r\n\r\n\r\n\r\nFilenames.json\r\n\r\n\r\n\r\nList of works that it uses for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\n\r\nHealth.json \r\n\r\n\r\n\r\nIt will check a URL and for reporting health status, we don’t use their management site and we disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\n\r\nTimeline.json\r\n\r\n\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at the sample configs for how to use.\r\n\r\n\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\n\r\n\r\nIf you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.\r\n\r\n\r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder.\r\n\r\n\r\n\r\n\r\nNOTE: on the latest binary release 4.0 the redemption.dll was already there.\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\n\r\n\r\nApp.log\r\n\r\n\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\n\r\n\r\n\r\nClientupdates.log\r\n\r\n\r\n\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n            To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\n\r\nNOTES: \r\n\r\n\r\nGhost can be resource intensive, especially if its throwing errors in the app.log log.  Working on getting the configuration files right so this log is basically empty.  For a reference, mine has only one entry after running work weeks.  Once you’ve tested it and have it working well, copy it over to other workstations.\r\n\r\n\r\nIf you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.\r\n\r\n\r\n',1,'2023-04-10 19:28:37','2023-04-10 19:28:37','ghost-traffic-generation','target-domain-planning-guide','version','','',2),(168,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; There is a script labeled CreateADAccounts.PS1.&nbsp; This is just an example using a company called Widgets inc with a domain of widgets.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; The CreateADAccounts.ps1 script is provided as an example, edit it however you wish.&nbsp;&nbsp; </span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNZ to point to the rootDNS server.&nbsp; </span></p>\r\n<p id=\"bkmrk-email-support---ther\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.&nbsp; </span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.</span></p>\r\n<ul id=\"bkmrk-disable-cortana---ap\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp; </span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-we-use-a-few-more-th\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</span></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two harddrives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails inbetween engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the clearlogs.ps1 and deleteallemails.ps1.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. </span></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</span></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTS</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. </span></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.&nbsp;&nbsp; </span></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Carnegie Mellon, provides a opensource solution called Ghosts. The github is here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"text-decoration: underline;\">https://github.com/cmu-sei/GHOSTS</span>. This can be </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">install a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  There is a script labeled CreateADAccounts.PS1.  This is just an example using a company called Widgets inc with a domain of widgets.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  The CreateADAccounts.ps1 script is provided as an example, edit it however you wish.   \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNZ to point to the rootDNS server.  \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.  \r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSremoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.  \r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to powershell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two harddrives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails inbetween engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the clearlogs.ps1 and deleteallemails.ps1.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls \r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. \r\nRouters \r\nVyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. \r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.   \r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a opensource solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be install a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-10 19:54:23','2023-04-10 19:54:23','general-guidance','target-domain-planning-guide','version','','',6),(169,27,'Blue Space Set up and Management Scripts','','',1,'2023-04-10 22:08:06','2023-04-10 22:08:06','blue-space-set-up-and-management-scripts','target-domain-planning-guide','version','','Initial publish',1),(172,27,'Blue Space Set up and Management Scripts','<ul id=\"bkmrk-cleanlogs.ps1-is-des\">\r\n<li class=\"null\">CleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space on the exchange.&nbsp; This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">DeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space and the size of the .edb mail database.&nbsp; This script is ussually ran in conjunction with CleanLogs.ps1.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.&nbsp; This will also create user defined AD groups and assign the new user to these groups.&nbsp; This is a template, feel free to modify to meet the needs you have for your environment.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a><br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/3\" target=\"_blank\" rel=\"noopener\">CreateMailboxes.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">\r\n</ul>','\r\nCleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space on the exchange.  This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n\r\nCleanLogs.ps1\r\n\r\n\r\nDeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space and the size of the .edb mail database.  This script is ussually ran in conjunction with CleanLogs.ps1.\r\n\r\nDeleteAllEmails.ps1\r\n\r\n\r\nCreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.  This will also create user defined AD groups and assign the new user to these groups.  This is a template, feel free to modify to meet the needs you have for your environment.\r\n\r\nCreateADUsers.ps1\r\n\r\n\r\nCreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n\r\nCreateMailboxes.ps1\r\n\r\n\r\n\r\n',1,'2023-04-10 22:27:10','2023-04-10 22:27:10','blue-space-set-up-and-management-scripts','target-domain-planning-guide','version','','',3),(173,27,'Blue Space Set up and Management Scripts','<ul id=\"bkmrk-cleanlogs.ps1-is-des\">\r\n<li class=\"null\">CleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space on the exchange.&nbsp; This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">DeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space and the size of the .edb mail database.&nbsp; This script is ussually ran in conjunction with CleanLogs.ps1.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.&nbsp; This will also create user defined AD groups and assign the new user to these groups.&nbsp; This is a template, feel free to modify to meet the needs you have for your environment.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a><br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/3\" target=\"_blank\" rel=\"noopener\">CreateMailboxes.ps1</a></li>\r\n</ul>\r\n</li>\r\n</ul>','\r\nCleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space on the exchange.  This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n\r\nCleanLogs.ps1\r\n\r\n\r\nDeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space and the size of the .edb mail database.  This script is ussually ran in conjunction with CleanLogs.ps1.\r\n\r\nDeleteAllEmails.ps1\r\n\r\n\r\nCreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.  This will also create user defined AD groups and assign the new user to these groups.  This is a template, feel free to modify to meet the needs you have for your environment.\r\n\r\nCreateADUsers.ps1\r\n\r\n\r\nCreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n\r\nCreateMailboxes.ps1\r\n\r\n\r\n',1,'2023-04-10 22:27:23','2023-04-10 22:27:23','blue-space-set-up-and-management-scripts','target-domain-planning-guide','version','','',4),(176,27,'Blue Space Set up and Management Scripts','<ul id=\"bkmrk-cleanlogs.ps1-is-des\">\r\n<li class=\"null\">CleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space on the exchange.&nbsp; This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">DeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space and the size of the .edb mail database.&nbsp; This script is ussually ran in conjunction with CleanLogs.ps1.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.&nbsp; This will also create user defined AD groups and assign the new user to these groups.&nbsp; This is a template, feel free to modify to meet the needs you have for your environment.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a><br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/3\" target=\"_blank\" rel=\"noopener\">CreateMailboxes.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Range-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.&nbsp; This script needs to be ran from the management network and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n<ul id=\"bkmrk-%C2%A0range-management.ps\">\r\n<li class=\"null\">&nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></li>\r\n</ul>\r\n</li>\r\n</ul>','\r\nCleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space on the exchange.  This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n\r\nCleanLogs.ps1\r\n\r\n\r\nDeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space and the size of the .edb mail database.  This script is ussually ran in conjunction with CleanLogs.ps1.\r\n\r\nDeleteAllEmails.ps1\r\n\r\n\r\nCreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.  This will also create user defined AD groups and assign the new user to these groups.  This is a template, feel free to modify to meet the needs you have for your environment.\r\n\r\nCreateADUsers.ps1\r\n\r\n\r\nCreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n\r\nCreateMailboxes.ps1\r\n\r\n\r\nRange-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.  This script needs to be ran from the management network and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n\r\n Range-Management.ps1\r\n\r\n\r\n',1,'2023-04-10 23:18:57','2023-04-10 23:18:57','blue-space-set-up-and-management-scripts','target-domain-planning-guide','version','','',5),(177,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documenation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; </span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.&nbsp; </span></p>\r\n<p id=\"bkmrk-email-support---ther\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.&nbsp; </span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.</span></p>\r\n<ul id=\"bkmrk-disable-cortana---ap\" style=\"margin-top: 0; margin-bottom: 0; padding-inline-start: 48px;\">\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp; </span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></p>\r\n</li>\r\n<li style=\"list-style-type: disc; font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre; margin-left: 36pt;\" aria-level=\"1\">\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" role=\"presentation\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-we-use-a-few-more-th\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</span></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a>.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. </span></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</span></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTS</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. </span></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a> </span></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"text-decoration: underline;\">https://github.com/cmu-sei/GHOSTS</span>. This can be </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  This documenation includes the PowerShell script CreateADUsers.ps1.  This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.  \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.  \r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\n\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\n\r\n\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\n\r\n\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.  \r\n\r\n\r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\n\r\n\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls \r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. \r\nRouters \r\nVyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. \r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1 \r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-10 23:20:11','2023-04-10 23:20:11','general-guidance','target-domain-planning-guide','version','','',7),(179,2,'Network Diagram','<div drawio-diagram=\"163\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span> - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span> - The SI-Router will route approx 1500 IP subnets.&nbsp; These subnets are organized by Geo-locations on the NRTS server.&nbsp; To see a list of available subnets and corresponding Geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various red team infrastructure services.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span> - This is used as a network to allow all Cyber Range VMs access to the real internet using a squid proxy on the IA-Proxy server.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span> - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServiceNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration to to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an&nbsp; openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; How to Guides -&gt; Importing CA certificates in a target domain.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; How to Guides - Target Domain Planning and Connection.<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will route approx 1500 IP subnets.  These subnets are organized by Geo-locations on the NRTS server.  To see a list of available subnets and corresponding Geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various red team infrastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet using a squid proxy on the IA-Proxy server.\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration to to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an  openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> How to Guides -> Importing CA certificates in a target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> How to Guides - Target Domain Planning and Connection.\r\n',1,'2023-04-10 23:31:56','2023-04-10 23:31:56','network-diagram','network-overview','version','','',7),(181,2,'Network Diagram','<div drawio-diagram=\"163\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; How to Guides -&gt; Importing CA certificates in a target domain.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; How to Guides - Target Domain Planning and Connection.<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> How to Guides -> Importing CA certificates in a target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> How to Guides - Target Domain Planning and Connection.\r\n',1,'2023-04-10 23:45:39','2023-04-10 23:45:39','network-diagram','network-overview','version','','',8),(182,28,'Importing CA and intermediate Certs to your Target Domain','','',1,'2023-04-10 23:46:25','2023-04-10 23:46:25','importing-ca-and-intermediate-certs-to-your-target-domain','target-domain-planning-guide','version','','Initial publish',1),(184,28,'Importing CA and intermediate Certs to your Target Domain','<p id=\"bkmrk-the-cyber-range-envi\">The Cyber Range environment will create a CA and intermediate Authority.&nbsp; This is used to simulate real world SSL signing services like Digicert or Verisign.&nbsp; By default, the Cyber Range installation will create one called globalcerts.com.&nbsp; These CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.&nbsp; These certs need to be imported into the trust stores of your windows based target systems.&nbsp; Below are the instructions for doing so.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-obtain-the-\">Step 1.&nbsp; Obtain the certs from the CA-Server</p>\r\n<ul id=\"bkmrk-from-your-target-dom\">\r\n<li class=\"null\">From your target domain, scp these certs off of the CA-server.\r\n<ul>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem&nbsp; ca.globalcert.com.crt.pem</li>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-2.%C2%A0-move-these-\">Step 2.&nbsp; Move these certs to your Active Directory server, and create a GPO to add these to the trust store.</p>\r\n<ul id=\"bkmrk-on-the-dc%2C-open-%22gro\">\r\n<li class=\"null\">On the DC, open \"Group Policy Management\"</li>\r\n<li class=\"null\">First, well add the CA certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Trusted Root Certificate Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Next import, the intermediate certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Intermediate Certification Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-3.%C2%A0-close-the-%22\">Step 3.&nbsp; Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.&nbsp; Then from a target VM browse to https://redbook.com and see can get there without a SSL warning.</p>','The Cyber Range environment will create a CA and intermediate Authority.  This is used to simulate real world SSL signing services like Digicert or Verisign.  By default, the Cyber Range installation will create one called globalcerts.com.  These CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.  These certs need to be imported into the trust stores of your windows based target systems.  Below are the instructions for doing so.\r\nStep 1.  Obtain the certs from the CA-Server\r\n\r\nFrom your target domain, scp these certs off of the CA-server.\r\n\r\nscp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem  ca.globalcert.com.crt.pem\r\nscp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem\r\n\r\n\r\n\r\nStep 2.  Move these certs to your Active Directory server, and create a GPO to add these to the trust store.\r\n\r\nOn the DC, open \"Group Policy Management\"\r\nFirst, well add the CA certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Trusted Root Certificate Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\nNext import, the intermediate certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Intermediate Certification Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\n\r\nStep 3.  Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.  Then from a target VM browse to https://redbook.com and see can get there without a SSL warning.',1,'2023-04-11 00:13:59','2023-04-11 00:13:59','importing-ca-and-intermediate-certs-to-your-target-domain','target-domain-planning-guide','version','','',2),(185,28,'Importing CA and Int Certs to your Target Domain','<p id=\"bkmrk-the-cyber-range-envi\">The Cyber Range environment will create a CA and intermediate Authority.&nbsp; This is used to simulate real world SSL signing services like Digicert or Verisign.&nbsp; By default, the Cyber Range installation will create one called globalcerts.com.&nbsp; These CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.&nbsp; These certs need to be imported into the trust stores of your windows based target systems.&nbsp; Below are the instructions for doing so.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-obtain-the-\">Step 1.&nbsp; Obtain the certs from the CA-Server</p>\r\n<ul id=\"bkmrk-from-your-target-dom\">\r\n<li class=\"null\">From your target domain, scp these certs off of the CA-server.\r\n<ul>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem&nbsp; ca.globalcert.com.crt.pem</li>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-2.%C2%A0-move-these-\">Step 2.&nbsp; Move these certs to your Active Directory server, and create a GPO to add these to the trust store.</p>\r\n<ul id=\"bkmrk-on-the-dc%2C-open-%22gro\">\r\n<li class=\"null\">On the DC, open \"Group Policy Management\"</li>\r\n<li class=\"null\">First, well add the CA certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Trusted Root Certificate Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Next import, the intermediate certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Intermediate Certification Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-3.%C2%A0-close-the-%22\">Step 3.&nbsp; Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.&nbsp; Then from a target VM browse to https://redbook.com and see can get there without a SSL warning.</p>','The Cyber Range environment will create a CA and intermediate Authority.  This is used to simulate real world SSL signing services like Digicert or Verisign.  By default, the Cyber Range installation will create one called globalcerts.com.  These CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.  These certs need to be imported into the trust stores of your windows based target systems.  Below are the instructions for doing so.\r\nStep 1.  Obtain the certs from the CA-Server\r\n\r\nFrom your target domain, scp these certs off of the CA-server.\r\n\r\nscp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem  ca.globalcert.com.crt.pem\r\nscp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem\r\n\r\n\r\n\r\nStep 2.  Move these certs to your Active Directory server, and create a GPO to add these to the trust store.\r\n\r\nOn the DC, open \"Group Policy Management\"\r\nFirst, well add the CA certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Trusted Root Certificate Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\nNext import, the intermediate certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Intermediate Certification Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\n\r\nStep 3.  Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.  Then from a target VM browse to https://redbook.com and see can get there without a SSL warning.',1,'2023-04-11 00:14:19','2023-04-11 00:14:19','importing-ca-and-int-certs-to-your-target-domain','target-domain-planning-guide','version','','',3),(187,2,'Network Diagram','<div drawio-diagram=\"163\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; How to Guides - Target Domain Planning and Connection.<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> How to Guides - Target Domain Planning and Connection.\r\n',1,'2023-04-11 00:17:03','2023-04-11 00:17:03','network-diagram','network-overview','version','','',9),(188,29,'Connecting a Target Domain to the Cyber Range','<p id=\"bkmrk-connecting-a-blue-sp\">Connecting a blue space is fairly straight foward.&nbsp; You can have a single WAN point for a blue space or as many as you would like.&nbsp; You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.&nbsp; Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.</p>\r\n<p id=\"bkmrk-below-is-the-simply-\">Below is the simply blue space example.</p>\r\n<div drawio-diagram=\"165\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155829.png\"></div>\r\n<p id=\"bkmrk-in-the-diagram-above\">In the diagram above, your Target Domain is built on another ESXI server.&nbsp; On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.&nbsp; Then this virtual switch will need an uplink that connects to a physical NIC on the host server.&nbsp; Then on the ESXI server running the Cyber Range environment, you\'ll need to add a uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.&nbsp; Then connect a line between those two physical switches.&nbsp;&nbsp;</p>\r\n<p id=\"bkmrk-next%2C-you-need-to-ip\">Next, you need to IP this connection.&nbsp; You can pick whatever IP you want for your WAN interface on your target network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.&nbsp; A good way to check your IP is to grep it against the Geo-Location IP folder structure on the NRTS server.&nbsp; Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.</p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fbackbonerou\"><code class=\"language-\">cd /root/backbonerouters\r\ngrep 44.22.1 */*</code></pre>\r\n<p id=\"bkmrk-above-we-are-greppin\">Above we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.&nbsp; This will find all possible matches.&nbsp; Then you just have to make sure that the IP/subnet doesn\'t fall into an existing IP/subnet.&nbsp; If your grep comes back empty, you are good to go with the IP you selected.&nbsp; Typically for a WAN connection, a /29 subnet is a reasonable choice.&nbsp;&nbsp; For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,&nbsp; the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.&nbsp; We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.&nbsp; Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.&nbsp; Below are the instructions for this.</p>\r\n<ul id=\"bkmrk-console-into-the-si-\">\r\n<li class=\"null\">Console into the SI-Router on the Cyber Range.</li>\r\n<li class=\"null\">Then edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source-\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<ul id=\"bkmrk-then-save-the-script\">\r\n<li class=\"null\">Then save the script and run it with ./Eth3RangeWAN.sh.&nbsp; That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.</li>\r\n</ul>\r\n<p id=\"bkmrk-adding-additional-ta\">Adding additional target domains is basically the same.&nbsp; For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.&nbsp; Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.&nbsp; For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.&nbsp; The Eth3RangeWAN.sh script would look like the following.&nbsp; Then we just run the script again.&nbsp; You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the route will just move on and then add the second IP gateway of 44.33.11.1 to the interface.</p>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source--1\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<p id=\"bkmrk-note%3A-you%27ll-need-a-\">NOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.&nbsp; ESXI virtual switches are limited to a single uplink, well technically you can have 4, but they can only be configured as teamed or fail over ports.&nbsp; So essentially it\'s like a single logical port.&nbsp; So to connect multiples, you\'ll just need to put a switch between your connections between target domain connections and to the Cyber Range RangeWAN uplink port.</p>','Connecting a blue space is fairly straight foward.  You can have a single WAN point for a blue space or as many as you would like.  You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.  Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.\r\nBelow is the simply blue space example.\r\n\r\nIn the diagram above, your Target Domain is built on another ESXI server.  On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.  Then this virtual switch will need an uplink that connects to a physical NIC on the host server.  Then on the ESXI server running the Cyber Range environment, you\'ll need to add a uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.  Then connect a line between those two physical switches.  \r\nNext, you need to IP this connection.  You can pick whatever IP you want for your WAN interface on your target network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.  A good way to check your IP is to grep it against the Geo-Location IP folder structure on the NRTS server.  Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.\r\ncd /root/backbonerouters\r\ngrep 44.22.1 */*\r\nAbove we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.  This will find all possible matches.  Then you just have to make sure that the IP/subnet doesn\'t fall into an existing IP/subnet.  If your grep comes back empty, you are good to go with the IP you selected.  Typically for a WAN connection, a /29 subnet is a reasonable choice.   For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,  the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.  We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.  Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.  Below are the instructions for this.\r\n\r\nConsole into the SI-Router on the Cyber Range.\r\nThen edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following\r\n\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\n\r\nThen save the script and run it with ./Eth3RangeWAN.sh.  That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.\r\n\r\nAdding additional target domains is basically the same.  For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.  Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.  For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.  The Eth3RangeWAN.sh script would look like the following.  Then we just run the script again.  You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the route will just move on and then add the second IP gateway of 44.33.11.1 to the interface.\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\nNOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.  ESXI virtual switches are limited to a single uplink, well technically you can have 4, but they can only be configured as teamed or fail over ports.  So essentially it\'s like a single logical port.  So to connect multiples, you\'ll just need to put a switch between your connections between target domain connections and to the Cyber Range RangeWAN uplink port.',1,'2023-04-11 01:08:33','2023-04-11 01:08:33','connecting-a-target-domain-to-the-cyber-range','target-domain-planning-guide','version','','Initial publish',1),(190,2,'Network Diagram','<div drawio-diagram=\"163\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-11 01:10:28','2023-04-11 01:10:28','network-diagram','network-overview','version','','',10),(192,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - (Googles recursive DNS server)</li>\r\n<li class=\"null\">198.41.0.4 - (A-root server)</li>\r\n<li class=\"null\">192.228.79.59 - (B-root server)</li>\r\n<li class=\"null\">192.33.4.12 - (C-root server)</li>\r\n<li class=\"null\">128.8.10.90 - (D-root server)</li>\r\n<li class=\"null\">192.203.230.10 - (E-root server)</li>\r\n<li class=\"null\">195.5.5.241 - (F-root server)</li>\r\n<li class=\"null\">192.112.36.4 - (G-root server)</li>\r\n<li class=\"null\">128.63.2.53 - (H-root server)</li>\r\n<li class=\"null\">192.36.148.17 - (I-root server)</li>\r\n<li class=\"null\">192.58.128.30 - (J-root server)</li>\r\n<li class=\"null\">193.0.15.129 - (K-root server)</li>\r\n<li class=\"null\">199.7.83.42 - (L-root server)</li>\r\n<li class=\"null\">202.12.27.33 - (M-root server)</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server in the Cyber Range handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE:&nbsp; For more information on using the scripts referenced above that reside on the NRTS; /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a><br></li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check your modification of the named.conf.RANGE file.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either check errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n<li class=\"null\">NOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - (Googles recursive DNS server)\r\n198.41.0.4 - (A-root server)\r\n192.228.79.59 - (B-root server)\r\n192.33.4.12 - (C-root server)\r\n128.8.10.90 - (D-root server)\r\n192.203.230.10 - (E-root server)\r\n195.5.5.241 - (F-root server)\r\n192.112.36.4 - (G-root server)\r\n128.63.2.53 - (H-root server)\r\n192.36.148.17 - (I-root server)\r\n192.58.128.30 - (J-root server)\r\n193.0.15.129 - (K-root server)\r\n199.7.83.42 - (L-root server)\r\n202.12.27.33 - (M-root server)\r\n\r\nThe RootDNS server in the Cyber Range handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and append the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE:  For more information on using the scripts referenced above that reside on the NRTS; /root/scripts/buildredteam.sh, /root/scripts/ManageDNS.sh and /root/scripts/RegisterDNS.sh, go to -> Using the NRTS \r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check your modification of the named.conf.RANGE file.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either check errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\nNOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.\r\n\r\n\r\n',1,'2023-04-11 17:07:44','2023-04-11 17:07:44','rootdns','cyber-range-systems-overview','version','','',7),(194,5,'Web-Services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">These directories contain the config files needed for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n<li class=\"null\">docker cp bookstack:/app/www/public/uploads/images .<br></li>\r\n<li class=\"null\">docker cp bookstack:/app/www/storage/uploads .</li>\r\n<li class=\"null\">tar -czxf redbook-images-backup.tar.gz images</li>\r\n<li class=\"null\">tar -czvf redbook-files-backup.tar.gz uploads</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n<li class=\"null\">tar -xvzf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp images bookstack:/app/www/public/uploads/</li>\r\n<li class=\"null\">tar -xvzf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp uploads bookstack:/app/www/storage/</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nThese directories contain the config files needed for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups here is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\ndocker cp bookstack:/app/www/public/uploads/images .\r\ndocker cp bookstack:/app/www/storage/uploads .\r\ntar -czxf redbook-images-backup.tar.gz images\r\ntar -czvf redbook-files-backup.tar.gz uploads\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\ntar -xvzf redbook-files-backup.tar.gz\r\ndocker cp images bookstack:/app/www/public/uploads/\r\ntar -xvzf redbook-files-backup.tar.gz\r\ndocker cp uploads bookstack:/app/www/storage/\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',1,'2023-04-11 17:16:39','2023-04-11 17:16:39','web-services','cyber-range-systems-overview','version','','',4),(196,6,'CA-Server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using the domain of globalcert.com.&nbsp; To create new SSL certs or to sign binaries, you can use scripts that exist on this server.&nbsp; The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.&nbsp; For more information on this go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a>.&nbsp; That said, if you want to generate these manually, below is an overview of scripts on the CA-server.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs and then sign these with the intermediate cert.&nbsp; The script has a help menu that is pretty self explanatory.&nbsp; below is the help menu that lists the various flags.</li>\r\n<li class=\"null\">\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/A2limage.png\" alt=\"image.png\"></p>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-an-example-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is an example for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using the domain of globalcert.com.  To create new SSL certs or to sign binaries, you can use scripts that exist on this server.  The NRTS will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.  For more information on this go to -> Cyber Range Systems Overview -> NRTS.  That said, if you want to generate these manually, below is an overview of scripts on the CA-server.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs and then sign these with the intermediate cert.  The script has a help menu that is pretty self explanatory.  below is the help menu that lists the various flags.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is an example for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n',1,'2023-04-11 17:22:05','2023-04-11 17:22:05','ca-server','cyber-range-systems-overview','version','','',6),(198,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email corpus was pulled using the Enron data dump.&nbsp; About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into databases.&nbsp; It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.&nbsp; The functionality of this is very customization.&nbsp; Here is an overview of how this server is used to generate email traffic.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/stoptrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the build-compose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.&nbsp; NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.&nbsp; Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.&nbsp; Also the IP subnet you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that IP subnet gateway IP to the SI-Router.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from publicly available databases of the Enron data mentioned earlier.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain that you connect to the Cyber Range.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.&nbsp; Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.&nbsp; For more information for setting up the traffic-gen to send emails to your target domain go to -&gt; How to Guides -&gt; Setting up the Traffic-Gen.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email corpus was pulled using the Enron data dump.  About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into databases.  It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.  The functionality of this is very customization.  Here is an overview of how this server is used to generate email traffic.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/stoptrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the build-compose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.  NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.  Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.  Also the IP subnet you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that IP subnet gateway IP to the SI-Router.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from publicly available databases of the Enron data mentioned earlier.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain that you connect to the Cyber Range.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.  Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.  Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.  For more information for setting up the traffic-gen to send emails to your target domain go to -> How to Guides -> Setting up the Traffic-Gen.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',1,'2023-04-11 17:32:11','2023-04-11 17:32:11','traffic-gen','cyber-range-systems-overview','version','','',6),(200,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems.&nbsp; There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a>.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.&nbsp; Its structured by Geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.&nbsp; &nbsp;This folder structure is used by other scripts on the NRTS to generator IP addresses.&nbsp; NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.&nbsp; Additionally for other OPFOR systems you want to add, you can use this list to pick an IP for that system.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul id=\"bkmrk-this-is-another-tool\">\r\n<li class=\"null\">This is another tool for generating Cobalt&nbsp;Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.&nbsp; NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever Go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildredteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.&nbsp; The script can also be used to set up the NRTS for phishing attacks.&nbsp; Go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a>for guides on how to set up all of these services.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage DNS records that get added to the rootDNS server.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS </a>for a guide on how use this script.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new DNS records that will get added to the rootDNS server.&nbsp; Go to -&gt; How to guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/manual-domain-registration\">Manual Domain Registration</a> for instructions on this script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/phishing-attack-buildredteamsh\">Phishing Attack</a> for instructions on the scripts below.<br></li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems.  There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -> Using the NRTS.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structured by Geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.  Additionally for other OPFOR systems you want to add, you can use this list to pick an IP for that system.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever Go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildredteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -> Using the NRTS for guides on how to set up all of these services.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage DNS records that get added to the rootDNS server.  Go to -> Using the NRTS -> Managing DNS for a guide on how use this script.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new DNS records that will get added to the rootDNS server.  Go to -> How to guides -> Manual Domain Registration for instructions on this script.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.  Go to -> Using the NRTS -> Phishing Attack for instructions on the scripts below.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n\r\n',1,'2023-04-11 18:22:32','2023-04-11 18:22:32','nrts','cyber-range-systems-overview','version','','',5),(202,10,'Manual Domain Registration','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS.</a><br></p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> Managing DNS.',1,'2023-04-11 18:26:09','2023-04-11 18:26:09','manual-domain-registration','how-to-guides','version','','',13),(203,30,'Setting up the Traffic-Gen for a Target Domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each external sender source domain and then running a script in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up take a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the cyber range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; Adding DNS for your Target Domain.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach a Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; Then next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want to the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 and the Traffic-Gen\'s root account with a password of toor.</p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder of it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml.</p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each external sender source domain and then running a script in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up take a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber range.  See Target Domain Planning Guide -> Connecting a target domain to the cyber range.   Once it\'s connected, make sure you add DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach a Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  Then next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want to the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 and the Traffic-Gen\'s root account with a password of toor.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder of it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml.',1,'2023-04-11 19:55:18','2023-04-11 19:55:18','setting-up-the-traffic-gen-for-a-target-domain','how-to-guides','version','','Initial publish',1),(205,30,'Setting up the Traffic-Gen for a Target Domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each domain that it will use to send emails from.&nbsp; Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up takes a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber Range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the Cyber Range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; Adding DNS for your Target Domain.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.<br></p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder for it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh<br></p>\r\n<pre id=\"bkmrk-cd-root-.%2Fbuidcompos\"><code class=\"language-\">cd root\r\n./buidcompose.sh</code></pre>\r\n<p id=\"bkmrk-when-the-script-firs\">When the script first runs, it preforms some system checks.&nbsp; The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.&nbsp; The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.&nbsp; Below is what you should see if everything checks out.</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/oMfimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oMfimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-if-it-errors%2C-it-wil\">If it errors, it will display the issues, you\'ll need to resolve those before proceeding.&nbsp; If the checks are good it will pop up the following text-based GUI.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8wximage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8wximage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-above-will-show-\">The above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.&nbsp; In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.&nbsp; That said, we\'ll select option 1 for \"GALFED\" and press enter.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Hkdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Hkdimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-script-builds-th\">The script builds the docker-compose.yml and tells you how to start sending emails.&nbsp; Then to kick it off just run the following.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstarttraf\"><code class=\"language-\">cd /root\r\n./starttrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each domain that it will use to send emails from.  Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up takes a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber Range.  See Target Domain Planning Guide -> Connecting a target domain to the Cyber Range.   Once it\'s connected, make sure you add DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder for it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh\r\ncd root\r\n./buidcompose.sh\r\nWhen the script first runs, it preforms some system checks.  The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.  The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.  Below is what you should see if everything checks out.\r\n\r\nIf it errors, it will display the issues, you\'ll need to resolve those before proceeding.  If the checks are good it will pop up the following text-based GUI.\r\n\r\nThe above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.  In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.  That said, we\'ll select option 1 for \"GALFED\" and press enter.\r\n\r\nThe script builds the docker-compose.yml and tells you how to start sending emails.  Then to kick it off just run the following.\r\ncd /root\r\n./starttrafficgen.sh\r\n ',1,'2023-04-11 22:32:36','2023-04-11 22:32:36','setting-up-the-traffic-gen-for-a-target-domain','how-to-guides','version','','',2),(207,30,'Setting up the Traffic-Gen for a Target Domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each domain that it will use to send emails from.&nbsp; Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up takes a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber Range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the Cyber Range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; Adding DNS for your Target Domain.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.<br></p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder for it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh<br></p>\r\n<pre id=\"bkmrk-cd-root-.%2Fbuidcompos\"><code class=\"language-\">cd root\r\n./buidcompose.sh</code></pre>\r\n<p id=\"bkmrk-when-the-script-firs\">When the script first runs, it preforms some system checks.&nbsp; The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.&nbsp; The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.&nbsp; Below is what you should see if everything checks out.</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/oMfimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oMfimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-if-it-errors%2C-it-wil\">If it errors, it will display the issues, you\'ll need to resolve those before proceeding.&nbsp; If the checks are good it will pop up the following text-based GUI.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8wximage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8wximage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-above-will-show-\">The above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.&nbsp; In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.&nbsp; That said, we\'ll select option 1 for \"GALFED\" and press enter.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Hkdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Hkdimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-script-builds-th\">The script builds the docker-compose.yml and tells you how to start sending emails.&nbsp; Then to kick it off just run the following.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstarttraf\"><code class=\"language-\">cd /root\r\n./starttrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-if-everything-went-w\">If everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/GJgimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GJgimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-at-this-point-you-ca\">At this point you can check your traffic logs - these are located at /root/TG/TrafficLog.&nbsp; There is a log for each emailing domains.&nbsp; You can tail all the logs at once with the following.</p>\r\n<pre id=\"bkmrk-tail--f-%2Froot%2Ftg%2Ftra\"><code class=\"language-\">tail -f /root/TG/TrafficLog/*</code></pre>\r\n<p id=\"bkmrk-here-is-a-sample-out\">Here is a sample output.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Iz8image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Iz8image.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\">To stop the Traffic-Gen run the following<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstoptraff\"><code class=\"language-\">cd /root\r\n./stoptrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-output-will-look-lik\">output will look like.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JBlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JBlimage.png\" alt=\"image.png\"></a></p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each domain that it will use to send emails from.  Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up takes a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber Range.  See Target Domain Planning Guide -> Connecting a target domain to the Cyber Range.   Once it\'s connected, make sure you add DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder for it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh\r\ncd root\r\n./buidcompose.sh\r\nWhen the script first runs, it preforms some system checks.  The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.  The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.  Below is what you should see if everything checks out.\r\n\r\nIf it errors, it will display the issues, you\'ll need to resolve those before proceeding.  If the checks are good it will pop up the following text-based GUI.\r\n\r\nThe above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.  In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.  That said, we\'ll select option 1 for \"GALFED\" and press enter.\r\n\r\nThe script builds the docker-compose.yml and tells you how to start sending emails.  Then to kick it off just run the following.\r\ncd /root\r\n./starttrafficgen.sh\r\nIf everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.\r\n\r\nAt this point you can check your traffic logs - these are located at /root/TG/TrafficLog.  There is a log for each emailing domains.  You can tail all the logs at once with the following.\r\ntail -f /root/TG/TrafficLog/*\r\nHere is a sample output.\r\n\r\nTo stop the Traffic-Gen run the following\r\ncd /root\r\n./stoptrafficgen.sh\r\noutput will look like.\r\n',1,'2023-04-11 23:08:59','2023-04-11 23:08:59','setting-up-the-traffic-gen-for-a-target-domain','how-to-guides','version','','',3),(208,30,'Setting up the Traffic-Gen for a Target Domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each domain that it will use to send emails from.&nbsp; Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up takes a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber Range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the Cyber Range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; Adding DNS for your Target Domain.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.<br></p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder for it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh<br></p>\r\n<pre id=\"bkmrk-cd-root-.%2Fbuidcompos\"><code class=\"language-\">cd root\r\n./buidcompose.sh</code></pre>\r\n<p id=\"bkmrk-when-the-script-firs\">When the script first runs, it preforms some system checks.&nbsp; The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.&nbsp; The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.&nbsp; Below is what you should see if everything checks out.</p>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/oMfimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oMfimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-if-it-errors%2C-it-wil\">If it errors, it will display the issues, you\'ll need to resolve those before proceeding.&nbsp; If the checks are good it will pop up the following text-based GUI.</p>\r\n<p id=\"bkmrk--1\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8wximage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8wximage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-above-will-show-\">The above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.&nbsp; In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.&nbsp; That said, we\'ll select option 1 for \"GALFED\" and press enter.</p>\r\n<p id=\"bkmrk--2\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Hkdimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Hkdimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-the-script-builds-th\">The script builds the docker-compose.yml and tells you how to start sending emails.&nbsp; Then to kick it off just run the following.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstarttraf\"><code class=\"language-\">cd /root\r\n./starttrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-if-everything-went-w\">If everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.</p>\r\n<p id=\"bkmrk--3\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/GJgimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GJgimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-at-this-point-you-ca\">At this point you can check your traffic logs - these are located at /root/TG/TrafficLog.&nbsp; There is a log for each emailing domains.&nbsp; You can tail all the logs at once with the following.</p>\r\n<pre id=\"bkmrk-tail--f-%2Froot%2Ftg%2Ftra\"><code class=\"language-\">tail -f /root/TG/TrafficLog/*</code></pre>\r\n<p id=\"bkmrk-here-is-a-sample-out\">Here is a sample output.</p>\r\n<p id=\"bkmrk--4\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/Iz8image.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Iz8image.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\">To stop the Traffic-Gen run the following<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstoptraff\"><code class=\"language-\">cd /root\r\n./stoptrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-output-will-look-lik\">output will look like.</p>\r\n<p id=\"bkmrk--5\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/JBlimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JBlimage.png\" alt=\"image.png\"></a></p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each domain that it will use to send emails from.  Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up takes a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber Range.  See Target Domain Planning Guide -> Connecting a target domain to the Cyber Range.   Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\nWhen you run the above command, you should get a response from your target domain exchange server that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder for it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh\r\ncd root\r\n./buidcompose.sh\r\nWhen the script first runs, it preforms some system checks.  The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.  The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains associated to the IPs resolve correctly.  Below is what you should see if everything checks out.\r\n\r\nIf it errors, it will display the issues, you\'ll need to resolve those before proceeding.  If the checks are good it will pop up the following text-based GUI.\r\n\r\nThe above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.  In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.  That said, we\'ll select option 1 for \"GALFED\" and press enter.\r\n\r\nThe script builds the docker-compose.yml and tells you how to start sending emails.  Then to kick it off just run the following.\r\ncd /root\r\n./starttrafficgen.sh\r\nIf everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.\r\n\r\nAt this point you can check your traffic logs - these are located at /root/TG/TrafficLog.  There is a log for each emailing domains.  You can tail all the logs at once with the following.\r\ntail -f /root/TG/TrafficLog/*\r\nHere is a sample output.\r\n\r\nTo stop the Traffic-Gen run the following\r\ncd /root\r\n./stoptrafficgen.sh\r\noutput will look like.\r\n',1,'2023-04-11 23:19:08','2023-04-11 23:19:08','setting-up-the-traffic-gen-for-a-target-domain','how-to-guides','version','','',4),(209,31,'Adding DNS for your Target Domain','<p id=\"bkmrk-the-target-domains-y\">The target domains you connect to the Cyber Range will most likely have publicly available services, for example maybe a public facing website and/or email services.&nbsp; For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.&nbsp; Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.&nbsp; Adding Target Domain DNS to the RootDNS server is a purely manual process.&nbsp; This guide is to help get that set up with a few examples.&nbsp;</p>\r\n<p id=\"bkmrk-example-1---your-tar\"><span style=\"text-decoration: underline;\"><strong>Example 1 </strong></span>- Your target domain is called widgets.com and has a public facing website and a mail server.&nbsp; For the purpose of this guide we\'ll assume that you have already completed the Target Domain Planning Guide -&gt; Connecting a Target Domain to the Cyber Range.&nbsp;&nbsp; Additionally during that part, you decided to use 44.22.11.10/29 for your firewall WAN connection.&nbsp; Then set up a port forward to on 44.22.11.10 to&nbsp; send port 80 and 443 to your public facing website, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to your target domains exchange server.&nbsp;&nbsp;&nbsp; Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th\">Step 1.&nbsp; Log into the RootDNS server.&nbsp; Then create a zone file in the /etc/bind/RANGE directory.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind%2Frange-v\"><code class=\"language-\">cd /etc/bind/RANGE\r\nvi db.widgets.com</code></pre>\r\n<p id=\"bkmrk-next-we-need-to-put-\">Next we need to put the following in the db.widgets.com zone file.</p>\r\n<pre id=\"bkmrk-%3B-widgets-blue-space\"><code class=\"language-\">; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4</code></pre>\r\n<p id=\"bkmrk-so-lets-explain-this\">So lets explain this line by line.</p>\r\n<ul id=\"bkmrk-line-1%C2%A0-%22%3B-widgets-b\">\r\n<li class=\"null\">Line 1&nbsp; \"; Widgets blue space DNS\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is just a comment, in a zone file you can add comments using a \";\".\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">NOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Line 2&nbsp; \"$TTL&nbsp;&nbsp;&nbsp;&nbsp; 88640\"&nbsp;&nbsp; This is the time in seconds that caching DNS servers should cache this record.</li>\r\n<li class=\"null\">Line 3 \"@&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp; @&nbsp;&nbsp; ns.widgets.com.&nbsp; 42 3H 15M 1W 1D\"&nbsp;&nbsp; This is the Start of Authority (SOA)&nbsp; for the domain.&nbsp; The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL</li>\r\n<li class=\"null\">Line 4 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns.widgets.com.\"&nbsp;&nbsp; This is setting the NameServer for the domain to the domain of ns.widgets.com</li>\r\n<li class=\"null\">Line 5 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp; widgets.com.\"&nbsp; This is setting the MX (mail server) domain to widgets.com.&nbsp; The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.</li>\r\n<li class=\"null\">Line 6 \"@&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp; 44.22.11.11\" .&nbsp; The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.&nbsp; This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.</li>\r\n<li class=\"null\">Line 7 \"www&nbsp;&nbsp; IN&nbsp;&nbsp; A&nbsp; 44.22.11.10\".&nbsp;&nbsp;&nbsp; This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.</li>\r\n<li class=\"null\">Line 8 \"owa&nbsp; IN&nbsp;&nbsp; A&nbsp;&nbsp; 44.22.11.11\".&nbsp; This sets the subdomain of owa to 44.22.11.11, this will allow HTTPS connections to our mailserver from the Cyber Range space using <a href=\"https://owa.widgets.com\">https://owa.widgets.com</a></li>\r\n<li class=\"null\">Line 9 \"ns&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; A 198.41.0.4\".&nbsp; This sets the subdomain of NS, which is also listed as the domains nameserver to the IP of 198.41.0.4.&nbsp; The IP 198.41.0.4 is an IP on the rootDNS server itself.&nbsp; This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.&nbsp; IPv6 records at set using \"AAAA\" verse \"A\".&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-step-2%3A%C2%A0-now-that-we\">Step 2:&nbsp; Now that we create the zone file, we should test it to make sure there are no syntax errors.&nbsp; You can do this on the RootDNS server using the following command.&nbsp;</p>\r\n<pre id=\"bkmrk-named-checkzone-%3Cdom\"><code class=\"language-\">named-checkzone &lt;domainname&gt; &lt;zonefile&gt;</code></pre>\r\n<p id=\"bkmrk-below-is-an-example.\">below is an example.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KSvimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-2.%C2%A0-once-you-ha\">Step 2.&nbsp; Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file.&nbsp;</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file\">Then append the file with the following syntax.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com.%22-\"><code class=\"language-\">zone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};</code></pre>\r\n<p id=\"bkmrk-when-you-are-done%2C-y\">When you are done, you can check that the named.conf.RANGE file doesn\'t have syntax errors with the following.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-named-c\"><code class=\"language-\">cd /etc/bind\r\nnamed-checkconf named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-if-are-no-errors%2C-yo\">If are no errors, you will get nothing back, below is an example output or a good check.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sY0image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-3.%C2%A0-now-that-we\">Step 3.&nbsp; Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.&nbsp; Do this with the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar\"><code class=\"language-\">service bind9 restart\r\n\r\n#  Then run the following to make sure bind is running\r\n\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-output-should-look-l\">Output should look like</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bj5image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-next%2C-run-a-nslookup\">Next, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2pHimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-example-2.%C2%A0-for-this\"><span style=\"text-decoration: underline;\"><strong>Example 2</strong></span>.&nbsp; For this example, we will be running a DNS nameserver within our Target Domain.&nbsp; Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.&nbsp; We\'ll use the domain of widgets.com also.&nbsp; In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.&nbsp; Instead we will be adding a forwarder in the RootDNS\'s&nbsp; named.conf.RANGE file.&nbsp; Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th-1\">Step 1.&nbsp; Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name-1\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file-1\">Then append the file with the following.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com%22-%7B\"><code class=\"language-\">zone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};</code></pre>\r\n<p id=\"bkmrk-step-2.%C2%A0-check-your-\">Step 2.&nbsp; Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.&nbsp;&nbsp; If that passes, run the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar-1\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-then-you-can-test-yo\">Then you can test your DNS again using nslookup.&nbsp; What this looks like depends on how you configured your target domain nameserver.</p>','The target domains you connect to the Cyber Range will most likely have publicly available services, for example maybe a public facing website and/or email services.  For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.  Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.  Adding Target Domain DNS to the RootDNS server is a purely manual process.  This guide is to help get that set up with a few examples. \r\nExample 1 - Your target domain is called widgets.com and has a public facing website and a mail server.  For the purpose of this guide we\'ll assume that you have already completed the Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range.   Additionally during that part, you decided to use 44.22.11.10/29 for your firewall WAN connection.  Then set up a port forward to on 44.22.11.10 to  send port 80 and 443 to your public facing website, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to your target domains exchange server.    Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.\r\nStep 1.  Log into the RootDNS server.  Then create a zone file in the /etc/bind/RANGE directory.\r\ncd /etc/bind/RANGE\r\nvi db.widgets.com\r\nNext we need to put the following in the db.widgets.com zone file.\r\n; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4\r\nSo lets explain this line by line.\r\n\r\nLine 1  \"; Widgets blue space DNS\"        This is just a comment, in a zone file you can add comments using a \";\".\r\n\r\n\r\n\r\nNOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.\r\n\r\n\r\n\r\n\r\nLine 2  \"$TTL     88640\"   This is the time in seconds that caching DNS servers should cache this record.\r\nLine 3 \"@     IN   SOA    @   ns.widgets.com.  42 3H 15M 1W 1D\"   This is the Start of Authority (SOA)  for the domain.  The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL\r\nLine 4 \"@    IN   NS      ns.widgets.com.\"   This is setting the NameServer for the domain to the domain of ns.widgets.com\r\nLine 5 \"@    IN    MX   10    widgets.com.\"  This is setting the MX (mail server) domain to widgets.com.  The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.\r\nLine 6 \"@   IN     A    44.22.11.11\" .  The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.  This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.\r\nLine 7 \"www   IN   A  44.22.11.10\".    This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.\r\nLine 8 \"owa  IN   A   44.22.11.11\".  This sets the subdomain of owa to 44.22.11.11, this will allow HTTPS connections to our mailserver from the Cyber Range space using https://owa.widgets.com\r\nLine 9 \"ns    IN   A 198.41.0.4\".  This sets the subdomain of NS, which is also listed as the domains nameserver to the IP of 198.41.0.4.  The IP 198.41.0.4 is an IP on the rootDNS server itself.  This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.  IPv6 records at set using \"AAAA\" verse \"A\". \r\n\r\nStep 2:  Now that we create the zone file, we should test it to make sure there are no syntax errors.  You can do this on the RootDNS server using the following command. \r\nnamed-checkzone <domainname> <zonefile>\r\nbelow is an example.\r\n\r\nStep 2.  Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file. \r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following syntax.\r\nzone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};\r\nWhen you are done, you can check that the named.conf.RANGE file doesn\'t have syntax errors with the following.\r\ncd /etc/bind\r\nnamed-checkconf named.conf.RANGE\r\nIf are no errors, you will get nothing back, below is an example output or a good check.\r\n\r\nStep 3.  Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.  Do this with the following.\r\nservice bind9 restart\r\n\r\n#  Then run the following to make sure bind is running\r\n\r\nservice bind9 status\r\nOutput should look like\r\n\r\nNext, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.\r\n\r\nExample 2.  For this example, we will be running a DNS nameserver within our Target Domain.  Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.  We\'ll use the domain of widgets.com also.  In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.  Instead we will be adding a forwarder in the RootDNS\'s  named.conf.RANGE file.  Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.\r\nStep 1.  Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.\r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following.\r\nzone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};\r\nStep 2.  Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.   If that passes, run the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nThen you can test your DNS again using nslookup.  What this looks like depends on how you configured your target domain nameserver.',1,'2023-04-12 00:29:14','2023-04-12 00:29:14','adding-dns-for-your-target-domain','target-domain-planning-guide','version','','Initial publish',1),(211,31,'Adding DNS for your Target Domain','<p id=\"bkmrk-the-target-domains-y\">The target domains you connect to the Cyber Range will most likely have publicly available services, for example maybe a public facing website and/or email services.&nbsp; For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.&nbsp; Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.&nbsp; Adding Target Domain DNS to the RootDNS server is a purely manual process.&nbsp; This guide is to help get that set up with a few examples.&nbsp;</p>\r\n<p id=\"bkmrk-example-1---your-tar\"><span style=\"text-decoration: underline;\"><strong>Example 1 </strong></span>- Your target domain is called widgets.com and has a public facing website and a mail server.&nbsp; For the purpose of this guide we\'ll assume that you have already completed the Target Domain Planning Guide -&gt; Connecting a Target Domain to the Cyber Range.&nbsp;&nbsp; Additionally during that part, you decided to use 44.22.11.10/29 for your firewall WAN connection.&nbsp; Then set up a port forward to on 44.22.11.10 to&nbsp; send port 80 and 443 to your public facing website, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to your target domains exchange server.&nbsp;&nbsp;&nbsp; Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th\">Step 1.&nbsp; Log into the RootDNS server.&nbsp; Then create a zone file in the /etc/bind/RANGE directory.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind%2Frange-v\"><code class=\"language-\">cd /etc/bind/RANGE\r\nvi db.widgets.com</code></pre>\r\n<p id=\"bkmrk-next-we-need-to-put-\">Next we need to put the following in the db.widgets.com zone file.</p>\r\n<pre id=\"bkmrk-%3B-widgets-blue-space\"><code class=\"language-\">; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4</code></pre>\r\n<p id=\"bkmrk-so-lets-explain-this\">So lets explain this line by line.</p>\r\n<ul id=\"bkmrk-line-1%C2%A0-%22%3B-widgets-b\">\r\n<li class=\"null\">Line 1&nbsp; \"; Widgets blue space DNS\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is just a comment, in a zone file you can add comments using a \";\".\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">NOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Line 2&nbsp; \"$TTL&nbsp;&nbsp;&nbsp;&nbsp; 88640\"&nbsp;&nbsp; This is the time in seconds that caching DNS servers should cache this record.</li>\r\n<li class=\"null\">Line 3 \"@&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp; @&nbsp;&nbsp; ns.widgets.com.&nbsp; 42 3H 15M 1W 1D\"&nbsp;&nbsp; This is the Start of Authority (SOA)&nbsp; for the domain.&nbsp; The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL</li>\r\n<li class=\"null\">Line 4 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns.widgets.com.\"&nbsp;&nbsp; This is setting the NameServer for the domain to the domain of ns.widgets.com</li>\r\n<li class=\"null\">Line 5 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp; widgets.com.\"&nbsp; This is setting the MX (mail server) domain to widgets.com.&nbsp; The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.</li>\r\n<li class=\"null\">Line 6 \"@&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp; 44.22.11.11\" .&nbsp; The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.&nbsp; This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.</li>\r\n<li class=\"null\">Line 7 \"www&nbsp;&nbsp; IN&nbsp;&nbsp; A&nbsp; 44.22.11.10\".&nbsp;&nbsp;&nbsp; This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.</li>\r\n<li class=\"null\">Line 8 \"owa&nbsp; IN&nbsp;&nbsp; A&nbsp;&nbsp; 44.22.11.11\".&nbsp; This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.</li>\r\n<li class=\"null\">Line 9 \"ns&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; A 198.41.0.4\".&nbsp; This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.&nbsp; The IP 198.41.0.4 is an IP on the rootDNS server itself.&nbsp; This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.&nbsp; IPv6 records at set using \"AAAA\" verse \"A\".&nbsp; For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.&nbsp; This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. <br></li>\r\n</ul>\r\n<p id=\"bkmrk-step-2%3A%C2%A0-now-that-we\">Step 2:&nbsp; Now that we create the zone file, we should test it to make sure there are no syntax errors.&nbsp; You can do this on the RootDNS server using the following command.&nbsp;</p>\r\n<pre id=\"bkmrk-named-checkzone-%3Cdom\"><code class=\"language-\">named-checkzone &lt;domainname&gt; &lt;zonefile&gt;</code></pre>\r\n<p id=\"bkmrk-below-is-an-example.\">below is an example.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KSvimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-2.%C2%A0-once-you-ha\">Step 2.&nbsp; Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file.&nbsp;</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file\">Then append the file with the following syntax.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com.%22-\"><code class=\"language-\">zone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};</code></pre>\r\n<p id=\"bkmrk-when-you-are-done%2C-y\">When you are done, you can check that the named.conf.RANGE file doesn\'t have syntax errors with the following.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-named-c\"><code class=\"language-\">cd /etc/bind\r\nnamed-checkconf named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-if-are-no-errors%2C-yo\">If there are no errors, you will get nothing back, below is an example output of a good check.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sY0image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-3.%C2%A0-now-that-we\">Step 3.&nbsp; Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.&nbsp; Do this with the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-output-should-look-l\">Output should look like</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bj5image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-next%2C-run-a-nslookup\">Next, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2pHimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-example-2.%C2%A0-for-this\"><span style=\"text-decoration: underline;\"><strong>Example 2</strong></span>.&nbsp; For this example, we will be running a DNS nameserver within our Target Domain.&nbsp; Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.&nbsp; We\'ll use the domain of widgets.com also.&nbsp; In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.&nbsp; Instead we will be adding a forwarder in the RootDNS\'s&nbsp; named.conf.RANGE file.&nbsp; Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th-1\">Step 1.&nbsp; Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name-1\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file-1\">Then append the file with the following.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com%22-%7B\"><code class=\"language-\">zone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};</code></pre>\r\n<p id=\"bkmrk-step-2.%C2%A0-check-your-\">Step 2.&nbsp; Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.&nbsp;&nbsp; If that passes, run the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar-1\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-then-you-can-test-yo\">Then you can test your DNS again using nslookup.&nbsp; What this looks like depends on how you configured your target domain nameserver.</p>','The target domains you connect to the Cyber Range will most likely have publicly available services, for example maybe a public facing website and/or email services.  For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.  Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.  Adding Target Domain DNS to the RootDNS server is a purely manual process.  This guide is to help get that set up with a few examples. \r\nExample 1 - Your target domain is called widgets.com and has a public facing website and a mail server.  For the purpose of this guide we\'ll assume that you have already completed the Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range.   Additionally during that part, you decided to use 44.22.11.10/29 for your firewall WAN connection.  Then set up a port forward to on 44.22.11.10 to  send port 80 and 443 to your public facing website, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to your target domains exchange server.    Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.\r\nStep 1.  Log into the RootDNS server.  Then create a zone file in the /etc/bind/RANGE directory.\r\ncd /etc/bind/RANGE\r\nvi db.widgets.com\r\nNext we need to put the following in the db.widgets.com zone file.\r\n; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4\r\nSo lets explain this line by line.\r\n\r\nLine 1  \"; Widgets blue space DNS\"        This is just a comment, in a zone file you can add comments using a \";\".\r\n\r\n\r\n\r\nNOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.\r\n\r\n\r\n\r\n\r\nLine 2  \"$TTL     88640\"   This is the time in seconds that caching DNS servers should cache this record.\r\nLine 3 \"@     IN   SOA    @   ns.widgets.com.  42 3H 15M 1W 1D\"   This is the Start of Authority (SOA)  for the domain.  The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL\r\nLine 4 \"@    IN   NS      ns.widgets.com.\"   This is setting the NameServer for the domain to the domain of ns.widgets.com\r\nLine 5 \"@    IN    MX   10    widgets.com.\"  This is setting the MX (mail server) domain to widgets.com.  The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.\r\nLine 6 \"@   IN     A    44.22.11.11\" .  The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.  This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.\r\nLine 7 \"www   IN   A  44.22.11.10\".    This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.\r\nLine 8 \"owa  IN   A   44.22.11.11\".  This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.\r\nLine 9 \"ns    IN   A 198.41.0.4\".  This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.  The IP 198.41.0.4 is an IP on the rootDNS server itself.  This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.  IPv6 records at set using \"AAAA\" verse \"A\".  For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.  This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. \r\n\r\nStep 2:  Now that we create the zone file, we should test it to make sure there are no syntax errors.  You can do this on the RootDNS server using the following command. \r\nnamed-checkzone <domainname> <zonefile>\r\nbelow is an example.\r\n\r\nStep 2.  Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file. \r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following syntax.\r\nzone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};\r\nWhen you are done, you can check that the named.conf.RANGE file doesn\'t have syntax errors with the following.\r\ncd /etc/bind\r\nnamed-checkconf named.conf.RANGE\r\nIf there are no errors, you will get nothing back, below is an example output of a good check.\r\n\r\nStep 3.  Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.  Do this with the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nOutput should look like\r\n\r\nNext, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.\r\n\r\nExample 2.  For this example, we will be running a DNS nameserver within our Target Domain.  Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.  We\'ll use the domain of widgets.com also.  In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.  Instead we will be adding a forwarder in the RootDNS\'s  named.conf.RANGE file.  Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.\r\nStep 1.  Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.\r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following.\r\nzone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};\r\nStep 2.  Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.   If that passes, run the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nThen you can test your DNS again using nslookup.  What this looks like depends on how you configured your target domain nameserver.',1,'2023-04-12 00:39:40','2023-04-12 00:39:40','adding-dns-for-your-target-domain','target-domain-planning-guide','version','','',2),(213,29,'Connecting a Target Domain to the Cyber Range','<p id=\"bkmrk-connecting-a-blue-sp\">Connecting a blue space is fairly straight foward.&nbsp; You can have a single WAN point for a blue space or as many as you would like.&nbsp; You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.&nbsp; Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.</p>\r\n<p id=\"bkmrk-below-is-the-simply-\">Below is the simple blue space example.</p>\r\n<div drawio-diagram=\"165\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155829.png\"></div>\r\n<p id=\"bkmrk-in-the-diagram-above\">In the diagram above, your Target Domain is built on another ESXI server.&nbsp; On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.&nbsp; Then this virtual switch will need an uplink that connects to a physical NIC on the host server.&nbsp; Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.&nbsp; Then connect a line between the&nbsp; physical NICs on those two servers.&nbsp;&nbsp;</p>\r\n<p id=\"bkmrk-next%2C-you-need-to-ip\">Next, you need to IP this connection.&nbsp; You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.&nbsp; A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.&nbsp; Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed from the NRTS server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fbackbonerou\"><code class=\"language-\">cd /root/backbonerouters\r\ngrep 44.22.1 */*</code></pre>\r\n<p id=\"bkmrk-above-we-are-greppin\">Above we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.&nbsp; This will find all possible matches.&nbsp; Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.&nbsp; If your grep comes back empty, you are good to go with the IP you selected.&nbsp; Typically for a WAN connection, a /29 subnet is a reasonable choice.&nbsp;&nbsp; For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,&nbsp; the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.&nbsp; We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.&nbsp; Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.&nbsp; Below are the instructions for this.</p>\r\n<ul id=\"bkmrk-console-into-the-si-\">\r\n<li class=\"null\">Console into the SI-Router on the Cyber Range.</li>\r\n<li class=\"null\">Then edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source-\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<ul id=\"bkmrk-then-save-the-script\">\r\n<li class=\"null\">Then save the script and run it with ./Eth3RangeWAN.sh.&nbsp; That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.</li>\r\n</ul>\r\n<p id=\"bkmrk-adding-additional-ta\">Adding additional target domains is basically the same.&nbsp; For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.&nbsp; Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.&nbsp; For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.&nbsp; The Eth3RangeWAN.sh script would look like the following.&nbsp; Then we just run the script again.&nbsp; You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.</p>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source--1\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<p id=\"bkmrk-note%3A-you%27ll-need-a-\">NOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.&nbsp; ESXI virtual switches are limited to a single uplink, well technically you can have 4, but they can only be configured as teamed or fail over ports.&nbsp; So essentially it\'s like a single logical port.&nbsp; So to connect multiples, you\'ll just need to put a switch between the connections from&nbsp; target domain&nbsp; WANs to the Cyber Range RangeWAN uplink port.&nbsp; Below is a really poorly made diagram of this.<br></p>\r\n<div drawio-diagram=\"179\" contenteditable=\"false\" id=\"bkmrk--2\"><img id=\"bkmrk--3\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681243955.png\"></div>','Connecting a blue space is fairly straight foward.  You can have a single WAN point for a blue space or as many as you would like.  You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.  Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.\r\nBelow is the simple blue space example.\r\n\r\nIn the diagram above, your Target Domain is built on another ESXI server.  On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.  Then this virtual switch will need an uplink that connects to a physical NIC on the host server.  Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.  Then connect a line between the  physical NICs on those two servers.  \r\nNext, you need to IP this connection.  You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.  A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.  Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed from the NRTS server.\r\ncd /root/backbonerouters\r\ngrep 44.22.1 */*\r\nAbove we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.  This will find all possible matches.  Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.  If your grep comes back empty, you are good to go with the IP you selected.  Typically for a WAN connection, a /29 subnet is a reasonable choice.   For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,  the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.  We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.  Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.  Below are the instructions for this.\r\n\r\nConsole into the SI-Router on the Cyber Range.\r\nThen edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following\r\n\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\n\r\nThen save the script and run it with ./Eth3RangeWAN.sh.  That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.\r\n\r\nAdding additional target domains is basically the same.  For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.  Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.  For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.  The Eth3RangeWAN.sh script would look like the following.  Then we just run the script again.  You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\nNOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.  ESXI virtual switches are limited to a single uplink, well technically you can have 4, but they can only be configured as teamed or fail over ports.  So essentially it\'s like a single logical port.  So to connect multiples, you\'ll just need to put a switch between the connections from  target domain  WANs to the Cyber Range RangeWAN uplink port.  Below is a really poorly made diagram of this.\r\n',1,'2023-04-12 01:12:46','2023-04-12 01:12:46','connecting-a-target-domain-to-the-cyber-range','target-domain-planning-guide','version','','',2),(215,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at <a href=\"https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries\">https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries</a>. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then, under windows client for the link that says “download the current 32-bit client zip file”.</span></p>\r\n<p id=\"bkmrk-%C2%A0-1\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"></p>\r\n<p id=\"bkmrk-ghost-set-up.\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul id=\"bkmrk-you-need-to-put-the-\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.</span></li>\r\n</ul>\r\n<p id=\"bkmrk-then-you-need-to-con\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.\"</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of galfed.com.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Not sure what this is used for, unfortunately Ghost isn\'t very well documented.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re target domain users emails, you have to make this.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample configs for how to use.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: on the latest binary release 4.0 the redemption.dll was included.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-starting-and-stoppin\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p id=\"bkmrk-notes%3A%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul id=\"bkmrk-ghost-can-be-resourc\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, especially if its throwing errors in the app.log log.&nbsp; Working on getting the configuration files right so this log is basically empty.&nbsp; For a reference, mine has only one entry after running work weeks.&nbsp; Once you’ve tested it and have it working well, copy it over to other workstations.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.</span></li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries. Then, under windows client for the link that says “download the current 32-bit client zip file”.\r\n\r\nGhost set up.\r\n\r\nYou need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.\r\n\r\nThen you need to config it.\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey\r\nHealthIsEnabled \r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….\"\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\nNot sure what this is used for, unfortunately Ghost isn\'t very well documented.\r\n\r\n\r\nEmail-content.csv \r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\nEmail-reply.csv\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\nEmails-domain.json\r\n\r\nThis is a list of all you’re target domain users emails, you have to make this.\r\n\r\n\r\nEmails-outside.json\r\n\r\nList of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. \r\n\r\n\r\nFilenames.json\r\n\r\nList that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\nHealth.json \r\n\r\nIt will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\nTimeline.json\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at the sample configs for how to use.\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\nIf you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.\r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: on the latest binary release 4.0 the redemption.dll was included.\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n            To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\n\r\nGhost can be resource intensive, especially if its throwing errors in the app.log log.  Working on getting the configuration files right so this log is basically empty.  For a reference, mine has only one entry after running work weeks.  Once you’ve tested it and have it working well, copy it over to other workstations.\r\nIf you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.\r\n\r\n',1,'2023-04-12 01:31:25','2023-04-12 01:31:25','ghost-traffic-generation','target-domain-planning-guide','version','','',3),(216,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems.  There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a>.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structured by Geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.  Additionally for other OPFOR systems you want to add, you can use this list to pick an IP for that system.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul id=\"bkmrk-this-is-another-tool\">\r\n<li class=\"null\">This is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever Go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildredteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a>for guides on how to set up all of these services.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage DNS records that get added to the rootDNS server.  Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS </a>for a guide on how use this script.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new DNS records that will get added to the rootDNS server.  Go to -&gt; How to guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/opfor-domain-registration-outside-of-nrts-automation\">Manual Domain Registration</a> for instructions on this script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.  Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/phishing-attack-buildredteamsh\">Phishing Attack</a> for instructions on the scripts below.<br></li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce your OPFOR teams time required to deploy infrastructure systems.  There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -> Using the NRTS.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structured by Geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure in text-based GUI\'s, you shouldn\'t place anything in this folder structure outside of what is already there.  Additionally for other OPFOR systems you want to add, you can use this list to pick an IP for that system.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever Go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a teamserver or an HAProxy redirector that will set up ACLs based on C2 profiles.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildredteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -> Using the NRTS for guides on how to set up all of these services.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage DNS records that get added to the rootDNS server.  Go to -> Using the NRTS -> Managing DNS for a guide on how use this script.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new DNS records that will get added to the rootDNS server.  Go to -> How to guides -> Manual Domain Registration for instructions on this script.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.  Go to -> Using the NRTS -> Phishing Attack for instructions on the scripts below.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n\r\n',1,'2023-04-12 01:32:34','2023-04-12 01:32:34','nrts','cyber-range-systems-overview','version','','System auto-update of internal links',6),(217,10,'OPFOR Domain Registration outside of NRTS Automation','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS.</a><br></p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> Managing DNS.',1,'2023-04-12 01:32:34','2023-04-12 01:32:34','opfor-domain-registration-outside-of-nrts-automation','how-to-guides','version','','',14),(218,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at <a href=\"https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries\">https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries</a>. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then, under windows client for the link that says “download the current 32-bit client zip file”.</span></p>\r\n<p id=\"bkmrk-%C2%A0-1\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"></p>\r\n<p id=\"bkmrk-ghost-set-up.\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul id=\"bkmrk-you-need-to-put-the-\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.</span></li>\r\n</ul>\r\n<p id=\"bkmrk-then-you-need-to-con\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.\"</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of galfed.com.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Not sure what this is used for, unfortunately Ghost isn\'t very well documented.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re target domain users emails, you have to make this.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample configs for how to use.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: on the latest binary release 4.0 the redemption.dll was included.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-starting-and-stoppin\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p id=\"bkmrk-notes%3A%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul id=\"bkmrk-ghost-can-be-resourc\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, especially if its throwing errors in the app.log log.&nbsp; Working on getting the configuration files right so this log is basically empty.&nbsp; For a reference, mine has only one entry after running work weeks.&nbsp; Once you’ve tested it and have it working well, copy it over to other workstations.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.</span></li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries. Then, under windows client for the link that says “download the current 32-bit client zip file”.\r\n\r\nGhost set up.\r\n\r\nYou need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.\r\n\r\nThen you need to config it.\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey\r\nHealthIsEnabled \r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….\"\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\nNot sure what this is used for, unfortunately Ghost isn\'t very well documented.\r\n\r\n\r\nEmail-content.csv \r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\nEmail-reply.csv\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\nEmails-domain.json\r\n\r\nThis is a list of all you’re target domain users emails, you have to make this.\r\n\r\n\r\nEmails-outside.json\r\n\r\nList of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. \r\n\r\n\r\nFilenames.json\r\n\r\nList that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\nHealth.json \r\n\r\nIt will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\nTimeline.json\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at the sample configs for how to use.\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\nIf you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.\r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: on the latest binary release 4.0 the redemption.dll was included.\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n            To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\n\r\nGhost can be resource intensive, especially if its throwing errors in the app.log log.  Working on getting the configuration files right so this log is basically empty.  For a reference, mine has only one entry after running work weeks.  Once you’ve tested it and have it working well, copy it over to other workstations.\r\nIf you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.\r\n\r\n',1,'2023-04-12 01:36:34','2023-04-12 01:36:34','ghost-traffic-generation','target-domain-planning-guide','version','','',4),(219,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at <a href=\"https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries\">https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries</a>. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then, under windows client for the link that says “download the current 32-bit client zip file”.</span></p>\r\n<p id=\"bkmrk-%C2%A0-1\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"></p>\r\n<p id=\"bkmrk-ghost-set-up.\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul id=\"bkmrk-you-need-to-put-the-\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.</span></li>\r\n</ul>\r\n<p id=\"bkmrk-then-you-need-to-con\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.\"</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of galfed.com.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Not sure what this is used for, unfortunately Ghost isn\'t very well documented.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re target domain users emails, you have to make this.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample configs for how to use.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: on the latest binary release 4.0 the redemption.dll was included.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-starting-and-stoppin\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p id=\"bkmrk-notes%3A%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul id=\"bkmrk-ghost-can-be-resourc\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, especially if its throwing errors in the app.log log.&nbsp; Working on getting the configuration files right so this log is basically empty.&nbsp; For a reference, mine has only one entry after running work weeks.&nbsp; Once you’ve tested it and have it working well, copy it over to other workstations.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.</span></li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, the binary zip can be found at https://github.com/cmu-sei/GHOSTS/wiki/Installation-from-distribution-binaries. Then, under windows client for the link that says “download the current 32-bit client zip file”.\r\n\r\nGhost set up.\r\n\r\nYou need to put the entire ghost folder from the binary zip on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.\r\n\r\nThen you need to config it.\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey\r\nHealthIsEnabled \r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….\"\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\nNot sure what this is used for, unfortunately Ghost isn\'t very well documented.\r\n\r\n\r\nEmail-content.csv \r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\nEmail-reply.csv\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\nEmails-domain.json\r\n\r\nThis is a list of all you’re target domain users emails, you have to make this.\r\n\r\n\r\nEmails-outside.json\r\n\r\nList of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. \r\n\r\n\r\nFilenames.json\r\n\r\nList that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\nHealth.json \r\n\r\nIt will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\nTimeline.json\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at the sample configs for how to use.\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\nIf you want to use the BrowserChrome handler, you need to install chrome version 81 for it to work.\r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: on the latest binary release 4.0 the redemption.dll was included.\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n            To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\n\r\nGhost can be resource intensive, especially if its throwing errors in the app.log log.  Working on getting the configuration files right so this log is basically empty.  For a reference, mine has only one entry after running work weeks.  Once you’ve tested it and have it working well, copy it over to other workstations.\r\nIf you change the timeline.json file while ghost is running, ghost will restart and use your modifications automatically, no need to restart it.\r\n\r\n',1,'2023-04-12 01:38:19','2023-04-12 01:38:19','ghost-traffic-generation','target-domain-planning-guide','version','','',5),(221,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at <a href=\"https://github.com/cmu-sei/GHOSTS\">https://github.com/cmu-sei/GHOSTS</a> The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file. </span></p>\r\n<p id=\"bkmrk-%C2%A0-1\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"></p>\r\n<p id=\"bkmrk-ghost-set-up.\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost set up.</span></p>\r\n<ul id=\"bkmrk-you-need-to-put-the-\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">You need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.</span></li>\r\n</ul>\r\n<p id=\"bkmrk-then-you-need-to-con\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then you need to config it.</span></p>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Config files (Ghosts/config)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Application.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Change the following variables to false</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IdEnabled - at the top</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under ClientResults</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled&nbsp; - under ClientUpdates</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">IsEnabled - under Survey</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HealthIsEnabled </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure the following variable is true</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">HandlersIsEnabled</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Remove the URLs every where you see it, the default looks like </span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">\"</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">http://ghosts-c2/api/…</span><span style=\"font-size: 10pt; font-family: Consolas, sans-serif; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.\"</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Set these which are typically under “PostURL”&nbsp; to “”</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Then in “Email”, the options are self explanatory, set these however you want it to run</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of galfed.com.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Dictionary.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Not sure what this is used for, unfortunately Ghost isn\'t very well documented.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-content.csv </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Email-reply.csv</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-domain.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is a list of all you’re target domain users emails, you have to make this.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Emails-outside.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. </span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Filenames.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Health.json </span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.</span></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Timeline.json</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is where you set up ghosts to preform activities as a user.&nbsp; Look at sample configs.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. </span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTE: The latest binary release 7.0 included this redemption.dll. </span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Logs (ghosts/logs)</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides information on ghosts application, use this to troubleshoot if something isn’t working.</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Provides entries for every action that ghosts makes, you can use this to validate things are working.</span>\r\n<ul>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">App.log</span></li>\r\n<li class=\"null\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Clientupdates.log</span></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-starting-and-stoppin\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">STARTING AND STOPPING GHOSTS</span></p>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"><span class=\"Apple-tab-span\" style=\"white-space: pre;\"> </span></span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</span></p>\r\n<p id=\"bkmrk-%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0%C2%A0to-stop-\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\" id=\"bkmrk-%C2%A0\">&nbsp;</p>\r\n<p id=\"bkmrk-notes%3A%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NOTES:&nbsp;</span></p>\r\n<ul id=\"bkmrk-ghost-can-be-resourc\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Ghost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">If you change the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.</span></li>\r\n</ul>\r\n<p id=\"bkmrk--5\"><br><br></p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at https://github.com/cmu-sei/GHOSTS The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file. \r\n\r\nGhost set up.\r\n\r\nYou need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.\r\n\r\nThen you need to config it.\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json\r\n\r\nUsed for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey\r\nHealthIsEnabled \r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like \"http://ghosts-c2/api/….\"\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\n\r\n\r\nDictionary.json\r\n\r\nNot sure what this is used for, unfortunately Ghost isn\'t very well documented.\r\n\r\n\r\nEmail-content.csv \r\n\r\nThis contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\n\r\n\r\nEmail-reply.csv\r\n\r\nThis is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\n\r\n\r\nEmails-domain.json\r\n\r\nThis is a list of all you’re target domain users emails, you have to make this.\r\n\r\n\r\nEmails-outside.json\r\n\r\nList of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null. \r\n\r\n\r\nFilenames.json\r\n\r\nList that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\n\r\n\r\nHealth.json \r\n\r\nIt will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.\r\n\r\n\r\nTimeline.json\r\n\r\nThis is where you set up ghosts to preform activities as a user.  Look at sample configs.\r\nWe add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep.\r\nIf you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. \r\nIf you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll. \r\n\r\n\r\n\r\n\r\nLogs (ghosts/logs)\r\n\r\nProvides information on ghosts application, use this to troubleshoot if something isn’t working.\r\nProvides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\n To start ghost, just click on the ghosts.exe in the root of the ghost folder\r\n To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\n \r\nNOTES: \r\n\r\nGhost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.\r\nIf you change the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.\r\n\r\n',1,'2023-04-12 01:48:18','2023-04-12 01:48:18','ghost-traffic-generation','target-domain-planning-guide','version','','',6),(222,2,'Cyber Range Network Diagram','<div drawio-diagram=\"163\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681151514.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 01:48:50','2023-04-12 01:48:50','cyber-range-network-diagram','network-overview','version','','',12),(224,2,'Cyber Range Network Diagram','<div drawio-diagram=\"180\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681300960.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 17:02:51','2023-04-12 17:02:51','cyber-range-network-diagram','network-overview','version','','',13),(226,2,'Cyber Range Network Diagram','<div drawio-diagram=\"181\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301037.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 17:04:03','2023-04-12 17:04:03','cyber-range-network-diagram','network-overview','version','','',14),(228,2,'Cyber Range Network Diagram','<div drawio-diagram=\"182\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301203.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 17:06:46','2023-04-12 17:06:46','cyber-range-network-diagram','network-overview','version','','',15),(230,2,'Cyber Range Network Diagram','<div drawio-diagram=\"182\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301203.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 17:14:10','2023-04-12 17:14:10','cyber-range-network-diagram','network-overview','version','','',16),(232,2,'Cyber Range Network Diagram','<div drawio-diagram=\"183\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">r<span style=\"text-decoration: underline;\">edbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - Windows VM.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - Windows VM.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 17:25:33','2023-04-12 17:25:33','cyber-range-network-diagram','network-overview','version','','',17),(234,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - (Googles recursive DNS server)</li>\r\n<li class=\"null\">198.41.0.4 - (A-root server)</li>\r\n<li class=\"null\">192.228.79.59 - (B-root server)</li>\r\n<li class=\"null\">192.33.4.12 - (C-root server)</li>\r\n<li class=\"null\">128.8.10.90 - (D-root server)</li>\r\n<li class=\"null\">192.203.230.10 - (E-root server)</li>\r\n<li class=\"null\">195.5.5.241 - (F-root server)</li>\r\n<li class=\"null\">192.112.36.4 - (G-root server)</li>\r\n<li class=\"null\">128.63.2.53 - (H-root server)</li>\r\n<li class=\"null\">192.36.148.17 - (I-root server)</li>\r\n<li class=\"null\">192.58.128.30 - (J-root server)</li>\r\n<li class=\"null\">193.0.15.129 - (K-root server)</li>\r\n<li class=\"null\">199.7.83.42 - (L-root server)</li>\r\n<li class=\"null\">202.12.27.33 - (M-root server)</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE:&nbsp; For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a><br></li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check your modification of the named.conf.RANGE file.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either check errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n<li class=\"null\">NOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - (Googles recursive DNS server)\r\n198.41.0.4 - (A-root server)\r\n192.228.79.59 - (B-root server)\r\n192.33.4.12 - (C-root server)\r\n128.8.10.90 - (D-root server)\r\n192.203.230.10 - (E-root server)\r\n195.5.5.241 - (F-root server)\r\n192.112.36.4 - (G-root server)\r\n128.63.2.53 - (H-root server)\r\n192.36.148.17 - (I-root server)\r\n192.58.128.30 - (J-root server)\r\n193.0.15.129 - (K-root server)\r\n199.7.83.42 - (L-root server)\r\n202.12.27.33 - (M-root server)\r\n\r\nThe RootDNS server handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores the domain zones files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE:  For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -> Using the NRTS \r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check your modification of the named.conf.RANGE file.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either check errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\nNOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.\r\n\r\n\r\n',1,'2023-04-12 17:34:33','2023-04-12 17:34:33','rootdns','cyber-range-systems-overview','version','','',8),(236,5,'Web-Services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">These directories contain the config files needed for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups, below is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n<li class=\"null\">docker cp bookstack:/app/www/public/uploads/images .<br></li>\r\n<li class=\"null\">docker cp bookstack:/config/files .</li>\r\n<li class=\"null\">tar -czvf redbook-images-backup.tar.gz images</li>\r\n<li class=\"null\">tar -czvf redbook-files-backup.tar.gz uploads</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n<li class=\"null\">tar -xzvf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp images bookstack:/app/www/public/uploads/</li>\r\n<li class=\"null\">tar -xzvf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp files&nbsp; bookstack:/config/www/</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nThese directories contain the config files needed for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups, below is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\ndocker cp bookstack:/app/www/public/uploads/images .\r\ndocker cp bookstack:/config/files .\r\ntar -czvf redbook-images-backup.tar.gz images\r\ntar -czvf redbook-files-backup.tar.gz uploads\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\ntar -xzvf redbook-files-backup.tar.gz\r\ndocker cp images bookstack:/app/www/public/uploads/\r\ntar -xzvf redbook-files-backup.tar.gz\r\ndocker cp files  bookstack:/config/www/\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',1,'2023-04-12 17:51:55','2023-04-12 17:51:55','web-services','cyber-range-systems-overview','version','','',5),(238,6,'CA-Server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using the domain of globalcert.com.&nbsp; To create new signed SSL certs or to sign binaries, you can use scripts on this server.&nbsp; The NRTS server will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.&nbsp; For more information on this go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a>.&nbsp; That said, if you want to generate these manually, below is an overview of scripts on the CA-server.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs and then sign these with the intermediate cert.&nbsp; The script has a help menu that is pretty self explanatory.&nbsp; below is the help menu that lists the various flags.</li>\r\n<li class=\"null\">\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/A2limage.png\" alt=\"image.png\"></p>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-an-example-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is an example for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using the domain of globalcert.com.  To create new signed SSL certs or to sign binaries, you can use scripts on this server.  The NRTS server will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.  For more information on this go to -> Cyber Range Systems Overview -> NRTS.  That said, if you want to generate these manually, below is an overview of scripts on the CA-server.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs and then sign these with the intermediate cert.  The script has a help menu that is pretty self explanatory.  below is the help menu that lists the various flags.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is an example for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n',1,'2023-04-12 18:41:31','2023-04-12 18:41:31','ca-server','cyber-range-systems-overview','version','','',7),(240,2,'Cyber Range Network Diagram','<div drawio-diagram=\"183\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles recursive DNS server IP of 8.8.8.8.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">redbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how to set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.<br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - Windows VM.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles recursive DNS server IP of 8.8.8.8.  This server is used for managing grayspace DNS.  You can register DNS manually or use automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how to set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.\r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - Windows VM.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC built that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 18:51:29','2023-04-12 18:51:29','cyber-range-network-diagram','network-overview','version','','',18),(242,2,'Cyber Range Network Diagram','<div drawio-diagram=\"183\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles recursive DNS server IP of 8.8.8.8.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">redbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how the Traffic-Gen server is set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.&nbsp; For instructions on setting using the Traffic-Gen, go to -&gt; How to Guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/setting-up-the-traffic-gen-for-a-target-domain\">Setting up the Traffic-Gen for a Target Domain</a>. <br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - Windows VM.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.&nbsp; Go to -&gt; Target Domain Planning Guide -&gt; Adding a Internet Access Proxy.<br></li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles recursive DNS server IP of 8.8.8.8.  This server is used for managing grayspace DNS.  You can register DNS manually or use automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how the Traffic-Gen server is set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.  For instructions on setting using the Traffic-Gen, go to -> How to Guides -> Setting up the Traffic-Gen for a Target Domain. \r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - Windows VM.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.  Go to -> Target Domain Planning Guide -> Adding a Internet Access Proxy.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 18:59:12','2023-04-12 18:59:12','cyber-range-network-diagram','network-overview','version','','',19),(243,32,'Adding a Internet Access Proxy for a Target Domain','<p id=\"bkmrk-having-a-way-to-acce\">Having a way to access the real internet from a target domain is very useful.&nbsp; There are a couple of ways to do this.&nbsp; One way would be to install a secondary NIC on all of your target domain and then interconnect that to the Cyber Range AdminNet.&nbsp; It would get a DHCP lease from the AdminNet-DHCP server and be able to use the same https://172.30.0.2:9999 proxy that the Cyber Range uses.&nbsp; However, this also creates a unwanted artifact of this secondary NIC on all your target domain systems that you\'ll have to tell the cyber defenders that use it for training to just ignore.&nbsp; The bigger concern is that the AdminNet is a flat network, connecting say multiple target domains to it could lead to inadvertent propagation.&nbsp; For example, if a red teamer drops wormable malware on Target Domain 1, unless you added appropriate firewall rules to this secondary interface, this malware would likely propagate to all other Target Domains via the AdminNet.&nbsp; That said, this method is not advisable but it is a method that an end user might consider so it worth explaining why it\'s not a good idea.&nbsp; The preferred method would be to add a squid proxy in your Target Domain DMZ.&nbsp; Give that server two NICs, one connected to the Target Domain DMZ and the other connected a real internet connection.&nbsp; The configuration of this will depend on how your Target Domain is built, but you can use the Cyber Range IA-proxy configuration as an example.&nbsp;</p>','Having a way to access the real internet from a target domain is very useful.  There are a couple of ways to do this.  One way would be to install a secondary NIC on all of your target domain and then interconnect that to the Cyber Range AdminNet.  It would get a DHCP lease from the AdminNet-DHCP server and be able to use the same https://172.30.0.2:9999 proxy that the Cyber Range uses.  However, this also creates a unwanted artifact of this secondary NIC on all your target domain systems that you\'ll have to tell the cyber defenders that use it for training to just ignore.  The bigger concern is that the AdminNet is a flat network, connecting say multiple target domains to it could lead to inadvertent propagation.  For example, if a red teamer drops wormable malware on Target Domain 1, unless you added appropriate firewall rules to this secondary interface, this malware would likely propagate to all other Target Domains via the AdminNet.  That said, this method is not advisable but it is a method that an end user might consider so it worth explaining why it\'s not a good idea.  The preferred method would be to add a squid proxy in your Target Domain DMZ.  Give that server two NICs, one connected to the Target Domain DMZ and the other connected a real internet connection.  The configuration of this will depend on how your Target Domain is built, but you can use the Cyber Range IA-proxy configuration as an example. ',1,'2023-04-12 20:49:06','2023-04-12 20:49:06','adding-a-internet-access-proxy-for-a-target-domain','target-domain-planning-guide','version','','Initial publish',1),(245,2,'Cyber Range Network Diagram','<div drawio-diagram=\"183\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles recursive DNS server IP of 8.8.8.8.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">redbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how the Traffic-Gen server is set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.&nbsp; For instructions on setting using the Traffic-Gen, go to -&gt; How to Guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/setting-up-the-traffic-gen-for-a-target-domain\">Setting up the Traffic-Gen for a Target Domain</a>. <br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - Windows VM.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.&nbsp; Go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/adding-a-internet-access-proxy-for-a-target-domain\">Adding a Internet Access Proxy for a Target Domain</a>.<br></li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles recursive DNS server IP of 8.8.8.8.  This server is used for managing grayspace DNS.  You can register DNS manually or use automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how the Traffic-Gen server is set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.  For instructions on setting using the Traffic-Gen, go to -> How to Guides -> Setting up the Traffic-Gen for a Target Domain. \r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - Windows VM.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.  Go to -> Target Domain Planning Guide -> Adding a Internet Access Proxy for a Target Domain.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',1,'2023-04-12 20:51:57','2023-04-12 20:51:57','cyber-range-network-diagram','network-overview','version','','',20),(247,4,'RootDNS','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - (Googles recursive DNS server)</li>\r\n<li class=\"null\">198.41.0.4 - (A-root server)</li>\r\n<li class=\"null\">192.228.79.59 - (B-root server)</li>\r\n<li class=\"null\">192.33.4.12 - (C-root server)</li>\r\n<li class=\"null\">128.8.10.90 - (D-root server)</li>\r\n<li class=\"null\">192.203.230.10 - (E-root server)</li>\r\n<li class=\"null\">195.5.5.241 - (F-root server)</li>\r\n<li class=\"null\">192.112.36.4 - (G-root server)</li>\r\n<li class=\"null\">128.63.2.53 - (H-root server)</li>\r\n<li class=\"null\">192.36.148.17 - (I-root server)</li>\r\n<li class=\"null\">192.58.128.30 - (J-root server)</li>\r\n<li class=\"null\">193.0.15.129 - (K-root server)</li>\r\n<li class=\"null\">199.7.83.42 - (L-root server)</li>\r\n<li class=\"null\">202.12.27.33 - (M-root server)</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores the domain zone files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE:&nbsp; For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a><br></li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check your modification of the named.conf.RANGE file.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either check errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n<li class=\"null\">NOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - (Googles recursive DNS server)\r\n198.41.0.4 - (A-root server)\r\n192.228.79.59 - (B-root server)\r\n192.33.4.12 - (C-root server)\r\n128.8.10.90 - (D-root server)\r\n192.203.230.10 - (E-root server)\r\n195.5.5.241 - (F-root server)\r\n192.112.36.4 - (G-root server)\r\n128.63.2.53 - (H-root server)\r\n192.36.148.17 - (I-root server)\r\n192.58.128.30 - (J-root server)\r\n193.0.15.129 - (K-root server)\r\n199.7.83.42 - (L-root server)\r\n202.12.27.33 - (M-root server)\r\n\r\nThe RootDNS server handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores the domain zone files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE:  For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -> Using the NRTS \r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check your modification of the named.conf.RANGE file.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either check errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\nNOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.\r\n\r\n\r\n',1,'2023-04-12 21:34:21','2023-04-12 21:34:21','rootdns','cyber-range-systems-overview','version','','',9),(249,7,'Traffic-Gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email corpus was pulled using the Enron data dump.&nbsp; About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into databases.&nbsp; It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.&nbsp; The functionality of this is very customizable.&nbsp; Here is an overview of how this server is used to generate email traffic.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/stoptrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the build-compose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.&nbsp; NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.&nbsp; Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.&nbsp; Also if the IP you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that a gateway IP in the in the same subnet for the IP you want to use to the SI-Router\'s ServicesNet interface.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from publicly available databases of the Enron data mentioned earlier.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain that you connect to the Cyber Range.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.&nbsp; Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.&nbsp; For more information for setting up the traffic-gen to send emails to your target domain go to -&gt; How to Guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/setting-up-the-traffic-gen-for-a-target-domain\">Setting up the Traffic-Gen for a Target Domain</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email corpus was pulled using the Enron data dump.  About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into databases.  It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.  The functionality of this is very customizable.  Here is an overview of how this server is used to generate email traffic.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/stoptrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the build-compose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.  NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.  Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.  Also if the IP you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that a gateway IP in the in the same subnet for the IP you want to use to the SI-Router\'s ServicesNet interface.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from publicly available databases of the Enron data mentioned earlier.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain that you connect to the Cyber Range.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.  Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.  Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.  For more information for setting up the traffic-gen to send emails to your target domain go to -> How to Guides -> Setting up the Traffic-Gen for a Target Domain.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',1,'2023-04-12 21:43:33','2023-04-12 21:43:33','traffic-gen','cyber-range-systems-overview','version','','',7),(251,9,'NRTS','<p id=\"bkmrk-the-not-red-team-ser\">The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce the time required to deploy infrastructure systems.&nbsp; There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a>.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.&nbsp; Its structured by Geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.&nbsp; &nbsp;This folder structure is used by other scripts on the NRTS to generator IP addresses.&nbsp; NOTE: the various scripts will use this folder structure to create menu items in a&nbsp; text-based GUI, you shouldn\'t place anything in this folder structure outside of what is already there.&nbsp; Additionally for other OPFOR systems you want to add and attach to the grayspace switch, you can use this list to pick an IP for that system.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul id=\"bkmrk-this-is-another-tool\">\r\n<li class=\"null\">This is another tool for generating Cobalt&nbsp;Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.&nbsp; NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever Go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a Cobalt Strike teamserver or if you are building an HAProxy redirector, the profile is used to set up ACLs based on the C2 profile.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildredteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.&nbsp; The script can also be used to set up the NRTS for phishing attacks.&nbsp; Go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a>for guides on how to set up all of these services.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage OPFOR DNS records that get added to the rootDNS server.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS </a>for a guide on how use this script.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new OPFOR DNS records that will get added to the rootDNS server.&nbsp; Go to -&gt; How to guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/opfor-domain-registration-outside-of-nrts-automation\">Manual Domain Registration</a> for instructions on this script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/phishing-attack-buildredteamsh\">Phishing Attack</a> for instructions on the scripts below.<br></li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce the time required to deploy infrastructure systems.  There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -> Using the NRTS.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structured by Geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure to create menu items in a  text-based GUI, you shouldn\'t place anything in this folder structure outside of what is already there.  Additionally for other OPFOR systems you want to add and attach to the grayspace switch, you can use this list to pick an IP for that system.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever Go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a Cobalt Strike teamserver or if you are building an HAProxy redirector, the profile is used to set up ACLs based on the C2 profile.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildredteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -> Using the NRTS for guides on how to set up all of these services.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage OPFOR DNS records that get added to the rootDNS server.  Go to -> Using the NRTS -> Managing DNS for a guide on how use this script.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new OPFOR DNS records that will get added to the rootDNS server.  Go to -> How to guides -> Manual Domain Registration for instructions on this script.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.  Go to -> Using the NRTS -> Phishing Attack for instructions on the scripts below.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n\r\n',1,'2023-04-12 21:52:15','2023-04-12 21:52:15','nrts','cyber-range-systems-overview','version','','',7),(252,10,'OPFOR Domain Registration outside of NRTS Automation','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete OPFOR DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh or as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS.</a><br></p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete OPFOR DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh or as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> Managing DNS.',1,'2023-04-12 21:54:31','2023-04-12 21:54:31','opfor-domain-registration-outside-of-nrts-automation','how-to-guides','version','','',15),(253,12,'Code Signing Binaries','<p id=\"bkmrk-using-the-ca-server-\">Using the CA-server to sign binaries.</p>\r\n<ul id=\"bkmrk-ssh-into-globalcerts\">\r\n<li class=\"null\">SSH into globalcerts.com.&nbsp;&nbsp; Creds: root&nbsp; password: toor</li>\r\n<li class=\"null\">\r\n</ul>','Using the CA-server to sign binaries.\r\n\r\nSSH into globalcerts.com.   Creds: root  password: toor\r\n\r\n',1,'2023-04-12 21:55:36','2023-04-12 21:55:36','code-signing-binaries','how-to-guides','version','','',2),(255,30,'Setting up the Traffic-Gen for a Target Domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each domain that it will use to send emails from.&nbsp; Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up takes a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber Range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the Cyber Range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/adding-dns-for-your-target-domain\">Adding DNS for your Target Domain</a>.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\n## When you run the above command, you should get a response from your target domain exchange server \r\n## that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.<br></p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder for it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh<br></p>\r\n<pre id=\"bkmrk-cd-root-.%2Fbuidcompos\"><code class=\"language-\">cd root\r\n./buidcompose.sh</code></pre>\r\n<p id=\"bkmrk-when-the-script-firs\">When the script first runs, it preforms some system checks.&nbsp; The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.&nbsp; The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains resolve to the IP listed in the emailerlist.txt file.&nbsp; Below is what you should see if everything checks out.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oMfimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-if-it-errors%2C-it-wil\">If it errors, it will display the issues, you\'ll need to resolve those before proceeding.&nbsp; If the checks are good it will pop up the following text-based GUI.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8wximage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-the-above-will-show-\">The above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.&nbsp; In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.&nbsp; That said, we\'ll select option 1 for \"GALFED\" and press enter.</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Hkdimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-the-script-builds-th\">The script builds the docker-compose.yml and tells you how to start sending emails.&nbsp; Then to kick it off just run the following.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstarttraf\"><code class=\"language-\">cd /root\r\n./starttrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-if-everything-went-w\">If everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GJgimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-at-this-point-you-ca\">At this point you can check your traffic logs - these are located at /root/TG/TrafficLog.&nbsp; There is a log for each emailing domains.&nbsp; You can tail all the logs at once with the following.</p>\r\n<pre id=\"bkmrk-tail--f-%2Froot%2Ftg%2Ftra\"><code class=\"language-\">tail -f /root/TG/TrafficLog/*</code></pre>\r\n<p id=\"bkmrk-here-is-a-sample-out\">Here is a sample output.</p>\r\n<p id=\"bkmrk--4\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Iz8image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-%C2%A0\">To stop the Traffic-Gen run the following<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstoptraff\"><code class=\"language-\">cd /root\r\n./stoptrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-output-will-look-lik\">output will look like.</p>\r\n<p id=\"bkmrk--5\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JBlimage.png\" alt=\"image.png\"></p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each domain that it will use to send emails from.  Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up takes a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber Range.  See Target Domain Planning Guide -> Connecting a target domain to the Cyber Range.   Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\n## When you run the above command, you should get a response from your target domain exchange server \r\n## that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder for it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh\r\ncd root\r\n./buidcompose.sh\r\nWhen the script first runs, it preforms some system checks.  The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.  The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains resolve to the IP listed in the emailerlist.txt file.  Below is what you should see if everything checks out.\r\n\r\nIf it errors, it will display the issues, you\'ll need to resolve those before proceeding.  If the checks are good it will pop up the following text-based GUI.\r\n\r\nThe above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.  In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.  That said, we\'ll select option 1 for \"GALFED\" and press enter.\r\n\r\nThe script builds the docker-compose.yml and tells you how to start sending emails.  Then to kick it off just run the following.\r\ncd /root\r\n./starttrafficgen.sh\r\nIf everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.\r\n\r\nAt this point you can check your traffic logs - these are located at /root/TG/TrafficLog.  There is a log for each emailing domains.  You can tail all the logs at once with the following.\r\ntail -f /root/TG/TrafficLog/*\r\nHere is a sample output.\r\n\r\nTo stop the Traffic-Gen run the following\r\ncd /root\r\n./stoptrafficgen.sh\r\noutput will look like.\r\n',1,'2023-04-12 22:03:06','2023-04-12 22:03:06','setting-up-the-traffic-gen-for-a-target-domain','how-to-guides','version','','',5),(257,13,'Creating Cobalt Strike C2 Profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike C2 Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So you should also testing this functionality on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; The max number of variants is 10, but it\'s a good idea to set this to 0.&nbsp; The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are;</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike.&nbsp; Or you can select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using SourcePoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">SourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n<ul id=\"bkmrk-path-for-the-executa\">\r\n<li class=\"null\">Path for the executable is /root/SourcePoint/SourcePoint</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">SourePoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.</li>\r\n<li class=\"null\">Required SourcePoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike C2 Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So you should also testing this functionality on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  The max number of variants is 10, but it\'s a good idea to set this to 0.  The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are;\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike.  Or you can select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing SourcePoint\r\n\r\nSourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n\r\nPath for the executable is /root/SourcePoint/SourcePoint\r\n\r\n\r\nSourePoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.\r\nRequired SourcePoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',1,'2023-04-12 22:08:18','2023-04-12 22:08:18','creating-cobalt-strike-c2-profiles','using-the-nrts','version','','',7),(259,14,'Starting a Cobalt Strike Teamserver (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.&nbsp; For instructions on how to create Cobalt Strike C2 profiles go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default.<br>\r\n<p>&nbsp;</p>\r\n</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use option 26&nbsp; \"USA\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use option 12 \"Seattle\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want a randomly generated IP or to set one manually.&nbsp; The guide will walk through both options.&nbsp; For a randomly set IP, the script will randomly select an IP from the Geo-location you selected during processing and the script will move on to the next menu.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add a random IP during processing so the menu will move to the next step.&nbsp; This will be shown after going over the manual process.</li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is what you will see when you select option \"s\".&nbsp; This list is can be long or short depending on the Geo-location you selected.&nbsp; Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu. &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.&nbsp; This will take you back to the previous menu.&nbsp; From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.&nbsp; NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.<br></li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">At this point you have either selected to randomly set an IP or set one manually.&nbsp; Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.\r\nAlso this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.  For instructions on how to create Cobalt Strike C2 profiles go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default.\r\n \r\n\r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use option 26  \"USA\".\r\n\r\n\r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use option 12 \"Seattle\".\r\n\r\n\r\n\r\nThen it will ask if you want a randomly generated IP or to set one manually.  The guide will walk through both options.  For a randomly set IP, the script will randomly select an IP from the Geo-location you selected during processing and the script will move on to the next menu.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add a random IP during processing so the menu will move to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is what you will see when you select option \"s\".  This list is can be long or short depending on the Geo-location you selected.  Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu.     \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.  This will take you back to the previous menu.  From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.  NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to randomly set an IP or set one manually.  Next, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n\r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n\r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n\r\n\r\nBelow is what the build process looks like.\r\n\r\n\r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',1,'2023-04-12 22:15:39','2023-04-12 22:15:39','starting-a-cobalt-strike-teamserver-buildredteamsh','using-the-nrts','version','','',8),(261,15,'Making a HAProxy Redirector (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and it doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default name or add own own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default of RD1. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\">&nbsp; <br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the option 25 \"UK\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select Option 2 \"London\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the manual process.<br></li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp; Below is the menu when you select Set IPs manually.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.&nbsp; The blank menu items will store IPs as you add them in.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Use the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the Geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.&nbsp; You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.150 from the 12.9.80.129/25 subnet.&nbsp; Note you can pick IPs from multiple IP subnets from the list.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.</li>\r\n<li class=\"null\">&nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-then-enter-the-ip.\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Then enter the IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.&nbsp; You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. <a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.&nbsp; This only changes the \"bind to\" on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but your Cobalt Strike listener will be listening on 8443, at least as long as you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirector should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This needs to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains - Option 1 - (use randomly generated one/s).&nbsp; If we select option 1, the script will add these during processing and move on to the next step.&nbsp; We\'ll cover that after going over the manual process.<br></li>\r\n<li class=\"null\">Assigning Domains - Option 2 - (Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list and&nbsp; it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.&nbsp; You will see the domain you entered is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; This directory will have you DNS information, IP information, where it\'s redirecting to, the name of the C2 profile used and an SSL folder containing signed SSL certs&nbsp; for all of the redirectors domains.&nbsp; You can validate if your redirector is running by looking at docker.&nbsp; Run docker ps and you should see RD1 up and running.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and it doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.  You can keep the default name or add own own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default of RD1.                                                                                                                               \r\n  \r\n\r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the option 25 \"UK\".\r\n\r\n\r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select Option 2 \"London\".\r\n\r\n\r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.  Below is the menu when you select Set IPs manually.  At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.  The blank menu items will store IPs as you add them in.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUse the \"s\" option to see available subnets.  This shows the available IP subnets based on the Geo-location selections you made previously.  The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.  You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.150 from the 12.9.80.129/25 subnet.  Note you can pick IPs from multiple IP subnets from the list.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\nThen enter the IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.  You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. \r\n\r\n\r\n\r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS.\r\n\r\n\r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.  This only changes the \"bind to\" on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but your Cobalt Strike listener will be listening on 8443, at least as long as you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n\r\n\r\nNext it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n\r\n\r\nNext it will ask what IP the redirector should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10.\r\n\r\n\r\n\r\nThen it will ask which Cobalt Strike profile to use.  This needs to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n\r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.\r\n\r\n\r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains - Option 1 - (use randomly generated one/s).  If we select option 1, the script will add these during processing and move on to the next step.  We\'ll cover that after going over the manual process.\r\nAssigning Domains - Option 2 - (Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list and  it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.  You will see the domain you entered is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n\r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.\r\n\r\n\r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  This directory will have you DNS information, IP information, where it\'s redirecting to, the name of the C2 profile used and an SSL folder containing signed SSL certs  for all of the redirectors domains.  You can validate if your redirector is running by looking at docker.  Run docker ps and you should see RD1 up and running.\r\n',1,'2023-04-12 22:27:00','2023-04-12 22:27:00','making-a-haproxy-redirector-buildredteamsh','using-the-nrts','version','','',11),(262,17,'Building a Payload Host (buildredteam.sh)','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.&nbsp; For this example, we\'ll leave it as the default of P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location for your IPs.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.&nbsp; For this example, we\'ll set our Geo-location to option 7 - France.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the script will move on to the next step.&nbsp; We\'ll cover that after going over the manual IP process.</li>\r\n<li class=\"null\">Setting IP\'s - Option 2 Set IPs manually.&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page down then&nbsp; press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, we\'ll select option 1 for the first blank spot.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-%C2%A0then-at-the-ip-entr\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">&nbsp;Then at the IP entry menu below we\'ll&nbsp; put in 184.84.181.201.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.&nbsp; You will see the blank at option 1 is populated with the IP you just entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"> &nbsp;</li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 1 use randomly generated one/s.&nbsp; When you select this, the script will generate random domains during processing and it will move on to the next step.&nbsp; This will be covered after walking through the manual DNS option.<br></li>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 2 Manually create domain name/s.&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"d\" when complete.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected to have domain names created Randomly or have completed the manual domain name process.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dDwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom service tag go there, ex.&nbsp; /root/services/&lt;service tag&gt;/WWW.</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.  For this example, we\'ll leave it as the default of P1.\r\n\r\n\r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location for your IPs.  The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.  For this example, we\'ll set our Geo-location to option 7 - France.\r\n\r\n\r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n\r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the script will move on to the next step.  We\'ll cover that after going over the manual IP process.\r\nSetting IP\'s - Option 2 Set IPs manually.  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page down then  press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, we\'ll select option 1 for the first blank spot.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n Then at the IP entry menu below we\'ll  put in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.  You will see the blank at option 1 is populated with the IP you just entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains -  Option 1 use randomly generated one/s.  When you select this, the script will generate random domains during processing and it will move on to the next step.  This will be covered after walking through the manual DNS option.\r\nAssigning Domains -  Option 2 Manually create domain name/s.  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"d\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have domain names created Randomly or have completed the manual domain name process.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.\r\n\r\n\r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom service tag go there, ex.  /root/services/<service tag>/WWW.\r\n',1,'2023-04-12 22:30:32','2023-04-12 22:30:32','building-a-payload-host-buildredteamsh','using-the-nrts','version','','',7),(264,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documenation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; </span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.&nbsp; </span></p>\r\n<p id=\"bkmrk-email-support---ther\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.&nbsp; </span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding-top: 0pt; padding-right: 0pt; padding-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.</span></p>\r\n<p dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\" id=\"bkmrk-disable-cortana---ap\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n<ul id=\"bkmrk-prevent-sleep---appl\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp; </span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></li>\r\n</ul>\r\n<p style=\"padding-left: 40px;\" id=\"bkmrk-group-policy-is-a-gr\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</span></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a>.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. </span></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</span></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTS</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. </span></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a> </span></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"text-decoration: underline;\">https://github.com/cmu-sei/GHOSTS</span>. This can be </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees that work for the blue space have some sort of job or role in the company, things like HR, finance, IT, etc.  This documenation includes the PowerShell script CreateADUsers.ps1.  This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic powershell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.  \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.  \r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.  \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls \r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. \r\nRouters \r\nVyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. \r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1 \r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-12 22:35:28','2023-04-12 22:35:28','general-guidance','target-domain-planning-guide','version','','',8),(266,25,'General Guidance','<p id=\"bkmrk-active-directory-ser\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Active Directory Server</span></p>\r\n<p id=\"bkmrk-user-accounts---crea\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">User accounts</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp; </span></p>\r\n<p id=\"bkmrk-dns---i-use-the-acti\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding-top: 0pt; padding-right: 0pt; padding-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">DNS</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\"> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.&nbsp; </span></p>\r\n<p id=\"bkmrk-email-support---ther\" style=\"padding-left: 40px;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Email support </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.&nbsp; </span></p>\r\n<p id=\"bkmrk-group-policies---i-w\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding-top: 0pt; padding-right: 0pt; padding-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: italic; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policies </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.</span></p>\r\n<p id=\"bkmrk-disable-cortana---ap\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 18pt; text-indent: -18pt; margin-top: 0pt; margin-bottom: 0pt; padding: 0pt 0pt 0pt 18pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Disable Cortana - Applied to Computer Configurations to Disable Cortana</span></p>\r\n<ul id=\"bkmrk-prevent-sleep---appl\">\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Prevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Enable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">MapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp; </span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">NTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</span></li>\r\n<li class=\"null\" style=\"line-height: 1.38;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">InstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</span></li>\r\n</ul>\r\n<p id=\"bkmrk-group-policy-is-a-gr\" style=\"padding-left: 40px;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.</span></p>\r\n<p id=\"bkmrk-file-server%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">File Server</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-just-install-a-windo\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</span></p>\r\n<p id=\"bkmrk-exchange%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Exchange</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-this-is-probably-the\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a>.</span></p>\r\n<p id=\"bkmrk-workstations%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Workstations</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-make-sure-you-instal\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</span></p>\r\n<p id=\"bkmrk-firewalls%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Firewalls</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-pfsense%2C-typi\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. </span></p>\r\n<p id=\"bkmrk-routers%C2%A0\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Routers</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">&nbsp;</span></p>\r\n<p id=\"bkmrk-we-use-vyos---these-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</span></p>\r\n<p id=\"bkmrk-snapshotting\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">SNAPSHOTS</span></p>\r\n<p id=\"bkmrk-i-always-create-powe\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. </span></p>\r\n<p id=\"bkmrk-powering-on-and-off\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Powering On and Off</span></p>\r\n<p id=\"bkmrk-powering-on%2C-i-start\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a> </span></p>\r\n<p id=\"bkmrk-internal-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Internal Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-ghosts---its-\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\"><span style=\"text-decoration: underline;\">https://github.com/cmu-sei/GHOSTS</span>. This can be </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from </span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: underline; text-decoration-skip-ink: none; vertical-align: baseline; white-space: pre-wrap;\">https://www.dimastr.com/redemption/download.htm</span><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</span></p>\r\n<p id=\"bkmrk-external-traffic-gen\" dir=\"ltr\" style=\"line-height: 1.38; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 13pt; font-family: Arial; background-color: transparent; font-weight: bold; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External Traffic Generation</span></p>\r\n<p id=\"bkmrk-we-use-whats-built-i\" dir=\"ltr\" style=\"line-height: 1.38; margin-left: 36pt; margin-top: 0pt; margin-bottom: 0pt;\"><span style=\"font-size: 11pt; font-family: Arial; background-color: transparent; font-weight: 400; font-style: normal; font-variant: normal; text-decoration: none; vertical-align: baseline; white-space: pre-wrap;\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</span></p>','Active Directory Server\r\nUser accounts - Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin.  \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.  \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.  \r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\n\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.  \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA_Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\nFile Server \r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange \r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1.\r\nWorkstations \r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls \r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. \r\nRouters \r\nVyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots. \r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1 \r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-12 22:44:50','2023-04-12 22:44:50','general-guidance','target-domain-planning-guide','version','','',9),(268,25,'General Guidance','<h4 id=\"bkmrk-active-directory-ser\">Active Directory Server</h4>\r\n<ul id=\"bkmrk-user-accounts--creat\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>User accounts</strong></span>- Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.&nbsp; This is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>DNS</strong></span> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Email support </strong></span>- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Group Policies </strong></span>- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Disable Cortana</span> - Applied to Computer Configurations to Disable Cortana</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Prevent Sleep </span>- Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Enable PSRemoting</span> - Applied to Computer Configurations - enabling WinRM Client and Service</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">MapNetworkDrives </span>- Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">NTP from DC</span> - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">InstallCA Certs </span>- since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.&nbsp; This script imports the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-file-server\">File Server</h4>\r\n<p id=\"bkmrk-just-install-a-windo\">Just install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</p>\r\n<h4 id=\"bkmrk-exchange\">Exchange</h4>\r\n<p id=\"bkmrk-this-is-probably-the\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></p>\r\n<h4 id=\"bkmrk-workstations\">Workstations</h4>\r\n<p id=\"bkmrk-make-sure-you-instal\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</p>\r\n<h4 id=\"bkmrk-firewalls\">Firewalls</h4>\r\n<p id=\"bkmrk-pfsense-is-a-decent-\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. Routers Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.</p>\r\n<h4 id=\"bkmrk-snapshots\">SNAPSHOTS</h4>\r\n<p id=\"bkmrk-its-good-practice-to\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.</p>\r\n<h4 id=\"bkmrk-powering-on-and-off\">Powering On and Off</h4>\r\n<p id=\"bkmrk-this-is-in-regards-t\">This is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></p>\r\n<h4 id=\"bkmrk-internal-traffic-gen\">Internal Traffic Generation</h4>\r\n<p id=\"bkmrk-carnegie-mellon%2C-pro\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.&nbsp; It’s around $300 per year or you can get a lifetime license for $900.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</p>\r\n<h4 id=\"bkmrk-external-traffic-gen\">External Traffic Generation</h4>\r\n<p id=\"bkmrk-external-traffic-is-\">External traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</p>','Active Directory Server\r\n\r\nUser accounts- Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets a generic password that is LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized easy to remember passwords so that while you are working with the blue space you could easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups.  This is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin. \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Fake Internet space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS to point to the rootDNS server. \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.\r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a blue space connected to a fake internet cyber range environment.\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups. \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA Certs - since we aren’t connected to the real internet, we built a Certificate Authority in our fake internet (CA-Server), then use this to issue certificates to the various HTTPS sites on the range.  This script imports the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a blue space.\r\n\r\nFile Server\r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense for what you want your blue space to do.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and do some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange\r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1\r\nWorkstations\r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls\r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build. Routers Vyos is a decent freeware solution for your routing requirements. you can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.\r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire blue space. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1\r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  It’s around $300 per year or you can get a lifetime license for $900.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your blue space from the grayspace, aka fake internet. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-13 01:06:40','2023-04-13 01:06:40','general-guidance','target-domain-planning-guide','version','','',10),(270,25,'General Guidance','<h4 id=\"bkmrk-active-directory-ser\">Active Directory Server</h4>\r\n<ul id=\"bkmrk-user-accounts--creat\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>User accounts</strong></span>- Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the use to that group.&nbsp; Having unique AD group assignments&nbsp; is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>DNS</strong></span> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Email support </strong></span>- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Group Policies </strong></span>- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that&nbsp; connected to a fake internet (Cyber Range) environment.\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Disable Cortana</span> - Applied to Computer Configurations to Disable Cortana</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Prevent Sleep </span>- Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Enable PSRemoting</span> - Applied to Computer Configurations - enabling WinRM Client and Service</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">MapNetworkDrives </span>- Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">NTP from DC</span> - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">InstallCA Certs </span>- since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.&nbsp; This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-file-server\">File Server</h4>\r\n<p id=\"bkmrk-just-install-a-windo\">Just install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</p>\r\n<h4 id=\"bkmrk-exchange\">Exchange</h4>\r\n<p id=\"bkmrk-this-is-probably-the\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></p>\r\n<h4 id=\"bkmrk-workstations\">Workstations</h4>\r\n<p id=\"bkmrk-make-sure-you-instal\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</p>\r\n<h4 id=\"bkmrk-firewalls\">Firewalls</h4>\r\n<p id=\"bkmrk-pfsense-is-a-decent-\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.</p>\r\n<h4 id=\"bkmrk-routers\">Routers</h4>\r\n<p id=\"bkmrk-vyos-is-a-decent-fre\">Vyos is a decent freeware solution for your routing requirements.&nbsp; You can use routers to manage routing between various blue space internal subnets.</p>\r\n<h4 id=\"bkmrk-snapshots\">SNAPSHOTS</h4>\r\n<p id=\"bkmrk-its-good-practice-to\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.</p>\r\n<h4 id=\"bkmrk-powering-on-and-off\">Powering On and Off</h4>\r\n<p id=\"bkmrk-this-is-in-regards-t\">This is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></p>\r\n<h4 id=\"bkmrk-internal-traffic-gen\">Internal Traffic Generation</h4>\r\n<p id=\"bkmrk-carnegie-mellon%2C-pro\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up see the Ghosts set up guide.&nbsp; I did provide some details on the “Ghost set up” document.</p>\r\n<h4 id=\"bkmrk-external-traffic-gen\">External Traffic Generation</h4>\r\n<p id=\"bkmrk-external-traffic-is-\">External traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt;&nbsp;<a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</p>','Active Directory Server\r\n\r\nUser accounts- Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the use to that group.  Having unique AD group assignments  is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin. \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server. \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.\r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that  connected to a fake internet (Cyber Range) environment.\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups. \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA Certs - since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.  This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.\r\n\r\nFile Server\r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange\r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1\r\nWorkstations\r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls\r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.\r\nRouters\r\nVyos is a decent freeware solution for your routing requirements.  You can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.\r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1\r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up see the Ghosts set up guide.  I did provide some details on the “Ghost set up” document.\r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-13 01:32:07','2023-04-13 01:32:07','general-guidance','target-domain-planning-guide','version','','',11);
INSERT INTO `page_revisions` VALUES (272,25,'General Guidance','<h4 id=\"bkmrk-active-directory-ser\">Active Directory Server</h4>\r\n<ul id=\"bkmrk-user-accounts--creat\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>User accounts</strong></span>- Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the use to that group.&nbsp; Having unique AD group assignments&nbsp; is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>DNS</strong></span> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Email support </strong></span>- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Group Policies </strong></span>- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that&nbsp; connected to a fake internet (Cyber Range) environment.\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Disable Cortana</span> - Applied to Computer Configurations to Disable Cortana</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Prevent Sleep </span>- Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Enable PSRemoting</span> - Applied to Computer Configurations - enabling WinRM Client and Service</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">MapNetworkDrives </span>- Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">NTP from DC</span> - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">InstallCA Certs </span>- since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.&nbsp; This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-file-server\">File Server</h4>\r\n<p id=\"bkmrk-just-install-a-windo\">Just install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</p>\r\n<h4 id=\"bkmrk-exchange\">Exchange</h4>\r\n<p id=\"bkmrk-this-is-probably-the\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></p>\r\n<h4 id=\"bkmrk-workstations\">Workstations</h4>\r\n<p id=\"bkmrk-make-sure-you-instal\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp; Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</p>\r\n<h4 id=\"bkmrk-firewalls\">Firewalls</h4>\r\n<p id=\"bkmrk-pfsense-is-a-decent-\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.</p>\r\n<h4 id=\"bkmrk-routers\">Routers</h4>\r\n<p id=\"bkmrk-vyos-is-a-decent-fre\">Vyos is a decent freeware solution for your routing requirements.&nbsp; You can use routers to manage routing between various blue space internal subnets.</p>\r\n<h4 id=\"bkmrk-snapshots\">SNAPSHOTS</h4>\r\n<p id=\"bkmrk-its-good-practice-to\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, I typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.</p>\r\n<h4 id=\"bkmrk-powering-on-and-off\">Powering On and Off</h4>\r\n<p id=\"bkmrk-this-is-in-regards-t\">This is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></p>\r\n<h4 id=\"bkmrk-internal-traffic-gen\">Internal Traffic Generation</h4>\r\n<p id=\"bkmrk-carnegie-mellon%2C-pro\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts set up go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/ghost-traffic-generation\">Ghost Traffic Generation</a>.&nbsp;<br></p>\r\n<h4 id=\"bkmrk-external-traffic-gen\">External Traffic Generation</h4>\r\n<p id=\"bkmrk-external-traffic-is-\">External traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt;&nbsp;<a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</p>','Active Directory Server\r\n\r\nUser accounts- Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the use to that group.  Having unique AD group assignments  is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin. \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server. \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.\r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that  connected to a fake internet (Cyber Range) environment.\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups. \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA Certs - since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.  This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.\r\n\r\nFile Server\r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange\r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB server.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1\r\nWorkstations\r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.  Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls\r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.\r\nRouters\r\nVyos is a decent freeware solution for your routing requirements.  You can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, I typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like, at least if you made powered off snapshots.\r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1\r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts set up go to -> Target Domain Planning Guide -> Ghost Traffic Generation. \r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-13 01:34:28','2023-04-13 01:34:28','general-guidance','target-domain-planning-guide','version','','',12),(274,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at <a href=\"https://github.com/cmu-sei/GHOSTS\">https://github.com/cmu-sei/GHOSTS</a> The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.</p>\r\n<h4 id=\"bkmrk-ghost-set-up\">Ghost set up</h4>\r\n<p id=\"bkmrk-you-need-to-put-the-\">You need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.</p>\r\n<h4 id=\"bkmrk-configuring-ghost\">Configuring Ghost<br></h4>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\">Config files (Ghosts/config)\r\n<ul>\r\n<li class=\"null\">Application.json - Used for general application variables and settings.&nbsp; Its designed to work with a management website through API’s.&nbsp; However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n<ul>\r\n<li class=\"null\">Change the following variables to false\r\n<ul>\r\n<li class=\"null\">IdEnabled - at the top</li>\r\n<li class=\"null\">IsEnabled - under ClientResults</li>\r\n<li class=\"null\">IsEnabled&nbsp; - under ClientUpdates</li>\r\n<li class=\"null\">IsEnabled - under Survey Health</li>\r\n<li class=\"null\">IsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Make sure the following variable is true\r\n<ul>\r\n<li class=\"null\">HandlersIsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Remove the URLs every where you see it, the default looks like <a href=\"http://ghosts-c2/api/\">http://ghosts-c2/api/</a>.\r\n<ul>\r\n<li class=\"null\">Set these which are typically under “PostURL”&nbsp; to “”</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</li>\r\n<li class=\"null\">Then in “Email”, the options are self explanatory, set these however you want it to run</li>\r\n<li class=\"null\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.&nbsp; Here’s and example for a domain of galfed.com.\r\n<ul>\r\n<li class=\"null\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Dictionary.json - Not sure what this is used for, unfortunately Ghost isn\'t very well documented.&nbsp;</li>\r\n<li class=\"null\">Email-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</li>\r\n<li class=\"null\">Email-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</li>\r\n<li class=\"null\">Emails-domain.json - This is a list of all you’re target domain users emails, you have to make this.&nbsp;</li>\r\n<li class=\"null\">Emails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like&nbsp;<a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.</li>\r\n<li class=\"null\">Filenames.json - List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</li>\r\n<li class=\"null\">Health.json - It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.</li>\r\n<li class=\"null\">Timeline.json - This is where you set up ghosts to preform activities as a user.&nbsp; Look at sample configs. We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep. If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Logs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. Provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n<ul>\r\n<li class=\"null\">App.log</li>\r\n<li class=\"null\">Clientupdates.log</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<h4 id=\"bkmrk-starting-and-stoppin\">STARTING AND STOPPING GHOSTS</h4>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</p>\r\n<p id=\"bkmrk-to-stop-ghosts%2C-just\">To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</p>\r\n<h4 id=\"bkmrk-notes%3A%C2%A0\">NOTES:&nbsp;</h4>\r\n<p id=\"bkmrk-ghost-can-be-resourc\">Ghost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute. If you change the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.</p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at https://github.com/cmu-sei/GHOSTS The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.\r\nGhost set up\r\nYou need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.\r\nConfiguring Ghost\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json - Used for general application variables and settings.  Its designed to work with a management website through API’s.  However, the management website isn\'t very intuitive. This document includes a GhostManagement.ps1 that makes for a decent Ghost management GUI.\r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey Health\r\nIsEnabled\r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like http://ghosts-c2/api/.\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command to make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\nDictionary.json - Not sure what this is used for, unfortunately Ghost isn\'t very well documented. \r\nEmail-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\nEmail-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\nEmails-domain.json - This is a list of all you’re target domain users emails, you have to make this. \r\nEmails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net. So anything you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverable. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.\r\nFilenames.json - List that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\nHealth.json - It will check a URL and for reporting health status, if you don’t use their management site and you can disable health in the application.json, so this doesn’t matter.\r\nTimeline.json - This is where you set up ghosts to preform activities as a user.  Look at sample configs. We add a handler type called Clicks that runs every minute, this just prevents the workstation it’s on from going to sleep. If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.\r\n\r\n\r\nLogs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. Provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\nTo start ghost, just click on the ghosts.exe in the root of the ghost folder\r\nTo stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\nGhost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute. If you change the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.',1,'2023-04-13 16:38:52','2023-04-13 16:38:52','ghost-traffic-generation','target-domain-planning-guide','version','','',7),(276,25,'General Guidance','<h4 id=\"bkmrk-active-directory-ser\">Active Directory Server</h4>\r\n<ul id=\"bkmrk-user-accounts--creat\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>User accounts</strong></span>- Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the user to that group.&nbsp; Having unique AD group assignments&nbsp; is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>DNS</strong></span> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Email support </strong></span>- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Group Policies </strong></span>- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that&nbsp; connected to a fake internet (Cyber Range) environment.\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Disable Cortana</span> - Applied to Computer Configurations to Disable Cortana</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Prevent Sleep </span>- Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Enable PSRemoting</span> - Applied to Computer Configurations - enabling WinRM Client and Service</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">MapNetworkDrives </span>- Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">NTP from DC</span> - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">InstallCA Certs </span>- since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.&nbsp; This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-file-server\">File Server</h4>\r\n<p id=\"bkmrk-just-install-a-windo\">Just install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</p>\r\n<h4 id=\"bkmrk-exchange\">Exchange</h4>\r\n<p id=\"bkmrk-this-is-probably-the\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB hard drive.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></p>\r\n<h4 id=\"bkmrk-workstations\">Workstations</h4>\r\n<p id=\"bkmrk-make-sure-you-instal\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp;</p>\r\n<p id=\"bkmrk-then-make-sure-the-w\">Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one-off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</p>\r\n<h4 id=\"bkmrk-firewalls\">Firewalls</h4>\r\n<p id=\"bkmrk-pfsense-is-a-decent-\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.</p>\r\n<h4 id=\"bkmrk-routers\">Routers</h4>\r\n<p id=\"bkmrk-vyos-is-a-decent-fre\">Vyos is a decent freeware solution for your routing requirements.&nbsp; You can use routers to manage routing between various blue space internal subnets.</p>\r\n<h4 id=\"bkmrk-snapshots\">SNAPSHOTS</h4>\r\n<p id=\"bkmrk-its-good-practice-to\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like.</p>\r\n<h4 id=\"bkmrk-powering-on-and-off\">Powering On and Off</h4>\r\n<p id=\"bkmrk-this-is-in-regards-t\">This is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></p>\r\n<h4 id=\"bkmrk-internal-traffic-gen\">Internal Traffic Generation</h4>\r\n<p id=\"bkmrk-carnegie-mellon%2C-pro\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/ghost-traffic-generation\">Ghost Traffic Generation</a>.&nbsp;<br></p>\r\n<h4 id=\"bkmrk-external-traffic-gen\">External Traffic Generation</h4>\r\n<p id=\"bkmrk-external-traffic-is-\">External traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt;&nbsp;<a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</p>','Active Directory Server\r\n\r\nUser accounts- Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the user to that group.  Having unique AD group assignments  is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin. \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server. \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.\r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that  connected to a fake internet (Cyber Range) environment.\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups. \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA Certs - since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.  This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.\r\n\r\nFile Server\r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange\r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB hard drive.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1\r\nWorkstations\r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software. \r\nThen make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one-off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls\r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.\r\nRouters\r\nVyos is a decent freeware solution for your routing requirements.  You can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like.\r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1\r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts go to -> Target Domain Planning Guide -> Ghost Traffic Generation. \r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',1,'2023-04-13 20:27:12','2023-04-13 20:27:12','general-guidance','target-domain-planning-guide','version','','',13),(278,26,'Ghost Traffic Generation','<p id=\"bkmrk-ghost-is-a-traffic-g\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at <a href=\"https://github.com/cmu-sei/GHOSTS\">https://github.com/cmu-sei/GHOSTS</a> The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.</p>\r\n<h4 id=\"bkmrk-ghost-set-up\">Ghost set up</h4>\r\n<p id=\"bkmrk-you-need-to-put-the-\">You need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.&nbsp; The included powershell script GhostManagement.ps1 can help with Ghost management and deployment.<br></p>\r\n<h4 id=\"bkmrk-configuring-ghost\">Configuring Ghost<br></h4>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\">Config files (Ghosts/config)\r\n<ul>\r\n<li class=\"null\">Application.json - Used for general application variables and settings.&nbsp;<br>\r\n<ul>\r\n<li class=\"null\">Change the following variables to false\r\n<ul>\r\n<li class=\"null\">IdEnabled - at the top</li>\r\n<li class=\"null\">IsEnabled - under ClientResults</li>\r\n<li class=\"null\">IsEnabled&nbsp; - under ClientUpdates</li>\r\n<li class=\"null\">IsEnabled - under Survey Health</li>\r\n<li class=\"null\">IsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Make sure the following variable is true\r\n<ul>\r\n<li class=\"null\">HandlersIsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Remove the URLs every where you see it, the default looks like <a href=\"http://ghosts-c2/api/\">http://ghosts-c2/api/</a>.\r\n<ul>\r\n<li class=\"null\">Set these which are typically under “PostURL”&nbsp; to “”</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</li>\r\n<li class=\"null\">Then in “Email”, the options are self explanatory, set these however you want it to run</li>\r\n<li class=\"null\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command on your Target Domain DC with powershell make sure it works.&nbsp; Here’s and example for a domain of galfed.com.\r\n<ul>\r\n<li class=\"null\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Dictionary.json - Not sure what this is used for, Ghost isn\'t very well documented.&nbsp;</li>\r\n<li class=\"null\">Email-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</li>\r\n<li class=\"null\">Email-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</li>\r\n<li class=\"null\">Emails-domain.json - This is a list of all you’re target domain users emails, you have to make this.&nbsp;</li>\r\n<li class=\"null\">Emails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net.&nbsp; You can use anything name you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverables. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.</li>\r\n<li class=\"null\">Filenames.json - List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</li>\r\n<li class=\"null\">Health.json - It will check a URL and for reporting health status, if you don’t use their management site ghost provides, you can disable health in the application.json.</li>\r\n<li class=\"null\">Timeline.json - This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample config file \"timeline.json\".&nbsp; If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Logs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. It provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n<ul>\r\n<li class=\"null\">App.log</li>\r\n<li class=\"null\">Clientupdates.log</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<h4 id=\"bkmrk-starting-and-stoppin\">STARTING AND STOPPING GHOSTS</h4>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</p>\r\n<p id=\"bkmrk-to-stop-ghosts%2C-just\">To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</p>\r\n<h4 id=\"bkmrk-notes%3A%C2%A0\">NOTES:&nbsp;</h4>\r\n<p id=\"bkmrk-ghost-can-be-resourc\">Ghost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.</p>\r\n<p id=\"bkmrk-if-you-update-the-ti\">If you update the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.</p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at https://github.com/cmu-sei/GHOSTS The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.\r\nGhost set up\r\nYou need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.  The included powershell script GhostManagement.ps1 can help with Ghost management and deployment.\r\nConfiguring Ghost\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json - Used for general application variables and settings. \r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey Health\r\nIsEnabled\r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like http://ghosts-c2/api/.\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command on your Target Domain DC with powershell make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\nDictionary.json - Not sure what this is used for, Ghost isn\'t very well documented. \r\nEmail-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\nEmail-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\nEmails-domain.json - This is a list of all you’re target domain users emails, you have to make this. \r\nEmails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net.  You can use anything name you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverables. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.\r\nFilenames.json - List that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\nHealth.json - It will check a URL and for reporting health status, if you don’t use their management site ghost provides, you can disable health in the application.json.\r\nTimeline.json - This is where you set up ghosts to preform activities as a user.  Look at the sample config file \"timeline.json\".  If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.\r\n\r\n\r\nLogs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. It provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\nTo start ghost, just click on the ghosts.exe in the root of the ghost folder\r\nTo stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\nGhost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.\r\nIf you update the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.',1,'2023-04-13 20:35:31','2023-04-13 20:35:31','ghost-traffic-generation','target-domain-planning-guide','version','','',8),(280,27,'Blue Space Set up and Management Scripts','<ul id=\"bkmrk-cleanlogs.ps1-is-des\">\r\n<li class=\"null\">CleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space on the exchange.&nbsp; This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">DeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space and the size of the .edb mail database.&nbsp; This script is ussually ran in conjunction with CleanLogs.ps1.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.&nbsp; This will also create user defined AD groups and assign the new user to these groups.&nbsp; This is a template, feel free to modify to meet the needs you have for your environment.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a><br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/3\" target=\"_blank\" rel=\"noopener\">CreateMailboxes.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Range-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.&nbsp; This script needs to be ran from the management network meaning the network where the ESXI Host IP resides and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n<ul id=\"bkmrk-%C2%A0range-management.ps\">\r\n<li class=\"null\">&nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></li>\r\n</ul>\r\n</li>\r\n</ul>','\r\nCleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space on the exchange.  This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n\r\nCleanLogs.ps1\r\n\r\n\r\nDeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space and the size of the .edb mail database.  This script is ussually ran in conjunction with CleanLogs.ps1.\r\n\r\nDeleteAllEmails.ps1\r\n\r\n\r\nCreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.  This will also create user defined AD groups and assign the new user to these groups.  This is a template, feel free to modify to meet the needs you have for your environment.\r\n\r\nCreateADUsers.ps1\r\n\r\n\r\nCreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n\r\nCreateMailboxes.ps1\r\n\r\n\r\nRange-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.  This script needs to be ran from the management network meaning the network where the ESXI Host IP resides and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n\r\n Range-Management.ps1\r\n\r\n\r\n',1,'2023-04-13 20:37:54','2023-04-13 20:37:54','blue-space-set-up-and-management-scripts','target-domain-planning-guide','version','','',6),(282,28,'Importing CA and Int Certs to your Target Domain','<p id=\"bkmrk-the-cyber-range-envi\">The Cyber Range environment will create a CA and intermediate Authority.&nbsp; This is used to simulate real world SSL signing services like Digicert or Verisign.&nbsp; By default, the Cyber Range installation will create one called globalcert.com.&nbsp; The globalcert.com CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.&nbsp; These certs need to be imported into the trust stores of your windows based target systems.&nbsp; Below are the instructions for doing so.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-obtain-the-\">Step 1.&nbsp; Obtain the certs from the CA-Server</p>\r\n<ul id=\"bkmrk-from-your-target-dom\">\r\n<li class=\"null\">From your target domain, scp these certs off of the CA-server.\r\n<ul>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem&nbsp; ca.globalcert.com.crt.pem</li>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-2.%C2%A0-move-these-\">Step 2.&nbsp; Move these certs to your Active Directory server, and create a GPO to add these to the trust store.</p>\r\n<ul id=\"bkmrk-on-the-dc%2C-open-%22gro\">\r\n<li class=\"null\">On the DC, open \"Group Policy Management\"</li>\r\n<li class=\"null\">Creeat a new GPO linked to your Target Domain and name it something like \"Import_CA\"</li>\r\n<li class=\"null\">Edit this GPO and then add the certificates.\r\n<ul>\r\n<li class=\"null\">First, well add the CA certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Trusted Root Certificate Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Next import, the intermediate certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Intermediate Certification Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-3.%C2%A0-close-the-%22\">Step 3.&nbsp; Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.&nbsp; Then from a target domain VM browse to https://redbook.com to validate there isn\'t an SSL error/warning.<br></p>','The Cyber Range environment will create a CA and intermediate Authority.  This is used to simulate real world SSL signing services like Digicert or Verisign.  By default, the Cyber Range installation will create one called globalcert.com.  The globalcert.com CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.  These certs need to be imported into the trust stores of your windows based target systems.  Below are the instructions for doing so.\r\nStep 1.  Obtain the certs from the CA-Server\r\n\r\nFrom your target domain, scp these certs off of the CA-server.\r\n\r\nscp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem  ca.globalcert.com.crt.pem\r\nscp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem\r\n\r\n\r\n\r\nStep 2.  Move these certs to your Active Directory server, and create a GPO to add these to the trust store.\r\n\r\nOn the DC, open \"Group Policy Management\"\r\nCreeat a new GPO linked to your Target Domain and name it something like \"Import_CA\"\r\nEdit this GPO and then add the certificates.\r\n\r\nFirst, well add the CA certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Trusted Root Certificate Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\nNext import, the intermediate certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Intermediate Certification Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\n\r\n\r\n\r\nStep 3.  Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.  Then from a target domain VM browse to https://redbook.com to validate there isn\'t an SSL error/warning.',1,'2023-04-13 20:41:22','2023-04-13 20:41:22','importing-ca-and-int-certs-to-your-target-domain','target-domain-planning-guide','version','','',4),(284,29,'Connecting a Target Domain to the Cyber Range','<p id=\"bkmrk-connecting-a-blue-sp\">Connecting a blue space is fairly straight forward.&nbsp; You can have a single WAN point for a blue space or as many as you would like.&nbsp; You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.&nbsp; Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.</p>\r\n<p id=\"bkmrk-below-is-the-simply-\">Below is the simple blue space example.</p>\r\n<div drawio-diagram=\"165\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155829.png\"></div>\r\n<p id=\"bkmrk-in-the-diagram-above\">In the diagram above, your Target Domain is built on another ESXI server.&nbsp; On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.&nbsp; Then this virtual switch will need an uplink that connects to a physical NIC on the host server.&nbsp; Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.&nbsp; Then connect a line between the&nbsp; physical NICs on those two servers.&nbsp;&nbsp;</p>\r\n<p id=\"bkmrk-next%2C-you-need-to-ip\">Next, you need to IP this connection.&nbsp; You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.&nbsp; A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.&nbsp; Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.</p>\r\n<p id=\"bkmrk-%C2%A0from-the-nrts-serve\">&nbsp;From the NRTS server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fbackbonerou\"><code class=\"language-\">cd /root/backbonerouters\r\ngrep 44.22.1 */*</code></pre>\r\n<p id=\"bkmrk-above-we-are-greppin\">Above we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.&nbsp; This will find all possible matches.&nbsp; Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.&nbsp; If your grep comes back empty, you are good to go with the IP you selected.&nbsp; Typically for a WAN connection, a /29 subnet is a reasonable choice.&nbsp;&nbsp; For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,&nbsp; the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.&nbsp; We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.&nbsp; Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.&nbsp; Below are the instructions for this.</p>\r\n<ul id=\"bkmrk-console-into-the-si-\">\r\n<li class=\"null\">Console into the SI-Router on the Cyber Range.</li>\r\n<li class=\"null\">Then edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source-\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<ul id=\"bkmrk-then-save-the-script\">\r\n<li class=\"null\">Then save the script and run it with ./Eth3RangeWAN.sh.&nbsp; That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.</li>\r\n</ul>\r\n<p id=\"bkmrk-adding-additional-ta\">Adding additional target domains is basically the same.&nbsp; For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.&nbsp; Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.&nbsp; For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.&nbsp; The Eth3RangeWAN.sh script would look like the following.&nbsp; Then we just run the script again.&nbsp; You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.</p>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source--1\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<p id=\"bkmrk-note%3A-you%27ll-need-a-\">NOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.&nbsp; ESXI virtual switches are limited to a single uplink.&nbsp; Technically you can have 4 uplinks on a Virtual Switch in ESXI, but these additional uplinks can only be configured as teamed or fail over ports.&nbsp; So essentially its like a single logical port.&nbsp; So to connect multiple Target Domains, you\'ll just need to put a switch between the connections from&nbsp; target domain&nbsp; WANs to the Cyber Range RangeWAN uplink port.&nbsp; Below is a really poorly made diagram of this.<br></p>\r\n<div drawio-diagram=\"179\" id=\"bkmrk--2\" contenteditable=\"false\"><img id=\"bkmrk--3\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681243955.png\"></div>','Connecting a blue space is fairly straight forward.  You can have a single WAN point for a blue space or as many as you would like.  You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.  Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.\r\nBelow is the simple blue space example.\r\n\r\nIn the diagram above, your Target Domain is built on another ESXI server.  On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.  Then this virtual switch will need an uplink that connects to a physical NIC on the host server.  Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.  Then connect a line between the  physical NICs on those two servers.  \r\nNext, you need to IP this connection.  You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.  A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.  Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.\r\n From the NRTS server.\r\ncd /root/backbonerouters\r\ngrep 44.22.1 */*\r\nAbove we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.  This will find all possible matches.  Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.  If your grep comes back empty, you are good to go with the IP you selected.  Typically for a WAN connection, a /29 subnet is a reasonable choice.   For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,  the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.  We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.  Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.  Below are the instructions for this.\r\n\r\nConsole into the SI-Router on the Cyber Range.\r\nThen edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following\r\n\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\n\r\nThen save the script and run it with ./Eth3RangeWAN.sh.  That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.\r\n\r\nAdding additional target domains is basically the same.  For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.  Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.  For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.  The Eth3RangeWAN.sh script would look like the following.  Then we just run the script again.  You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\nNOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.  ESXI virtual switches are limited to a single uplink.  Technically you can have 4 uplinks on a Virtual Switch in ESXI, but these additional uplinks can only be configured as teamed or fail over ports.  So essentially its like a single logical port.  So to connect multiple Target Domains, you\'ll just need to put a switch between the connections from  target domain  WANs to the Cyber Range RangeWAN uplink port.  Below is a really poorly made diagram of this.\r\n',1,'2023-04-13 22:40:20','2023-04-13 22:40:20','connecting-a-target-domain-to-the-cyber-range','target-domain-planning-guide','version','','',3),(286,31,'Adding DNS for your Target Domain','<p id=\"bkmrk-the-target-domains-y\">You will most likely want the target domains you connect to the Cyber Range to have \"publicly\" available services, for example maybe a public facing website and/or email services.&nbsp; For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.&nbsp; Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.&nbsp; Adding Target Domain DNS to the RootDNS server is a purely manual process.&nbsp; This guide is to help get that set up with a few examples.&nbsp;</p>\r\n<p id=\"bkmrk-example-1---your-tar\"><span style=\"text-decoration: underline;\"><strong>Example 1 </strong></span>- Your target domain is called widgets.com and has a public facing website and a mail server.&nbsp; For the purpose of this guide we\'ll assume that we have already completed the Target Domain Planning Guide -&gt; Connecting a Target Domain to the Cyber Range.&nbsp;&nbsp; Additionally, we decided to use 44.22.11.10/29 for target domain&nbsp; firewall WAN connection.&nbsp; Then, to enable our public services to reachable through our Firewall, we set up a port forward on 44.22.11.10 to send port 80 and 443 to our target domain web server, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to our target domains exchange server.&nbsp;&nbsp;&nbsp; Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th\">Step 1.&nbsp; Log into the RootDNS server.&nbsp; Then create a zone file in the /etc/bind/RANGE directory.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind%2Frange-v\"><code class=\"language-\">cd /etc/bind/RANGE\r\nvi db.widgets.com</code></pre>\r\n<p id=\"bkmrk-next-we-need-to-put-\">Next we need to put the following in the db.widgets.com zone file.</p>\r\n<pre id=\"bkmrk-%3B-widgets-blue-space\"><code class=\"language-\">; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4</code></pre>\r\n<p id=\"bkmrk-so-lets-explain-this\">So lets explain this line by line.</p>\r\n<ul id=\"bkmrk-line-1%C2%A0-%22%3B-widgets-b\">\r\n<li class=\"null\">Line 1&nbsp; \"; Widgets blue space DNS\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is just a comment, in a zone file you can add comments using a \";\".\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">NOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Line 2&nbsp; \"$TTL&nbsp;&nbsp;&nbsp;&nbsp; 88640\"&nbsp;&nbsp; This is the time in seconds that caching DNS servers should cache this record.</li>\r\n<li class=\"null\">Line 3 \"@&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp; @&nbsp;&nbsp; ns.widgets.com.&nbsp; 42 3H 15M 1W 1D\"&nbsp;&nbsp; This is the Start of Authority (SOA)&nbsp; for the domain.&nbsp; The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL</li>\r\n<li class=\"null\">Line 4 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns.widgets.com.\"&nbsp;&nbsp; This is setting the NameServer for the domain to the domain of ns.widgets.com</li>\r\n<li class=\"null\">Line 5 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp; widgets.com.\"&nbsp; This is setting the MX (mail server) domain to widgets.com.&nbsp; The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.</li>\r\n<li class=\"null\">Line 6 \"@&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp; 44.22.11.11\" .&nbsp; The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.&nbsp; This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.</li>\r\n<li class=\"null\">Line 7 \"www&nbsp;&nbsp; IN&nbsp;&nbsp; A&nbsp; 44.22.11.10\".&nbsp;&nbsp;&nbsp; This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.</li>\r\n<li class=\"null\">Line 8 \"owa&nbsp; IN&nbsp;&nbsp; A&nbsp;&nbsp; 44.22.11.11\".&nbsp; This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.</li>\r\n<li class=\"null\">Line 9 \"ns&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; A 198.41.0.4\".&nbsp; This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.&nbsp; The IP 198.41.0.4 is an IP on the rootDNS server itself.&nbsp; This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.&nbsp; IPv6 records at set using \"AAAA\" verse \"A\".&nbsp; For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.&nbsp; This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. <br></li>\r\n</ul>\r\n<p id=\"bkmrk-step-2%3A%C2%A0-now-that-we\">Step 2:&nbsp; Now that we create the zone file, we should test it to make sure there are no syntax errors.&nbsp; You can do this on the RootDNS server using the following command.&nbsp;</p>\r\n<pre id=\"bkmrk-named-checkzone-%3Cdom\"><code class=\"language-\">named-checkzone &lt;domainname&gt; &lt;zonefile&gt;</code></pre>\r\n<p id=\"bkmrk-below-is-an-example.\">below is an example.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KSvimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-2.%C2%A0-once-you-ha\">Step 2.&nbsp; Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file.&nbsp;</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file\">Then append the file with the following syntax.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com.%22-\"><code class=\"language-\">zone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};</code></pre>\r\n<p id=\"bkmrk-when-you-are-done%2C-y\">Next we\'ll validate the edits we made to named.conf.RANGE.<br></p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-named-c\"><code class=\"language-\">cd /etc/bind\r\nnamed-checkconf named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-if-are-no-errors%2C-yo\">If there are no errors, you will get nothing back, below is an example output of a good check.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sY0image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-3.%C2%A0-now-that-we\">Step 3.&nbsp; Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.&nbsp; Do this with the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-output-should-look-l\">Output should look like</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bj5image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-next%2C-run-a-nslookup\">Next, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2pHimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-example-2.%C2%A0-for-this\"><span style=\"text-decoration: underline;\"><strong>Example 2</strong></span>.&nbsp; For this example, we will be running a DNS nameserver within our Target Domain.&nbsp; Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.&nbsp; We\'ll use the domain of widgets.com also.&nbsp; In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.&nbsp; Instead we will be adding a forwarder in the RootDNS\'s&nbsp; named.conf.RANGE file.&nbsp; Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th-1\">Step 1.&nbsp; Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name-1\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file-1\">Then append the file with the following.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com%22-%7B\"><code class=\"language-\">zone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};</code></pre>\r\n<p id=\"bkmrk-step-2.%C2%A0-check-your-\">Step 2.&nbsp; Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.&nbsp;&nbsp; If that passes, run the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar-1\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-then-you-can-test-yo\">Then you can test your DNS again using nslookup.&nbsp; What this looks like depends on how you configured your target domain nameserver.</p>','You will most likely want the target domains you connect to the Cyber Range to have \"publicly\" available services, for example maybe a public facing website and/or email services.  For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.  Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.  Adding Target Domain DNS to the RootDNS server is a purely manual process.  This guide is to help get that set up with a few examples. \r\nExample 1 - Your target domain is called widgets.com and has a public facing website and a mail server.  For the purpose of this guide we\'ll assume that we have already completed the Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range.   Additionally, we decided to use 44.22.11.10/29 for target domain  firewall WAN connection.  Then, to enable our public services to reachable through our Firewall, we set up a port forward on 44.22.11.10 to send port 80 and 443 to our target domain web server, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to our target domains exchange server.    Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.\r\nStep 1.  Log into the RootDNS server.  Then create a zone file in the /etc/bind/RANGE directory.\r\ncd /etc/bind/RANGE\r\nvi db.widgets.com\r\nNext we need to put the following in the db.widgets.com zone file.\r\n; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4\r\nSo lets explain this line by line.\r\n\r\nLine 1  \"; Widgets blue space DNS\"        This is just a comment, in a zone file you can add comments using a \";\".\r\n\r\n\r\n\r\nNOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.\r\n\r\n\r\n\r\n\r\nLine 2  \"$TTL     88640\"   This is the time in seconds that caching DNS servers should cache this record.\r\nLine 3 \"@     IN   SOA    @   ns.widgets.com.  42 3H 15M 1W 1D\"   This is the Start of Authority (SOA)  for the domain.  The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL\r\nLine 4 \"@    IN   NS      ns.widgets.com.\"   This is setting the NameServer for the domain to the domain of ns.widgets.com\r\nLine 5 \"@    IN    MX   10    widgets.com.\"  This is setting the MX (mail server) domain to widgets.com.  The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.\r\nLine 6 \"@   IN     A    44.22.11.11\" .  The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.  This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.\r\nLine 7 \"www   IN   A  44.22.11.10\".    This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.\r\nLine 8 \"owa  IN   A   44.22.11.11\".  This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.\r\nLine 9 \"ns    IN   A 198.41.0.4\".  This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.  The IP 198.41.0.4 is an IP on the rootDNS server itself.  This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.  IPv6 records at set using \"AAAA\" verse \"A\".  For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.  This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. \r\n\r\nStep 2:  Now that we create the zone file, we should test it to make sure there are no syntax errors.  You can do this on the RootDNS server using the following command. \r\nnamed-checkzone <domainname> <zonefile>\r\nbelow is an example.\r\n\r\nStep 2.  Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file. \r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following syntax.\r\nzone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};\r\nNext we\'ll validate the edits we made to named.conf.RANGE.\r\ncd /etc/bind\r\nnamed-checkconf named.conf.RANGE\r\nIf there are no errors, you will get nothing back, below is an example output of a good check.\r\n\r\nStep 3.  Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.  Do this with the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nOutput should look like\r\n\r\nNext, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.\r\n\r\nExample 2.  For this example, we will be running a DNS nameserver within our Target Domain.  Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.  We\'ll use the domain of widgets.com also.  In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.  Instead we will be adding a forwarder in the RootDNS\'s  named.conf.RANGE file.  Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.\r\nStep 1.  Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.\r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following.\r\nzone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};\r\nStep 2.  Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.   If that passes, run the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nThen you can test your DNS again using nslookup.  What this looks like depends on how you configured your target domain nameserver.',1,'2023-04-13 22:46:22','2023-04-13 22:46:22','adding-dns-for-your-target-domain','target-domain-planning-guide','version','','',3);
/*!40000 ALTER TABLE `page_revisions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `pages`
--

DROP TABLE IF EXISTS `pages`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `pages` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `book_id` int(11) NOT NULL,
  `chapter_id` int(11) NOT NULL,
  `name` varchar(191) NOT NULL,
  `slug` varchar(191) NOT NULL,
  `html` longtext NOT NULL,
  `text` longtext NOT NULL,
  `priority` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `created_by` int(11) NOT NULL,
  `updated_by` int(11) NOT NULL,
  `draft` tinyint(1) NOT NULL DEFAULT 0,
  `markdown` longtext NOT NULL DEFAULT '',
  `revision_count` int(11) NOT NULL,
  `template` tinyint(1) NOT NULL DEFAULT 0,
  `deleted_at` timestamp NULL DEFAULT NULL,
  `owned_by` int(10) unsigned NOT NULL,
  `editor` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`id`),
  KEY `pages_slug_index` (`slug`),
  KEY `pages_book_id_index` (`book_id`),
  KEY `pages_chapter_id_index` (`chapter_id`),
  KEY `pages_priority_index` (`priority`),
  KEY `pages_created_by_index` (`created_by`),
  KEY `pages_updated_by_index` (`updated_by`),
  KEY `pages_draft_index` (`draft`),
  KEY `pages_template_index` (`template`),
  KEY `pages_owned_by_index` (`owned_by`),
  KEY `pages_updated_at_index` (`updated_at`)
) ENGINE=InnoDB AUTO_INCREMENT=33 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `pages`
--

LOCK TABLES `pages` WRITE;
/*!40000 ALTER TABLE `pages` DISABLE KEYS */;
INSERT INTO `pages` VALUES (1,1,0,'New Page','new-page','<div drawio-diagram=\"1\" contenteditable=\"false\" id=\"bkmrk-\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-03/drawing-1-1680023230.png\"></div>','',2,'2023-03-28 22:06:51','2023-03-28 23:24:32',1,1,0,'',1,0,'2023-03-28 23:24:32',1,''),(2,2,0,'Cyber Range Network Diagram','cyber-range-network-diagram','<div drawio-diagram=\"183\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681301764.png\"></div>\r\n<h3 id=\"bkmrk-network-diagram-note\">Network Diagram Notes</h3>\r\n<p id=\"bkmrk-si-router---this-is-\"><strong>SI-Router</strong> - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following ESXI virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>ServicesNet</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Grayspace</strong></span>&nbsp;<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>AdminNet</strong></span><br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>RangeWAN</strong></span><br></li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\"><strong>ServicesNet</strong> - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\"><strong>RootDNS</strong> - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles recursive DNS server IP of 8.8.8.8.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/rootdns\">rootDNS</a>.</li>\r\n<li class=\"null\"><strong>Web-Services </strong>- This provides a few simulated real world services that can be used for OPFOR and/or for range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">redbook.com </span>- This is the bookstack app you are currently looking at.&nbsp; This is used for documentation of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">dropbox.com</span> - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.<br></li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">pastebin.com</span> - This is a hastebin server to simulated the real world pastebin.&nbsp; This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">diagrams.net </span>- This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\"><strong>CA-Server </strong>- This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/importing-ca-and-int-certs-to-your-target-domain\">Importing CA and Int certs to your target domain</a>.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signed binary\'s, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/ca-server\">CA-Server</a>.</li>\r\n<li class=\"null\"><strong>Traffic-Gen</strong> - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.&nbsp; For more information about how the Traffic-Gen server is set this up, go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a>.&nbsp; For instructions on setting using the Traffic-Gen, go to -&gt; How to Guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/setting-up-the-traffic-gen-for-a-target-domain\">Setting up the Traffic-Gen for a Target Domain</a>. <br></li>\r\n<li class=\"null\"><strong>Traffic-WebHost </strong>- This is a Ubuntu server running Apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\"><strong>Grayspace</strong> - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.&nbsp; By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp; To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.<br></p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.&nbsp; Go to Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a> for information how its built.&nbsp; Go to <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a> for instructions on how to build out red team infrastructure.<br></li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - Windows VM.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\"><strong>AdminNet</strong> - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are two servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\"><strong>AdminNet-DHCP</strong> - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.&nbsp; Go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/adding-a-internet-access-proxy-for-a-target-domain\">Adding a Internet Access Proxy for a Target Domain</a>.<br></li>\r\n<li class=\"null\"><strong>IA-Proxy</strong> - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.</li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\"><strong>RangeWAN</strong> - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details on building and connecting a target domain, go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a Target Domain to the Cyber Range</a>.&nbsp;<br></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','\r\nNetwork Diagram Notes\r\nSI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following ESXI virtual switches.\r\n\r\nServicesNet \r\nGrayspace \r\nAdminNet\r\nRangeWAN\r\n\r\nServicesNet - ESXI switch that connects to the SI router as well as the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles recursive DNS server IP of 8.8.8.8.  This server is used for managing grayspace DNS.  You can register DNS manually or use automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration go to Cyber Range Systems Overview -> rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used for OPFOR and/or for range management.  These services are build in docker containers and provide the following;\r\n\r\nredbook.com - This is the bookstack app you are currently looking at.  This is used for documentation of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web Dav, API\'s and provides additional ways for OPFOR to host payloads and/or exfil data.\r\npastebin.com - This is a hastebin server to simulated the real world pastebin.  This can be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documentation.\r\n\r\n\r\nCA-Server - This is a Ubuntu server with an openSSL implementation to provide a certificate authority and intermediate certificate authority to simulate a real world CA server to provide signed SSL certificates for the Cyber Range environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain and add them to trust stores via GPO, for how to do this, go to -> Target Domain Planning Guide -> Importing CA and Int certs to your target domain.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signed binary\'s, go to -> Cyber Range Systems Overview -> CA-Server.\r\nTraffic-Gen - This as a Ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated external SMTP traffic to your target domains.  For more information about how the Traffic-Gen server is set this up, go to -> Cyber Range Systems Overview -> Traffic-Gen.  For instructions on setting using the Traffic-Gen, go to -> How to Guides -> Setting up the Traffic-Gen for a Target Domain. \r\nTraffic-WebHost - This is a Ubuntu server running Apache and hosting several virtual host websites.  This exists to allow  traffic generation agents on target domain workstations to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infrastructure systems.  By default the Cyber range installation instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want.  To get a list of routable IPs to use for any system you add, look at the /root/backbonerouters folder on the NRTS or console into the SI-Router and look at Eth2.\r\n\r\nNRTS (Not Red Team Server) - This is a customized Ubuntu server that can create various red team infrastructure systems in docker containers.  Go to Cyber Range Systems Overview -> NRTS for information how its built.  Go to Using the NRTS for instructions on how to build out red team infrastructure.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - Windows VM.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are two servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary NIC that connects to this network and will get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminNet-DHCP - Provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.  Go to -> Target Domain Planning Guide -> Adding a Internet Access Proxy for a Target Domain.\r\nIA-Proxy - This is a Ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999.\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virtual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details on building and connecting a target domain, go to -> Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range. \r\n',2,'2023-03-28 22:36:23','2023-04-12 20:51:57',1,1,0,'',20,0,NULL,1,''),(3,2,0,'Network Diagram Notes','network-diagram-notes','<p id=\"bkmrk-si-router---this-is-\">SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.&nbsp; It has 4 interfaces that connect to the following virtual switches.</p>\r\n<ul id=\"bkmrk-servicesnet---the-si\">\r\n<li class=\"null\">ServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.</li>\r\n<li class=\"null\">Grayspace - The SI-Router will router apprx 1500 IP subnets.&nbsp; These subnets are organized by geo-locations on the NRTS server.&nbsp; To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.&nbsp; The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.</li>\r\n<li class=\"null\">AdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet</li>\r\n<li class=\"null\">RangeWAN - This is where you will connect target domains to the Cyber Range environment.</li>\r\n</ul>\r\n<p id=\"bkmrk-servicenet---esxi-sw\">ServiceNet - ESXI switch that connects to the SI router.&nbsp; Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.</p>\r\n<ul id=\"bkmrk-rootdns---this-is-th\">\r\n<li class=\"null\">RootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.&nbsp; Additionally it has Googles 8.8.8.8 IP address.&nbsp; This server is used for managing grayspace DNS.&nbsp; You can register DNS manually or use the automation scripts build on the NRTS server.&nbsp; For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.</li>\r\n<li class=\"null\">Web-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.&nbsp; These services are build in docker containers and provide the following;\r\n<ul>\r\n<li class=\"null\">Redbook.com - This the bookstack app you are currently looking at.&nbsp; This is used for documentation and covers an overview of the Cyber Range environment.&nbsp; You can also expand upon this with your own documentation for whatever.</li>\r\n<li class=\"null\">dropbox.com - This is an owncloud server to simulated a cloud based file hosting service.&nbsp; It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.&nbsp; See the OPFOR section for some methods.</li>\r\n<li class=\"null\">pastebin.com - This is a haste bin server to simulated the real world pastebin.&nbsp; This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.</li>\r\n<li class=\"null\">diagrams.net - This is draw.io and used for generating whatever diagram you want.&nbsp; Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.&nbsp; In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.&nbsp; Once that is done, any certs you create with the CA-Server will appear as trusted.&nbsp; For how to generate SSL certs as well as code signing binarys, see CA-Server details.</li>\r\n<li class=\"null\">Traffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.&nbsp; See Traffic-Gen details for more information on this.</li>\r\n<li class=\"null\">Traffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.&nbsp; This exists to allow&nbsp; Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.</li>\r\n</ul>\r\n<p id=\"bkmrk-grayspace---this-is-\">Grayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.&nbsp; By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.&nbsp; Feel free to add whatever else you want.&nbsp;</p>\r\n<ul id=\"bkmrk-nrts-%28not-red-team-s\">\r\n<li class=\"null\">NRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.&nbsp; See NRTS for more details.</li>\r\n<li class=\"null\">Kali - basic kali build, add whatever tools you want.</li>\r\n<li class=\"null\">FlareVM - basic windows VM, but I would advise installing Visual Studios.</li>\r\n</ul>\r\n<p id=\"bkmrk-adminnet---this-is-a\">AdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.&nbsp; There are main servers on this network, AdminNet-DHCP and IA-Proxy.&nbsp; Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.</p>\r\n<ul id=\"bkmrk-adminnet-dhcp---prov\">\r\n<li class=\"null\">Adminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.&nbsp; For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.</li>\r\n<li class=\"null\">IA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.&nbsp; To access real world internet from any VM in the cyber range, just set the proxy to <a href=\"http://172.30.0.2:9999\">http://172.30.0.2:9999</a></li>\r\n</ul>\r\n<p id=\"bkmrk-rangewan---this-is-f\">RangeWAN - This is for connection one or more target domains to the cyber range.&nbsp; Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.&nbsp; Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.&nbsp; More specific details are explained in the target range planning section</p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','SI-Router - This is a vyos router that handles all the routing within the Cyber Range and to your target domains.  It has 4 interfaces that connect to the following virtual switches.\r\n\r\nServicesNet - The SI-Router will route several IP subnets related to systems on the ServicesNet network.\r\nGrayspace - The SI-Router will router apprx 1500 IP subnets.  These subnets are organized by geo-locations on the NRTS server.  To see a list of available subnets and coorisponding geo-locations, look on the NRTS at /root/backbonerouters.  The NRTS will use the list of these subnets to automate IP address assignments for various OPFOR infastructure services.\r\nAdminNet - This is used as a network to allow all Cyber Range VMs access to the real internet\r\nRangeWAN - This is where you will connect target domains to the Cyber Range environment.\r\n\r\nServiceNet - ESXI switch that connects to the SI router.  Used for hosting the RootDNS, Web-services, CA-Server, Traffic-Gen, and Traffic-Web host servers.\r\n\r\nRootDNS - This is the Grayspaces DNS server, it has been IP\'ed with all of the real world root DNS server IPs, meaning the A-root through M-root real world DNS servers.  Additionally it has Googles 8.8.8.8 IP address.  This server is used for managing grayspace DNS.  You can register DNS manually or use the automation scripts build on the NRTS server.  For more details on the RootDNS servers configuration see Grayspace Detailed Configurations - rootDNS.\r\nWeb-Services - This provides a few simulated real world services that can be used by OPFOR or general range management.  These services are build in docker containers and provide the following;\r\n\r\nRedbook.com - This the bookstack app you are currently looking at.  This is used for documentation and covers an overview of the Cyber Range environment.  You can also expand upon this with your own documentation for whatever.\r\ndropbox.com - This is an owncloud server to simulated a cloud based file hosting service.  It has a web dav, api\'s and provides additional ways for OPFOR to host payloads.  See the OPFOR section for some methods.\r\npastebin.com - This is a haste bin server to simulated the real world pastebin.  This can also be used for hosting code snippets that can be pulled from grayspace for OPFOR needs.\r\ndiagrams.net - This is draw.io and used for generating whatever diagram you want.  Its integrated into redbook (bookstack) and was used to make the network diagrams found in this documenation.\r\n\r\n\r\nCA-Server - This is an openssl certificate authority and intermediate certificate authority to simulate a real world CA server to provide SSL certificates for your training environment.  In order to make these certs trusted in your target domain environments you will need to copy the ca.globalcert.com.crt.pem and int.globalcert.com.crt.pem over to your target domain domain controller and add them to target domain Trust stores via GPO, see xxx for how to do this.  Once that is done, any certs you create with the CA-Server will appear as trusted.  For how to generate SSL certs as well as code signing binarys, see CA-Server details.\r\nTraffic-Gen - This as a ubuntu server running customizable docker containers that will send emails to users in your target domain to simulated real world traffic.  See Traffic-Gen details for more information on this.\r\nTraffic-WebHost - This is a ubuntu server running apache and hosting several virtual host websites.  This exists to allow  Ghost agents on target domains to be able to open browsers and hit various websites for traffic generation purposes.\r\n\r\nGrayspace - This is an ESXI virtual switch used to connect OPFOR infastructure systems.  By default the Cyber range instructions will build out an NRTS server, a Kali server, and a FlareVM.  Feel free to add whatever else you want. \r\n\r\nNRTS (Not Red Team Server) - This is a customized ubuntu server that can create various red team infastructure systems in docker containers.  See NRTS for more details.\r\nKali - basic kali build, add whatever tools you want.\r\nFlareVM - basic windows VM, but I would advise installing Visual Studios.\r\n\r\nAdminNet - This is an ESXI virtual Switch and is used to enable real world internet access to all the VM\'s in the Cyber Range.  There are main servers on this network, AdminNet-DHCP and IA-Proxy.  Additionally all of the VMs in this cyber range have a secondary nic built that connects to this network and will automatically get a DHCP lease on the 172.30.0.0/21 subnet.\r\n\r\nAdminnet-DHCP - provides DHCP services to all systems in the Cyber Range, with the exception of the target domains.  For target domains it\'s preferable to add a real internet proxy in its domain verses using this proxy for reason better explained in the target range planning section.\r\nIA-Proxy - This is a ubuntu server running a squid proxy to allow Cyber Range VM\'s internet access.  To access real world internet from any VM in the cyber range, just set the proxy to http://172.30.0.2:9999\r\n\r\nRangeWAN - This is for connection one or more target domains to the cyber range.  Once you\'ve build out a target domain, pick an public IP address for the WAN connection point and connect it to this virual switch.  Then edit the RangeWAN interface on the SI router to complete the connect of your target domain to the cyber range.  More specific details are explained in the target range planning section\r\n',3,'2023-03-28 23:24:56','2023-04-04 20:31:12',1,1,0,'',3,0,'2023-04-04 20:31:12',1,''),(4,3,0,'RootDNS','rootdns','<p id=\"bkmrk-the-rootdns-server-i\">The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.&nbsp; To simulate real world DNS, the server is configured with the following IP addresses;</p>\r\n<ul id=\"bkmrk-8.8.8.8---simulated-\">\r\n<li class=\"null\">8.8.8.8 - (Googles recursive DNS server)</li>\r\n<li class=\"null\">198.41.0.4 - (A-root server)</li>\r\n<li class=\"null\">192.228.79.59 - (B-root server)</li>\r\n<li class=\"null\">192.33.4.12 - (C-root server)</li>\r\n<li class=\"null\">128.8.10.90 - (D-root server)</li>\r\n<li class=\"null\">192.203.230.10 - (E-root server)</li>\r\n<li class=\"null\">195.5.5.241 - (F-root server)</li>\r\n<li class=\"null\">192.112.36.4 - (G-root server)</li>\r\n<li class=\"null\">128.63.2.53 - (H-root server)</li>\r\n<li class=\"null\">192.36.148.17 - (I-root server)</li>\r\n<li class=\"null\">192.58.128.30 - (J-root server)</li>\r\n<li class=\"null\">193.0.15.129 - (K-root server)</li>\r\n<li class=\"null\">199.7.83.42 - (L-root server)</li>\r\n<li class=\"null\">202.12.27.33 - (M-root server)</li>\r\n</ul>\r\n<p id=\"bkmrk-the-rootdns-server-i-1\">The RootDNS server handles all \"grayspace\" DNS.&nbsp; To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.&nbsp; Below is a listing of the file/folder structure along with a brief explanation of its purpose.</p>\r\n<p id=\"bkmrk-bind9-configuration-\">BIND9 CONFIGURATION Overview</p>\r\n<ul id=\"bkmrk-configuration-files-\">\r\n<li class=\"null\">Configuration Files\r\n<ul>\r\n<li class=\"null\">/etc/bind/named.conf&nbsp; &nbsp;- Contains \"includes\" for the segmented out \"named.conf\" files.</li>\r\n<li class=\"null\">/etc/bind/named.conf.options&nbsp; - Contains the bind9 options that make it a recursive DNS server.&nbsp; This file also specifies the IPs the server listens on.</li>\r\n<li class=\"null\">/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.</li>\r\n<li class=\"null\">/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.&nbsp; For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.</li>\r\n<li class=\"null\">/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers</li>\r\n<li class=\"null\">/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOLDERS\r\n<ul>\r\n<li class=\"null\">/etc/bind/OPFOR - Stores the domain zone files for all the referenced domains in the named.conf.OPFOR config file.</li>\r\n<li class=\"null\">/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.</li>\r\n<li class=\"null\">/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.</li>\r\n<li class=\"null\">/etc/bind/blackhole - This contains two files.\r\n<ul>\r\n<li class=\"null\">db.blackhole - this is a zone file that points to 127.0.0.1</li>\r\n<li class=\"null\">Rangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.&nbsp; This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.&nbsp; Things like updateapi.google.com, etc.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-dns-automation-overv\">DNS AUTOMATION Overview</p>\r\n<p id=\"bkmrk-the-root-dns-server-\">The root DNS server has some automation built in to automate OPFOR DNS registration.&nbsp; The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fadd-re\">\r\n<li class=\"null\">/root/scripts/add-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will create a PID lock when it\'s executed to prevent the script from running more than one instance.&nbsp; If this was ran concurrently, it would likely result in a corruption of the bind configuration.&nbsp; The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.&nbsp; The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.&nbsp; If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.&nbsp; It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.&nbsp; It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/delete-REDTEAM-DNS.sh\r\n<ul>\r\n<li class=\"null\">This script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.&nbsp; The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.&nbsp; This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.&nbsp; On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.&nbsp; This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.&nbsp; A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/makednsfile.sh\r\n<ul>\r\n<li class=\"null\">This script will generate a DNS file to feed to add-REDTEAM-DNS.sh.&nbsp; It\'s for when a user elects randomly generated domains.&nbsp; In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.&nbsp; When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/masterdomainlist.txt\r\n<ul>\r\n<li class=\"null\">This is a file that contains roughly 11000 domain names.&nbsp; This list was generated by scrapping a website that listed expired domain names.&nbsp; The goal here is to have a large pool of domains that aren\'t owned in the real world.&nbsp; The concept here is that these domains would be available to be purchased by an adversary.&nbsp; It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n<ul>\r\n<li class=\"null\">This script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.&nbsp; This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">NOTE:&nbsp; For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a><br></li>\r\n</ul>\r\n<p id=\"bkmrk-how-to-manually-add-\">HOW TO MANUALLY ADD DNS</p>\r\n<ul id=\"bkmrk-to-add-new-target-do\">\r\n<li class=\"null\">To add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.&nbsp; There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.&nbsp; Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.</li>\r\n<li class=\"null\">Once you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.&nbsp; However, before doing this it\'s a good idea to check your syntax first.&nbsp; To test your zone file run\r\n<ul>\r\n<li class=\"null\">named-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&lt;- replace \"mydomain.com\" with your domain.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then to check your modification of the named.conf.RANGE file.\r\n<ul>\r\n<li class=\"null\">named-checkconfig /etc/bind/named.conf.RANGE</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If either check errors, check your syntax, make corrections and try again.&nbsp; Once they both pass run \"service bind9 restart\"</li>\r\n<li class=\"null\">To add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.</li>\r\n<li class=\"null\">NOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\" style=\"padding-left: 40px;\"></p>\r\n<p id=\"bkmrk-%C2%A0-1\" style=\"padding-left: 40px;\"></p>','The RootDNS server is built on Ubuntu 22.01 and runs a recursive bind9 server.  To simulate real world DNS, the server is configured with the following IP addresses;\r\n\r\n8.8.8.8 - (Googles recursive DNS server)\r\n198.41.0.4 - (A-root server)\r\n192.228.79.59 - (B-root server)\r\n192.33.4.12 - (C-root server)\r\n128.8.10.90 - (D-root server)\r\n192.203.230.10 - (E-root server)\r\n195.5.5.241 - (F-root server)\r\n192.112.36.4 - (G-root server)\r\n128.63.2.53 - (H-root server)\r\n192.36.148.17 - (I-root server)\r\n192.58.128.30 - (J-root server)\r\n193.0.15.129 - (K-root server)\r\n199.7.83.42 - (L-root server)\r\n202.12.27.33 - (M-root server)\r\n\r\nThe RootDNS server handles all \"grayspace\" DNS.  To keep this a bit organized, the configuration for the bind9 server has been broken up into functional sections.  Below is a listing of the file/folder structure along with a brief explanation of its purpose.\r\nBIND9 CONFIGURATION Overview\r\n\r\nConfiguration Files\r\n\r\n/etc/bind/named.conf   - Contains \"includes\" for the segmented out \"named.conf\" files.\r\n/etc/bind/named.conf.options  - Contains the bind9 options that make it a recursive DNS server.  This file also specifies the IPs the server listens on.\r\n/etc/bind/named.conf.default-zones - This is a default zone created by bind9, it has been unmodified.\r\n/etc/bind/named.conf.OPFOR - This contains the domain references for all OPFOR DNS entries.  For the most part entries here are managed via scripts on the RootDNS server and NRTS servers.\r\n/etc/bind/named.conf.RANGE - This contains the domain references for all DNS needed by the ServicesNet systems and target domains, with the exception of the traffic-gen and traffic-webhost servers\r\n/etc/bind/named.conf.TRAFFIC - This contains the domain references for all traffic gen domains.\r\n\r\n\r\nFOLDERS\r\n\r\n/etc/bind/OPFOR - Stores the domain zone files for all the referenced domains in the named.conf.OPFOR config file.\r\n/etc/bind/RANGE - Stores the domain zone files for all referenced domains in the named.conf.RANGE config file.\r\n/etc/bind/TRAFFIC - Stores the domain zone files for all the referenced domains in the named.conf.TRAFFIC config file.\r\n/etc/bind/blackhole - This contains two files.\r\n\r\ndb.blackhole - this is a zone file that points to 127.0.0.1\r\nRangism.zone - this is a conf file that references several domains and pointing them all to the db.blackhole zone file.  This is used to capture various auto generated OS and application DNS requests for real world systems that can\'t be reached or replicated in this environment.  Things like updateapi.google.com, etc.\r\n\r\n\r\n\r\n\r\n\r\nDNS AUTOMATION Overview\r\nThe root DNS server has some automation built in to automate OPFOR DNS registration.  The scripts and path for adding/removing OPFOR DNS entries are listed below along with an explanation of their functionality.\r\n\r\n/root/scripts/add-REDTEAM-DNS.sh\r\n\r\nThis script will create a PID lock when it\'s executed to prevent the script from running more than one instance.  If this was ran concurrently, it would likely result in a corruption of the bind configuration.  The way it works is the DNS registration section of the NRTS server\'s /root/scripts/buildredteam.sh script will SCP a DNS file containing domain names and IPs using an SSH key, then remotely run the add-REDTEAM-DNS.sh script and feed it the DNS file as an argument.  The script will take this list, check if the domain already exists in any of the zone file locations, aka, RANGE, OPFOR, and TRAFFIC zone file folders.  If it exists in the RANGE or TRAFFIC folder, it will skip that DNS registration request, if it exists in the OPFOR folder, it will assume the user wants to update the record and process it.  It then creates a zone file for each domain, adds it to the /etc/bind/OPFOR directory and creates a copy of the named.conf.OPFOR config file and appends the zone reference in the copy if the reference didn\'t already exist.  It will then run a named-checkconf against the copy, if this passed, it will replace the named.conf.OPFOR with the copy and restart the bind9 service to read in the new configurations.\r\n\r\n\r\n/root/scripts/delete-REDTEAM-DNS.sh\r\n\r\nThis script will remove DNS zone files from the /etc/bind/OPFOR directory as well as remove the zone file references from the named.conf.OPFOR config file.  The way this works is when the add-REDTEAM-DNS.sh script runs and originally added the OPFOR DNS, it will tag the zone file as well as add tags to the section in the named.conf.OPFOR file.  This tag is a user added value that is entered when the user requests DNS registration from an NRTS server.  On the NRTS there is a script for managing DNS at /root/scripts/ManageDNS.sh.  This script will connect to the rootDNS server and get a list of all OPFOR DNS organized by tags.  A user can select OPFOR DNS entries to be removed by selecting the tag associated with those DNS records.\r\n\r\n\r\n/root/scripts/autoredirector/makednsfile.sh\r\n\r\nThis script will generate a DNS file to feed to add-REDTEAM-DNS.sh.  It\'s for when a user elects randomly generated domains.  In this case the NRTS will send a list of IPs to the rootDNS server and this script will randomly select available domains from the masterdomainlist.txt file and pair one it to each of the IP in the list.  When it selects a domain from the masterdomainlist, it will edit that domain by adding a \"#\" to the front of the domain to prevent it from being reused.\r\n\r\n\r\n/root/scripts/autoredirector/masterdomainlist.txt\r\n\r\nThis is a file that contains roughly 11000 domain names.  This list was generated by scrapping a website that listed expired domain names.  The goal here is to have a large pool of domains that aren\'t owned in the real world.  The concept here is that these domains would be available to be purchased by an adversary.  It wouldn\'t make sense for an adversary to be able to use www.microsoft.com for their C2.\r\n\r\n\r\n/root/scripts/autoredirector/resetmasterdomainlist.sh\r\n\r\nThis script will remove and \"#\" from the front of any domain names in the masterdomainlist.txt file.  This is for when you\'ve deleted out all red team DNS and want to make all previously used domains from the list available again.\r\n\r\n\r\nNOTE:  For more information on using the scripts referenced above that reside on the NRTS; buildredteam.sh, ManageDNS.sh and RegisterDNS.sh, go to -> Using the NRTS \r\n\r\nHOW TO MANUALLY ADD DNS\r\n\r\nTo add new target domain records, you will need to create a zone file in the /etc/bind/RANGE and modify the /etc/bind/named.conf.RANGE file to add the reference.  There is an example zone file in the /etc/bind/RANGE directory to use as a reference called db.example.com.  Then, to add the reference in the named.conf.RANGE file, simply follow the syntax used for other zone files.\r\nOnce you have created the zone file and added the reference, you need to run \"service bind9 restart\" to read in the new domain.  However, before doing this it\'s a good idea to check your syntax first.  To test your zone file run\r\n\r\nnamed-checkzone mydomain.com /etc/bind/RANGE/db.mydomain.com         <- replace \"mydomain.com\" with your domain.\r\n\r\n\r\nThen to check your modification of the named.conf.RANGE file.\r\n\r\nnamed-checkconfig /etc/bind/named.conf.RANGE\r\n\r\n\r\nIf either check errors, check your syntax, make corrections and try again.  Once they both pass run \"service bind9 restart\"\r\nTo add DNS manually in either TRAFFIC or OPFOR, follow the same steps, just make sure you are adding the zone file to the correct directory and you are modifying the correct \"named.conf.xxxx\" file.\r\nNOTE: You should always run a \"service bind9 status\" after a \"service bind9 restart\" to ensure its running.\r\n\r\n\r\n',2,'2023-03-28 23:58:33','2023-04-12 21:34:21',1,1,0,'',9,0,NULL,1,''),(5,3,0,'Web-Services','web-services','<p id=\"bkmrk-the-web-services-vm-\">The web services VM adds the following webservers to the Cyber Range environment;</p>\r\n<ul id=\"bkmrk-pastebin.com---this-\">\r\n<li class=\"null\">pastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com</li>\r\n<li class=\"null\">redbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.</li>\r\n<li class=\"null\">dropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.&nbsp; This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.</li>\r\n<li class=\"null\">diagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook.&nbsp;</li>\r\n</ul>\r\n<p id=\"bkmrk-the-services-above-r\">The services above reside in the following folders on the web-services VM</p>\r\n<ul id=\"bkmrk-%2Froot%2Fpastebin%C2%A0-%2Froo\">\r\n<li class=\"null\">/root/pastebin&nbsp;<br></li>\r\n<li class=\"null\">/root/redbook</li>\r\n<li class=\"null\">/root/owncloud</li>\r\n<li class=\"null\">/root/drawio<br></li>\r\n</ul>\r\n<p id=\"bkmrk-in-each-directory-ar\">These directories contain the config files needed for the container along with a docker-compose file.&nbsp; The containers should all start up automatically on reboot.&nbsp; To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.&nbsp; For a quick check you can run \"docker ps\" and it will list running containers.</p>\r\n<p id=\"bkmrk-note%3A-both-redbook-%28\">NOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.&nbsp; If you want to make make backups, below is the syntax for creating the backups and for restoring from these backups.</p>\r\n<p id=\"bkmrk-backing-up\">BACKING UP</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp &gt; bookstackbackup.sql</li>\r\n<li class=\"null\">docker cp bookstack:/app/www/public/uploads/images .<br></li>\r\n<li class=\"null\">docker cp bookstack:/config/files .</li>\r\n<li class=\"null\">tar -czvf redbook-images-backup.tar.gz images</li>\r\n<li class=\"null\">tar -czvf redbook-files-backup.tar.gz uploads</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud &gt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-restoring\">RESTORING</p>\r\n<ul id=\"bkmrk-for-bookstack-%28redbo-1\">\r\n<li class=\"null\">FOR BOOKSTACK (redbook.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp &lt; bookstackbackup.sql</li>\r\n<li class=\"null\">tar -xzvf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp images bookstack:/app/www/public/uploads/</li>\r\n<li class=\"null\">tar -xzvf redbook-files-backup.tar.gz</li>\r\n<li class=\"null\">docker cp files&nbsp; bookstack:/config/www/</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">FOR OWNCLOUD (dropbox.com)\r\n<ul>\r\n<li class=\"null\">docker exec -i owncloud_db mysql -uowncloud -powncloud owncloud &lt; owncloudbackup.sql</li>\r\n</ul>\r\n</li>\r\n</ul>','The web services VM adds the following webservers to the Cyber Range environment;\r\n\r\npastebin.com - this is a hastebin server running in a docker container that simulates pastebin.com\r\nredbook.com - this is a bookstack server running in a docker container used for Cyber Range documentation, you are using it right now.\r\ndropbox.com - this is a owncloud file share server running in a docker container used to simulate a cloud file sharing service.  This can be used for range management, like hosting various apps that you want to install on various target domains, but mostly it\'s there for payload hosting or as an exfiltration point for OPFOR.\r\ndiagrams.net - this is draw.io running in a docker container used for creating diagrams on redbook. \r\n\r\nThe services above reside in the following folders on the web-services VM\r\n\r\n/root/pastebin \r\n/root/redbook\r\n/root/owncloud\r\n/root/drawio\r\n\r\nThese directories contain the config files needed for the container along with a docker-compose file.  The containers should all start up automatically on reboot.  To check the status of the container, I\'d advise googling docker to see how to interact and do things in docker.  For a quick check you can run \"docker ps\" and it will list running containers.\r\nNOTE: both redbook (bookstack) and owncloud (dropbox) use a mysql database.  If you want to make make backups, below is the syntax for creating the backups and for restoring from these backups.\r\nBACKING UP\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysqldump -uroot -pbookstack bookstackapp > bookstackbackup.sql\r\ndocker cp bookstack:/app/www/public/uploads/images .\r\ndocker cp bookstack:/config/files .\r\ntar -czvf redbook-images-backup.tar.gz images\r\ntar -czvf redbook-files-backup.tar.gz uploads\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysqldump -uowncloud -powncloud owncloud > owncloudbackup.sql\r\n\r\n\r\n\r\nRESTORING\r\n\r\nFOR BOOKSTACK (redbook.com)\r\n\r\ndocker exec -i bookstack_db mysql -uroot -pbookstack bookstackapp < bookstackbackup.sql\r\ntar -xzvf redbook-files-backup.tar.gz\r\ndocker cp images bookstack:/app/www/public/uploads/\r\ntar -xzvf redbook-files-backup.tar.gz\r\ndocker cp files  bookstack:/config/www/\r\n\r\n\r\nFOR OWNCLOUD (dropbox.com)\r\n\r\ndocker exec -i owncloud_db mysql -uowncloud -powncloud owncloud < owncloudbackup.sql\r\n\r\n\r\n',3,'2023-03-29 01:05:37','2023-04-12 17:51:55',1,1,0,'',5,0,NULL,1,''),(6,3,0,'CA-Server','ca-server','<p id=\"bkmrk-the-ca-server-is-bui\">The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.&nbsp; The CA and intermediate certs have already been created using the domain of globalcert.com.&nbsp; To create new signed SSL certs or to sign binaries, you can use scripts on this server.&nbsp; The NRTS server will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.&nbsp; For more information on this go to -&gt; Cyber Range Systems Overview -&gt; <a href=\"https://redbook.com/books/cyber-range-systems-overview/page/nrts\">NRTS</a>.&nbsp; That said, if you want to generate these manually, below is an overview of scripts on the CA-server.</p>\r\n<ul id=\"bkmrk-%2Froot%2Fcertmaker.sh-t\">\r\n<li class=\"null\">/root/certmaker.sh\r\n<ul>\r\n<li class=\"null\">This is used to create HTTPS SSL certs and then sign these with the intermediate cert.&nbsp; The script has a help menu that is pretty self explanatory.&nbsp; below is the help menu that lists the various flags.</li>\r\n<li class=\"null\">\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/A2limage.png\" alt=\"image.png\"></p>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-an-example-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is an example for created a cert for humanzoo.com\r\n<ul>\r\n<li class=\"null\">./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/codesigncertmaker.sh</li>\r\n<li class=\"null\">/root/cs_codesigncertmaker.sh</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The CA server is built on Ubuntu 22.01 and uses openSSL to create a Certificate Authority and intermediate Certificate Authority for signing SSL certs.  The CA and intermediate certs have already been created using the domain of globalcert.com.  To create new signed SSL certs or to sign binaries, you can use scripts on this server.  The NRTS server will also use these scripts automatically to sign SSL certs for the redirectors and payload hosts services it builds.  For more information on this go to -> Cyber Range Systems Overview -> NRTS.  That said, if you want to generate these manually, below is an overview of scripts on the CA-server.\r\n\r\n/root/certmaker.sh\r\n\r\nThis is used to create HTTPS SSL certs and then sign these with the intermediate cert.  The script has a help menu that is pretty self explanatory.  below is the help menu that lists the various flags.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is an example for created a cert for humanzoo.com\r\n\r\n./certmaker.sh -d humanzoo.com -C US -ST NY -L \'New York City\' -O \'Human Zoo foundation\' -CN humanzoo.com -A humanzoo -DNS1 www.humanzoo.com -DNS2 login.humanzoo.com\r\n\r\n\r\n\r\n\r\n/root/codesigncertmaker.sh\r\n/root/cs_codesigncertmaker.sh\r\n\r\n',4,'2023-03-29 01:21:16','2023-04-12 18:41:31',1,1,0,'',7,0,NULL,1,''),(7,3,0,'Traffic-Gen','traffic-gen','<p id=\"bkmrk-the-traffic-gen-serv\">The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.&nbsp; The email corpus was pulled using the Enron data dump.&nbsp; About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.&nbsp; Since then several projects have organized these emails into databases.&nbsp; It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.&nbsp; The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.&nbsp; The functionality of this is very customizable.&nbsp; Here is an overview of how this server is used to generate email traffic.</p>\r\n<p id=\"bkmrk-file-structure\">FILE STRUCTURE</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbuildcompose.s\">\r\n<li class=\"null\">Email Traffic generation scripts\r\n<ul id=\"bkmrk-%C2%A0%2Froot%2Fbuildcompose.\">\r\n<li class=\"null\">&nbsp;/root/buildcompose.sh\r\n<ul id=\"bkmrk-this-script-will-mod\">\r\n<li class=\"null\">This script will modify the docker-compose file based on user input.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/starttrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose up -d\"</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/stoptrafficgen.sh\r\n<ul id=\"bkmrk-simple-script-that-i-1\">\r\n<li class=\"null\">Simple script that is basically \"docker-compose down\"</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-folder-structure-of-\">Folder structure of the email traffic generator.&nbsp;&nbsp;</p>\r\n<ul id=\"bkmrk-%2Froot%2Femailerlist.tx\">\r\n<li class=\"null\">/root/emailerlist.txt\r\n<ul id=\"bkmrk-this-file-contains-t\">\r\n<li class=\"null\">This file contains the domains and IPs that will be used by the email traffic generator.&nbsp; This is read in by the build-compose file to configure a docker container for each one.&nbsp; Then each container will use the contents of the /root/TG folder for composing and sending emails.&nbsp; NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.&nbsp; Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.&nbsp; Also if the IP you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that a gateway IP in the in the same subnet for the IP you want to use to the SI-Router\'s ServicesNet interface.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG\r\n<ul id=\"bkmrk-%2Froot%2Ftg%2Fcontent%2Fema\">\r\n<li class=\"null\">/root/TG/Content/EmailContent.csv\r\n<ul id=\"bkmrk-this-file-is-a-csv-o\">\r\n<li class=\"null\">This file is a CSV of subject, email body content.&nbsp; This content was extracted from publicly available databases of the Enron data mentioned earlier.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/RandomFiles/\r\n<ul id=\"bkmrk-this-directory-conta\">\r\n<li class=\"null\">This directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.&nbsp; These files are used as email attachments.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/SendTo/&lt;user defined dir&gt;/sendto.txt\r\n<ul id=\"bkmrk-the-sendto.txt-file-\">\r\n<li class=\"null\">The sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.&nbsp; This is designed to support multiple target domains.&nbsp; The way this works is you create a folder for each target domain that you connect to the Cyber Range.&nbsp; This is the &lt;user defined dir&gt;.&nbsp; When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.&nbsp; For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.&nbsp; Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.&nbsp; Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.&nbsp; For more information for setting up the traffic-gen to send emails to your target domain go to -&gt; How to Guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/setting-up-the-traffic-gen-for-a-target-domain\">Setting up the Traffic-Gen for a Target Domain</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TG/Senders/senders.txt\r\n<ul id=\"bkmrk-this-file-contains-t-1\">\r\n<li class=\"null\">This file contains the \"from\" names in a firstname.lastname format.&nbsp; The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">&nbsp;/root/TG/Scripts/StartEmail.sh\r\n<ul id=\"bkmrk-this-is-the-entrypoi\">\r\n<li class=\"null\">This is the entrypoint script for the docker containers.&nbsp; It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.&nbsp; This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.&nbsp; These settings can be modified two ways.&nbsp; First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script.&nbsp;</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/TrafficLog\r\n<ul id=\"bkmrk-this-directory-is-wh\">\r\n<li class=\"null\">This directory is where each container will create a traffic log.&nbsp; The name of each log will be log_&lt;senderdomain&gt;.&nbsp; The log will track a count of emails sent by that container, the time, and who the email was sent to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>','The Traffic-gen server was built on Ubuntu 22.01 and uses a customized docker container that will use Postfix and mutt to send emails to a given list of users.  The email corpus was pulled using the Enron data dump.  About 20 years ago, the FCC forced Enron to make it\'s corporate emails public.  Since then several projects have organized these emails into databases.  It\'s a decent source for pulling out human readable \"subject\" and \"body\" content.  The container will use a script that will randomly pull subject and email body content from a CSV file, then randomly select a email address from a user provided list and send an email.  The functionality of this is very customizable.  Here is an overview of how this server is used to generate email traffic.\r\nFILE STRUCTURE\r\n\r\nEmail Traffic generation scripts\r\n\r\n /root/buildcompose.sh\r\n\r\nThis script will modify the docker-compose file based on user input.\r\n\r\n\r\n/root/starttrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose up -d\"\r\n\r\n\r\n/root/stoptrafficgen.sh\r\n\r\nSimple script that is basically \"docker-compose down\"\r\n\r\n\r\n\r\n\r\n\r\nFolder structure of the email traffic generator.  \r\n\r\n/root/emailerlist.txt\r\n\r\nThis file contains the domains and IPs that will be used by the email traffic generator.  This is read in by the build-compose file to configure a docker container for each one.  Then each container will use the contents of the /root/TG folder for composing and sending emails.  NOTE: You can modify this list, however, you will have to add domain zone files for any new domains you want to use to the RootDNS DNS system in the /etc/bind/TRAFFIC directory and add a reference for that domain in the RootDNS servers /etc/bind/named.conf.TRAFFIC file.  Additionally, you\'ll have to add the IP you want to use for the domain to the Traffic-Gen server.  Also if the IP you add isn\'t already listed on the SI-Router\'s ServicesNet interface, you will need to add that a gateway IP in the in the same subnet for the IP you want to use to the SI-Router\'s ServicesNet interface.\r\n\r\n\r\n /root/TG\r\n\r\n/root/TG/Content/EmailContent.csv\r\n\r\nThis file is a CSV of subject, email body content.  This content was extracted from publicly available databases of the Enron data mentioned earlier.\r\n\r\n\r\n/root/TG/RandomFiles/\r\n\r\nThis directory contains 108 random files of types .doc, .docx, .ppt, .pptx, .pdf, and .xlsx.  These files are used as email attachments.\r\n\r\n\r\n/root/TG/SendTo/<user defined dir>/sendto.txt\r\n\r\nThe sendto.txt file should contain a list of email addresses that the traffic generator will send emails to.  This is designed to support multiple target domains.  The way this works is you create a folder for each target domain that you connect to the Cyber Range.  This is the <user defined dir>.  When you run the buildcompose.sh, it will first ask which of these directories should it build the docker-compose file for.  For example, if you made a target domain called widgets.com, you would make a directory at /root/TG/SendTo/widgets.  Then in that directory you would make a file called \"sendto.txt\" and fill it with email addresses for the users in the widget domain that you want the email traffic generator to send emails to.  Always name the email list in the \"target domain\" folder as sendto.txt - this file name is hard-coded in the email sending script.  For more information for setting up the traffic-gen to send emails to your target domain go to -> How to Guides -> Setting up the Traffic-Gen for a Target Domain.\r\n\r\n\r\n/root/TG/Senders/senders.txt\r\n\r\nThis file contains the \"from\" names in a firstname.lastname format.  The email traffic generator will use this in combination with each containers domain from the emailerlist.txt to generate the \"from\" email address.\r\n\r\n\r\n /root/TG/Scripts/StartEmail.sh\r\n\r\nThis is the entrypoint script for the docker containers.  It runs an endless loop that will send emails to the addresses in the \"sendto.txt\" file.  This script is customizable where you can adjust the time interval between emails sent, add jitter to that time internal, set a max number of recipients, and set a max number of attachments.  These settings can be modified two ways.  First you can edit the script and change the default values set for these, or you could modify the docker-compose file and add the appropriate setting flags to the entrypoint script. \r\n\r\n\r\n/root/TrafficLog\r\n\r\nThis directory is where each container will create a traffic log.  The name of each log will be log_<senderdomain>.  The log will track a count of emails sent by that container, the time, and who the email was sent to.\r\n\r\n\r\n\r\n\r\n',5,'2023-03-29 01:32:17','2023-04-12 21:43:33',1,1,0,'',7,0,NULL,1,''),(8,3,0,'Traffic-WebHost','traffic-webhost','<p id=\"bkmrk-this-hosts-several-w\">This hosts several websites that can be used by Ghost to create outbound http and https traffic from within a target domain.</p>\r\n<p id=\"bkmrk-%C2%A0\">&nbsp;</p>','This hosts several websites that can be used by Ghost to create outbound http and https traffic from within a target domain.\r\n ',6,'2023-03-29 01:40:43','2023-03-29 01:41:20',1,1,0,'',1,0,NULL,1,''),(9,3,0,'NRTS','nrts','<p id=\"bkmrk-the-not-red-team-ser\">The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.&nbsp; It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.&nbsp; I haven\'t tested the bounds of this so not sure what the maximum is.&nbsp; In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.&nbsp; However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.&nbsp; You can clone this VM and make as many NRTS as you would like.&nbsp; This server can do several things and will greatly reduce the time required to deploy infrastructure systems.&nbsp; There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS</a>.</p>\r\n<p id=\"bkmrk-folder-structure\">Folder Structure</p>\r\n<ul id=\"bkmrk-%2Froot%2Fbackbonerouter\">\r\n<li class=\"null\">/root/backbonerouters\r\n<ul>\r\n<li class=\"null\">This directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.&nbsp; Its structured by Geo-location, in the following format /root/backbonerouters/&lt;country&gt;/&lt;city.txt&gt;.&nbsp; &nbsp;This folder structure is used by other scripts on the NRTS to generator IP addresses.&nbsp; NOTE: the various scripts will use this folder structure to create menu items in a&nbsp; text-based GUI, you shouldn\'t place anything in this folder structure outside of what is already there.&nbsp; Additionally for other OPFOR systems you want to add and attach to the grayspace switch, you can use this list to pick an IP for that system.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/C2concealer\r\n<ul>\r\n<li class=\"null\">This is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/SourcePoint\r\n<ul id=\"bkmrk-this-is-another-tool\">\r\n<li class=\"null\">This is another tool for generating Cobalt&nbsp;Strike C2 profiles, for a guide on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/cobaltstrike-local\r\n<ul>\r\n<li class=\"null\">This is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.&nbsp; NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/go\r\n<ul>\r\n<li class=\"null\">Golang is install for whatever Go projects you want to mess with.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/Profiles\r\n<ul>\r\n<li class=\"null\">This is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a Cobalt Strike teamserver or if you are building an HAProxy redirector, the profile is used to set up ACLs based on the C2 profile.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts\r\n<ul>\r\n<li class=\"null\">This is where most of the custom scripts reside.</li>\r\n<li class=\"null\">/root/scripts/buildredteam.sh\r\n<ul>\r\n<li class=\"null\">This is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.&nbsp; The script can also be used to set up the NRTS for phishing attacks.&nbsp; Go to -&gt; <a href=\"https://redbook.com/books/using-the-nrts\">Using the NRTS </a>for guides on how to set up all of these services.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/ManageDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to manage OPFOR DNS records that get added to the rootDNS server.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS </a>for a guide on how use this script.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/RegisterDNS.sh\r\n<ul>\r\n<li class=\"null\">This script is used to create new OPFOR DNS records that will get added to the rootDNS server.&nbsp; Go to -&gt; How to guides -&gt; <a href=\"https://redbook.com/books/how-to-guides/page/opfor-domain-registration-outside-of-nrts-automation\">Manual Domain Registration</a> for instructions on this script.<br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish\r\n<ul>\r\n<li class=\"null\">This directory contains scripts for sending phishing emails.&nbsp; Go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/phishing-attack-buildredteamsh\">Phishing Attack</a> for instructions on the scripts below.<br></li>\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">Used to send a phish to a single target.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">Used to send phishing attacks to a list of targets.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">/root/services\r\n<ul>\r\n<li class=\"null\">This directory is used for storing information regarding containers that the buildredteam.sh script creates.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','The Not Red Team Server (NRTS) is built on Ubuntu 22.01 and is used to quickly build out OPFOR infrastructure.  It uses docker to containerize each individual infrastructure system so that one NRTS can support multiple services, such as a redirector, Cobalt Strike teamserver, payload host, or multiples of each.  I haven\'t tested the bounds of this so not sure what the maximum is.  In testing, the system has supported 3 teamservers, 3 redirectors, and 3 payloads host running simultaneously.  However, this server isn\'t meant to be the single server for all OPFOR infrastructure needs.  You can clone this VM and make as many NRTS as you would like.  This server can do several things and will greatly reduce the time required to deploy infrastructure systems.  There is a lot going on in this VM, below is a description of the folder structure, for more detailed guides on how to use this VM, go to -> Using the NRTS.\r\nFolder Structure\r\n\r\n/root/backbonerouters\r\n\r\nThis directory contains a list of all the IP subnets that the SI-router will route for systems connected to the grayspace ESXI switch.  Its structured by Geo-location, in the following format /root/backbonerouters/<country>/<city.txt>.   This folder structure is used by other scripts on the NRTS to generator IP addresses.  NOTE: the various scripts will use this folder structure to create menu items in a  text-based GUI, you shouldn\'t place anything in this folder structure outside of what is already there.  Additionally for other OPFOR systems you want to add and attach to the grayspace switch, you can use this list to pick an IP for that system.\r\n\r\n\r\n/root/C2concealer\r\n\r\nThis is a tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/SourcePoint\r\n\r\nThis is another tool for generating Cobalt Strike C2 profiles, for a guide on this go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\n\r\n/root/cobaltstrike-local\r\n\r\nThis is a copy of Cobalt Strike, this is a clean copy and when you build a teamserver using the buildredteam.sh, it will make a copy of this for each teamserver you build.  NOTE: don\'t launch Cobalt Strike teamservers directly from this folder, the artifacts and data that would generate would get populated into all the cobalt strike teamservers that get build via the buildredteam.sh on the NRTS.\r\n\r\n\r\n/root/go\r\n\r\nGolang is install for whatever Go projects you want to mess with.\r\n\r\n\r\n/root/Profiles\r\n\r\nThis is where to put your Cobalt Strike C2 profiles and where the buildredteam.sh will look for profiles when it\'s setting up a Cobalt Strike teamserver or if you are building an HAProxy redirector, the profile is used to set up ACLs based on the C2 profile.\r\n\r\n\r\n/root/scripts\r\n\r\nThis is where most of the custom scripts reside.\r\n/root/scripts/buildredteam.sh\r\n\r\nThis is the script used to automate the build of OPFOR infrastructure, it will create redirectors, payload hosts, and Cobalt Strike teamservers in docker containers.  The script can also be used to set up the NRTS for phishing attacks.  Go to -> Using the NRTS for guides on how to set up all of these services.\r\n\r\n\r\n/root/scripts/ManageDNS.sh\r\n\r\nThis script is used to manage OPFOR DNS records that get added to the rootDNS server.  Go to -> Using the NRTS -> Managing DNS for a guide on how use this script.\r\n\r\n\r\n/root/scripts/RegisterDNS.sh\r\n\r\nThis script is used to create new OPFOR DNS records that will get added to the rootDNS server.  Go to -> How to guides -> Manual Domain Registration for instructions on this script.\r\n\r\n\r\n/root/scripts/phish\r\n\r\nThis directory contains scripts for sending phishing emails.  Go to -> Using the NRTS -> Phishing Attack for instructions on the scripts below.\r\n/root/scripts/phish/phish.sh\r\n\r\nUsed to send a phish to a single target.\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nUsed to send phishing attacks to a list of targets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n/root/services\r\n\r\nThis directory is used for storing information regarding containers that the buildredteam.sh script creates.\r\n\r\n\r\n\r\n',7,'2023-03-29 01:41:24','2023-04-12 21:52:15',1,1,0,'',7,0,NULL,1,''),(10,4,0,'OPFOR Domain Registration outside of NRTS Automation','opfor-domain-registration-outside-of-nrts-automation','<h2 id=\"bkmrk-add-domains-based-on\">Add Domains based on user created file</h2>\r\n<p id=\"bkmrk-step1.-obtain-the-%22r\"><strong>Step 1.</strong> Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.</p>\r\n<p id=\"bkmrk-step2.-set-up-ssh-ke\"><strong>Step 2</strong>. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.&nbsp; If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.<br></p>\r\n<pre id=\"bkmrk-ssh-copy-id-root%40198\"><code class=\"language-\">ssh-copy-id root@198.41.0.4   ## the password is : toor</code></pre>\r\n<p id=\"bkmrk-step3.-look-at-regis\"><strong>Step 3</strong>. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.&nbsp; <img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerdns-help.png\" alt=\"RegisterDNS-help.png\"></p>\r\n<p id=\"bkmrk-step4.-create-a-dns-\"><strong>Step 4</strong>. Create a DNS file according to the scripts usage. Below is an example.</p>\r\n<p id=\"bkmrk--11\"><a href=\"https://redbook.com/uploads/images/gallery/2023-03/examplednsfile.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/examplednsfile.png\" alt=\"exampleDNSfile.png\"></a></p>\r\n<p id=\"bkmrk-step5.-run-registerd\"><strong>Step 5</strong>. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt<img src=\"https://redbook.com/uploads/images/gallery/2023-03/scaled-1680-/registerprocess.png\" alt=\"registerprocess.png\"></p>\r\n<h3 id=\"bkmrk-managing-dns\">Managing DNS</h3>\r\n<p id=\"bkmrk-on-an-nrts-server-in\">On an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.&nbsp;&nbsp; Use this script to View or Delete OPFOR DNS registrations.&nbsp; DNS is tagged by the user when it\'s created by either the RegisterDNS.sh or as part of the process of the buildredteam.sh script.&nbsp; For more information on this go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/managing-dns-managednssh\">Managing DNS.</a><br></p>','Add Domains based on user created file\r\nStep 1. Obtain the \"RegisterDNS.sh\" script. This can be found on any NRTS server at /root/scripts. You can use it from the NRTS or SCP it over to Kali or most Linux based systems.\r\nStep 2. Set up ssh keys between the system you are on and the rootDNS server at 198.41.0.4.  If you are doing this from an NRTS, you can skip this step since the ssh keys are set up during the initial build of the NRTS.\r\nssh-copy-id root@198.41.0.4   ## the password is : toor\r\nStep 3. Look at RegisterDNS.sh\'s usage. Run the script without passing a file or argument.  \r\nStep 4. Create a DNS file according to the scripts usage. Below is an example.\r\n\r\nStep 5. Run RegisterDNS.sh with the path to your DNS file, ex .\\RegisterDNS.sh mydns.txt\r\nManaging DNS\r\nOn an NRTS server in the /root/scripts directory is a script called ManageDNS.sh.   Use this script to View or Delete OPFOR DNS registrations.  DNS is tagged by the user when it\'s created by either the RegisterDNS.sh or as part of the process of the buildredteam.sh script.  For more information on this go to -> Using the NRTS -> Managing DNS.',2,'2023-03-30 17:46:53','2023-04-12 21:54:31',1,1,0,'',15,0,NULL,1,'wysiwyg'),(11,4,0,'Proxy All the things','proxy-all-the-things','<p id=\"bkmrk-note%3A-the-proxy-is-a\">NOTE: The proxy is at http://172.30.0.2:9999</p>\r\n<h4 id=\"bkmrk-setting-up-docker-in\">Setting up Docker in linux</h4>\r\n<ul id=\"bkmrk-add-folder-for-the-d\">\r\n<li class=\"null\">Add folder for the docker service if it doesn\'t exist and add a proxy conf file&nbsp; &nbsp; &nbsp;&nbsp; <br></li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fsystemd%2Fsyst\"><code class=\"language-bash\">cd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in\">\r\n<li class=\"null\">Put the following in the http-proxy.conf</li>\r\n</ul>\r\n<pre id=\"bkmrk-%5Bservice%5D-environmen\"><code class=\"language-bash\">[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"</code></pre>\r\n<ul id=\"bkmrk-lastly%2C-reload-daemo\">\r\n<li class=\"null\">Lastly, reload daemon and restart the docker service<br></li>\r\n</ul>\r\n<pre id=\"bkmrk-systemctl-daemon-rel\"><code class=\"language-\">systemctl daemon-reload\r\nsystemctl restart docker</code></pre>\r\n<h4 id=\"bkmrk-adding-proxy-to-a-do\">Adding Proxy to a Dockerfile</h4>\r\n<ul id=\"bkmrk-edit-your-dockerfile\">\r\n<li class=\"null\">edit your dockerfile in your favorite linux text editor and add these variables.</li>\r\n</ul>\r\n<pre id=\"bkmrk-env-http_proxy-http%3A\"><code class=\"language-\">ENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-add-proxy-to-apt\">Add Proxy to Apt</h4>\r\n<ul id=\"bkmrk-go-to-the-apt.conf.d\">\r\n<li class=\"null\">Go to the apt.conf.d directory and create a proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fapt%2Fapt.conf\"><code class=\"language-bash\">cd /etc/apt/apt.conf.d\r\nvi proxy.conf</code></pre>\r\n<ul id=\"bkmrk-put-the-following-in-1\">\r\n<li class=\"null\">Put the following in the proxy.conf file</li>\r\n</ul>\r\n<pre id=\"bkmrk-acquire%3A%3Ahttp%3A%3Aproxy\"><code class=\"language-\">Acquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";</code></pre>\r\n<h4 id=\"bkmrk-add-proxy-for-wget\">Add proxy for wget</h4>\r\n<ul id=\"bkmrk-edit-the-%2Fetc%2Fwgetrc\">\r\n<li class=\"null\">Edit the /etc/wgetrc file.&nbsp; Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.</li>\r\n</ul>\r\n<pre id=\"bkmrk-use_proxy%3Dyes-http_p\"><code class=\"language-\">use_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-cobalt-strike-update\">Cobalt Strike Update script</h4>\r\n<ul id=\"bkmrk-in-order-to-run-the-\">\r\n<li class=\"null\">In order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.&nbsp; Below is the additional flags you need to add.</li>\r\n</ul>\r\n<pre id=\"bkmrk-java--dhttp.proxyhos\"><code class=\"language-\">java -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999</code></pre>\r\n<h4 id=\"bkmrk-using-git-via-proxy\">Using git via proxy</h4>\r\n<ul id=\"bkmrk-git-can-use-your-env\">\r\n<li class=\"null\">git can use your environment variables to use a proxy, wget can to depending on the version of linux.&nbsp; To use git through the proxy, set the following environment variables with the following command.</li>\r\n</ul>\r\n<pre id=\"bkmrk-export-http_proxy%3Dht\"><code class=\"language-\">export http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999</code></pre>\r\n<h4 id=\"bkmrk-pip3-install-via-pro\">PIP3 install via proxy</h4>\r\n<ul id=\"bkmrk-on-occasion-pip3-ins\">\r\n<li class=\"null\">On occasion pip3 installs on ubuntu runs into issues.&nbsp; The following has worked to resolve it.</li>\r\n</ul>\r\n<pre id=\"bkmrk-apt-remove---purge-p\"><code class=\"language-\">apt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py</code></pre>','NOTE: The proxy is at http://172.30.0.2:9999\r\nSetting up Docker in linux\r\n\r\nAdd folder for the docker service if it doesn\'t exist and add a proxy conf file       \r\n\r\ncd /etc/systemd/system\r\nmkdir docker.service.d\r\ncd docker.service.d\r\nvi http-proxy.conf\r\n\r\nPut the following in the http-proxy.conf\r\n\r\n[Service]\r\nEnvironment=\"HTTP_PROXY=http://172.30.0.2:9999\"\r\nEnvironment=\"HTTPS_PROXY=http://172.30.0.2:9999\"\r\n\r\nLastly, reload daemon and restart the docker service\r\n\r\nsystemctl daemon-reload\r\nsystemctl restart docker\r\nAdding Proxy to a Dockerfile\r\n\r\nedit your dockerfile in your favorite linux text editor and add these variables.\r\n\r\nENV http_proxy http://172.30.0.2:9999\r\nENV https_proxy http://172.30.0.2:9999\r\nAdd Proxy to Apt\r\n\r\nGo to the apt.conf.d directory and create a proxy.conf file\r\n\r\ncd /etc/apt/apt.conf.d\r\nvi proxy.conf\r\n\r\nPut the following in the proxy.conf file\r\n\r\nAcquire::http::Proxy \"http://172.30.0.2:9999\";\r\nAcquire::https::Proxy \"http://172.30.0.2:9999\";\r\nAdd proxy for wget\r\n\r\nEdit the /etc/wgetrc file.  Find the lines \"use_proxy\", \"http_proxy\", and \"https_proxy\" and edit them to match the following.\r\n\r\nuse_proxy=yes\r\nhttp_proxy=http://172.30.0.2:9999\r\nhttps_proxy=http://172.30.0.2:9999\r\nCobalt Strike Update script\r\n\r\nIn order to run the update script for Cobalt Strike, you need to modify the \"update\" script to add proxy information in to the java command.  Below is the additional flags you need to add.\r\n\r\njava -Dhttp.proxyHost=172.30.0.2 -Dhttp.proxyPort=9999 -Dhttps.proxyhost=172.30.0.2 -Dhttps.proxyPort=9999\r\nUsing git via proxy\r\n\r\ngit can use your environment variables to use a proxy, wget can to depending on the version of linux.  To use git through the proxy, set the following environment variables with the following command.\r\n\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\nPIP3 install via proxy\r\n\r\nOn occasion pip3 installs on ubuntu runs into issues.  The following has worked to resolve it.\r\n\r\napt remove --purge python3-pip -y\r\nexport http_proxy=http://172.30.0.2:9999\r\nexport https_proxy=http://172.30.0.2:9999\r\ncurl \"https://bootstrap.pypa.io/get-pip.py\" -o \"install-pip2-ubuntu.py\"\r\npython3 install-pip3-ubuntu.py',3,'2023-04-03 19:54:40','2023-04-06 01:30:39',1,1,0,'',3,0,NULL,1,''),(12,4,0,'Code Signing Binaries','code-signing-binaries','<p id=\"bkmrk-using-the-ca-server-\">Using the CA-server to sign binaries.</p>\r\n<ul id=\"bkmrk-ssh-into-globalcerts\">\r\n<li class=\"null\">SSH into globalcerts.com.&nbsp;&nbsp; Creds: root&nbsp; password: toor</li>\r\n<li class=\"null\">\r\n</ul>','Using the CA-server to sign binaries.\r\n\r\nSSH into globalcerts.com.   Creds: root  password: toor\r\n\r\n',4,'2023-04-03 20:15:55','2023-04-12 21:55:36',1,1,0,'',2,0,NULL,1,''),(13,6,0,'Creating Cobalt Strike C2 Profiles','creating-cobalt-strike-c2-profiles','<h3 id=\"bkmrk-script-generated-cob\">Script generated Cobalt Strike C2 Profiles</h3>\r\n<ul id=\"bkmrk-there-are-two-differ\">\r\n<li class=\"null\">There are two different solutions installed on the NRTS by default.&nbsp; These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.&nbsp; You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.&nbsp; One of the more common issues seen is very slow download transfer rates through a beacon.&nbsp; After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.&nbsp; Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.&nbsp; So you should also testing this functionality on your test target as well.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-c2concealer\">Using C2concealer</h4>\r\n<ul id=\"bkmrk-note%3A-c2concealer-is\">\r\n<li class=\"null\">NOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.</li>\r\n<li class=\"null\">There are two arguments that C2concealer accepts; --variants and --hostname.&nbsp; The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.&nbsp; The max number of variants is 10, but it\'s a good idea to set this to 0.&nbsp; The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.&nbsp; c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.&nbsp; Below is a usage example.</li>\r\n</ul>\r\n<pre id=\"bkmrk-c2concealer---varian\"><code class=\"language-\">C2concealer --variants 0 --hostname humanzoo.com</code></pre>\r\n<p id=\"bkmrk-the-script-will-ask-\">The script will ask for an SSL option, these options are;</p>\r\n<ul id=\"bkmrk-self-signed-ssl-cert\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Self-signed SSL cert</li>\r\n<li class=\"null\">LetsEncrypt SSL cert</li>\r\n<li class=\"null\">Existing Keystore</li>\r\n<li class=\"null\">No SSL</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">If you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.&nbsp; If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike.&nbsp; Or you can select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.&nbsp; The LetsEncrypt SSL cert will fail in this closed grayspace environment.</li>\r\n<li class=\"null\">Once you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23%23\"><code class=\"language-\">############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################</code></pre>\r\n<ul id=\"bkmrk-it-saves-the-profile\">\r\n<li class=\"null\">It saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.&nbsp; The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.&nbsp; This directory is /root/Profiles.&nbsp; Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.</li>\r\n</ul>\r\n<pre id=\"bkmrk-mv-ba3e5732.profile-\"><code class=\"language-\">mv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/</code></pre>\r\n<ul id=\"bkmrk-at-this-point-the-pr\">\r\n<li class=\"null\">At this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-using-sourcepoint\">Using SourcePoint</h4>\r\n<ul id=\"bkmrk-sourcepoint-isn%27t-ad\">\r\n<li class=\"null\">SourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n<ul id=\"bkmrk-path-for-the-executa\">\r\n<li class=\"null\">Path for the executable is /root/SourcePoint/SourcePoint</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">SourePoint has a larger number of arguments and gives you a lot more control.&nbsp; For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.</li>\r\n<li class=\"null\">Required SourcePoint arguments.\r\n<ul>\r\n<li class=\"null\">-host&nbsp;&nbsp;\r\n<ul>\r\n<li class=\"null\">This is the host name it will add as a server variable in the profile</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Outfile\r\n<ul>\r\n<li class=\"null\">This is the name/path to save the profile as</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">-Injector\r\n<ul>\r\n<li class=\"null\">This is the process injection method, the script provides two options&nbsp;\r\n<ul>\r\n<li class=\"null\">VirtualAllocEx (Great for cross architecture i.e x86 -&gt; x64 and x64-&gt;x86)</li>\r\n<li class=\"null\">NtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example Usage</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fsourcepoint\"><code class=\"language-bash\">cd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx</code></pre>\r\n<ul id=\"bkmrk-output-will-look-lik\">\r\n<li class=\"null\">Output will look like.</li>\r\n</ul>\r\n<pre id=\"bkmrk-_____-____-_-__-%2F-__\"><code class=\"language-\">\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source</code></pre>\r\n<ul id=\"bkmrk-note%3A-the-profiles-g\">\r\n<li class=\"null\">NOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.&nbsp; So it\'s a good idea to test these profiles before trying to use them.&nbsp; Below is how to test it on a NRTS.</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fcobaltstrik\"><code class=\"language-bash\">cd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile</code></pre>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Script generated Cobalt Strike C2 Profiles\r\n\r\nThere are two different solutions installed on the NRTS by default.  These are Forty North Securities C2Concealer and Tylous\'s Github SourcePoint.  You should test these out prior to building out an engagement worth of payloads, there are some issues especially since Cobalt Strike updates have a tendency to mess around with C2 profile syntax.  One of the more common issues seen is very slow download transfer rates through a beacon.  After you build a profile, I\'d advice generating a payload, dropping it on a test target and trying to download some 50mb or larger file to see how long it takes.  Another issue involves processes used for fork and run actions, like beacon spawning or running execute-assembly.  So you should also testing this functionality on your test target as well.\r\n\r\nUsing C2concealer\r\n\r\nNOTE: C2concealer is added to the NRTS path, so you don\'t need to be in the C2concealer directory to use it.\r\nThere are two arguments that C2concealer accepts; --variants and --hostname.  The script will generate a C2 profile based off of the hostname you provide and add variants based on the number of variants you set.  The max number of variants is 10, but it\'s a good idea to set this to 0.  The script will test the profile it generates against Cobalt Strikes c2lint script and the more variants you provide the great the chances are that it will fail the c2lint test.  c2lint is a built in script that comes with Cobalt Strike that is designed to test/validate a C2 profile.  Below is a usage example.\r\n\r\nC2concealer --variants 0 --hostname humanzoo.com\r\nThe script will ask for an SSL option, these options are;\r\n\r\n\r\n\r\nSelf-signed SSL cert\r\nLetsEncrypt SSL cert\r\nExisting Keystore\r\nNo SSL\r\n\r\n\r\nIf you plan on using a redirector, you can select \"No SSL\", the NRTS redirector will handle SSL certs for all the domains you use with it.  If you aren\'t using a redirector, you can generator SSL certs on the CA-server and then add those to a keystore in Cobalt Strike.  Or you can select self-signed certs, but those will be self-signed and not a great solution unless self-signed is an indicator you want to emulate in your engagement.  The LetsEncrypt SSL cert will fail in this closed grayspace environment.\r\nOnce you\'ve made a selection, the tool should generate a profile for you, and you\'d get an output that will scroll through the C2lint check and finish with the following;\r\n\r\n############################################################\r\n# Profile successfully passed C2lintcheck                  #\r\n# Profile name: ba3e5732.profile                           #\r\n# Generated by FortyNorthSecurity\'s C2concealer tool.      #\r\n############################################################\r\n\r\nIt saves the profile with a \"randomly generated named\".profile in the directory you ran C2concealer from.  The next step is to rename the profile to something meaningful and moving it to the directory on the NRTS that the buildredteam.sh script will look in when it\'s building a Cobalt Strike teamserver.  This directory is /root/Profiles.  Below is an example, so modify as needed based on where you created the profile and what you get in regards of a randomized profile name.\r\n\r\nmv ba3e5732.profile humanzoo.profile\r\nmv humanzoo.profile /root/Profiles/\r\n\r\nAt this point the profile is ready to use, when you go to set up a Cobalt Strike teamserver on the NRTS, the script will see this profile and give you the option to select it.\r\n\r\nUsing SourcePoint\r\n\r\nSourcePoint isn\'t added to the path by default, so you need to provide the full path or navigate to the directory to run it.\r\n\r\nPath for the executable is /root/SourcePoint/SourcePoint\r\n\r\n\r\nSourePoint has a larger number of arguments and gives you a lot more control.  For this guide, we\'ll cover just the required arguments, to see a full list of arguments, run ./SourcePoint -h.\r\nRequired SourcePoint arguments.\r\n\r\n-host  \r\n\r\nThis is the host name it will add as a server variable in the profile\r\n\r\n\r\n-Outfile\r\n\r\nThis is the name/path to save the profile as\r\n\r\n\r\n-Injector\r\n\r\nThis is the process injection method, the script provides two options \r\n\r\nVirtualAllocEx (Great for cross architecture i.e x86 -> x64 and x64->x86)\r\nNtMapViewOfSection (A more stealthy option, however fails over to VirtualAllocEx)\r\n\r\n\r\n\r\n\r\n\r\n\r\nExample Usage\r\n\r\ncd /root/SourcePoint\r\n./SourcePoint -Host humanzoo.com -Outfile /root/Profiles/humanzoo2.profile -Injector VirtualAllocEx\r\n\r\nOutput will look like.\r\n\r\n\r\n           _____                            ____        _       __ \r\n          / ___/____  __  _______________  / __ \\____  (_)___  / /_\r\n          \\__ \\/ __ \\/ / / / ___/ ___/ _ \\/ /_/ / __ \\/ / __ \\/ __/\r\n         ___/ / /_/ / /_/ / /  / /__/  __/ ____/ /_/ / / / / / /_  \r\n        /____/\\____/\\__,_/_/   \\___/\\___/_/    \\____/_/_/ /_/\\__/  \r\n                                                        (@Tyl0us)\r\n                                                                                                                         \r\n\r\n[*] Preparing Varibles...\r\n[*] Building Profile...\r\n[!] Host Staging Is Disabled - Staged Payloads Are Not Available But Your Beacon Payload Is Not Available To Anyone That Connects\r\n[*] Beacon DLL Spoofed To: audioeng.dll\r\n[*] Post-Ex Process Name: gpupdate.exe\r\n[!] Beacon Shellcode Will Obfuscate Beacon in Memory Prior to Sleeping\r\n[*] Seleted Profile: \r\n[+] Profile Generated: /root/Profiles/humanzoo2.profile\r\n[+] Happy Hacking\r\nroot@nrts:~/Source\r\n\r\nNOTE: the profiles generated by SourcePoint are not ran through C2lint via the script.  So it\'s a good idea to test these profiles before trying to use them.  Below is how to test it on a NRTS.\r\n\r\ncd /root/cobaltstrike-local\r\n./c2lint /root/Profiles/humanzoo2.profile\r\n',5,'2023-04-03 20:19:08','2023-04-12 22:08:18',1,1,0,'',7,0,NULL,1,''),(14,6,0,'Starting a Cobalt Strike Teamserver (buildredteam.sh)','starting-a-cobalt-strike-teamserver-buildredteamsh','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.&nbsp; This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.&nbsp; Doing so would create artifacts on any teamserver you build using the build script.&nbsp; That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.</p>\r\n<p id=\"bkmrk-also-this-guide-is-a\">Also this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.&nbsp; For this example, we will use humanzoo.profile as the profile we created.&nbsp; For instructions on how to create Cobalt Strike C2 profiles go to -&gt; Using the NRTS -&gt; <a href=\"https://redbook.com/books/using-the-nrts/page/creating-cobalt-strike-c2-profiles\">Creating Cobalt Strike C2 Profiles</a>.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Example usage.</li>\r\n<li class=\"null\">\r\n<pre><code class=\"language-bash\">cd /root/scripts\r\n./buildredteam.sh</code></pre>\r\n</li>\r\n<li class=\"null\">This will pop up a text-based menu.&nbsp; At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default.<br>\r\n<p>&nbsp;</p>\r\n</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hGyimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Next it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.&nbsp; Here you select what Geo-based IP you want to set up your teamserver with.&nbsp; For this example we\'ll use option 26&nbsp; \"USA\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/N1Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-drill-\">\r\n<li class=\"null\">Next, it will drill down further with a City location, some only have one option, but the USA one has several.&nbsp; For this example, we\'ll use option 12 \"Seattle\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KZNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want a randomly generated IP or to set one manually.&nbsp; The guide will walk through both options.&nbsp; For a randomly set IP, the script will randomly select an IP from the Geo-location you selected during processing and the script will move on to the next menu.&nbsp; For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.&nbsp; It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uPMimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips---option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add a random IP during processing so the menu will move to the next step.&nbsp; This will be shown after going over the manual process.</li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp;&nbsp; Below is the menu when you selected option 2.&nbsp; At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0Ddimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-here-is-what-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is what you will see when you select option \"s\".&nbsp; This list is can be long or short depending on the Geo-location you selected.&nbsp; Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu. &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/c2Fimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-i%27ve-decided-w\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.&nbsp; This will take you back to the previous menu.&nbsp; From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.&nbsp; NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.<br></li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iWuimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-wh\">\r\n<li class=\"null\">At this point you have either selected to randomly set an IP or set one manually.&nbsp; Next, it will ask what profile you want to use.&nbsp; It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.&nbsp; For this example, we\'ll use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JHKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a password to use.&nbsp; For this we\'ll set the password to toor.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3ybimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you%27v\">\r\n<li class=\"null\">At this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JB2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-what-the-bu\">\r\n<li class=\"null\">Below is what the build process looks like.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b00image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script exits and your Cobalt Strike teamserver should be up and running in a container.&nbsp; Information about the service is also placed in /root/services/TS1/ directory.&nbsp; To check your container, run docker ps, below is a screenshot of this.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/BAHimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/BAHimage.png\" alt=\"image.png\"></a></p>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  On the root folder of the NRTS is a copy of Cobalt Strike listed as cobaltstrike-local.  This is a clean template of Cobalt Strike and you shouldn\'t use this to start a Cobalt Strike teamserver directly.  Doing so would create artifacts on any teamserver you build using the build script.  That said, these instructions are for using the buildredteam.sh script to start a Cobalt Strike teamserver.\r\nAlso this guide is assuming that you have already created a Cobalt Strike C2 profile that you want to use.  For this example, we will use humanzoo.profile as the profile we created.  For instructions on how to create Cobalt Strike C2 profiles go to -> Using the NRTS -> Creating Cobalt Strike C2 Profiles.\r\n\r\nUse the following script to start a Cobalt Strike teamserver on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nExample usage.\r\n\r\ncd /root/scripts\r\n./buildredteam.sh\r\n\r\nThis will pop up a text-based menu.  At the screen below select option 3 \"Set up a Cobalt Strike teamserver\"\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you TS1, or if there is already a TS1, it will give a default of TS2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default.\r\n \r\n\r\n\r\nNext it will set up IPs, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.  Here you select what Geo-based IP you want to set up your teamserver with.  For this example we\'ll use option 26  \"USA\".\r\n\r\n\r\n\r\nNext, it will drill down further with a City location, some only have one option, but the USA one has several.  For this example, we\'ll use option 12 \"Seattle\".\r\n\r\n\r\n\r\nThen it will ask if you want a randomly generated IP or to set one manually.  The guide will walk through both options.  For a randomly set IP, the script will randomly select an IP from the Geo-location you selected during processing and the script will move on to the next menu.  For manual, you need to put in the IP yourself, but you can view available IP subnets which the guide will show.  It then validates that the IP you enter is correct before proceeding if it\'s not validate it will ask you to try again.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add a random IP during processing so the menu will move to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.   Below is the menu when you selected option 2.  At this screen you can enter \"s\" and press enter to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is what you will see when you select option \"s\".  This list is can be long or short depending on the Geo-location you selected.  Use space bar to page down, and then press \"q\" and \"enter\" to exit this view and get back to the previous menu.     \r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter you\'ve decided what subnet you want to use from the list above, write it down or memorize it and then press \"q\" and then \"enter\" to exit out of the IP subnet view screen.  This will take you back to the previous menu.  From the list above for this example, we\'ll select 54.88.220.10 from the 54.88.220.1/22 subnet.  NOTE: Never you the actual IP listed, for example you wouldn\'t use 54.88.220.1 in this case, the IP listed is the gateway IP and resides on the SI-router.\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to randomly set an IP or set one manually.  Next, it will ask what profile you want to use.  It pulls this from files in /root/Profiles, so make sure that is where you save any profiles you create.  For this example, we\'ll use the humanzoo2.profile.\r\n\r\n\r\n\r\nThen it will ask for a password to use.  For this we\'ll set the password to toor.\r\n\r\n\r\n\r\nAt this point, you\'ve set all the settings needed to start a teamserver, the script shows what you\'ve selected, give that a once over and if you are happy with it press enter and it will start the build process.\r\n\r\n\r\n\r\nBelow is what the build process looks like.\r\n\r\n\r\n\r\nAt this point the script exits and your Cobalt Strike teamserver should be up and running in a container.  Information about the service is also placed in /root/services/TS1/ directory.  To check your container, run docker ps, below is a screenshot of this.\r\n\r\n\r\n',6,'2023-04-03 21:35:50','2023-04-12 22:15:39',1,1,0,'',8,0,NULL,1,''),(15,6,0,'Making a HAProxy Redirector (buildredteam.sh)','making-a-haproxy-redirector-buildredteamsh','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and it doesn\'t match it will forward the traffic to a decoy website.</p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a HAProxy redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default name or add own own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave it as the default of RD1. &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;&nbsp;</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/59Fimage.png\" alt=\"image.png\">&nbsp; <br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for the number of IPs, the script limits this to 20 for sanity reasons.&nbsp; For this example, we\'ll use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vq2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the option 25 \"UK\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6itimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-to-\">\r\n<li class=\"null\">Then it will ask to select a city, some have a few, but a lot only have one.&nbsp; For this example, we\'ll select Option 2 \"London\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Ycfimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-if-\">\r\n<li class=\"null\">Then it will ask if you want to set IPs randomly or manually.&nbsp; This guide will walk through both processes.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/yTwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%28random%29\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the manual process.<br></li>\r\n<li class=\"null\">Setting IPs - Option 2 Set IPs manually.&nbsp; The next few screenshots shows the manual IP process.&nbsp; Below is the menu when you select Set IPs manually.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.&nbsp; The blank menu items will store IPs as you add them in.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-%22s%22-option\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Use the \"s\" option to see available subnets.&nbsp; This shows the available IP subnets based on the Geo-location selections you made previously.&nbsp; The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.&nbsp; You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.150 from the 12.9.80.129/25 subnet.&nbsp; Note you can pick IPs from multiple IP subnets from the list.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Mc7image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-after-pressing-%22q%22-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">After pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.</li>\r\n<li class=\"null\">&nbsp;<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B5bimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-then-enter-the-ip.\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Then enter the IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jRdimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-enter-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.&nbsp; You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.&nbsp; Note:&nbsp; If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. <a href=\"https://redbook.com/uploads/images/gallery/2023-04/gjaimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gjaimage.png\" alt=\"image.png\"></a></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have either set IPs randomly or manually, below is the next menu screen.&nbsp; Here it asks for what ports to redirect.&nbsp; For this example, we\'ll select HTTP, HTTPS.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pYCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-once-selected%2C-it-wi\">\r\n<li class=\"null\">Once selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.&nbsp; This only changes the \"bind to\" on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but your Cobalt Strike listener will be listening on 8443, at least as long as you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.&nbsp; However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.&nbsp; To accept the default just press enter.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/XMHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-abo\">\r\n<li class=\"null\">Next it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.&nbsp; Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6goimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-wha\">\r\n<li class=\"null\">Next it will ask what IP the redirector should be redirecting to.&nbsp; This should be your Cobalt Strike Teamserver IP. &nbsp; For this example we will be using 54.88.220.10.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hXTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-whi\">\r\n<li class=\"null\">Then it will ask which Cobalt Strike profile to use.&nbsp; This needs to be the same as the profile used to start the Cobalt Strike teamserver.&nbsp; The script will use information from the profile to build out ACLs.&nbsp; These ACLs are used to identify C2 traffic from other things hitting a redirector domain.&nbsp; If you select the wrong profile, your C2 will not work.&nbsp; For this example we will use the humanzoo2.profile.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/uJUimage.png\" alt=\"image.png\"><br></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.&nbsp; NOTE: this has to be a site that exist in the range and is reachable.&nbsp; If you put in a domain that isn\'t reachable, the HAProxy will stop working.&nbsp; The default is set to redbook.com.&nbsp; We\'ll leave the default for this example.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/B4Aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to create manual domains or have them randomly generated.&nbsp; If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.&nbsp; This guide will walk through both options.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/iTDimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-%28o\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains - Option 1 - (use randomly generated one/s).&nbsp; If we select option 1, the script will add these during processing and move on to the next step.&nbsp; We\'ll cover that after going over the manual process.<br></li>\r\n<li class=\"null\">Assigning Domains - Option 2 - (Manually create domain name/s).&nbsp; When you select option 2, you get the menu shown below.&nbsp; Here you pick an IP from the list and&nbsp; it will take you to a menu for entering a domain name for that IP.&nbsp; For this example will use option 1&nbsp; for IP 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2I5image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you-selected-an\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you selected an IP to add a domain for, you get the menu shown below.&nbsp; For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3UBimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-press-enter-on-the-a\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.&nbsp; You will see the domain you entered is populated next to the IP.&nbsp; Repeat this process for all IPs, and select \"d\" for done when you are finished.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Nxsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point%2C-you-h\">\r\n<li class=\"null\">At this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.&nbsp; This tag is used by other scripts to identify who created these domains and/or what there purpose is.&nbsp; This will allow these domains to be deleted later like say after an engagement and you no longer need them.&nbsp; For this example, I\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dj9image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h7Iimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li class=\"null\">Below is a screenshot of the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/vleimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-should-now-have-\">\r\n<li class=\"null\">You should now have a working redirector.&nbsp; The information regarding the redirector is located at /root/services/RD1.&nbsp; This directory will have you DNS information, IP information, where it\'s redirecting to, the name of the C2 profile used and an SSL folder containing signed SSL certs&nbsp; for all of the redirectors domains.&nbsp; You can validate if your redirector is running by looking at docker.&nbsp; Run docker ps and you should see RD1 up and running.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dhEimage.png\" alt=\"image.png\"></li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The HAProxy redirector is only compatible with a Cobalt Strike teamserver, this is due to the script using information from the Cobalt Strike teamservers C2 profile to add ACLs to detect C2 traffic, if traffic hitting one of the redirect domains and it doesn\'t match it will forward the traffic to a decoy website.\r\nNOTE: This guide is assuming you already have a Cobalt Strike team server running.  \r\nFor this example, we\'ll assume we have a Cobalt Strike teamserver running at 54.88.220.10 that is using the humanzoo2.profile.\r\n\r\nUse the following script to start a HAProxy redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 2 \"Set up a HAProxy redirector (http and/or https only)\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already an RD1, it will give a default of RD2, and so on.  You can keep the default name or add own own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave it as the default of RD1.                                                                                                                               \r\n  \r\n\r\n\r\nNext it will ask for the number of IPs, the script limits this to 20 for sanity reasons.  For this example, we\'ll use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location to pull IP addresses from, the NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. For this example we\'ll use the option 25 \"UK\".\r\n\r\n\r\n\r\nThen it will ask to select a city, some have a few, but a lot only have one.  For this example, we\'ll select Option 2 \"London\".\r\n\r\n\r\n\r\nThen it will ask if you want to set IPs randomly or manually.  This guide will walk through both processes.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the manual process.\r\nSetting IPs - Option 2 Set IPs manually.  The next few screenshots shows the manual IP process.  Below is the menu when you select Set IPs manually.  At this screen you can enter \"s\" to see a list of IP subnets to select IPs from.  The blank menu items will store IPs as you add them in.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUse the \"s\" option to see available subnets.  This shows the available IP subnets based on the Geo-location selections you made previously.  The list is typically long, you can hit the spacebar to page down and press \"q\" then \"enter\" to exit out of the IP subnet view and go back to the previous menu.  You can pick IPs from any of these subnets, so for this example, we\'ll use 12.9.80.150 from the 12.9.80.129/25 subnet.  Note you can pick IPs from multiple IP subnets from the list.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAfter pressing \"q\" then \"Enter\" to get back to the previous menu, we\'ll select option 1 to put in an IP for the first IP slot.\r\n \r\n\r\n\r\n\r\n\r\n\r\n\r\nThen enter the IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you enter the IP and press enter, the script will take some time to validate the IP, and then it will take you back to the original menu.  You should now see the IP you entered, continue these steps until you\'ve added IPs for all empty slots.  Note:  If you don\'t fill in all empty slots, the script will just use the IPs it has and continue, so say you asked for 5 IPs but only entered 3, it will build it our for those three. \r\n\r\n\r\n\r\n\r\nAt this point we have either set IPs randomly or manually, below is the next menu screen.  Here it asks for what ports to redirect.  For this example, we\'ll select HTTP, HTTPS.\r\n\r\n\r\n\r\nOnce selected, it will ask if you want to change the port, so if you want the redirector to use port 8443 for HTTPS instead of 443.  This only changes the \"bind to\" on the Cobalt Strike teamserver, your Cobalt Strike payload will still call out on 443, but your Cobalt Strike listener will be listening on 8443, at least as long as you configure the Cobalt Strike Listener\'s \"Bind to\" address to do this.  However, with the teamserver and redirectors residing on the same NRTS, this isn\'t really necessary.  To accept the default just press enter.\r\n\r\n\r\n\r\nNext it will ask about changing the bind port for HTTP, again you can do this or just leave it as default.  Just keep in mind if you change this, you\'ll need to build your Cobalt Strike listener accordingly.\r\n\r\n\r\n\r\nNext it will ask what IP the redirector should be redirecting to.  This should be your Cobalt Strike Teamserver IP.   For this example we will be using 54.88.220.10.\r\n\r\n\r\n\r\nThen it will ask which Cobalt Strike profile to use.  This needs to be the same as the profile used to start the Cobalt Strike teamserver.  The script will use information from the profile to build out ACLs.  These ACLs are used to identify C2 traffic from other things hitting a redirector domain.  If you select the wrong profile, your C2 will not work.  For this example we will use the humanzoo2.profile.\r\n\r\n\r\n\r\nNext it will ask for a decoy website, this is where the HAproxy will redirect any traffic that hits one of its domains if the traffic doesn\'t match the Cobalt Strike ACL that is created based on the C2 profile.  NOTE: this has to be a site that exist in the range and is reachable.  If you put in a domain that isn\'t reachable, the HAProxy will stop working.  The default is set to redbook.com.  We\'ll leave the default for this example.\r\n\r\n\r\n\r\nNext it will ask if you want to create manual domains or have them randomly generated.  If you are using HTTPS, then domains need to be created now in order to create the SSL certificates that the redirector will use.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains - Option 1 - (use randomly generated one/s).  If we select option 1, the script will add these during processing and move on to the next step.  We\'ll cover that after going over the manual process.\r\nAssigning Domains - Option 2 - (Manually create domain name/s).  When you select option 2, you get the menu shown below.  Here you pick an IP from the list and  it will take you to a menu for entering a domain name for that IP.  For this example will use option 1  for IP 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you selected an IP to add a domain for, you get the menu shown below.  For this example we\'ll make a domain called goatfarmer.com for the IP of 208.82.7.57.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve added a domain named and pressed \"enter\" it takes you back to the original menu.  You will see the domain you entered is populated next to the IP.  Repeat this process for all IPs, and select \"d\" for done when you are finished.\r\n\r\n\r\n\r\n\r\n\r\nAt this point, you have either selected random domain name generation or you have manually added domain names for all of your IPs, the next thing the script will ask for is a Tag for these domains.  This tag is used by other scripts to identify who created these domains and/or what there purpose is.  This will allow these domains to be deleted later like say after an engagement and you no longer need them.  For this example, I\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nFinally the script has everything it needs to build your HAproxy redirector, take a look at the settings and it you are good with it, press enter to start the redirector build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.\r\n\r\n\r\n\r\nYou should now have a working redirector.  The information regarding the redirector is located at /root/services/RD1.  This directory will have you DNS information, IP information, where it\'s redirecting to, the name of the C2 profile used and an SSL folder containing signed SSL certs  for all of the redirectors domains.  You can validate if your redirector is running by looking at docker.  Run docker ps and you should see RD1 up and running.\r\n',7,'2023-04-03 22:23:09','2023-04-12 22:27:00',1,1,0,'',11,0,NULL,1,''),(16,6,0,'Making a NGINX Redirector (buildredteam.sh)','making-a-nginx-redirector-buildredteamsh','<p id=\"bkmrk-note%3A-the-nrts-is-de\">&nbsp;NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp; <br></p>\r\n<p id=\"bkmrk-note%3A-the-haproxy-re\">NOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.<br></p>\r\n<p id=\"bkmrk-note%3A-this-guide-is-\">NOTE: This guide is assuming you already have a Cobalt Strike or other team server running.&nbsp; <br></p>\r\n<p id=\"bkmrk-for-this-example%2C-we\">For this example, we\'ll assume we have a teamserver running at 54.88.220.10.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a NGINX redirector on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.&nbsp; You can keep the default or set your own.&nbsp; This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.&nbsp; For this example, we\'ll leave the default of RD1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/CBYimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-asks-for-the\">\r\n<li class=\"null\">Next it asks for the number of IPs.&nbsp; For the example we\'ll use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ApVimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a Geo-location base for your setting your IP\'s.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters. &nbsp; For this example we\'ll use option 4 Canada.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/RStimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-narrows-it-d\">\r\n<li class=\"null\">Then it narrows it down by city, for this example we\'ll use Toronto.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/VBWimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP manually or randomly.&nbsp; This guide will walk through both options.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Qhimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ips-%281-set-r\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the menu will move on to the next step.&nbsp; This will be shown after going over the Manual IP option.</li>\r\n<li class=\"null\">Setting IPs&nbsp; - Option 2 set IPs Manually.&nbsp; Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.&nbsp; At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.&nbsp; This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out of the IP subnet view and get back to the previous menu.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X3Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-using-the-list-of-av\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Using the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.20 out of the 72.3.244.1/25 IP subnet, but you can use multiple subnets from the list.&nbsp; Press \"q\" then \"enter\" to exit the IP subnet view to get&nbsp; back at the manual IP menu.&nbsp; For this example, we\'ll select 1 for the first blank space.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/bTcimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-brings-up-the-i\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This brings up the IP entry menu, for this example we\'ll use 72.3.244.20.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hdjimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-enter-th\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and you will see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jJGimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-i-have\">\r\n<li class=\"null\">At this point you have either selected to have IPs generated randomly or have manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.&nbsp;&nbsp; For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rocimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-if-\">\r\n<li class=\"null\">Next it will ask if you want to set a different port for the \"bind to\" this is related to a Cobalt Strike feature where you can have a listener set the \"bind to\" to a different port.&nbsp; The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.&nbsp; You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.&nbsp; For this example we will leave it at the default.&nbsp; The screenshoot shows that it will asks this for each port being redirected.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/rtkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-2\">\r\n<li class=\"null\">Next it will ask for the IP to redirect to.&nbsp; This should be your C2 server\'s IP.&nbsp; For this example we are using a teamserver running on 54.88.220.10</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Dp2image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-want-to\">\r\n<li class=\"null\">Next it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.&nbsp; This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.&nbsp; The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.&nbsp; This guide will walk through both Random and manually domain options.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/LCiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assigning-domains-na\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning domains - Option 1 (Use randomly generated one/s).&nbsp; When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.&nbsp; This will be shown after going over the Manual domain name option. &nbsp;&nbsp; <br></li>\r\n<li class=\"null\">Assigning domains - Option 2 (Manually create domain names/s).&nbsp; This will take you to the menu below.&nbsp; Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.&nbsp; For this example, we\'ll set option 1 (205.225.141.68).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/nkAimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-show-the-m\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">This will show the menu below where it asks for the domain name.&nbsp; Enter the domain you want to use for that IP and press enter.&nbsp; For this example, we\'ll use goatfarmer.com.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/J49image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-you%27ve-entered-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu.&nbsp; You should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sbaimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point you have either selected randomly generated domain names or completed adding domain names manual.&nbsp; Next the script will ask you to set a tag for your DNS.&nbsp; This is used to identify the domains later when you want to remove them.&nbsp; For this example, we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xo4image.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-now-the-script-has-a\">\r\n<li class=\"null\">Now the script has all the information it needs to build your NGINX redirector.&nbsp; Review the settings and if you are happy with it press enter to start the docker container build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ROCimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-shows-the-buil\">\r\n<li class=\"null\">Below shows the build process, you should now have a NGINX redirector.&nbsp; You can get information about it from the /root/services/RD1 folder.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HDTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-to-check-that-your-c\">\r\n<li class=\"null\">To check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><a href=\"https://redbook.com/uploads/images/gallery/2023-04/4KAimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/4KAimage.png\" alt=\"image.png\"></a></p>',' NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so.  \r\nNOTE: The NGINX redirector can be use with most C2 servers and can redirect DNS traffic.\r\nNOTE: This guide is assuming you already have a Cobalt Strike or other team server running.  \r\nFor this example, we\'ll assume we have a teamserver running at 54.88.220.10.\r\n\r\nUse the following script to start a NGINX redirector on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select Option 1 \"Set up a NGINX redirector (http,https, DNS)\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you RD1, or if there is already a RD1, it will give a default of RD2, and so on.  You can keep the default or set your own.  This will be the name of the folder it creates in /root/services for its docker container build and also the name of the docker container itself.  For this example, we\'ll leave the default of RD1.\r\n\r\n\r\n\r\nNext it asks for the number of IPs.  For the example we\'ll use 5.\r\n\r\n\r\n\r\nNext it will ask for a Geo-location base for your setting your IP\'s.  The NRTS has a list of IP subnets stored in a Geo-location based folder structure at /root/backbonerouters.   For this example we\'ll use option 4 Canada.\r\n\r\n\r\n\r\nThen it narrows it down by city, for this example we\'ll use Toronto.\r\n\r\n\r\n\r\nNext, it will ask if you want to set IP manually or randomly.  This guide will walk through both options.\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 set random IPs.  When you select option 1, it will add random IPs during processing so the menu will move on to the next step.  This will be shown after going over the Manual IP option.\r\nSetting IPs  - Option 2 set IPs Manually.  Then next few screenshots shows the manual IP process. Below is the menu when you select option 2.  At this screen you can enter \"s\" to see a list of IP subnets to select an IP from.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available Subnets\", you can use this information to select your IPs.  This list can be long, use spacebar to page down, then enter \"q\" and press \"enter\" to exit out of the IP subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nUsing the list of available IP\'s you can use IP\'s out of any of these subnets, for this example I\'ll use 72.3.244.20 out of the 72.3.244.1/25 IP subnet, but you can use multiple subnets from the list.  Press \"q\" then \"enter\" to exit the IP subnet view to get  back at the manual IP menu.  For this example, we\'ll select 1 for the first blank space.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis brings up the IP entry menu, for this example we\'ll use 72.3.244.20.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve enter the IP and pressed enter, it goes back to the manual IP menu and you will see slot one is populated with the IP, continue this process until you\'ve filled all the blanks, then select \"d\" for done.\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have IPs generated randomly or have manually set IPs, which brings us to the next menu that asks what ports to redirect as shown below.   For this example, we\'ll select option 4 for DNS, HTTP and HTTPS.\r\n\r\n\r\n\r\nNext it will ask if you want to set a different port for the \"bind to\" this is related to a Cobalt Strike feature where you can have a listener set the \"bind to\" to a different port.  The payload you build will still use port 443 for example of a HTTPS payload, but the teamserver will listen on a different port like say 8443.  You need a redirector to do something like this, however since the teamserver and redirectors are running in containers, there isn\'t really a need to do this.  For this example we will leave it at the default.  The screenshoot shows that it will asks this for each port being redirected.\r\n\r\n\r\n\r\nNext it will ask for the IP to redirect to.  This should be your C2 server\'s IP.  For this example we are using a teamserver running on 54.88.220.10\r\n\r\n\r\n\r\nNext it will want to set up DNS and it will give you the option for randomly generated DNS or will let you manually create your domain names.  This is necessary whenever you select to redirect HTTPS, the script will need the domain names to generator the CA signed SSL certificates.  The script will automatically connect to the CA server to get these signed so they can be used by the NGINX redirector.  This guide will walk through both Random and manually domain options.\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning domains - Option 1 (Use randomly generated one/s).  When you select this, the script will randomly generate domain names during processing, so it just moves on to the next menu.  This will be shown after going over the Manual domain name option.    \r\nAssigning domains - Option 2 (Manually create domain names/s).  This will take you to the menu below.  Note there is a list of IP\'s, you select a menu number next to an IP to set the domain for that IP.  For this example, we\'ll set option 1 (205.225.141.68).\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nThis will show the menu below where it asks for the domain name.  Enter the domain you want to use for that IP and press enter.  For this example, we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered the domain and pressed enter it takes you back to the manual domain name menu.  You should see the domain populated next to the IP, repeat this process for all IPs and press \"d\" when you are finished.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected randomly generated domain names or completed adding domain names manual.  Next the script will ask you to set a tag for your DNS.  This is used to identify the domains later when you want to remove them.  For this example, we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nNow the script has all the information it needs to build your NGINX redirector.  Review the settings and if you are happy with it press enter to start the docker container build process.\r\n\r\n\r\n\r\nBelow shows the build process, you should now have a NGINX redirector.  You can get information about it from the /root/services/RD1 folder.\r\n\r\n\r\n\r\nTo check that your container is running run docker ps, you should see a container running with the \"Docker service Tag\" from above.\r\n\r\n',8,'2023-04-04 00:13:37','2023-04-05 20:51:00',1,1,0,'',5,0,NULL,1,''),(17,6,0,'Building a Payload Host (buildredteam.sh)','building-a-payload-host-buildredteamsh','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The NRTS is designed to run red team infrastructure using docker containers.&nbsp; Building these out and managing the network for this is best left up to the script designed to do so.&nbsp;</p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to start a Payload Host on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-y\">\r\n<li class=\"null\">Next it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.&nbsp; You can keep the default name or add your own.&nbsp; This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.&nbsp; For this example, we\'ll leave it as the default of P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/jICimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for\">\r\n<li class=\"null\">Next it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.&nbsp; For this example we will use 5.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/E0aimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-then-it-will-ask-for\">\r\n<li class=\"null\">Then it will ask for a Geo-location for your IPs.&nbsp; The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.&nbsp; For this example, we\'ll set our Geo-location to option 7 - France.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/hzximage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-for-1\">\r\n<li class=\"null\">Next it will ask for a city, some options have a few and some only have one.&nbsp; For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/UQkimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-it-will-ask-if\">\r\n<li class=\"null\">Next, it will ask if you want to set IP\'s randomly or manually.&nbsp; This guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Pysimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-setting-ip%27s-option-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IP\'s - Option 1 Set random IPs.&nbsp; When you select option 1, it will add random IPs during processing so the script will move on to the next step.&nbsp; We\'ll cover that after going over the manual IP process.</li>\r\n<li class=\"null\">Setting IP\'s - Option 2 Set IPs manually.&nbsp; When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.&nbsp; Select a blank option to get to the IP input screen.&nbsp; First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of the \"show available subnets\".&nbsp; This can be a long list, use spacebar to page down then&nbsp; press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qstimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-now-that-we-know-wha\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Now that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .&nbsp; You can use any IP from the list of subnets and pull IPs from multiple subnets.&nbsp; Back at the manual IP menu, we\'ll select option 1 for the first blank spot.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/3Qyimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-%C2%A0then-at-the-ip-entr\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">&nbsp;Then at the IP entry menu below we\'ll&nbsp; put in 184.84.181.201.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GViimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-when-i-press-enter-f\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.&nbsp; You will see the blank at option 1 is populated with the IP you just entered.&nbsp; Repeat this for all blanks and then press \"d\" when you are done.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/EYoimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha\">\r\n<li class=\"null\">At this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.&nbsp; This brings you to the next menu.&nbsp; Here it asks you how you want to assign DNS.&nbsp; You can select random or manual, this guide will walk you through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/9nzimage.png\" alt=\"image.png\"> &nbsp;</li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-option-1-\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 1 use randomly generated one/s.&nbsp; When you select this, the script will generate random domains during processing and it will move on to the next step.&nbsp; This will be covered after walking through the manual DNS option.<br></li>\r\n<li class=\"null\">Assigning Domains -&nbsp; Option 2 Manually create domain name/s.&nbsp; This will take you to a new menu that shows a list of IPs.&nbsp; Here you select an IP and then it will ask you to enter the domain name to use for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HNlimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-for-this-example-we%27\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">For this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.&nbsp; Then we\'ll use goatfarmer.com for that IP.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/h9Rimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-once-we-enter-the-do\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Once we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.&nbsp; Repeat this process for all IP\'s press \"d\" when complete.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/6Mtimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-you-ha-1\">\r\n<li class=\"null\">At this point you have either selected to have domain names created Randomly or have completed the manual domain name process.&nbsp; Next the script will ask you for a DNS tag.&nbsp; This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.&nbsp; For this example we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/aUSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-the-sc\">\r\n<li class=\"null\">At this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/YcJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho-1\">\r\n<li class=\"null\">Below is a screenshot of the build process.&nbsp; After its complete information about the payload host service is located at /root/services/P1.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dDwimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-you-can-check-that-y\">\r\n<li class=\"null\">You can check that your payload host container is running by running docker ps.&nbsp; You should see a container named P1 or whatever you set as the Docker Service Tag.</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/dj1image.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-then-to-add-payloads\">\r\n<li class=\"null\">Then to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.&nbsp; Note: if you set a custom service tag go there, ex.&nbsp; /root/services/&lt;service tag&gt;/WWW.</li>\r\n</ul>','NOTE: The NRTS is designed to run red team infrastructure using docker containers.  Building these out and managing the network for this is best left up to the script designed to do so. \r\n\r\nUse the following script to start a Payload Host on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 4 \"Set up a payload host server\".\r\n\r\n\r\n\r\nNext it will ask for a service tag, by default it will give you P1, or if there is already a P1, it will give a default of P2, and so on.  You can keep the default name or add your own.  This will be the name of the folder it creates at /root/services for its docker container build and also the name of the container itself.  For this example, we\'ll leave it as the default of P1.\r\n\r\n\r\n\r\nNext it will ask for the number of IPs, you can set up several IPs and they will all host whatever you place on it.  For this example we will use 5.\r\n\r\n\r\n\r\nThen it will ask for a Geo-location for your IPs.  The NRTS has a list of IP subnets stored in a Geo-location folder structure at /root/backbonerouters.  For this example, we\'ll set our Geo-location to option 7 - France.\r\n\r\n\r\n\r\nNext it will ask for a city, some options have a few and some only have one.  For example France only has one, so we\'ll select 1 -Paris since there isn\'t another option.\r\n\r\n\r\n\r\nNext, it will ask if you want to set IP\'s randomly or manually.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IP\'s - Option 1 Set random IPs.  When you select option 1, it will add random IPs during processing so the script will move on to the next step.  We\'ll cover that after going over the manual IP process.\r\nSetting IP\'s - Option 2 Set IPs manually.  When you select this option you get a menu screen showing blank options, these blanks need to be filled in with manually entered IPs.  Select a blank option to get to the IP input screen.  First we need to see what IPs are available, so we\'ll select option \"s\" to show available subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of the \"show available subnets\".  This can be a long list, use spacebar to page down then  press \"q\" followed by \"enter\" to exit out of the subnet view and get back to the previous menu.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nNow that we know what IP subnets we can use, we\'ll use 184.84.181.201 from the 184.84.180.1/22 .  You can use any IP from the list of subnets and pull IPs from multiple subnets.  Back at the manual IP menu, we\'ll select option 1 for the first blank spot.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n Then at the IP entry menu below we\'ll  put in 184.84.181.201.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce you\'ve entered an IP and pressed enter, it will take you back to the manual IP menu.  You will see the blank at option 1 is populated with the IP you just entered.  Repeat this for all blanks and then press \"d\" when you are done.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to set IP\'s Randomly or have completed entering IPs manually.  This brings you to the next menu.  Here it asks you how you want to assign DNS.  You can select random or manual, this guide will walk you through both paths.\r\n  \r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domains -  Option 1 use randomly generated one/s.  When you select this, the script will generate random domains during processing and it will move on to the next step.  This will be covered after walking through the manual DNS option.\r\nAssigning Domains -  Option 2 Manually create domain name/s.  This will take you to a new menu that shows a list of IPs.  Here you select an IP and then it will ask you to enter the domain name to use for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nFor this example we\'ll select option 1 - 199.101.132.203, this will bring use to the domain name entry menu below.  Then we\'ll use goatfarmer.com for that IP.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nOnce we enter the domain name, it will take you back to the manual DNS menu, only now you should see the domain name populated next to the IP.  Repeat this process for all IP\'s press \"d\" when complete.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point you have either selected to have domain names created Randomly or have completed the manual domain name process.  Next the script will ask you for a DNS tag.  This tag is used to identify the DNS that it will register for later like say after an engagement and you want to remove those DNS records.  For this example we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nAt this point the script has everything it needs to build the payload host, check the settings you selected and if you are happy with it press enter to start the build process.\r\n\r\n\r\n\r\nBelow is a screenshot of the build process.  After its complete information about the payload host service is located at /root/services/P1.\r\n\r\n\r\n\r\nYou can check that your payload host container is running by running docker ps.  You should see a container named P1 or whatever you set as the Docker Service Tag.\r\n\r\n\r\n\r\nThen to add payloads on the payload host, transfer the payloads to the NRTS and place them in the /root/services/P1/WWW directory.  Note: if you set a custom service tag go there, ex.  /root/services/<service tag>/WWW.\r\n',9,'2023-04-04 01:12:36','2023-04-12 22:30:32',1,1,0,'',7,0,NULL,1,''),(18,6,0,'Phishing Attack (buildredteam.sh)','phishing-attack-buildredteamsh','<p id=\"bkmrk-note%3A-the-nrts-is-de\">NOTE: The Phishing attack option doesn\'t build a docker container.&nbsp; Instead it sets up the NRTS host to perform the phishing attack.&nbsp; This step is just preparing the NRTS to mimic a domain for sending the phish.<br></p>\r\n<ul id=\"bkmrk-use-the-following-sc\">\r\n<li class=\"null\">Use the following script to set up phishing attack on an NRTS server;\r\n<ul>\r\n<li class=\"null\">/root/scripts/buildredteam.sh</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">This will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/qoiimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-this-will-then-ask-t\">\r\n<li class=\"null\">This will then ask to select a geo-location based IP, first select a country.&nbsp; For this example we\'ll use China.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2LTimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next-it-will-ask-you\">\r\n<li class=\"null\">Next it will ask you to select a city, for this example we\'ll use Beijing.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/pOSimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-next%2C-the-script-wil\">\r\n<li class=\"null\">Next, the script will ask if you want a randomly generated IP or if you want to manually set it.&nbsp; This guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/zhIimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-set-ips---option-1-%28\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Setting IPs - Option 1 Set random IPs.&nbsp; When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.&nbsp; This will be shown after going over the set IPs manually process.</li>\r\n<li class=\"null\">Setting&nbsp; IPs - Option 2 Set IPs manually.&nbsp; When you select this option it will ask you to provide an IP.&nbsp; Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.&nbsp; Enter \"s\" at the menu below to see a list of IP subnets.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/PKKimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-below-is-a-screensho\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Below is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the Geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.&nbsp; For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ntHimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-type-%22q%22-and-hit-ent\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Type \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.&nbsp; NOTE: do not use the actual listed IP from the list.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HqFimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav\">\r\n<li class=\"null\">At this point we have set our selected to get a randomly generated IP or set it manually.&nbsp; The next menu screen asks how we want to assign our Domain name.&nbsp; Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Zjsimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-assign-dns-%28option-1\">\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">Assigning Domain names -&nbsp; Option 1 Use randomly generated one/s.&nbsp; This option will assign random domain names during processing and will move on to the next step.&nbsp; We\'ll cover that after going over the manual domain name option.<br></li>\r\n<li class=\"null\">Assigning Domain names - Option 2 Manually create domain name/s.&nbsp;&nbsp; Selecting this option will bring up&nbsp; the following menu.&nbsp; It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/ABNimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<ul id=\"bkmrk-at-this-point-we-hav-1\">\r\n<li class=\"null\">At this point we have either selected to have a domain name generated randomly or we manually set a domain name.&nbsp; The script will then want a Tag for your DNS.&nbsp; This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.&nbsp; For this example, we\'ll use \"test-DNS\".</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/0yJimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<ul id=\"bkmrk-finally-the-script-h\">\r\n<li class=\"null\">Finally the script has all the information it needs to set up for a phishing attack.&nbsp; Press enter at the screen below.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/7saimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Below is a screenshot of the phish preparation build.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bxbimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n<p id=\"bkmrk-the-script-edits-the\">The script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.&nbsp; After this you use the scripts at /root/scripts/phish to send your phishing attack.&nbsp; In the /root/scripts/phish directory there are two scripts for sending phishing attacks.&nbsp; They are phish.sh and spam.sh.&nbsp; Below is some information on what to modify in these scripts for your attack.<br></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F\">\r\n<li class=\"null\">/root/scripts/phish/phish.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a single email address.</li>\r\n<li class=\"null\">The script needs to be modified for your attack.&nbsp;</li>\r\n<li class=\"null\">vi phish.sh</li>\r\n<li class=\"null\">The top lines set the \"From\" address. &nbsp; Edit the from and realname to match the domain you set up prior and whatever username you want.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/eUlimage.png\" alt=\"image.png\"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;\r\n<p>&nbsp;</p>\r\n</li>\r\n<li class=\"null\">Then the last line in the script is the phish.&nbsp; Place your subject in, then edit the /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.&nbsp; If you don\'t have an attachment, delete out the \"-a /path\" from the line.&nbsp; Then at the end replace target@domain.com with the email address you want to send the phish to.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/xITimage.png\" alt=\"image.png\"></p>\r\n<ul id=\"bkmrk-%2Froot%2Fscripts%2Fphish%2F-1\">\r\n<li class=\"null\">/root/scripts/phish/spam.sh\r\n<ul>\r\n<li class=\"null\">This is used to send a phish to a list of email addresses.&nbsp; This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.&nbsp; The only difference here is that you don\'t add the target email address in the script.&nbsp; Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','NOTE: The Phishing attack option doesn\'t build a docker container.  Instead it sets up the NRTS host to perform the phishing attack.  This step is just preparing the NRTS to mimic a domain for sending the phish.\r\n\r\nUse the following script to set up phishing attack on an NRTS server;\r\n\r\n/root/scripts/buildredteam.sh\r\n\r\n\r\nThis will bring up the text-based menu seen below, select option 5 \"Set up a phishing attack\".\r\n\r\n\r\n\r\nThis will then ask to select a geo-location based IP, first select a country.  For this example we\'ll use China.\r\n\r\n\r\n\r\nNext it will ask you to select a city, for this example we\'ll use Beijing.\r\n\r\n\r\n\r\nNext, the script will ask if you want a randomly generated IP or if you want to manually set it.  This guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nSetting IPs - Option 1 Set random IPs.  When you select this option the script will take note of it and assign a randomly generated IP during processing and will simply take you to the next menu.  This will be shown after going over the set IPs manually process.\r\nSetting  IPs - Option 2 Set IPs manually.  When you select this option it will ask you to provide an IP.  Before you can provide one, you will need to know what what IP subnets are available for the Geo-location you previously selected.  Enter \"s\" at the menu below to see a list of IP subnets.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nBelow is a screenshot of available IP subnets. The IP subnet view list can vary in size depending on the Geo-location you selected, you can hit the spacebar to page down and then type \"q\" and hit enter to exit out of thte IP subnet view and get back to the IP input menu.  For this example we\'ll use the 95.213.0.1/22 subnet and set our IP to 95.213.1.30.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nType \"q\" and hit enter to exit the IP subnet list, then enter an IP that falls within the subnet you selected.  NOTE: do not use the actual listed IP from the list.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have set our selected to get a randomly generated IP or set it manually.  The next menu screen asks how we want to assign our Domain name.  Again we have the option to have this done randomly or to set it manually, this guide will walk through both paths.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAssigning Domain names -  Option 1 Use randomly generated one/s.  This option will assign random domain names during processing and will move on to the next step.  We\'ll cover that after going over the manual domain name option.\r\nAssigning Domain names - Option 2 Manually create domain name/s.   Selecting this option will bring up  the following menu.  It will ask for the domain you want to use, for this example we\'ll use goatfarmer.com.\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nAt this point we have either selected to have a domain name generated randomly or we manually set a domain name.  The script will then want a Tag for your DNS.  This tag is used to identify your DNS later, like say after an engagement and you want to remove the the DNS records used.  For this example, we\'ll use \"test-DNS\".\r\n\r\n\r\n\r\nFinally the script has all the information it needs to set up for a phishing attack.  Press enter at the screen below.\r\n\r\nBelow is a screenshot of the phish preparation build.\r\n\r\n\r\nThe script edits the postfix configuration to match the domain you\'ve selected, register that domain on the rootDNS server and assign that IP address to your NRTS server.  After this you use the scripts at /root/scripts/phish to send your phishing attack.  In the /root/scripts/phish directory there are two scripts for sending phishing attacks.  They are phish.sh and spam.sh.  Below is some information on what to modify in these scripts for your attack.\r\n\r\n/root/scripts/phish/phish.sh\r\n\r\nThis is used to send a phish to a single email address.\r\nThe script needs to be modified for your attack. \r\nvi phish.sh\r\nThe top lines set the \"From\" address.   Edit the from and realname to match the domain you set up prior and whatever username you want.\r\n                      \r\n \r\n\r\nThen the last line in the script is the phish.  Place your subject in, then edit the /root/scripts/phish/body.txt for the body of the email, then if you have an attachment replace the /root/scripts/phish/bad.exe with your attachment.  If you don\'t have an attachment, delete out the \"-a /path\" from the line.  Then at the end replace target@domain.com with the email address you want to send the phish to.\r\n\r\n\r\n\r\n\r\n\r\n/root/scripts/phish/spam.sh\r\n\r\nThis is used to send a phish to a list of email addresses.  This needs to be edited for your attack, change the script similar to the above instructions for phish.sh.  The only difference here is that you don\'t add the target email address in the script.  Instead you add a list of target email addresses to /root/scripts/phish/emaillist.txt.\r\n\r\n\r\n\r\n',10,'2023-04-04 01:52:57','2023-04-06 01:24:45',1,1,0,'',7,0,NULL,1,''),(19,6,0,'Managing Services (buildredteam.sh)','managing-services-buildredteamsh','<p id=\"bkmrk-then-nrts-builds-red\">Then NRTS builds red team infrastructure in docker containers.&nbsp; These containers and services can be managed using the /root/scripts/buildredteam.sh.&nbsp; NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks.&nbsp;</p>\r\n<ul id=\"bkmrk-to-view%2C-restart-or-\">\r\n<li class=\"null\">To View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/b0Yimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Then select option 6 - Container management.&nbsp; From this menu you can view, delete, start or stop a saved container.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Kb5image.png\" alt=\"image.png\">\r\n<p><br></p>\r\n</li>\r\n<li class=\"null\">The <strong>View Container Menu </strong>will show you the status of the various service containers.&nbsp; Below is and example.&nbsp; NOTE: This view will show if the container is currently running or stopped.&nbsp; You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.&nbsp; This is because the phish set up doesn\'t create a docker container.&nbsp; Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.&nbsp; For more on phishing attacks goto -&gt; Using the NRTS -&gt; Setting up Phishing attacks.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/llJimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">From the View Menu, you can select a service to see more information about it.&nbsp; It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n<ul id=\"bkmrk-%C2%A0payload-host-servic\">\r\n<li class=\"null\">&nbsp;payload host service (P1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/tHEimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">phish set up (phish).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/wRNimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">redirector (RD1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/s1Nimage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Cobalt strike teamserver (TS1).</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oIPimage.png\" alt=\"image.png\"></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The <strong>Delete Container Menu</strong> option shows the following.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/roTimage.png\" alt=\"image.png\">\r\n<ul id=\"bkmrk-from-the-delete-menu\">\r\n<li class=\"null\">From the delete menu you can select a service to delete whether it is running or not.&nbsp; This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/&lt;servicetag&gt; directory.&nbsp; <br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">The&nbsp;<strong>Start Container menu</strong> option allows you to start a stopped container.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HB3image.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">The&nbsp;<strong>Stop Container menu&nbsp;</strong>option allows you to stop a running container.&nbsp; This will just kill and remove the container, it can be restarted later with no lose in functionality.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/gLFimage.png\" alt=\"image.png\">\r\n<p>&nbsp;</p>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-%C2%A0\"></p>','Then NRTS builds red team infrastructure in docker containers.  These containers and services can be managed using the /root/scripts/buildredteam.sh.  NOTE: phishing is currently the only service not build in a container, but the script will set up the NRTS host to be able to mimic a domain of your choosing for phishing attacks. \r\n\r\nTo View, restart or delete a NRTS red team infrastructure service run /root/scripts/buildredteam.sh to get the the menu below.\r\n\r\nThen select option 6 - Container management.  From this menu you can view, delete, start or stop a saved container.\r\n\r\n\r\n\r\nThe View Container Menu will show you the status of the various service containers.  Below is and example.  NOTE: This view will show if the container is currently running or stopped.  You\'ll also notice the \"phish\" service doesn\'t show a running or stopped status.  This is because the phish set up doesn\'t create a docker container.  Instead it prep\'s the NRTS host to sending phishing attacks and then phishing attacks are done from other scripts at /root/scripts/phish.  For more on phishing attacks goto -> Using the NRTS -> Setting up Phishing attacks.\r\n\r\nFrom the View Menu, you can select a service to see more information about it.  It will show all the relevant information, below is examples of looking at the information page for each service type.\r\n\r\n payload host service (P1).\r\n\r\nphish set up (phish).\r\n\r\nredirector (RD1).\r\n\r\nCobalt strike teamserver (TS1).\r\n\r\n\r\n\r\nThe Delete Container Menu option shows the following.\r\n\r\n\r\nFrom the delete menu you can select a service to delete whether it is running or not.  This will stop the container, remove it, remove any IP\'s set on the host for the container and delete out the /root/services/<servicetag> directory.  \r\n\r\n\r\nThe Start Container menu option allows you to start a stopped container.\r\n\r\nThe Stop Container menu option allows you to stop a running container.  This will just kill and remove the container, it can be restarted later with no lose in functionality.\r\n\r\n \r\n\r\n\r\n',11,'2023-04-04 17:37:31','2023-04-06 01:28:32',1,1,0,'',4,0,NULL,1,''),(20,6,0,'Managing DNS (ManageDNS.sh)','managing-dns-managednssh','<p id=\"bkmrk-the-cyber-range-is-d\">The Cyber range is designed for Red Team domain name registration via the NRTS server.&nbsp; The various service scripts interact with the RootDNS server to create and register domains.&nbsp; To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.&nbsp; To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.&nbsp; Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.&nbsp; The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh</p>\r\n<p id=\"bkmrk-note%3A-if-you-want-to\">NOTE: if you want to register DNS outside of the automation built into the buildredteam.sh, there is another script on the NRTS called RegisterDNS.sh.&nbsp; For usage of this go to -&gt; How to guides -&gt; Manual Domain Registration.</p>\r\n<ul id=\"bkmrk-launch-the-script-fr\">\r\n<li class=\"null\">Launch the script from the NRTS server</li>\r\n</ul>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fm\"><code class=\"language-bash\">cd /root/scripts\r\n./ManageDNS.sh</code></pre>\r\n<ul id=\"bkmrk-this-will-bring-up-t\">\r\n<li class=\"null\">This will bring up the text based menu below.<img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/X9Ximage.png\" alt=\"image.png\"></li>\r\n<li class=\"null\">Option 1 - View DNS records, will bring up a list of Tags, as shown below\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/HfLimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">From the View menu you can pick an option to see the domains that have been registered for the selected tag.&nbsp; For example, below is option 2 for \"OPFOR-chip-test\".\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/NWzimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Option 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/buTimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">When you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.&nbsp; If a user selects delete all it adds a 30 second delay for the same reason.&nbsp; Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n<p><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/TFUimage.png\" alt=\"image.png\"></p>\r\n</li>\r\n<li class=\"null\">Here is what it shows when you enter y to continue.\r\n<p><a href=\"https://redbook.com/uploads/images/gallery/2023-04/8awimage.png\" target=\"_blank\" rel=\"noopener\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8awimage.png\" alt=\"image.png\"></a></p>\r\n</li>\r\n</ul>','The Cyber range is designed for Red Team domain name registration via the NRTS server.  The various service scripts interact with the RootDNS server to create and register domains.  To help with DNS management, there is a script on the NRTS that can view and delete DNS records from the rootDNS server.  To enable these, every time the NRTS remotely adds DNS records on the RootDNS it will tag the records in both the zone reference config file as well as in each domain zone file.  Then the user can view DNS records created under that tag and also elect to delete DNS records for a specific tag.  The script for doing this resides on any NRTS server at /root/scripts/manageDNS.sh\r\nNOTE: if you want to register DNS outside of the automation built into the buildredteam.sh, there is another script on the NRTS called RegisterDNS.sh.  For usage of this go to -> How to guides -> Manual Domain Registration.\r\n\r\nLaunch the script from the NRTS server\r\n\r\ncd /root/scripts\r\n./ManageDNS.sh\r\n\r\nThis will bring up the text based menu below.\r\nOption 1 - View DNS records, will bring up a list of Tags, as shown below\r\n\r\n\r\nFrom the View menu you can pick an option to see the domains that have been registered for the selected tag.  For example, below is option 2 for \"OPFOR-chip-test\".\r\n\r\n\r\nOption 2 - Delete DNS records, will bring up a list of tags as shown below.\r\n\r\n\r\nWhen you select to delete DNS for a tag, it will give you a warning and a 10 second delay to allow the user to \"CTRL-C\" out of it.  If a user selects delete all it adds a 30 second delay for the same reason.  Here is a screenshot showing the deletion of the tag \"OPFOR-Chip-test\"\r\n\r\n\r\nHere is what it shows when you enter y to continue.\r\n\r\n\r\n',12,'2023-04-05 00:04:31','2023-04-05 00:38:36',1,1,0,'',4,0,NULL,1,''),(21,6,0,'Reverting the NRTS','reverting-the-nrts','<p id=\"bkmrk-if-you-want-to-wipe-\">If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.&nbsp; It\'s located on the NRTS at /root/scripts/revert.sh</p>\r\n<p id=\"bkmrk-below-is-usage\">below is usage</p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fscripts-.%2Fr\"><code class=\"language-bash\">cd /root/scripts\r\n./revert.sh</code></pre>\r\n<ul id=\"bkmrk-when-you-run-this%2C-i\">\r\n<li class=\"null\">When you run this, it will make sure you want to by making you confirm.</li>\r\n<li class=\"null\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Awbimage.png\" alt=\"image.png\"></li>\r\n</ul>','If you want to wipe out all containers/services/configurations on an NRTS, there is a revert.sh script to do this.  It\'s located on the NRTS at /root/scripts/revert.sh\r\nbelow is usage\r\ncd /root/scripts\r\n./revert.sh\r\n\r\nWhen you run this, it will make sure you want to by making you confirm.\r\n\r\n',13,'2023-04-05 00:39:07','2023-04-06 01:29:08',1,1,0,'',2,0,NULL,1,''),(22,7,0,'Cred list','cred-list','<table id=\"bkmrk-system-username-pass\" style=\"border-collapse: collapse; width: 61.2346%;\" border=\"1\"><colgroup><col style=\"width: 47.0516%;\"><col style=\"width: 29.5141%;\"><col style=\"width: 23.4343%;\"></colgroup>\r\n<tbody>\r\n<tr>\r\n<td><strong>System</strong><br></td>\r\n<td><strong>Username</strong><br></td>\r\n<td><strong>Password</strong><br></td>\r\n</tr>\r\n<tr>\r\n<td>IA-Proxy<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>CA-Server<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td class=\"align-left\">rootDNS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>web-services<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-Gen<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Traffic-WebHost<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>NRTS<br></td>\r\n<td>user &amp; root<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>Adminnet-DHCP<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>SI-router<br></td>\r\n<td>vyos<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n<tr>\r\n<td>redbook.com web GUI (bookstack)<br></td>\r\n<td>admin@admin.com<br></td>\r\n<td>toortoor</td>\r\n</tr>\r\n<tr>\r\n<td>dropbox.com web GUI (owncloud)<br></td>\r\n<td>admin<br></td>\r\n<td>toor<br></td>\r\n</tr>\r\n</tbody>\r\n</table>','\r\n\r\n\r\nSystem\r\nUsername\r\nPassword\r\n\r\n\r\nIA-Proxy\r\nuser & root\r\ntoor\r\n\r\n\r\nCA-Server\r\nuser & root\r\ntoor\r\n\r\n\r\nrootDNS\r\nuser & root\r\ntoor\r\n\r\n\r\nweb-services\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-Gen\r\nuser & root\r\ntoor\r\n\r\n\r\nTraffic-WebHost\r\nuser & root\r\ntoor\r\n\r\n\r\nNRTS\r\nuser & root\r\ntoor\r\n\r\n\r\nAdminnet-DHCP\r\nvyos\r\ntoor\r\n\r\n\r\nSI-router\r\nvyos\r\ntoor\r\n\r\n\r\nredbook.com web GUI (bookstack)\r\nadmin@admin.com\r\ntoortoor\r\n\r\n\r\ndropbox.com web GUI (owncloud)\r\nadmin\r\ntoor\r\n\r\n\r\n',2,'2023-04-05 00:47:29','2023-04-05 00:59:29',1,1,0,'',4,0,NULL,1,''),(23,6,0,'New Page','new-page','','',14,'2023-04-05 19:30:34','2023-04-05 19:31:11',1,1,0,'',1,0,'2023-04-05 19:31:11',1,''),(24,6,0,'New Page','new-page','','',14,'2023-04-05 19:31:15','2023-04-05 19:31:26',1,1,0,'',1,0,'2023-04-05 19:31:26',1,''),(25,8,0,'General Guidance','general-guidance','<h4 id=\"bkmrk-active-directory-ser\">Active Directory Server</h4>\r\n<ul id=\"bkmrk-user-accounts--creat\">\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>User accounts</strong></span>- Create several users and give the users context.&nbsp; Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.&nbsp; This documentation includes the PowerShell script <a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a>.&nbsp; This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.&nbsp; It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.&nbsp; Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.&nbsp; It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.&nbsp; If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.&nbsp; Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.&nbsp; However before this will work you will have to modify the AD password policies to allow for simple passwords.&nbsp; It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.&nbsp; The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the user to that group.&nbsp; Having unique AD group assignments&nbsp; is useful to assign folder permissions on a file server to make the blue space more realistic.&nbsp; Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.&nbsp; Then it also creates a separate Admin account that they would use for system administration.&nbsp; The second account has a different login and password.&nbsp; Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm&nbsp; and a password of SmithAdmin.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>DNS</strong></span> - Its very common to use the Active directory server to manage blue space DNS.&nbsp; Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.&nbsp; Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Email support </strong></span>- There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.&nbsp; However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\"><strong>Group Policies </strong></span>- This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that&nbsp; connected to a fake internet (Cyber Range) environment.\r\n<ul>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Disable Cortana</span> - Applied to Computer Configurations to Disable Cortana</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Prevent Sleep </span>- Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">Enable PSRemoting</span> - Applied to Computer Configurations - enabling WinRM Client and Service</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">MapNetworkDrives </span>- Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups.&nbsp;</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">NTP from DC</span> - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.</li>\r\n<li class=\"null\"><span style=\"text-decoration: underline;\">InstallCA Certs </span>- since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.&nbsp; This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.&nbsp; This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Group Policy is a great way to manage your blue space environment.&nbsp; Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.</li>\r\n</ul>\r\n<h4 id=\"bkmrk-file-server\">File Server</h4>\r\n<p id=\"bkmrk-just-install-a-windo\">Just install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.&nbsp; Set the folder permissions based on the AD groups you created on the AD.&nbsp; This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.&nbsp; Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.</p>\r\n<h4 id=\"bkmrk-exchange\">Exchange</h4>\r\n<p id=\"bkmrk-this-is-probably-the\">This is probably the toughest thing to set up.&nbsp; You need to build your Active Directory server first, then create your user accounts.&nbsp; Next, power it off and create a snapshot of it.&nbsp; This way you can revert and start over if something goes wrong when you are building an exchange server.&nbsp; There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.&nbsp; Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.&nbsp; So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.&nbsp; When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.&nbsp; One that’s 80GB and one that’s 100GB.&nbsp; Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB hard drive.&nbsp; Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the <a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a> and <a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></p>\r\n<h4 id=\"bkmrk-workstations\">Workstations</h4>\r\n<p id=\"bkmrk-make-sure-you-instal\">Make sure you install additional software.&nbsp; It’s not very realistic if they are just base installs of windows 10.&nbsp; Add additional browsers like firefox, chrome.&nbsp; Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.&nbsp; Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software.&nbsp;</p>\r\n<p id=\"bkmrk-then-make-sure-the-w\">Then make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one-off software on a few.&nbsp; If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.&nbsp; Then join each clone to the domain.</p>\r\n<h4 id=\"bkmrk-firewalls\">Firewalls</h4>\r\n<p id=\"bkmrk-pfsense-is-a-decent-\">PFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.&nbsp; Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.</p>\r\n<h4 id=\"bkmrk-routers\">Routers</h4>\r\n<p id=\"bkmrk-vyos-is-a-decent-fre\">Vyos is a decent freeware solution for your routing requirements.&nbsp; You can use routers to manage routing between various blue space internal subnets.</p>\r\n<h4 id=\"bkmrk-snapshots\">SNAPSHOTS</h4>\r\n<p id=\"bkmrk-its-good-practice-to\">Its good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.&nbsp; Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.&nbsp; This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.&nbsp; NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.&nbsp; As a rule, typically have no more than 3 snapshots going at one time.&nbsp; Reverting to snapshots you can do as fast as you like.</p>\r\n<h4 id=\"bkmrk-powering-on-and-off\">Powering On and Off</h4>\r\n<p id=\"bkmrk-this-is-in-regards-t\">This is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.&nbsp; Then for powering off, reverse this the order.&nbsp; If you have an ESXI license it will come with PowerCLI support.&nbsp; It’s fairly easy to create a PowerCLI script to manage powering on and off the range.&nbsp; The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple. &nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></p>\r\n<h4 id=\"bkmrk-internal-traffic-gen\">Internal Traffic Generation</h4>\r\n<p id=\"bkmrk-carnegie-mellon%2C-pro\">Carnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.&nbsp; In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.&nbsp; This driver bypasses the security features in Outlook that prevent scripted emails.&nbsp; You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.&nbsp; Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.&nbsp; It’s not to bad and they have a WIKI.&nbsp; For more information on Ghosts go to -&gt; Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/ghost-traffic-generation\">Ghost Traffic Generation</a>.&nbsp;<br></p>\r\n<h4 id=\"bkmrk-external-traffic-gen\">External Traffic Generation</h4>\r\n<p id=\"bkmrk-external-traffic-is-\">External traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -&gt;&nbsp;<a href=\"https://redbook.com/books/cyber-range-systems-overview/page/traffic-gen\">Traffic-Gen</a> for an overview on how this works and how to set it up for your blue space.</p>','Active Directory Server\r\n\r\nUser accounts- Create several users and give the users context.  Have the employees(Users) that work for the Target Domain have some sort of job or role in the company, things like HR, finance, IT, etc.  This documentation includes the PowerShell script CreateADUsers.ps1.  This is just an example using a fictional blue space organization called Galactic Federation with a domain of galfed.com.  It\'s a fairly basic PowerShell script that can be edited to match whatever you want to do for a blue space.  Currently it\'s set up to read a CSV of user information, where you provide the employees First name, middle Initial, Last Name, and occupation.  It will create an AD user for each line with a login that looks like FirstName.Lastname and sets each users password in the following format; LastnamePass. For example, if you added a Will Smith, their login is Will.Smith and their password would be SmithPass.  If you want to, you can add another column to the user csv file and insert randomly generated passwords and then modify the script to use this instead.  Keep in mind that it is useful to have some standardized password that is easy to remember so that while you are working with the blue space you can easily login as any user without referencing a complex password sheet.  However before this will work you will have to modify the AD password policies to allow for simple passwords.  It\'s also a good idea to avoided using the exact same password for every user account so that their password hashes aren’t all identical.  The CreateADAccounts.PS1 also sets up some custom organizational Units in Active directory for user accounts and a different one for admin accounts, it then uses the Occupation column from the user data CSV to create Active directory groups and assigns the user to that group.  Having unique AD group assignments  is useful to assign folder permissions on a file server to make the blue space more realistic.  Additionally, for any user that you want to be a domain admin, it will create two AD accounts for them, one is a regular account that they would use for day to day work like email, etc.  Then it also creates a separate Admin account that they would use for system administration.  The second account has a different login and password.  Going back to the will smith example, if Will was an admin, the script would build a secondary admin account with a login of Will.Smith.adm  and a password of SmithAdmin. \r\nDNS - Its very common to use the Active directory server to manage blue space DNS.  Typically all domain workstations DNS are configured to point to the IP of the Active Directory server.  Then you set the Active Directory DNS server to Forward to the recursive DNS server in the Cyber Range space, aka the rootDNS server. Alternatively you can build another DNS server in the blue space DMZ and have the AD point to that and set the forwarder on the DMZ DNS server to point to the rootDNS server. \r\nEmail support - There will be things that need to be done to prepare the Active Directory to support Microsoft Exchange. There are several online guides for configuring an exchange server, so follow one of these for whatever version of exchange you want to use.  However, it\'s a good idea to snapshot both the AD server and exchange before starting. If something goes wrong, it’s hard to reverse the modifications made to the AD during the Exchange installation process.\r\nGroup Policies - This guide won’t get into the details for setting up all of following group policies, this is just a list of ones that are advisable to set up for a Target Domain (blue space) that  connected to a fake internet (Cyber Range) environment.\r\n\r\nDisable Cortana - Applied to Computer Configurations to Disable Cortana\r\nPrevent Sleep - Applied to Computer Configurations to prevent the Windows VMs from hibernating basically “Turn Off the hard disk (plugged in) set to disabled, Allow standby states (S1-S3) when sleeping (plugged in) set to disabled, Specify the unattended sleep timeout (plugged in) set to disabled.\r\nEnable PSRemoting - Applied to Computer Configurations - enabling WinRM Client and Service\r\nMapNetworkDrives - Once you’ve set up a file server and set folder permissions based on occupations, you can set it to automatically Map the network drive based on user login groups. \r\nNTP from DC - Applied to computer configurations, basically setting it so all the clients get NTP from the DC.\r\nInstallCA Certs - since we aren’t connected to the real internet, the Cyber Range provides its own Certificate Authority, aka, the CA-Server.  This GPO is used to import the root and intermediary Certificates into the trust store on each workstation.  This allows the workstations to go to the various fake internet sites and have valid SSL certificates to avoid the untrusted warning popups.\r\n\r\n\r\nGroup Policy is a great way to manage your blue space environment.  Making sure the VM’s don’t go to sleep, ensuring they get NTP from the DC, and being able to PowerShell remote to everything are some of the bigger tips to help you build and manage a Target Domain.\r\n\r\nFile Server\r\nJust install a windows server and set up some sort of shared file/folder structure that makes sense based on your Target Domain.  Set the folder permissions based on the AD groups you created on the AD.  This will make your Red Team have to do work and some lateral movement in order to get to whatever files they are trying to reach.  Plus you can use this to set up different mapped network drives for users based on AD groups when they log in.\r\nExchange\r\nThis is probably the toughest thing to set up.  You need to build your Active Directory server first, then create your user accounts.  Next, power it off and create a snapshot of it.  This way you can revert and start over if something goes wrong when you are building an exchange server.  There are some AD modifications that are a part of building an exchange server that are hard to clean up/or reverse.  Side note: Its a good idea to take snapshots with the VM powered off, otherwise the snapshot will include a complete copy of running memory.  So if you snapshot a AD and you gave it 16 GB of RAM, it would increase the size of the snapshot by 16 GB.  When building an exchange, it should have 16 GB of RAM and helpful if you add two hard drives.  One that’s 80GB and one that’s 100GB.  Then install windows server on the 80GB drive and set up the exchange logs and database to use the 100GB hard drive.  Depending on what you use for email traffic generation, this server tends to fill up fast, when you run out of drive space it’s extremely difficult to recover the exchange server. Its a good idea to clear out logs and emails in between engagements/exercises. There are two scripts included in this documentation to help with that, but they will need to be modified to work with the blue space you build. These scripts are the CleanLogs.ps1 and DeleteAllEmails.ps1\r\nWorkstations\r\nMake sure you install additional software.  It’s not very realistic if they are just base installs of windows 10.  Add additional browsers like firefox, chrome.  Add Microsoft Office, Adobe Reader, and then whatever else that makes sense for the blue space environment. A good technique for providing your red team vectors for exploitation is to look at recently exploited software, for example, third party software that has privilege exploitation vulnerabilities.  Ideally you will want to find current exploits, meaning things that are less than a year old. Also you\'ll want to make sure that there is a metasploit module or better yet a Proof of Concept exploit available to take advantage of the exploitable software. \r\nThen make sure the windows firewall allows whatever services you want to use for management by the “blue space” admins. There are a few scripts provided in this documentation for blue space management/health checks that require powershell remoting. A good way to manage this would be using a GPO to set workstation firewall settings. Additionally, make a baseline VM with all installed software, then you can clone this as many times as you need, then, if you want, install some one-off software on a few.  If you make a master workstation with all the software installed for cloning, don’t join it to the domain, make your clones first.  Then join each clone to the domain.\r\nFirewalls\r\nPFSense is a decent freeware solution. Typically you build this with just three interfaces, one for a WAN connection, aka the connection to the SI-Router, a LAN connection - to connect to the workstations/servers, and a DMZ connection to set up any DMZ services you want your blue space to have.  Typically a public facing web server and OWA for your exchange. However, the blue space is whatever you want to do, so don\'t feel limited, do whatever makes sense for the blue space you build.\r\nRouters\r\nVyos is a decent freeware solution for your routing requirements.  You can use routers to manage routing between various blue space internal subnets.\r\nSNAPSHOTS\r\nIts good practice to always create powered off snapshots, powered on ones require the snapshot to include RAM and eats up a lot of space.  Once you have a solid working range and everything is working like you want it to, power down the entire range and create a baseline snapshot for the whole thing prior to running any attacks against the blue space.  This way you always have a range you can revert back to where there aren’t any artifacts from prior attacks.  NOTE: Don’t kick off two many snapshots at once, it will sometimes cause a failure.  As a rule, typically have no more than 3 snapshots going at one time.  Reverting to snapshots you can do as fast as you like.\r\nPowering On and Off\r\nThis is in regards to the sequence of powering on a entire Target Domain. The first thing you want to have running is all networking devices, aka firewall, routers. Then move on to the AD, then the Exchange and other servers, then lastly the workstations.  Then for powering off, reverse this the order.  If you have an ESXI license it will come with PowerCLI support.  It’s fairly easy to create a PowerCLI script to manage powering on and off the range.  The ESXI GUI also has some power on and off sequencing, but PowerCLI can be used to easily script this out as well as scripting out Reverting to snapshots. This documentation includes a example PowerCLI script that builds out a GUI for powering on/off VMs as well as reverting to the latest snapshot. You’ll have to modify some variables in the script based on your environment but the script is fairly well documented and this should be fairly simple.  Range-Management.ps1\r\nInternal Traffic Generation\r\nCarnegie Mellon, provides a open source solution called Ghosts. The github is here https://github.com/cmu-sei/GHOSTS. This can be installed on a variety of operating systems and you can set up the configuration file to browse websites, create word documents/powerpoints/excels and save those to a file share, send emails and run pretty much whatever you can from a command-line.  In order for it to be able to send emails you will need to purchase a special driver for outlook called redemption.dll.  This driver bypasses the security features in Outlook that prevent scripted emails.  You can get the redemption.dll from https://www.dimastr.com/redemption/download.htm.  Building and managing ghost would take to long to try and capture in a “how to”, the best bet is to build a blue space an figure it out.  It’s not to bad and they have a WIKI.  For more information on Ghosts go to -> Target Domain Planning Guide -> Ghost Traffic Generation. \r\nExternal Traffic Generation\r\nExternal traffic is the traffic that hits your Target Domain from the fake internet, aka Cyber Range. The Cyber Range comes with a VM designed for this purpose called \"Traffic-Gen\". Go to Cyber Range Systems Overview -> Traffic-Gen for an overview on how this works and how to set it up for your blue space.',2,'2023-04-10 16:59:58','2023-04-13 20:27:12',1,1,0,'',13,0,NULL,1,''),(26,8,0,'Ghost Traffic Generation','ghost-traffic-generation','<p id=\"bkmrk-ghost-is-a-traffic-g\">Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at <a href=\"https://github.com/cmu-sei/GHOSTS\">https://github.com/cmu-sei/GHOSTS</a> The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.</p>\r\n<h4 id=\"bkmrk-ghost-set-up\">Ghost set up</h4>\r\n<p id=\"bkmrk-you-need-to-put-the-\">You need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.&nbsp; You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.&nbsp; The included powershell script GhostManagement.ps1 can help with Ghost management and deployment.<br></p>\r\n<h4 id=\"bkmrk-configuring-ghost\">Configuring Ghost<br></h4>\r\n<ul id=\"bkmrk-config-files-%28ghosts\">\r\n<li class=\"null\">Config files (Ghosts/config)\r\n<ul>\r\n<li class=\"null\">Application.json - Used for general application variables and settings.&nbsp;<br>\r\n<ul>\r\n<li class=\"null\">Change the following variables to false\r\n<ul>\r\n<li class=\"null\">IdEnabled - at the top</li>\r\n<li class=\"null\">IsEnabled - under ClientResults</li>\r\n<li class=\"null\">IsEnabled&nbsp; - under ClientUpdates</li>\r\n<li class=\"null\">IsEnabled - under Survey Health</li>\r\n<li class=\"null\">IsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Make sure the following variable is true\r\n<ul>\r\n<li class=\"null\">HandlersIsEnabled</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Remove the URLs every where you see it, the default looks like <a href=\"http://ghosts-c2/api/\">http://ghosts-c2/api/</a>.\r\n<ul>\r\n<li class=\"null\">Set these which are typically under “PostURL”&nbsp; to “”</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Then under “OfficeDocsMaxAgeInHours”, set this to -1</li>\r\n<li class=\"null\">Then in “Email”, the options are self explanatory, set these however you want it to run</li>\r\n<li class=\"null\">There is a “EmailDomainSearchString”, set this to match your target domain, you can test your command on your Target Domain DC with powershell make sure it works.&nbsp; Here’s and example for a domain of galfed.com.\r\n<ul>\r\n<li class=\"null\">Get-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Dictionary.json - Not sure what this is used for, Ghost isn\'t very well documented.&nbsp;</li>\r\n<li class=\"null\">Email-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.</li>\r\n<li class=\"null\">Email-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own</li>\r\n<li class=\"null\">Emails-domain.json - This is a list of all you’re target domain users emails, you have to make this.&nbsp;</li>\r\n<li class=\"null\">Emails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net.&nbsp; You can use anything name you want with these domains like <a href=\"mailto:john.smith@gmail.com\">john.smith@gmail.com</a>. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverables. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.</li>\r\n<li class=\"null\">Filenames.json - List that ghost will use for creating Office application filenames.&nbsp; You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.</li>\r\n<li class=\"null\">Health.json - It will check a URL and for reporting health status, if you don’t use their management site ghost provides, you can disable health in the application.json.</li>\r\n<li class=\"null\">Timeline.json - This is where you set up ghosts to preform activities as a user.&nbsp; Look at the sample config file \"timeline.json\".&nbsp; If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.&nbsp; It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.&nbsp; Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.&nbsp; When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Logs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. It provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n<ul>\r\n<li class=\"null\">App.log</li>\r\n<li class=\"null\">Clientupdates.log</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<h4 id=\"bkmrk-starting-and-stoppin\">STARTING AND STOPPING GHOSTS</h4>\r\n<p id=\"bkmrk-to-start-ghost%2C-just\">To start ghost, just click on the ghosts.exe in the root of the ghost folder</p>\r\n<p id=\"bkmrk-to-stop-ghosts%2C-just\">To stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.</p>\r\n<h4 id=\"bkmrk-notes%3A%C2%A0\">NOTES:&nbsp;</h4>\r\n<p id=\"bkmrk-ghost-can-be-resourc\">Ghost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.</p>\r\n<p id=\"bkmrk-if-you-update-the-ti\">If you update the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.</p>','Ghost is a traffic generator created by Carnegie Mellon, they offer their source code on github, but also provide pre-combiled binaries. If you just want to download and go, links to releases is located on their github at https://github.com/cmu-sei/GHOSTS The Releases link is on the right hand side. Click that to get to the page where you can download a ghost distribution in a zip file.\r\nGhost set up\r\nYou need to put the entire ghost folder from the zip file on each client/workstation that you want to generate traffic on.  You can put it anywhere you want, placing at c:\\Ghosts isn\'t a bad choice.  The included powershell script GhostManagement.ps1 can help with Ghost management and deployment.\r\nConfiguring Ghost\r\n\r\nConfig files (Ghosts/config)\r\n\r\nApplication.json - Used for general application variables and settings. \r\n\r\nChange the following variables to false\r\n\r\nIdEnabled - at the top\r\nIsEnabled - under ClientResults\r\nIsEnabled  - under ClientUpdates\r\nIsEnabled - under Survey Health\r\nIsEnabled\r\n\r\n\r\nMake sure the following variable is true\r\n\r\nHandlersIsEnabled\r\n\r\n\r\nRemove the URLs every where you see it, the default looks like http://ghosts-c2/api/.\r\n\r\nSet these which are typically under “PostURL”  to “”\r\n\r\n\r\nThen under “OfficeDocsMaxAgeInHours”, set this to -1\r\nThen in “Email”, the options are self explanatory, set these however you want it to run\r\nThere is a “EmailDomainSearchString”, set this to match your target domain, you can test your command on your Target Domain DC with powershell make sure it works.  Here’s and example for a domain of galfed.com.\r\n\r\nGet-ADUser -Filter * -SearchBase ‘OU=Users,DC=galfed,DC=com’ -properties mail | Select -expand mail”\r\n\r\n\r\n\r\n\r\nDictionary.json - Not sure what this is used for, Ghost isn\'t very well documented. \r\nEmail-content.csv - This contains email content, you can just leave this alone, or if you\'re ambitious create your own.\r\nEmail-reply.csv - This is a list of email replays, you can just leave this alone, or if you’re ambitious create your own\r\nEmails-domain.json - This is a list of all you’re target domain users emails, you have to make this. \r\nEmails-outside.json - List of external email addresses. You can make up emails for the default domains that the Traffic-Gen sets up for email traffic, these domains are msn.com, gmail.com, facebook.com, linkdin.com, and salesforce.net.  You can use anything name you want with these domains like john.smith@gmail.com. However, you will need to have the Traffic-Gen running, otherwise any emails sent to these domains via ghost in your target domain will get returned as undeliverables. When the Traffic-Gen is running, it stands up a Postfix mailserver for the aforementioned domains and any emails to any user name will be accepted by the postfix mailserver, which then just sends the email to /dev/null.\r\nFilenames.json - List that ghost will use for creating Office application filenames.  You want this to be rather large, it doesn’t repeat, so when it hits the end, ghost stops working.\r\nHealth.json - It will check a URL and for reporting health status, if you don’t use their management site ghost provides, you can disable health in the application.json.\r\nTimeline.json - This is where you set up ghosts to preform activities as a user.  Look at the sample config file \"timeline.json\".  If you want to use the BrowserChrome handler, you will need to download the chrome driver for the version of Chrome installed on the system you will be running Ghost on and place this in the ghost folder. If you want to use the Outlook handler (needed for email), you need to get a copy of the redemption.dll, it’s a special driver that circumvents outlook’s internal security for automated emails.  It’s available here https://www.dimastr.com/redemption/download.htm and costs $300.00.  Make sure that the version of outlook you install on clients is supported by whatever version of redemption.dll you end up getting.  When you have it, place it in Ghosts/lib folder. NOTE: The latest binary release 7.0 included this redemption.dll.\r\n\r\n\r\nLogs (ghosts/logs) Provides information on ghosts application, use this to troubleshoot if something isn’t working. It provides entries for every action that ghosts makes, you can use this to validate things are working.\r\n\r\nApp.log\r\nClientupdates.log\r\n\r\n\r\n\r\nSTARTING AND STOPPING GHOSTS\r\nTo start ghost, just click on the ghosts.exe in the root of the ghost folder\r\nTo stop ghosts, just click on the kill-ghosts.bat in the root of the ghost folder.\r\nNOTES: \r\nGhost can be resource intensive, when you set handlers, you should make reasonable choices, for example a normal user isn\'t generating a new word document once a minute.\r\nIf you update the timeline.json file while ghost is running, ghost will automatically start using the new timeline.json file so you don\'t need to restart it.',3,'2023-04-10 19:22:35','2023-04-13 20:35:31',1,1,0,'',8,0,NULL,1,''),(27,8,0,'Blue Space Set up and Management Scripts','blue-space-set-up-and-management-scripts','<ul id=\"bkmrk-cleanlogs.ps1-is-des\">\r\n<li class=\"null\">CleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space on the exchange.&nbsp; This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/1\" target=\"_blank\" rel=\"noopener\">CleanLogs.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">DeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.&nbsp; This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.&nbsp; It\'s also helpful to reduce drive space and the size of the .edb mail database.&nbsp; This script is ussually ran in conjunction with CleanLogs.ps1.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/4\" target=\"_blank\" rel=\"noopener\">DeleteAllEmails.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.&nbsp; This will also create user defined AD groups and assign the new user to these groups.&nbsp; This is a template, feel free to modify to meet the needs you have for your environment.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/2\" target=\"_blank\" rel=\"noopener\">CreateADUsers.ps1</a><br></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">CreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n<ul>\r\n<li class=\"null\"><a href=\"https://redbook.com/attachments/3\" target=\"_blank\" rel=\"noopener\">CreateMailboxes.ps1</a></li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Range-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.&nbsp; This script needs to be ran from the management network meaning the network where the ESXI Host IP resides and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n<ul id=\"bkmrk-%C2%A0range-management.ps\">\r\n<li class=\"null\">&nbsp;<a href=\"https://redbook.com/attachments/5\" target=\"_blank\" rel=\"noopener\">Range-Management.ps1</a></li>\r\n</ul>\r\n</li>\r\n</ul>','\r\nCleanLogs.ps1 is designed to remove Exchange logs from your blue space Exchange Server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space on the exchange.  This script will need to be modify based on how your exchange was built/configured to ensure it\'s pointing to the correct log path.\r\n\r\nCleanLogs.ps1\r\n\r\n\r\nDeleteAllEmails.ps1 is designed to remove emails from your blue space exchange server.  This is done post-engagement/exercise to remove any prior artifacts or any time you need to do this.  It\'s also helpful to reduce drive space and the size of the .edb mail database.  This script is ussually ran in conjunction with CleanLogs.ps1.\r\n\r\nDeleteAllEmails.ps1\r\n\r\n\r\nCreateADUsers.ps1 is designed to take a user generated CSV for user accounts and then create the AD user account.  This will also create user defined AD groups and assign the new user to these groups.  This is a template, feel free to modify to meet the needs you have for your environment.\r\n\r\nCreateADUsers.ps1\r\n\r\n\r\nCreateMailboxes.ps1 is designed to enable/add mailboxes using your user account CSV file.\r\n\r\nCreateMailboxes.ps1\r\n\r\n\r\nRange-Management.ps1 is a PowerCLI script designed to manage turning on and off as well as reverting VMs.  This script needs to be ran from the management network meaning the network where the ESXI Host IP resides and you need to have a licensed copy of ESXI to be able to use the full feature set of PowerCLI.\r\n\r\n Range-Management.ps1\r\n\r\n\r\n',4,'2023-04-10 22:07:50','2023-04-13 20:37:54',1,1,0,'',6,0,NULL,1,''),(28,8,0,'Importing CA and Int Certs to your Target Domain','importing-ca-and-int-certs-to-your-target-domain','<p id=\"bkmrk-the-cyber-range-envi\">The Cyber Range environment will create a CA and intermediate Authority.&nbsp; This is used to simulate real world SSL signing services like Digicert or Verisign.&nbsp; By default, the Cyber Range installation will create one called globalcert.com.&nbsp; The globalcert.com CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.&nbsp; These certs need to be imported into the trust stores of your windows based target systems.&nbsp; Below are the instructions for doing so.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-obtain-the-\">Step 1.&nbsp; Obtain the certs from the CA-Server</p>\r\n<ul id=\"bkmrk-from-your-target-dom\">\r\n<li class=\"null\">From your target domain, scp these certs off of the CA-server.\r\n<ul>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem&nbsp; ca.globalcert.com.crt.pem</li>\r\n<li class=\"null\">scp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-2.%C2%A0-move-these-\">Step 2.&nbsp; Move these certs to your Active Directory server, and create a GPO to add these to the trust store.</p>\r\n<ul id=\"bkmrk-on-the-dc%2C-open-%22gro\">\r\n<li class=\"null\">On the DC, open \"Group Policy Management\"</li>\r\n<li class=\"null\">Creeat a new GPO linked to your Target Domain and name it something like \"Import_CA\"</li>\r\n<li class=\"null\">Edit this GPO and then add the certificates.\r\n<ul>\r\n<li class=\"null\">First, well add the CA certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Trusted Root Certificate Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Next import, the intermediate certificate.\r\n<ul>\r\n<li class=\"null\">Go to Computer Configuration -&gt; Policies -&gt; Windows Settings -&gt; Security Settings -&gt; Public Key Policies -&gt; Intermediate Certification Authorities.&nbsp; Then right click in the right window and select \"import\".&nbsp; Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.&nbsp; If you don\'t see it change file types to all.<br></li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n<p id=\"bkmrk-step-3.%C2%A0-close-the-%22\">Step 3.&nbsp; Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.&nbsp; Then from a target domain VM browse to https://redbook.com to validate there isn\'t an SSL error/warning.<br></p>','The Cyber Range environment will create a CA and intermediate Authority.  This is used to simulate real world SSL signing services like Digicert or Verisign.  By default, the Cyber Range installation will create one called globalcert.com.  The globalcert.com CA and the intermediate cert used for signing SSL certs are generated during the initial build of the CA-server.  These certs need to be imported into the trust stores of your windows based target systems.  Below are the instructions for doing so.\r\nStep 1.  Obtain the certs from the CA-Server\r\n\r\nFrom your target domain, scp these certs off of the CA-server.\r\n\r\nscp root@180.1.1.50:/root/ca/certs/ca.globalcert.com.crt.pem  ca.globalcert.com.crt.pem\r\nscp root@180.1.1.50:/root/ca/intermediate/certs/int.globalcert.com.crt.pem int.globalcert.com.crt.pem\r\n\r\n\r\n\r\nStep 2.  Move these certs to your Active Directory server, and create a GPO to add these to the trust store.\r\n\r\nOn the DC, open \"Group Policy Management\"\r\nCreeat a new GPO linked to your Target Domain and name it something like \"Import_CA\"\r\nEdit this GPO and then add the certificates.\r\n\r\nFirst, well add the CA certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Trusted Root Certificate Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored ca.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\nNext import, the intermediate certificate.\r\n\r\nGo to Computer Configuration -> Policies -> Windows Settings -> Security Settings -> Public Key Policies -> Intermediate Certification Authorities.  Then right click in the right window and select \"import\".  Then follow the import window instructions and browse to where you stored int.globalcert.com.crt.pem and select it.  If you don\'t see it change file types to all.\r\n\r\n\r\n\r\n\r\n\r\nStep 3.  Close the \"Group Policy Manager\" then run \"gpupdate /force on all your windows based systems connected to your domain.  Then from a target domain VM browse to https://redbook.com to validate there isn\'t an SSL error/warning.',5,'2023-04-10 23:45:56','2023-04-13 20:41:22',1,1,0,'',4,0,NULL,1,''),(29,8,0,'Connecting a Target Domain to the Cyber Range','connecting-a-target-domain-to-the-cyber-range','<p id=\"bkmrk-connecting-a-blue-sp\">Connecting a blue space is fairly straight forward.&nbsp; You can have a single WAN point for a blue space or as many as you would like.&nbsp; You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.&nbsp; Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.</p>\r\n<p id=\"bkmrk-below-is-the-simply-\">Below is the simple blue space example.</p>\r\n<div drawio-diagram=\"165\" id=\"bkmrk-\" contenteditable=\"false\"><img id=\"bkmrk--1\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681155829.png\"></div>\r\n<p id=\"bkmrk-in-the-diagram-above\">In the diagram above, your Target Domain is built on another ESXI server.&nbsp; On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.&nbsp; Then this virtual switch will need an uplink that connects to a physical NIC on the host server.&nbsp; Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.&nbsp; Then connect a line between the&nbsp; physical NICs on those two servers.&nbsp;&nbsp;</p>\r\n<p id=\"bkmrk-next%2C-you-need-to-ip\">Next, you need to IP this connection.&nbsp; You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.&nbsp; A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.&nbsp; Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.</p>\r\n<p id=\"bkmrk-%C2%A0from-the-nrts-serve\">&nbsp;From the NRTS server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot%2Fbackbonerou\"><code class=\"language-\">cd /root/backbonerouters\r\ngrep 44.22.1 */*</code></pre>\r\n<p id=\"bkmrk-above-we-are-greppin\">Above we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.&nbsp; This will find all possible matches.&nbsp; Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.&nbsp; If your grep comes back empty, you are good to go with the IP you selected.&nbsp; Typically for a WAN connection, a /29 subnet is a reasonable choice.&nbsp;&nbsp; For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,&nbsp; the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.&nbsp; We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.&nbsp; Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.&nbsp; Below are the instructions for this.</p>\r\n<ul id=\"bkmrk-console-into-the-si-\">\r\n<li class=\"null\">Console into the SI-Router on the Cyber Range.</li>\r\n<li class=\"null\">Then edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following</li>\r\n</ul>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source-\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<ul id=\"bkmrk-then-save-the-script\">\r\n<li class=\"null\">Then save the script and run it with ./Eth3RangeWAN.sh.&nbsp; That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.</li>\r\n</ul>\r\n<p id=\"bkmrk-adding-additional-ta\">Adding additional target domains is basically the same.&nbsp; For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.&nbsp; Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.&nbsp; For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.&nbsp; The Eth3RangeWAN.sh script would look like the following.&nbsp; Then we just run the script again.&nbsp; You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.</p>\r\n<pre id=\"bkmrk-%23%21%2Fbin%2Fvbash-source--1\"><code class=\"language-\">#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit</code></pre>\r\n<p id=\"bkmrk-note%3A-you%27ll-need-a-\">NOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.&nbsp; ESXI virtual switches are limited to a single uplink.&nbsp; Technically you can have 4 uplinks on a Virtual Switch in ESXI, but these additional uplinks can only be configured as teamed or fail over ports.&nbsp; So essentially its like a single logical port.&nbsp; So to connect multiple Target Domains, you\'ll just need to put a switch between the connections from&nbsp; target domain&nbsp; WANs to the Cyber Range RangeWAN uplink port.&nbsp; Below is a really poorly made diagram of this.<br></p>\r\n<div drawio-diagram=\"179\" id=\"bkmrk--2\" contenteditable=\"false\"><img id=\"bkmrk--3\" src=\"https://redbook.com/uploads/images/drawio/2023-04/drawing-1-1681243955.png\"></div>','Connecting a blue space is fairly straight forward.  You can have a single WAN point for a blue space or as many as you would like.  You just have to add a gateway IP for the WAN connection on the SI-Router\'s RangeWAN interface and then connect the blue space WAN edge interface to the Cyber Range RangeWAN ESXI switch.  Since there are too many possibilities for what a blue space could look like, this guide will use a simple example of a basic blue space to explain the process of connecting a blue space to the cyber range.\r\nBelow is the simple blue space example.\r\n\r\nIn the diagram above, your Target Domain is built on another ESXI server.  On this server you\'ll need to create a virtual switch for the Target Domain WAN connection point.  Then this virtual switch will need an uplink that connects to a physical NIC on the host server.  Then on the ESXI server running the Cyber Range environment, you\'ll need to add an uplink to the \"RangeWAN\" virtual switch that maps to a physical NIC on that server.  Then connect a line between the  physical NICs on those two servers.  \r\nNext, you need to IP this connection.  You can pick almost whatever IP you want for your WAN interface on your target domain network, however you need to make sure that the IP you select isn\'t already a routed IP on the Cyber Range SI-router.  A good way to check that the IP you want to use is available is to grep the IP against the Geo-Location IP folder structure on the NRTS server.  Below is some suggestions for validating the IP you want to use for your Target Domains WAN isn\'t already routed.\r\n From the NRTS server.\r\ncd /root/backbonerouters\r\ngrep 44.22.1 */*\r\nAbove we are grepping for the first two octets and the first part of the third octet against all files in the /root/backbonerouters directory on the NRTS.  This will find all possible matches.  Then you just have to make sure that the IP/subnet you want to use doesn\'t fall into an existing IP/subnet.  If your grep comes back empty, you are good to go with the IP you selected.  Typically for a WAN connection, a /29 subnet is a reasonable choice.   For this example we\'ll use a Target Domain WAN IP of 44.22.11.10/29,  the available IPs in this subnet ranges from 44.22.11.9 to 44.22.11.14.  We\'ll use 44.22.11.9 as our gateway IP so we\'ll need to configure the SI-router with that IP, then we still have 44.22.11.11 to 44.22.11.14 available to use with our target domain, for example we can set up a virtual IP of 44.22.11.11 to use for OWA.  Once you\'ve set your Target Domain WAN IP to 44.22.11.10/29, we need to configure the SI-Router to be it\'s gateway to the Cyber Range.  Below are the instructions for this.\r\n\r\nConsole into the SI-Router on the Cyber Range.\r\nThen edit the following script /home/vyos/Scripts/Eth3RangeWAN.sh to look like the following\r\n\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\n\r\nThen save the script and run it with ./Eth3RangeWAN.sh.  That\'s it, you should be able to ping back and forth from the SI-Router to your Target Domain firewall, just make sure that you have rules set to allow ICMP and whatever else you want enabled in your Target Domain firewall.\r\n\r\nAdding additional target domains is basically the same.  For example, we\'ll add another target domain that say is using a WAN IP of 55.44.11.2/29.  Once we\'ve added the physical connection like shown above for the second target domain, we can just modify the /home/vyos/Scripts/Eth3RangeWAN.sh and add the gateway for this new target domain.  For this one we\'ll again set the gateway as the first available IP of the subnet, in this case it would be 55.44.11.1/29.  The Eth3RangeWAN.sh script would look like the following.  Then we just run the script again.  You\'ll get some errors saying the previous IP of 44.22.11.10/29 already exists, but that doesn\'t hurt anything, the script will just move on and then add the second IP gateway of 44.33.11.1 to the interface.\r\n#!/bin/vbash\r\n\r\nsource /opt/vyatta/etc/functions/script-template\r\n\r\nconfigure\r\nset interfaces ethernet eth3 address 44.22.11.10/29\r\nset interfaces ethernet eth3 address 55.44.11.1/29\r\nset interfaces ethernet eth3 duplex auto\r\nset interfaces ethernet eth3 speed auto\r\ncommit\r\nexit\r\nNOTE: You\'ll need a switch to connect up more than one target domain to the cyber range.  ESXI virtual switches are limited to a single uplink.  Technically you can have 4 uplinks on a Virtual Switch in ESXI, but these additional uplinks can only be configured as teamed or fail over ports.  So essentially its like a single logical port.  So to connect multiple Target Domains, you\'ll just need to put a switch between the connections from  target domain  WANs to the Cyber Range RangeWAN uplink port.  Below is a really poorly made diagram of this.\r\n',6,'2023-04-11 00:17:20','2023-04-13 22:40:20',1,1,0,'',3,0,NULL,1,''),(30,4,0,'Setting up the Traffic-Gen for a Target Domain','setting-up-the-traffic-gen-for-a-target-domain','<p id=\"bkmrk-the-traffic-gen-is-d\">The Traffic-Gen is designed to send emails from external sources to Target Domain users.&nbsp; It does this by creating a docker container for each domain that it will use to send emails from.&nbsp; Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.&nbsp; Setting this up takes a little bit of effort, but it\'s not too bad.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-make-sure-t\">Step 1.&nbsp; Make sure that your target domain is connected to the Cyber Range.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/connecting-a-target-domain-to-the-cyber-range\">Connecting a target domain to the Cyber Range</a>.&nbsp;&nbsp; Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.&nbsp; See Target Domain Planning Guide -&gt; <a href=\"https://redbook.com/books/target-domain-planning-guide/page/adding-dns-for-your-target-domain\">Adding DNS for your Target Domain</a>.&nbsp;&nbsp; Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.&nbsp; You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.</p>\r\n<pre id=\"bkmrk-telnet-galfed.com-25\"><code class=\"language-\">telnet galfed.com 25\r\n\r\n## When you run the above command, you should get a response from your target domain exchange server \r\n## that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...</code></pre>\r\n<p id=\"bkmrk-if-your-telnet-conne\">If your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.&nbsp; Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.</p>\r\n<p id=\"bkmrk-step-2.%C2%A0-at-this-poi\">Step 2.&nbsp; At this point you have validated your target domain exchange is reachable from the Cyber Range.&nbsp; The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.&nbsp; You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.&nbsp; Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.&nbsp; You can do this via SCP.&nbsp; Below is an example of SCPing the email list from the a target domain exchange server.&nbsp; For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.&nbsp; Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.<br></p>\r\n<pre id=\"bkmrk-scp-galfedemails.txt\"><code class=\"language-\">scp galfedemails.txt root@92.107.127.12:/root</code></pre>\r\n<p id=\"bkmrk-step-3.%C2%A0-at-this-poi\">Step 3.&nbsp; At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.&nbsp; Next is creating a folder for it, running a dos2unix against it and renaming it.&nbsp; The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-dos2unix-ga\"><code class=\"language-\">cd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt</code></pre>\r\n<p id=\"bkmrk-step-4.%C2%A0-now-we-have\">Step 4.&nbsp; Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.&nbsp; At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh<br></p>\r\n<pre id=\"bkmrk-cd-root-.%2Fbuidcompos\"><code class=\"language-\">cd root\r\n./buidcompose.sh</code></pre>\r\n<p id=\"bkmrk-when-the-script-firs\">When the script first runs, it preforms some system checks.&nbsp; The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.&nbsp; The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains resolve to the IP listed in the emailerlist.txt file.&nbsp; Below is what you should see if everything checks out.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/oMfimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-if-it-errors%2C-it-wil\">If it errors, it will display the issues, you\'ll need to resolve those before proceeding.&nbsp; If the checks are good it will pop up the following text-based GUI.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/8wximage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-the-above-will-show-\">The above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.&nbsp; In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.&nbsp; That said, we\'ll select option 1 for \"GALFED\" and press enter.</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Hkdimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-the-script-builds-th\">The script builds the docker-compose.yml and tells you how to start sending emails.&nbsp; Then to kick it off just run the following.</p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstarttraf\"><code class=\"language-\">cd /root\r\n./starttrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-if-everything-went-w\">If everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/GJgimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-at-this-point-you-ca\">At this point you can check your traffic logs - these are located at /root/TG/TrafficLog.&nbsp; There is a log for each emailing domains.&nbsp; You can tail all the logs at once with the following.</p>\r\n<pre id=\"bkmrk-tail--f-%2Froot%2Ftg%2Ftra\"><code class=\"language-\">tail -f /root/TG/TrafficLog/*</code></pre>\r\n<p id=\"bkmrk-here-is-a-sample-out\">Here is a sample output.</p>\r\n<p id=\"bkmrk--4\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Iz8image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-%C2%A0\">To stop the Traffic-Gen run the following<br></p>\r\n<pre id=\"bkmrk-cd-%2Froot-.%2Fstoptraff\"><code class=\"language-\">cd /root\r\n./stoptrafficgen.sh</code></pre>\r\n<p id=\"bkmrk-output-will-look-lik\">output will look like.</p>\r\n<p id=\"bkmrk--5\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/JBlimage.png\" alt=\"image.png\"></p>','The Traffic-Gen is designed to send emails from external sources to Target Domain users.  It does this by creating a docker container for each domain that it will use to send emails from.  Then a script runs in each container that will generate randomized emails to send to a list of email address that you provide.  Setting this up takes a little bit of effort, but it\'s not too bad.\r\nStep 1.  Make sure that your target domain is connected to the Cyber Range.  See Target Domain Planning Guide -> Connecting a target domain to the Cyber Range.   Once it\'s connected, make sure you add a DNS record for it in the rootDNS server.  See Target Domain Planning Guide -> Adding DNS for your Target Domain.   Once it\'s connected and DNS is configured, make sure that your exchange is reachable from the Cyber Range.  You can do this by running a telnet test from any system in the Cyber Range, below is an example using an NRTS server to reach an example Target Domain exchange at galfed.com.\r\ntelnet galfed.com 25\r\n\r\n## When you run the above command, you should get a response from your target domain exchange server \r\n## that looks something like the following.\r\n\r\nTrying 8.21.10.19...\r\nConnected to galfed.com\r\nEscape Character is \'^]\'.\r\n220 GF-exch01.galfed.com Microsoft ESMTP MAIL Service ready at ...\r\nIf your telnet connection test works and you get a response from your Target Domain exchange, you can proceed to Step 2.  Otherwise, troubleshoot your target Domain exchange server, your target domain connection to the Cyber Range and/or target domain DNS record on the rootDNS and fix the issue, don\'t proceed to step 2 until you\'ve had a successful telnet test.\r\nStep 2.  At this point you have validated your target domain exchange is reachable from the Cyber Range.  The next step is compiling a list of email address that you would like the Traffic-Gen to send emails to.  You can do this using the user.csv you would have made if you used the CreateADusers.ps1 to generate your target domain users, or powershell via the exchange management console to get a list of emails.  Once you have a list of emails that you want the Traffic-Gen to send emails to, you need to get the list over to the Traffic-Gen.  You can do this via SCP.  Below is an example of SCPing the email list from the a target domain exchange server.  For this example, galfedemails.txt is my list of target domain email address, this should be in the format of one email address per line no spaces, and no commas.  Then we\'ll use the Traffic-Gen IP of 92.107.127.12 to SCP the file to it.\r\nscp galfedemails.txt root@92.107.127.12:/root\r\nStep 3.  At this point you should have transfer your list of Target Domain email address over to the Traffic-Gen.  Next is creating a folder for it, running a dos2unix against it and renaming it.  The Traffic-Gen script that sends emails in a docker container needs the file to be named \"sendto.txt\", and the build-compose.sh script needs this file to be in a specific directory, below is an example of making the directory, dos2unixing the file, and renaming it on the Traffic-Gen server.\r\ncd /root\r\ndos2unix galfedemails.txt\r\nmkdir /root/TG/SendTo/GALFED\r\nmv galfedemails.txt /root/TG/SendTo/GALFED/sendto.txt\r\nStep 4.  Now we have validated our target domain exchange is reachable, we\'ve made a list of target domain emails we want the Traffic-Gen to send emails to and transferred the list to the Traffic-Gen, re-named it as \"sendto.txt\" and placed it in a custom directory at /root/TG/SendTo.  At this point we can use the build-compose.sh script to build the docker-compose.yml. Below is the how to launch the buildcompose.sh\r\ncd root\r\n./buidcompose.sh\r\nWhen the script first runs, it preforms some system checks.  The file /root/emailerlist.txt contains the domains and associated IPs for the domains that the Traffic-Gen will use as the sender domains.  The script will read this in and validate that the server has those IP\'s assigned and that a DNS lookup for the domains resolve to the IP listed in the emailerlist.txt file.  Below is what you should see if everything checks out.\r\n\r\nIf it errors, it will display the issues, you\'ll need to resolve those before proceeding.  If the checks are good it will pop up the following text-based GUI.\r\n\r\nThe above will show you the domains it will use for sending the emails, then you select from the list the target domains you would like it to send emails to.  In this case, GALFED is the only option, but if you have multiple Target domains and have gone through the steps to create a target domain folder with a list of emails to send to named \"sendto.txt\" in that directory, the script would automatically add it as another option.  That said, we\'ll select option 1 for \"GALFED\" and press enter.\r\n\r\nThe script builds the docker-compose.yml and tells you how to start sending emails.  Then to kick it off just run the following.\r\ncd /root\r\n./starttrafficgen.sh\r\nIf everything went well, you should have email traffic now being sent to your target domain, the output of the command above should look like the following.\r\n\r\nAt this point you can check your traffic logs - these are located at /root/TG/TrafficLog.  There is a log for each emailing domains.  You can tail all the logs at once with the following.\r\ntail -f /root/TG/TrafficLog/*\r\nHere is a sample output.\r\n\r\nTo stop the Traffic-Gen run the following\r\ncd /root\r\n./stoptrafficgen.sh\r\noutput will look like.\r\n',5,'2023-04-11 18:28:43','2023-04-12 22:03:06',1,1,0,'',5,0,NULL,1,''),(31,8,0,'Adding DNS for your Target Domain','adding-dns-for-your-target-domain','<p id=\"bkmrk-the-target-domains-y\">You will most likely want the target domains you connect to the Cyber Range to have \"publicly\" available services, for example maybe a public facing website and/or email services.&nbsp; For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.&nbsp; Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.&nbsp; Adding Target Domain DNS to the RootDNS server is a purely manual process.&nbsp; This guide is to help get that set up with a few examples.&nbsp;</p>\r\n<p id=\"bkmrk-example-1---your-tar\"><span style=\"text-decoration: underline;\"><strong>Example 1 </strong></span>- Your target domain is called widgets.com and has a public facing website and a mail server.&nbsp; For the purpose of this guide we\'ll assume that we have already completed the Target Domain Planning Guide -&gt; Connecting a Target Domain to the Cyber Range.&nbsp;&nbsp; Additionally, we decided to use 44.22.11.10/29 for target domain&nbsp; firewall WAN connection.&nbsp; Then, to enable our public services to reachable through our Firewall, we set up a port forward on 44.22.11.10 to send port 80 and 443 to our target domain web server, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to our target domains exchange server.&nbsp;&nbsp;&nbsp; Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th\">Step 1.&nbsp; Log into the RootDNS server.&nbsp; Then create a zone file in the /etc/bind/RANGE directory.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind%2Frange-v\"><code class=\"language-\">cd /etc/bind/RANGE\r\nvi db.widgets.com</code></pre>\r\n<p id=\"bkmrk-next-we-need-to-put-\">Next we need to put the following in the db.widgets.com zone file.</p>\r\n<pre id=\"bkmrk-%3B-widgets-blue-space\"><code class=\"language-\">; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4</code></pre>\r\n<p id=\"bkmrk-so-lets-explain-this\">So lets explain this line by line.</p>\r\n<ul id=\"bkmrk-line-1%C2%A0-%22%3B-widgets-b\">\r\n<li class=\"null\">Line 1&nbsp; \"; Widgets blue space DNS\"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; This is just a comment, in a zone file you can add comments using a \";\".\r\n<ul>\r\n<li style=\"list-style-type: none;\">\r\n<ul>\r\n<li class=\"null\">NOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.</li>\r\n</ul>\r\n</li>\r\n</ul>\r\n</li>\r\n<li class=\"null\">Line 2&nbsp; \"$TTL&nbsp;&nbsp;&nbsp;&nbsp; 88640\"&nbsp;&nbsp; This is the time in seconds that caching DNS servers should cache this record.</li>\r\n<li class=\"null\">Line 3 \"@&nbsp;&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; SOA&nbsp;&nbsp;&nbsp; @&nbsp;&nbsp; ns.widgets.com.&nbsp; 42 3H 15M 1W 1D\"&nbsp;&nbsp; This is the Start of Authority (SOA)&nbsp; for the domain.&nbsp; The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL</li>\r\n<li class=\"null\">Line 4 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; NS&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ns.widgets.com.\"&nbsp;&nbsp; This is setting the NameServer for the domain to the domain of ns.widgets.com</li>\r\n<li class=\"null\">Line 5 \"@&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp; MX&nbsp;&nbsp; 10&nbsp;&nbsp;&nbsp; widgets.com.\"&nbsp; This is setting the MX (mail server) domain to widgets.com.&nbsp; The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.</li>\r\n<li class=\"null\">Line 6 \"@&nbsp;&nbsp; IN&nbsp;&nbsp;&nbsp;&nbsp; A&nbsp;&nbsp;&nbsp; 44.22.11.11\" .&nbsp; The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.&nbsp; This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.</li>\r\n<li class=\"null\">Line 7 \"www&nbsp;&nbsp; IN&nbsp;&nbsp; A&nbsp; 44.22.11.10\".&nbsp;&nbsp;&nbsp; This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.</li>\r\n<li class=\"null\">Line 8 \"owa&nbsp; IN&nbsp;&nbsp; A&nbsp;&nbsp; 44.22.11.11\".&nbsp; This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.</li>\r\n<li class=\"null\">Line 9 \"ns&nbsp;&nbsp;&nbsp; IN&nbsp;&nbsp; A 198.41.0.4\".&nbsp; This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.&nbsp; The IP 198.41.0.4 is an IP on the rootDNS server itself.&nbsp; This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.&nbsp; IPv6 records at set using \"AAAA\" verse \"A\".&nbsp; For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.&nbsp; This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. <br></li>\r\n</ul>\r\n<p id=\"bkmrk-step-2%3A%C2%A0-now-that-we\">Step 2:&nbsp; Now that we create the zone file, we should test it to make sure there are no syntax errors.&nbsp; You can do this on the RootDNS server using the following command.&nbsp;</p>\r\n<pre id=\"bkmrk-named-checkzone-%3Cdom\"><code class=\"language-\">named-checkzone &lt;domainname&gt; &lt;zonefile&gt;</code></pre>\r\n<p id=\"bkmrk-below-is-an-example.\">below is an example.</p>\r\n<p id=\"bkmrk-\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/KSvimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-2.%C2%A0-once-you-ha\">Step 2.&nbsp; Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file.&nbsp;</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file\">Then append the file with the following syntax.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com.%22-\"><code class=\"language-\">zone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};</code></pre>\r\n<p id=\"bkmrk-when-you-are-done%2C-y\">Next we\'ll validate the edits we made to named.conf.RANGE.<br></p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-named-c\"><code class=\"language-\">cd /etc/bind\r\nnamed-checkconf named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-if-are-no-errors%2C-yo\">If there are no errors, you will get nothing back, below is an example output of a good check.</p>\r\n<p id=\"bkmrk--1\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/sY0image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-step-3.%C2%A0-now-that-we\">Step 3.&nbsp; Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.&nbsp; Do this with the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-output-should-look-l\">Output should look like</p>\r\n<p id=\"bkmrk--2\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/Bj5image.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-next%2C-run-a-nslookup\">Next, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.</p>\r\n<p id=\"bkmrk--3\"><img src=\"https://redbook.com/uploads/images/gallery/2023-04/scaled-1680-/2pHimage.png\" alt=\"image.png\"></p>\r\n<p id=\"bkmrk-example-2.%C2%A0-for-this\"><span style=\"text-decoration: underline;\"><strong>Example 2</strong></span>.&nbsp; For this example, we will be running a DNS nameserver within our Target Domain.&nbsp; Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.&nbsp; We\'ll use the domain of widgets.com also.&nbsp; In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.&nbsp; Instead we will be adding a forwarder in the RootDNS\'s&nbsp; named.conf.RANGE file.&nbsp; Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.</p>\r\n<p id=\"bkmrk-step-1.%C2%A0-log-into-th-1\">Step 1.&nbsp; Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.</p>\r\n<pre id=\"bkmrk-cd-%2Fetc%2Fbind-vi-name-1\"><code class=\"language-\">cd /etc/bind\r\nvi named.conf.RANGE</code></pre>\r\n<p id=\"bkmrk-then-append-the-file-1\">Then append the file with the following.</p>\r\n<pre id=\"bkmrk-zone-%22widgets.com%22-%7B\"><code class=\"language-\">zone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};</code></pre>\r\n<p id=\"bkmrk-step-2.%C2%A0-check-your-\">Step 2.&nbsp; Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.&nbsp;&nbsp; If that passes, run the following.</p>\r\n<pre id=\"bkmrk-service-bind9-restar-1\"><code class=\"language-\">service bind9 restart\r\nservice bind9 status</code></pre>\r\n<p id=\"bkmrk-then-you-can-test-yo\">Then you can test your DNS again using nslookup.&nbsp; What this looks like depends on how you configured your target domain nameserver.</p>','You will most likely want the target domains you connect to the Cyber Range to have \"publicly\" available services, for example maybe a public facing website and/or email services.  For systems in the Cyber Range to reach these services, it will need to have its domain registered on the rootDNS server.  Since the services and subdomains for user created Target domains tends to be very dynamic and not a frequently required task, there is no script for setting this up.  Adding Target Domain DNS to the RootDNS server is a purely manual process.  This guide is to help get that set up with a few examples. \r\nExample 1 - Your target domain is called widgets.com and has a public facing website and a mail server.  For the purpose of this guide we\'ll assume that we have already completed the Target Domain Planning Guide -> Connecting a Target Domain to the Cyber Range.   Additionally, we decided to use 44.22.11.10/29 for target domain  firewall WAN connection.  Then, to enable our public services to reachable through our Firewall, we set up a port forward on 44.22.11.10 to send port 80 and 443 to our target domain web server, then set up a virtual IP at 44.22.11.11 and port forwarded ports 443 and 25 to our target domains exchange server.    Therefore, we need to set up DNS for widgets.com for a public website, OWA over 443, and SMTP on 25 for email.\r\nStep 1.  Log into the RootDNS server.  Then create a zone file in the /etc/bind/RANGE directory.\r\ncd /etc/bind/RANGE\r\nvi db.widgets.com\r\nNext we need to put the following in the db.widgets.com zone file.\r\n; Widgets blue space DNS\r\n$TTL	88640\r\n@		IN		SOA		@		ns.widgets.com.	42 3H 15M 1W 1D\r\n@		IN		NS				ns.widgets.com.\r\n@		IN		MX		10		widgets.com.\r\n@		IN		A		44.22.11.11\r\nwww		IN		A		44.22.11.10\r\nowa		IN		A		44.22.11.11\r\nns		IN		A		198.41.0.4\r\nSo lets explain this line by line.\r\n\r\nLine 1  \"; Widgets blue space DNS\"        This is just a comment, in a zone file you can add comments using a \";\".\r\n\r\n\r\n\r\nNOTE: in the bind zone reference file, aka, named.conf.xxx - you have to use \"//\" for comments.\r\n\r\n\r\n\r\n\r\nLine 2  \"$TTL     88640\"   This is the time in seconds that caching DNS servers should cache this record.\r\nLine 3 \"@     IN   SOA    @   ns.widgets.com.  42 3H 15M 1W 1D\"   This is the Start of Authority (SOA)  for the domain.  The 42 is the serial #, 3H is refresh, 15M retry, 1W expire, 1D, negative caching TTL\r\nLine 4 \"@    IN   NS      ns.widgets.com.\"   This is setting the NameServer for the domain to the domain of ns.widgets.com\r\nLine 5 \"@    IN    MX   10    widgets.com.\"  This is setting the MX (mail server) domain to widgets.com.  The \"10\" is for setting a priority, say if the domain had more than one mail server, you could make one a higher priority.\r\nLine 6 \"@   IN     A    44.22.11.11\" .  The @ indicates it applies to the Top Level Domain (TLD) meaning widgets.com.  This sets the IP of \"widgets.com\" to 44.22.11.11 which is what we are using at the firewall to port forward to our mail server.\r\nLine 7 \"www   IN   A  44.22.11.10\".    This sets the subdomain of www to 44.22.11.10, this is what we set up via a firewall port forward to go to our public facing website.\r\nLine 8 \"owa  IN   A   44.22.11.11\".  This sets the subdomain of owa to 44.22.11.11, this is to allow reaching our mailserver from the Cyber Range space using https://owa.widgets.com.\r\nLine 9 \"ns    IN   A 198.41.0.4\".  This sets the subdomain of ns, which is also listed as the domains nameserver domain to the IP of 198.41.0.4.  The IP 198.41.0.4 is an IP on the rootDNS server itself.  This prevents DNS from looking for additional DNS information from some other server, like say if something wanted to get the IPv6 address for the domain.  IPv6 records at set using \"AAAA\" verse \"A\".  For example an nslookup will attempt to retrieve an IPv6 IP, if the nameserver IP was set to something arbitrary or to 44.22.11.11 or 44.22.11.10, it would send a DNS query to that for the IPv6 address, which won\'t get a response.  This means DNS lookups for your domain will be slow as it waits for additional queries, for say an IPv6 address to time out. \r\n\r\nStep 2:  Now that we create the zone file, we should test it to make sure there are no syntax errors.  You can do this on the RootDNS server using the following command. \r\nnamed-checkzone <domainname> <zonefile>\r\nbelow is an example.\r\n\r\nStep 2.  Once you have created your Zone file, you need to add a reference for it in the /etc/bind/named.conf.RANGE file. \r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following syntax.\r\nzone \"widgets.com.\" IN {\r\n	type master;\r\n    file \"RANGE/db.widgets.com\";\r\n    allow-query { any; };\r\n    allow-update { none; };\r\n};\r\nNext we\'ll validate the edits we made to named.conf.RANGE.\r\ncd /etc/bind\r\nnamed-checkconf named.conf.RANGE\r\nIf there are no errors, you will get nothing back, below is an example output of a good check.\r\n\r\nStep 3.  Now that we have our zone file created and added the reference in named.conf.RANGE, we can restart bind to make it read in the new config.  Do this with the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nOutput should look like\r\n\r\nNext, run a nslookup to validate your DNS works, you can run this from your Target Domain or on the rootDNS server.\r\n\r\nExample 2.  For this example, we will be running a DNS nameserver within our Target Domain.  Again, we\'ll assume we completed the connecting a Target Domain to the Cyber Range portion and are using 44.33.22.2/29 for our Target Domain\'s Firewall WAN connection.  We\'ll use the domain of widgets.com also.  In this case, we will be managing our DNS using our own DNS server within our Target Domain, so we won\'t be setting up a zone file.  Instead we will be adding a forwarder in the RootDNS\'s  named.conf.RANGE file.  Just make sure you are port forwarding port 53 through your target domain firewall to the internal IP of your DNS nameserver.\r\nStep 1.  Log into the RootDNS server and edit the /etc/bind/named.conf.RANGE file.\r\ncd /etc/bind\r\nvi named.conf.RANGE\r\nThen append the file with the following.\r\nzone \"widgets.com\" {\r\n	type forward;\r\n    forwarders { 44.33.22.2; };\r\n};\r\nStep 2.  Check your syntax for errors by running the named-checkconf /etc/bind/named.conf.RANGE.   If that passes, run the following.\r\nservice bind9 restart\r\nservice bind9 status\r\nThen you can test your DNS again using nslookup.  What this looks like depends on how you configured your target domain nameserver.',7,'2023-04-11 23:19:22','2023-04-13 22:46:22',1,1,0,'',3,0,NULL,1,''),(32,8,0,'Adding a Internet Access Proxy for a Target Domain','adding-a-internet-access-proxy-for-a-target-domain','<p id=\"bkmrk-having-a-way-to-acce\">Having a way to access the real internet from a target domain is very useful.&nbsp; There are a couple of ways to do this.&nbsp; One way would be to install a secondary NIC on all of your target domain and then interconnect that to the Cyber Range AdminNet.&nbsp; It would get a DHCP lease from the AdminNet-DHCP server and be able to use the same https://172.30.0.2:9999 proxy that the Cyber Range uses.&nbsp; However, this also creates a unwanted artifact of this secondary NIC on all your target domain systems that you\'ll have to tell the cyber defenders that use it for training to just ignore.&nbsp; The bigger concern is that the AdminNet is a flat network, connecting say multiple target domains to it could lead to inadvertent propagation.&nbsp; For example, if a red teamer drops wormable malware on Target Domain 1, unless you added appropriate firewall rules to this secondary interface, this malware would likely propagate to all other Target Domains via the AdminNet.&nbsp; That said, this method is not advisable but it is a method that an end user might consider so it worth explaining why it\'s not a good idea.&nbsp; The preferred method would be to add a squid proxy in your Target Domain DMZ.&nbsp; Give that server two NICs, one connected to the Target Domain DMZ and the other connected a real internet connection.&nbsp; The configuration of this will depend on how your Target Domain is built, but you can use the Cyber Range IA-proxy configuration as an example.&nbsp;</p>','Having a way to access the real internet from a target domain is very useful.  There are a couple of ways to do this.  One way would be to install a secondary NIC on all of your target domain and then interconnect that to the Cyber Range AdminNet.  It would get a DHCP lease from the AdminNet-DHCP server and be able to use the same https://172.30.0.2:9999 proxy that the Cyber Range uses.  However, this also creates a unwanted artifact of this secondary NIC on all your target domain systems that you\'ll have to tell the cyber defenders that use it for training to just ignore.  The bigger concern is that the AdminNet is a flat network, connecting say multiple target domains to it could lead to inadvertent propagation.  For example, if a red teamer drops wormable malware on Target Domain 1, unless you added appropriate firewall rules to this secondary interface, this malware would likely propagate to all other Target Domains via the AdminNet.  That said, this method is not advisable but it is a method that an end user might consider so it worth explaining why it\'s not a good idea.  The preferred method would be to add a squid proxy in your Target Domain DMZ.  Give that server two NICs, one connected to the Target Domain DMZ and the other connected a real internet connection.  The configuration of this will depend on how your Target Domain is built, but you can use the Cyber Range IA-proxy configuration as an example. ',8,'2023-04-12 18:59:20','2023-04-12 20:49:06',1,1,0,'',1,0,NULL,1,'');
/*!40000 ALTER TABLE `pages` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `password_resets`
--

DROP TABLE IF EXISTS `password_resets`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `password_resets` (
  `email` varchar(191) NOT NULL,
  `token` varchar(191) NOT NULL,
  `created_at` timestamp NOT NULL DEFAULT current_timestamp() ON UPDATE current_timestamp(),
  KEY `password_resets_email_index` (`email`),
  KEY `password_resets_token_index` (`token`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `password_resets`
--

LOCK TABLES `password_resets` WRITE;
/*!40000 ALTER TABLE `password_resets` DISABLE KEYS */;
/*!40000 ALTER TABLE `password_resets` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `permission_role`
--

DROP TABLE IF EXISTS `permission_role`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `permission_role` (
  `permission_id` int(10) unsigned NOT NULL,
  `role_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`permission_id`,`role_id`),
  KEY `permission_role_role_id_foreign` (`role_id`),
  CONSTRAINT `permission_role_permission_id_foreign` FOREIGN KEY (`permission_id`) REFERENCES `role_permissions` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `permission_role_role_id_foreign` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `permission_role`
--

LOCK TABLES `permission_role` WRITE;
/*!40000 ALTER TABLE `permission_role` DISABLE KEYS */;
INSERT INTO `permission_role` VALUES (19,1),(20,1),(21,1),(22,1),(23,1),(24,1),(24,2),(25,1),(25,2),(26,1),(26,2),(27,1),(27,2),(28,1),(28,2),(29,1),(29,2),(30,1),(30,2),(31,1),(31,2),(32,1),(32,2),(33,1),(33,2),(34,1),(34,2),(35,1),(35,2),(36,1),(36,2),(37,1),(37,2),(38,1),(38,2),(39,1),(39,2),(40,1),(40,2),(41,1),(41,2),(42,1),(42,2),(43,1),(43,2),(44,1),(44,2),(45,1),(45,2),(46,1),(46,2),(47,1),(47,2),(48,1),(48,2),(48,3),(48,4),(49,1),(49,2),(49,3),(49,4),(50,1),(50,2),(50,3),(50,4),(51,1),(51,2),(51,3),(51,4),(52,1),(52,2),(52,3),(52,4),(53,1),(53,2),(53,3),(53,4),(54,1),(55,1),(56,1),(57,1),(58,1),(59,1),(60,1),(61,1),(62,1),(63,1),(64,1),(65,1),(66,1),(66,2),(66,3),(66,4),(67,1),(67,2),(67,3),(67,4),(68,1),(68,2),(69,1),(69,2),(70,1),(70,2),(71,1),(71,2),(72,1),(72,2),(73,1),(73,2),(74,1),(75,1),(76,1),(76,2),(76,3),(76,4),(77,1);
/*!40000 ALTER TABLE `permission_role` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `references`
--

DROP TABLE IF EXISTS `references`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `references` (
  `id` bigint(20) unsigned NOT NULL AUTO_INCREMENT,
  `from_id` int(10) unsigned NOT NULL,
  `from_type` varchar(25) NOT NULL,
  `to_id` int(10) unsigned NOT NULL,
  `to_type` varchar(25) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `references_from_id_index` (`from_id`),
  KEY `references_from_type_index` (`from_type`),
  KEY `references_to_id_index` (`to_id`),
  KEY `references_to_type_index` (`to_type`)
) ENGINE=InnoDB AUTO_INCREMENT=146 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `references`
--

LOCK TABLES `references` WRITE;
/*!40000 ALTER TABLE `references` DISABLE KEYS */;
INSERT INTO `references` VALUES (102,6,'page',9,'page'),(118,2,'page',4,'page'),(119,2,'page',28,'page'),(120,2,'page',6,'page'),(121,2,'page',7,'page'),(122,2,'page',30,'page'),(123,2,'page',9,'page'),(124,2,'page',6,'book'),(125,2,'page',32,'page'),(126,2,'page',29,'page'),(127,4,'page',6,'book'),(128,7,'page',30,'page'),(129,9,'page',6,'book'),(130,9,'page',13,'page'),(131,9,'page',20,'page'),(132,9,'page',10,'page'),(133,9,'page',18,'page'),(134,10,'page',20,'page'),(135,30,'page',29,'page'),(136,30,'page',31,'page'),(137,14,'page',13,'page'),(144,25,'page',26,'page'),(145,25,'page',7,'page');
/*!40000 ALTER TABLE `references` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `role_permissions`
--

DROP TABLE IF EXISTS `role_permissions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `role_permissions` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `display_name` varchar(191) DEFAULT NULL,
  `description` varchar(191) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `permissions_name_unique` (`name`)
) ENGINE=InnoDB AUTO_INCREMENT=78 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `role_permissions`
--

LOCK TABLES `role_permissions` WRITE;
/*!40000 ALTER TABLE `role_permissions` DISABLE KEYS */;
INSERT INTO `role_permissions` VALUES (19,'settings-manage','Manage Settings',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(20,'users-manage','Manage Users',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(21,'user-roles-manage','Manage Roles & Permissions',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(22,'restrictions-manage-all','Manage All Entity Permissions',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(23,'restrictions-manage-own','Manage Entity Permissions On Own Content',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(24,'book-create-all','Create All Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(25,'book-create-own','Create Own Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(26,'book-update-all','Update All Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(27,'book-update-own','Update Own Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(28,'book-delete-all','Delete All Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(29,'book-delete-own','Delete Own Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(30,'page-create-all','Create All Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(31,'page-create-own','Create Own Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(32,'page-update-all','Update All Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(33,'page-update-own','Update Own Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(34,'page-delete-all','Delete All Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(35,'page-delete-own','Delete Own Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(36,'chapter-create-all','Create All Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(37,'chapter-create-own','Create Own Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(38,'chapter-update-all','Update All Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(39,'chapter-update-own','Update Own Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(40,'chapter-delete-all','Delete All Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(41,'chapter-delete-own','Delete Own Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(42,'image-create-all','Create All Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(43,'image-create-own','Create Own Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(44,'image-update-all','Update All Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(45,'image-update-own','Update Own Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(46,'image-delete-all','Delete All Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(47,'image-delete-own','Delete Own Images',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(48,'book-view-all','View All Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(49,'book-view-own','View Own Books',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(50,'page-view-all','View All Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(51,'page-view-own','View Own Pages',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(52,'chapter-view-all','View All Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(53,'chapter-view-own','View Own Chapters',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(54,'attachment-create-all','Create All Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(55,'attachment-create-own','Create Own Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(56,'attachment-update-all','Update All Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(57,'attachment-update-own','Update Own Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(58,'attachment-delete-all','Delete All Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(59,'attachment-delete-own','Delete Own Attachments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(60,'comment-create-all','Create All Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(61,'comment-create-own','Create Own Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(62,'comment-update-all','Update All Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(63,'comment-update-own','Update Own Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(64,'comment-delete-all','Delete All Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(65,'comment-delete-own','Delete Own Comments',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(66,'bookshelf-view-all','View All BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(67,'bookshelf-view-own','View Own BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(68,'bookshelf-create-all','Create All BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(69,'bookshelf-create-own','Create Own BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(70,'bookshelf-update-all','Update All BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(71,'bookshelf-update-own','Update Own BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(72,'bookshelf-delete-all','Delete All BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(73,'bookshelf-delete-own','Delete Own BookShelves',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(74,'templates-manage','Manage Page Templates',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(75,'access-api','Access system API',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38'),(76,'content-export','Export Content',NULL,'2023-03-28 22:04:39','2023-03-28 22:04:39'),(77,'editor-change','Change page editor',NULL,'2023-03-28 22:04:39','2023-03-28 22:04:39');
/*!40000 ALTER TABLE `role_permissions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `role_user`
--

DROP TABLE IF EXISTS `role_user`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `role_user` (
  `user_id` int(10) unsigned NOT NULL,
  `role_id` int(10) unsigned NOT NULL,
  PRIMARY KEY (`user_id`,`role_id`),
  KEY `role_user_role_id_foreign` (`role_id`),
  CONSTRAINT `role_user_role_id_foreign` FOREIGN KEY (`role_id`) REFERENCES `roles` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `role_user_user_id_foreign` FOREIGN KEY (`user_id`) REFERENCES `users` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `role_user`
--

LOCK TABLES `role_user` WRITE;
/*!40000 ALTER TABLE `role_user` DISABLE KEYS */;
INSERT INTO `role_user` VALUES (1,1),(2,4);
/*!40000 ALTER TABLE `role_user` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `roles`
--

DROP TABLE IF EXISTS `roles`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `roles` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `display_name` varchar(191) DEFAULT NULL,
  `description` varchar(191) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `system_name` varchar(191) NOT NULL,
  `external_auth_id` varchar(180) NOT NULL DEFAULT '',
  `mfa_enforced` tinyint(1) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `roles_system_name_index` (`system_name`),
  KEY `roles_external_auth_id_index` (`external_auth_id`)
) ENGINE=InnoDB AUTO_INCREMENT=5 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `roles`
--

LOCK TABLES `roles` WRITE;
/*!40000 ALTER TABLE `roles` DISABLE KEYS */;
INSERT INTO `roles` VALUES (1,'Admin','Administrator of the whole application','2023-03-28 22:04:38','2023-03-28 22:04:38','admin','',0),(2,'Editor','User can edit Books, Chapters & Pages','2023-03-28 22:04:38','2023-03-28 22:04:38','','',0),(3,'Viewer','User can view books & their content behind authentication','2023-03-28 22:04:38','2023-03-28 22:04:38','','',0),(4,'Public','The role given to public visitors if allowed','2023-03-28 22:04:38','2023-03-28 22:04:38','public','',0);
/*!40000 ALTER TABLE `roles` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `search_terms`
--

DROP TABLE IF EXISTS `search_terms`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `search_terms` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `term` varchar(180) NOT NULL,
  `entity_type` varchar(100) NOT NULL,
  `entity_id` int(11) NOT NULL,
  `score` int(11) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `search_terms_term_index` (`term`),
  KEY `search_terms_entity_type_index` (`entity_type`),
  KEY `search_terms_entity_type_entity_id_index` (`entity_type`,`entity_id`),
  KEY `search_terms_score_index` (`score`)
) ENGINE=InnoDB AUTO_INCREMENT=48577 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `search_terms`
--

LOCK TABLES `search_terms` WRITE;
/*!40000 ALTER TABLE `search_terms` DISABLE KEYS */;
INSERT INTO `search_terms` VALUES (1,'test','book',1,48),(2,'New','page',1,40),(3,'Page','page',1,40),(4,'Grayspace','bookshelf',1,48),(1616,'Traffic-WebHost','page',8,40),(1617,'This','page',8,1),(1618,'hosts','page',8,1),(1619,'several','page',8,1),(1620,'websites','page',8,1),(1621,'that','page',8,1),(1622,'can','page',8,1),(1623,'be','page',8,1),(1624,'used','page',8,1),(1625,'by','page',8,1),(1626,'Ghost','page',8,1),(1627,'to','page',8,1),(1628,'create','page',8,1),(1629,'outbound','page',8,1),(1630,'http','page',8,1),(1631,'and','page',8,1),(1632,'https','page',8,1),(1633,'traffic','page',8,1),(1634,'from','page',8,1),(1635,'within','page',8,1),(1636,'a','page',8,1),(1637,'target','page',8,1),(1638,'domain','page',8,1),(1639,' ','page',8,1),(2205,'Register','book',5,48),(2206,'DNS','book',5,48),(4923,'test','chapter',1,48),(11729,'Network','book',2,48),(11730,'Overview','book',2,48),(11731,'Cyber','book',3,48),(11732,'Range','book',3,48),(11733,'Systems','book',3,48),(11734,'Overview','book',3,48),(11735,'How','book',4,48),(11736,'to','book',4,48),(11737,'Guides','book',4,48),(11770,'Network','page',3,40),(11771,'Diagram','page',3,40),(11772,'Notes','page',3,40),(11773,'SI-Router','page',3,3),(11774,'-','page',3,24),(11775,'This','page',3,21),(11776,'is','page',3,18),(11777,'a','page',3,19),(11778,'vyos','page',3,1),(11779,'router','page',3,4),(11780,'that','page',3,9),(11781,'handles','page',3,1),(11782,'all','page',3,6),(11783,'the','page',3,43),(11784,'routing','page',3,1),(11785,'within','page',3,1),(11786,'Cyber','page',3,8),(11787,'Range','page',3,7),(11788,'and','page',3,18),(11789,'to','page',3,38),(11790,'your','page',3,7),(11791,'target','page',3,14),(11792,'domains','page',3,6),(11793,' ','page',3,32),(11794,'It','page',3,2),(11795,'has','page',3,4),(11796,'4','page',3,1),(11797,'interfaces','page',3,1),(11798,'connect','page',3,5),(11799,'following','page',3,2),(11800,'virtual','page',3,4),(11801,'switches','page',3,1),(11802,'ServicesNet','page',3,2),(11803,'The','page',3,3),(11804,'will','page',3,9),(11805,'route','page',3,1),(11806,'several','page',3,2),(11807,'IP','page',3,6),(11808,'subnets','page',3,5),(11809,'related','page',3,1),(11810,'systems','page',3,4),(11811,'on','page',3,10),(11812,'network','page',3,5),(11813,'\r','page',3,16),(11814,'Grayspace','page',3,3),(11815,'apprx','page',3,1),(11816,'1500','page',3,1),(11817,'These','page',3,2),(11818,'are','page',3,5),(11819,'organized','page',3,1),(11820,'by','page',3,2),(11821,'geo-locations','page',3,2),(11822,'NRTS','page',3,7),(11823,'server','page',3,14),(11824,'To','page',3,2),(11825,'see','page',3,4),(11826,'list','page',3,2),(11827,'of','page',3,7),(11828,'available','page',3,1),(11829,'coorisponding','page',3,1),(11830,'look','page',3,1),(11831,'at','page',3,2),(11832,'/root/backbonerouters','page',3,1),(11833,'use','page',3,2),(11834,'these','page',3,2),(11835,'automate','page',3,1),(11836,'address','page',3,3),(11837,'assignments','page',3,1),(11838,'for','page',3,18),(11839,'various','page',3,3),(11840,'OPFOR','page',3,6),(11841,'infastructure','page',3,3),(11842,'services','page',3,4),(11843,'AdminNet','page',3,2),(11844,'used','page',3,9),(11845,'as','page',3,5),(11846,'allow','page',3,2),(11847,'VMs','page',3,2),(11848,'access','page',3,4),(11849,'real','page',3,10),(11850,'internet\r','page',3,1),(11851,'RangeWAN','page',3,3),(11852,'where','page',3,1),(11853,'you','page',3,8),(11854,'environment','page',3,3),(11855,'ServiceNet','page',3,1),(11856,'ESXI','page',3,3),(11857,'switch','page',3,3),(11858,'connects','page',3,2),(11859,'SI','page',3,2),(11860,'Used','page',3,1),(11861,'hosting','page',3,4),(11862,'RootDNS','page',3,3),(11863,'Web-services','page',3,1),(11864,'CA-Server','page',3,4),(11865,'Traffic-Gen','page',3,3),(11866,'Traffic-Web','page',3,1),(11867,'host','page',3,3),(11868,'servers','page',3,4),(11869,'Grayspaces','page',3,1),(11870,'DNS','page',3,5),(11871,'it','page',3,4),(11872,'been','page',3,1),(11873,'ed','page',3,1),(11874,'with','page',3,4),(11875,'world','page',3,8),(11876,'root','page',3,1),(11877,'IPs','page',3,1),(11878,'meaning','page',3,1),(11879,'A-root','page',3,1),(11880,'through','page',3,1),(11881,'M-root','page',3,1),(11882,'Additionally','page',3,2),(11883,'Googles','page',3,1),(11884,'8','page',3,4),(11885,'managing','page',3,1),(11886,'grayspace','page',3,2),(11887,'You','page',3,2),(11888,'can','page',3,6),(11889,'register','page',3,1),(11890,'manually','page',3,1),(11891,'or','page',3,3),(11892,'automation','page',3,1),(11893,'scripts','page',3,1),(11894,'build','page',3,5),(11895,'For','page',3,3),(11896,'more','page',3,4),(11897,'details','page',3,5),(11898,'configuration','page',3,1),(11899,'Detailed','page',3,1),(11900,'Configurations','page',3,1),(11901,'rootDNS','page',3,1),(11902,'Web-Services','page',3,1),(11903,'provides','page',3,3),(11904,'few','page',3,1),(11905,'simulated','page',3,4),(11906,'be','page',3,4),(11907,'general','page',3,1),(11908,'range','page',3,8),(11909,'management','page',3,1),(11910,'in','page',3,12),(11911,'docker','page',3,3),(11912,'containers','page',3,3),(11913,'provide','page',3,2),(11914,'Redbook','page',3,1),(11915,'com','page',3,5),(11916,'bookstack','page',3,2),(11917,'app','page',3,1),(11918,'currently','page',3,1),(11919,'looking','page',3,1),(11920,'documentation','page',3,2),(11921,'covers','page',3,1),(11922,'an','page',3,7),(11923,'overview','page',3,1),(11924,'also','page',3,2),(11925,'expand','page',3,1),(11926,'upon','page',3,1),(11927,'this','page',3,9),(11928,'own','page',3,1),(11929,'whatever','page',3,4),(11930,'dropbox','page',3,1),(11931,'owncloud','page',3,1),(11932,'cloud','page',3,1),(11933,'based','page',3,1),(11934,'file','page',3,1),(11935,'service','page',3,1),(11936,'web','page',3,1),(11937,'dav','page',3,1),(11938,'api','page',3,1),(11939,'s','page',3,4),(11940,'additional','page',3,1),(11941,'ways','page',3,1),(11942,'payloads','page',3,1),(11943,'See','page',3,3),(11944,'section','page',3,3),(11945,'some','page',3,1),(11946,'methods','page',3,1),(11947,'pastebin','page',3,2),(11948,'haste','page',3,1),(11949,'bin','page',3,1),(11950,'code','page',3,2),(11951,'snippets','page',3,1),(11952,'pulled','page',3,1),(11953,'from','page',3,2),(11954,'needs','page',3,1),(11955,'diagrams','page',3,2),(11956,'net','page',3,1),(11957,'draw','page',3,1),(11958,'io','page',3,1),(11959,'generating','page',3,1),(11960,'diagram','page',3,1),(11961,'want','page',3,3),(11962,'Its','page',3,1),(11963,'integrated','page',3,1),(11964,'into','page',3,1),(11965,'redbook','page',3,1),(11966,'was','page',3,1),(11967,'make','page',3,2),(11968,'found','page',3,1),(11969,'documenation','page',3,1),(11970,'openssl','page',3,1),(11971,'certificate','page',3,2),(11972,'authority','page',3,2),(11973,'intermediate','page',3,1),(11974,'simulate','page',3,1),(11975,'CA','page',3,1),(11976,'SSL','page',3,2),(11977,'certificates','page',3,1),(11978,'training','page',3,1),(11979,'In','page',3,1),(11980,'order','page',3,1),(11981,'certs','page',3,3),(11982,'trusted','page',3,2),(11983,'domain','page',3,8),(11984,'environments','page',3,1),(11985,'need','page',3,1),(11986,'copy','page',3,1),(11987,'ca','page',3,1),(11988,'globalcert','page',3,2),(11989,'crt','page',3,2),(11990,'pem','page',3,2),(11991,'int','page',3,1),(11992,'over','page',3,1),(11993,'controller','page',3,1),(11994,'add','page',3,4),(11995,'them','page',3,1),(11996,'Trust','page',3,1),(11997,'stores','page',3,1),(11998,'via','page',3,1),(11999,'GPO','page',3,1),(12000,'xxx','page',3,1),(12001,'how','page',3,2),(12002,'do','page',3,1),(12003,'Once','page',3,2),(12004,'done','page',3,1),(12005,'any','page',3,2),(12006,'create','page',3,2),(12007,'appear','page',3,1),(12008,'generate','page',3,1),(12009,'well','page',3,1),(12010,'signing','page',3,1),(12011,'binarys','page',3,1),(12012,'ubuntu','page',3,4),(12013,'running','page',3,3),(12014,'customizable','page',3,1),(12015,'send','page',3,1),(12016,'emails','page',3,1),(12017,'users','page',3,1),(12018,'traffic','page',3,2),(12019,'information','page',3,1),(12020,'Traffic-WebHost','page',3,1),(12021,'apache','page',3,1),(12022,'websites','page',3,2),(12023,'exists','page',3,1),(12024,'allow ','page',3,1),(12025,'Ghost','page',3,1),(12026,'agents','page',3,1),(12027,'able','page',3,1),(12028,'open','page',3,1),(12029,'browsers','page',3,1),(12030,'hit','page',3,1),(12031,'generation','page',3,1),(12032,'purposes','page',3,1),(12033,'By','page',3,1),(12034,'default','page',3,1),(12035,'instructions','page',3,1),(12036,'out','page',3,2),(12037,'Kali','page',3,2),(12038,'FlareVM','page',3,2),(12039,'Feel','page',3,1),(12040,'free','page',3,1),(12041,'else','page',3,1),(12042,'Not','page',3,1),(12043,'Red','page',3,1),(12044,'Team','page',3,1),(12045,'Server','page',3,1),(12046,'customized','page',3,1),(12047,'red','page',3,1),(12048,'team','page',3,1),(12049,'basic','page',3,2),(12050,'kali','page',3,1),(12051,'tools','page',3,1),(12052,'windows','page',3,1),(12053,'VM','page',3,4),(12054,'but','page',3,1),(12055,'I','page',3,1),(12056,'would','page',3,1),(12057,'advise','page',3,1),(12058,'installing','page',3,1),(12059,'Visual','page',3,1),(12060,'Studios','page',3,1),(12061,'Switch','page',3,1),(12062,'enable','page',3,1),(12063,'internet','page',3,4),(12064,'There','page',3,1),(12065,'main','page',3,1),(12066,'AdminNet-DHCP','page',3,1),(12067,'IA-Proxy','page',3,2),(12068,'cyber','page',3,4),(12069,'have','page',3,1),(12070,'secondary','page',3,1),(12071,'nic','page',3,1),(12072,'built','page',3,1),(12073,'automatically','page',3,1),(12074,'get','page',3,1),(12075,'DHCP','page',3,2),(12076,'lease','page',3,1),(12077,'172','page',3,1),(12078,'30','page',3,2),(12079,'0','page',3,2),(12080,'0/21','page',3,1),(12081,'subnet','page',3,1),(12082,'Adminnet-DHCP','page',3,1),(12083,'exception','page',3,1),(12084,'preferable','page',3,1),(12085,'proxy','page',3,4),(12086,'its','page',3,1),(12087,'verses','page',3,1),(12088,'using','page',3,1),(12089,'reason','page',3,1),(12090,'better','page',3,1),(12091,'explained','page',3,2),(12092,'planning','page',3,2),(12093,'squid','page',3,1),(12094,'just','page',3,1),(12095,'set','page',3,1),(12096,'http','page',3,1),(12097,'//172','page',3,1),(12098,'2','page',3,1),(12099,'9999','page',3,1),(12100,'connection','page',3,2),(12101,'one','page',3,1),(12102,'ve','page',3,1),(12103,'pick','page',3,1),(12104,'public','page',3,1),(12105,'WAN','page',3,1),(12106,'point','page',3,1),(12107,'virual','page',3,1),(12108,'Then','page',3,1),(12109,'edit','page',3,1),(12110,'interface','page',3,1),(12111,'complete','page',3,1),(12112,'More','page',3,1),(12113,'specific','page',3,1),(15942,'Managing','page',20,40),(15943,'DNS','page',20,49),(15944,'ManageDNS','page',20,40),(15945,'sh','page',20,44),(15946,'The','page',20,3),(15947,'Cyber','page',20,1),(15948,'range','page',20,1),(15949,'is','page',20,6),(15950,'designed','page',20,1),(15951,'for','page',20,7),(15952,'Red','page',20,1),(15953,'Team','page',20,1),(15954,'domain','page',20,2),(15955,'name','page',20,1),(15956,'registration','page',20,1),(15957,'via','page',20,1),(15958,'the','page',20,22),(15959,'NRTS','page',20,6),(15960,'server','page',20,5),(15961,' ','page',20,9),(15962,'various','page',20,1),(15963,'service','page',20,1),(15964,'scripts','page',20,1),(15965,'interact','page',20,1),(15966,'with','page',20,2),(15967,'RootDNS','page',20,2),(15968,'to','page',20,10),(15969,'create','page',20,1),(15970,'and','page',20,4),(15971,'register','page',20,2),(15972,'domains','page',20,2),(15973,'To','page',20,2),(15974,'help','page',20,1),(15975,'management','page',20,1),(15976,'there','page',20,2),(15977,'a','page',20,10),(15978,'script','page',20,4),(15979,'on','page',20,4),(15980,'that','page',20,3),(15981,'can','page',20,3),(15982,'view','page',20,2),(15983,'delete','page',20,4),(15984,'records','page',20,7),(15985,'from','page',20,2),(15986,'rootDNS','page',20,1),(15987,'enable','page',20,1),(15988,'these','page',20,1),(15989,'every','page',20,1),(15990,'time','page',20,1),(15991,'remotely','page',20,1),(15992,'adds','page',20,2),(15993,'it','page',20,5),(15994,'will','page',20,5),(15995,'tag','page',20,6),(15996,'in','page',20,2),(15997,'both','page',20,1),(15998,'zone','page',20,2),(15999,'reference','page',20,1),(16000,'config','page',20,1),(16001,'file','page',20,2),(16002,'as','page',20,4),(16003,'well','page',20,1),(16004,'each','page',20,1),(16005,'Then','page',20,1),(16006,'user','page',20,3),(16007,'created','page',20,1),(16008,'under','page',20,1),(16009,'also','page',20,1),(16010,'elect','page',20,1),(16011,'specific','page',20,1),(16012,'doing','page',20,1),(16013,'this','page',20,2),(16014,'resides','page',20,1),(16015,'any','page',20,1),(16016,'at','page',20,1),(16017,'/root/scripts/manageDNS','page',20,1),(16018,'NOTE','page',20,1),(16019,'if','page',20,1),(16020,'you','page',20,5),(16021,'want','page',20,1),(16022,'outside','page',20,1),(16023,'of','page',20,6),(16024,'automation','page',20,1),(16025,'built','page',20,1),(16026,'into','page',20,1),(16027,'buildredteam','page',20,1),(16028,'another','page',20,1),(16029,'called','page',20,1),(16030,'RegisterDNS','page',20,1),(16031,'For','page',20,2),(16032,'usage','page',20,1),(16033,'go','page',20,1),(16034,'-','page',20,4),(16035,'How','page',20,1),(16036,'guides','page',20,1),(16037,'Manual','page',20,1),(16038,'Domain','page',20,1),(16039,'Registration','page',20,1),(16040,'Launch','page',20,1),(16041,'cd','page',20,1),(16042,'/root/scripts\r','page',20,1),(16043,'/ManageDNS','page',20,1),(16044,'This','page',20,1),(16045,'bring','page',20,3),(16046,'up','page',20,3),(16047,'text','page',20,1),(16048,'based','page',20,1),(16049,'menu','page',20,2),(16050,'below','page',20,3),(16051,'\r','page',20,12),(16052,'Option','page',20,2),(16053,'1','page',20,1),(16054,'View','page',20,2),(16055,'list','page',20,2),(16056,'Tags','page',20,1),(16057,'shown','page',20,2),(16058,'below\r','page',20,1),(16059,'From','page',20,1),(16060,'pick','page',20,1),(16061,'an','page',20,1),(16062,'option','page',20,2),(16063,'see','page',20,1),(16064,'have','page',20,1),(16065,'been','page',20,1),(16066,'registered','page',20,1),(16067,'selected','page',20,1),(16068,'example','page',20,1),(16069,'2','page',20,2),(16070,'OPFOR-chip-test','page',20,1),(16071,'Delete','page',20,1),(16072,'tags','page',20,1),(16073,'When','page',20,1),(16074,'select','page',20,1),(16075,'give','page',20,1),(16076,'warning','page',20,1),(16077,'10','page',20,1),(16078,'second','page',20,2),(16079,'delay','page',20,2),(16080,'allow','page',20,1),(16081,'CTRL-C','page',20,1),(16082,'out','page',20,1),(16083,'If','page',20,1),(16084,'selects','page',20,1),(16085,'all','page',20,1),(16086,'30','page',20,1),(16087,'same','page',20,1),(16088,'reason','page',20,1),(16089,'Here','page',20,2),(16090,'screenshot','page',20,1),(16091,'showing','page',20,1),(16092,'deletion','page',20,1),(16093,'OPFOR-Chip-test','page',20,1),(16094,'what','page',20,1),(16095,'shows','page',20,1),(16096,'when','page',20,1),(16097,'enter','page',20,1),(16098,'y','page',20,1),(16099,'continue','page',20,1),(16147,'Default','book',7,48),(16148,'Creds','book',7,48),(16149,'for','book',7,48),(16150,'all','book',7,48),(16151,'the','book',7,48),(16152,'things','book',7,48),(16215,'Cred','page',22,40),(16216,'list','page',22,40),(16217,'System','page',22,1),(16218,'\r','page',22,56),(16219,'Username','page',22,1),(16220,'Password','page',22,1),(16221,'IA-Proxy','page',22,1),(16222,'user','page',22,7),(16223,'&','page',22,7),(16224,'root','page',22,7),(16225,'toor','page',22,10),(16226,'CA-Server','page',22,1),(16227,'rootDNS','page',22,1),(16228,'web-services','page',22,1),(16229,'Traffic-Gen','page',22,1),(16230,'Traffic-WebHost','page',22,1),(16231,'NRTS','page',22,1),(16232,'Adminnet-DHCP','page',22,1),(16233,'vyos','page',22,2),(16234,'SI-router','page',22,1),(16235,'redbook','page',22,1),(16236,'com','page',22,3),(16237,'web','page',22,2),(16238,'GUI','page',22,2),(16239,'bookstack','page',22,1),(16240,'admin@admin','page',22,1),(16241,'toortoor\r','page',22,1),(16242,'dropbox','page',22,1),(16243,'owncloud','page',22,1),(16244,'admin','page',22,1),(18533,'New','page',23,40),(18534,'Page','page',23,40),(18535,'New','page',24,40),(18536,'Page','page',24,40),(18579,'Using','book',6,48),(18580,'the','book',6,50),(18581,'NRTS','book',6,50),(18582,'The','book',6,1),(18583,'Not','book',6,1),(18584,'Red','book',6,1),(18585,'Team','book',6,1),(18586,'Server','book',6,1),(18587,'is','book',6,1),(18588,'swiss','book',6,1),(18589,'army','book',6,1),(18590,'knife','book',6,1),(18591,'for','book',6,2),(18592,'building','book',6,1),(18593,'red','book',6,1),(18594,'team','book',6,1),(18595,'infrastructure','book',6,1),(18596,'  ','book',6,1),(18597,'This','book',6,1),(18598,'guide','book',6,1),(18599,'will','book',6,1),(18600,'provide','book',6,1),(18601,'step','book',6,2),(18602,'by','book',6,1),(18603,'instructions','book',6,1),(18604,'using','book',6,1),(18605,'it','book',6,1),(18606,'s','book',6,1),(18607,'key','book',6,1),(18608,'features','book',6,1),(18609,'For','book',6,1),(18610,'details','book',6,1),(18611,'on','book',6,1),(18612,'file','book',6,1),(18613,'structure','book',6,1),(18614,'go','book',6,1),(18615,'to','book',6,1),(18616,'-','book',6,2),(18617,'Cyber','book',6,1),(18618,'Range','book',6,1),(18619,'Systems','book',6,1),(18620,'Overview','book',6,1),(19694,'Making','page',16,40),(19695,'a','page',16,66),(19696,'NGINX','page',16,46),(19697,'Redirector','page',16,40),(19698,'buildredteam','page',16,40),(19699,'sh','page',16,40),(19700,' NOTE','page',16,1),(19701,'The','page',16,6),(19702,'NRTS','page',16,3),(19703,'is','page',16,12),(19704,'designed','page',16,2),(19705,'to','page',16,44),(19706,'run','page',16,2),(19707,'red','page',16,1),(19708,'team','page',16,2),(19709,'infrastructure','page',16,1),(19710,'using','page',16,2),(19711,'docker','page',16,5),(19712,'containers','page',16,2),(19713,' ','page',16,39),(19714,'Building','page',16,1),(19715,'these','page',16,3),(19716,'out','page',16,4),(19717,'and','page',16,16),(19718,'managing','page',16,1),(19719,'the','page',16,65),(19720,'network','page',16,1),(19721,'for','page',16,22),(19722,'this','page',16,25),(19723,'best','page',16,1),(19724,'left','page',16,1),(19725,'up','page',16,5),(19726,'script','page',16,7),(19727,'do','page',16,3),(19728,'so','page',16,5),(19729,'NOTE','page',16,2),(19730,'redirector','page',16,7),(19731,'can','page',16,11),(19732,'be','page',16,7),(19733,'use','page',16,14),(19734,'with','page',16,4),(19735,'most','page',16,1),(19736,'C2','page',16,2),(19737,'servers','page',16,1),(19738,'redirect','page',16,4),(19739,'DNS','page',16,6),(19740,'traffic','page',16,1),(19741,'This','page',16,14),(19742,'guide','page',16,3),(19743,'assuming','page',16,1),(19744,'you','page',16,32),(19745,'already','page',16,2),(19746,'have','page',16,8),(19747,'Cobalt','page',16,2),(19748,'Strike','page',16,2),(19749,'or','page',16,7),(19750,'other','page',16,1),(19751,'server','page',16,4),(19752,'running','page',16,6),(19753,'For','page',16,11),(19754,'example','page',16,15),(19755,'we','page',16,14),(19756,'ll','page',16,12),(19757,'assume','page',16,1),(19758,'teamserver','page',16,4),(19759,'at','page',16,4),(19760,'54','page',16,2),(19761,'88','page',16,2),(19762,'220','page',16,2),(19763,'10','page',16,2),(19764,'Use','page',16,2),(19765,'following','page',16,1),(19766,'start','page',16,2),(19767,'on','page',16,6),(19768,'an','page',16,3),(19769,'\r','page',16,6),(19770,'/root/scripts/buildredteam','page',16,1),(19771,'sh\r','page',16,1),(19772,'will','page',16,29),(19773,'bring','page',16,1),(19774,'text-based','page',16,1),(19775,'menu','page',16,13),(19776,'seen','page',16,1),(19777,'below','page',16,4),(19778,'select','page',16,11),(19779,'Option','page',16,5),(19780,'1','page',16,6),(19781,'Set','page',16,1),(19782,'http','page',16,1),(19783,'https','page',16,1),(19784,'Next','page',16,8),(19785,'it','page',16,23),(19786,'ask','page',16,6),(19787,'service','page',16,2),(19788,'tag','page',16,2),(19789,'by','page',16,3),(19790,'default','page',16,5),(19791,'give','page',16,3),(19792,'RD1','page',16,3),(19793,'if','page',16,4),(19794,'there','page',16,3),(19795,'of','page',16,15),(19796,'RD2','page',16,1),(19797,'You','page',16,4),(19798,'keep','page',16,1),(19799,'set','page',16,11),(19800,'your','page',16,9),(19801,'own','page',16,1),(19802,'name','page',16,5),(19803,'folder','page',16,3),(19804,'creates','page',16,1),(19805,'in','page',16,3),(19806,'/root/services','page',16,1),(19807,'its','page',16,1),(19808,'container','page',16,5),(19809,'build','page',16,5),(19810,'also','page',16,1),(19811,'itself','page',16,1),(19812,'leave','page',16,2),(19813,'asks','page',16,4),(19814,'number','page',16,2),(19815,'IPs','page',16,9),(19816,'5','page',16,1),(19817,'Geo-location','page',16,2),(19818,'base','page',16,1),(19819,'setting','page',16,1),(19820,'IP','page',16,24),(19821,'s','page',16,6),(19822,'has','page',16,2),(19823,'list','page',16,6),(19824,'subnets','page',16,4),(19825,'stored','page',16,1),(19826,'based','page',16,1),(19827,'structure','page',16,1),(19828,'/root/backbonerouters','page',16,1),(19829,'option','page',16,8),(19830,'4','page',16,2),(19831,'Canada','page',16,1),(19832,'Then','page',16,2),(19833,'narrows','page',16,1),(19834,'down','page',16,2),(19835,'city','page',16,1),(19836,'Toronto','page',16,1),(19837,'want','page',16,5),(19838,'manually','page',16,4),(19839,'randomly','page',16,6),(19840,'walk','page',16,2),(19841,'through','page',16,2),(19842,'both','page',16,2),(19843,'options','page',16,2),(19844,'Setting','page',16,2),(19845,'-','page',16,4),(19846,'random','page',16,2),(19847,'When','page',16,2),(19848,'add','page',16,1),(19849,'during','page',16,2),(19850,'processing','page',16,2),(19851,'move','page',16,1),(19852,'next','page',16,6),(19853,'step','page',16,1),(19854,'shown','page',16,3),(19855,'after','page',16,2),(19856,'going','page',16,2),(19857,'over','page',16,2),(19858,'Manual','page',16,2),(19859,'IPs ','page',16,1),(19860,'2','page',16,3),(19861,'Manually','page',16,2),(19862,'few','page',16,1),(19863,'screenshots','page',16,1),(19864,'shows','page',16,3),(19865,'manual','page',16,5),(19866,'process','page',16,5),(19867,'Below','page',16,3),(19868,'when','page',16,3),(19869,'At','page',16,3),(19870,'screen','page',16,1),(19871,'enter','page',16,9),(19872,'see','page',16,4),(19873,'from','page',16,4),(19874,'screenshot','page',16,1),(19875,'show','page',16,2),(19876,'available','page',16,2),(19877,'Subnets','page',16,1),(19878,'information','page',16,3),(19879,'long','page',16,1),(19880,'spacebar','page',16,1),(19881,'page','page',16,1),(19882,'then','page',16,3),(19883,'q','page',16,2),(19884,'press','page',16,4),(19885,'exit','page',16,2),(19886,'subnet','page',16,3),(19887,'view','page',16,2),(19888,'get','page',16,3),(19889,'back','page',16,4),(19890,'previous','page',16,1),(19891,'Using','page',16,1),(19892,'any','page',16,1),(19893,'I','page',16,1),(19894,'72','page',16,3),(19895,'3','page',16,3),(19896,'244','page',16,3),(19897,'20','page',16,2),(19898,'1/25','page',16,1),(19899,'but','page',16,2),(19900,'multiple','page',16,1),(19901,'Press','page',16,1),(19902,'get ','page',16,1),(19903,'first','page',16,1),(19904,'blank','page',16,1),(19905,'space','page',16,1),(19906,'brings','page',16,2),(19907,'entry','page',16,1),(19908,'Once','page',16,2),(19909,'ve','page',16,3),(19910,'pressed','page',16,2),(19911,'goes','page',16,1),(19912,'slot','page',16,1),(19913,'one','page',16,1),(19914,'populated','page',16,2),(19915,'continue','page',16,1),(19916,'until','page',16,1),(19917,'filled','page',16,1),(19918,'all','page',16,3),(19919,'blanks','page',16,1),(19920,'d','page',16,2),(19921,'done','page',16,1),(19922,'point','page',16,2),(19923,'either','page',16,2),(19924,'selected','page',16,2),(19925,'generated','page',16,4),(19926,'which','page',16,1),(19927,'us','page',16,1),(19928,'that','page',16,5),(19929,'what','page',16,1),(19930,'ports','page',16,1),(19931,'as','page',16,1),(19932,'  ','page',16,2),(19933,'HTTP','page',16,1),(19934,'HTTPS','page',16,3),(19935,'different','page',16,3),(19936,'port','page',16,5),(19937,'bind','page',16,2),(19938,'related','page',16,1),(19939,'feature','page',16,1),(19940,'where','page',16,2),(19941,'listener','page',16,1),(19942,'payload','page',16,2),(19943,'still','page',16,1),(19944,'443','page',16,1),(19945,'listen','page',16,1),(19946,'like','page',16,2),(19947,'say','page',16,1),(19948,'8443','page',16,1),(19949,'need','page',16,3),(19950,'something','page',16,1),(19951,'however','page',16,1),(19952,'since','page',16,1),(19953,'redirectors','page',16,1),(19954,'are','page',16,4),(19955,'isn','page',16,1),(19956,'t','page',16,1),(19957,'really','page',16,1),(19958,'screenshoot','page',16,1),(19959,'each','page',16,1),(19960,'being','page',16,1),(19961,'redirected','page',16,1),(19962,'should','page',16,4),(19963,'let','page',16,1),(19964,'create','page',16,2),(19965,'domain','page',16,14),(19966,'names','page',16,5),(19967,'necessary','page',16,1),(19968,'whenever','page',16,1),(19969,'generator','page',16,1),(19970,'CA','page',16,2),(19971,'signed','page',16,2),(19972,'SSL','page',16,1),(19973,'certificates','page',16,1),(19974,'automatically','page',16,1),(19975,'connect','page',16,1),(19976,'they','page',16,1),(19977,'used','page',16,2),(19978,'Random','page',16,1),(19979,'Assigning','page',16,2),(19980,'domains','page',16,3),(19981,'one/s','page',16,1),(19982,'generate','page',16,1),(19983,'just','page',16,1),(19984,'moves','page',16,1),(19985,'names/s','page',16,1),(19986,'take','page',16,1),(19987,'Note','page',16,1),(19988,'205','page',16,1),(19989,'225','page',16,1),(19990,'141','page',16,1),(19991,'68','page',16,1),(19992,'Enter','page',16,1),(19993,'goatfarmer','page',16,1),(19994,'com','page',16,1),(19995,'entered','page',16,1),(19996,'takes','page',16,1),(19997,'repeat','page',16,1),(19998,'finished','page',16,1),(19999,'completed','page',16,1),(20000,'adding','page',16,1),(20001,'identify','page',16,1),(20002,'later','page',16,1),(20003,'remove','page',16,1),(20004,'them','page',16,1),(20005,'test-DNS','page',16,1),(20006,'Now','page',16,1),(20007,'needs','page',16,1),(20008,'Review','page',16,1),(20009,'settings','page',16,1),(20010,'happy','page',16,1),(20011,'now','page',16,1),(20012,'about','page',16,1),(20013,'/root/services/RD1','page',16,1),(20014,'To','page',16,1),(20015,'check','page',16,1),(20016,'ps','page',16,1),(20017,'Docker','page',16,1),(20018,'Tag','page',16,1),(20019,'above','page',16,1),(20319,'Phishing','page',18,41),(20320,'Attack','page',18,40),(20321,'buildredteam','page',18,40),(20322,'sh','page',18,43),(20323,'NOTE','page',18,2),(20324,'The','page',18,8),(20325,'attack','page',18,9),(20326,'option','page',18,8),(20327,'doesn','page',18,1),(20328,'t','page',18,3),(20329,'build','page',18,2),(20330,'a','page',18,21),(20331,'docker','page',18,1),(20332,'container','page',18,1),(20333,' ','page',18,41),(20334,'Instead','page',18,2),(20335,'it','page',18,8),(20336,'sets','page',18,1),(20337,'up','page',18,6),(20338,'the','page',18,55),(20339,'NRTS','page',18,4),(20340,'host','page',18,1),(20341,'to','page',18,40),(20342,'perform','page',18,1),(20343,'phishing','page',18,6),(20344,'This','page',18,10),(20345,'step','page',18,2),(20346,'is','page',18,9),(20347,'just','page',18,1),(20348,'preparing','page',18,1),(20349,'mimic','page',18,1),(20350,'domain','page',18,10),(20351,'for','page',18,13),(20352,'sending','page',18,2),(20353,'phish','page',18,9),(20354,'Use','page',18,2),(20355,'following','page',18,2),(20356,'script','page',18,10),(20357,'set','page',18,11),(20358,'on','page',18,5),(20359,'an','page',18,6),(20360,'server','page',18,3),(20361,'\r','page',18,13),(20362,'/root/scripts/buildredteam','page',18,1),(20363,'sh\r','page',18,4),(20364,'will','page',18,16),(20365,'bring','page',18,2),(20366,'text-based','page',18,1),(20367,'menu','page',18,6),(20368,'seen','page',18,1),(20369,'below','page',18,3),(20370,'select','page',18,6),(20371,'5','page',18,1),(20372,'Set','page',18,3),(20373,'then','page',18,6),(20374,'ask','page',18,5),(20375,'geo-location','page',18,1),(20376,'based','page',18,1),(20377,'IP','page',18,16),(20378,'first','page',18,1),(20379,'country','page',18,1),(20380,'For','page',18,3),(20381,'this','page',18,13),(20382,'example','page',18,5),(20383,'we','page',18,10),(20384,'ll','page',18,6),(20385,'use','page',18,8),(20386,'China','page',18,1),(20387,'Next','page',18,2),(20388,'you','page',18,24),(20389,'city','page',18,1),(20390,'Beijing','page',18,1),(20391,'if','page',18,3),(20392,'want','page',18,8),(20393,'randomly','page',18,6),(20394,'generated','page',18,5),(20395,'or','page',18,4),(20396,'manually','page',18,6),(20397,'guide','page',18,2),(20398,'walk','page',18,2),(20399,'through','page',18,2),(20400,'both','page',18,2),(20401,'paths','page',18,2),(20402,'Setting','page',18,1),(20403,'IPs','page',18,5),(20404,'-','page',18,3),(20405,'Option','page',18,4),(20406,'1','page',18,3),(20407,'random','page',18,2),(20408,'When','page',18,2),(20409,'take','page',18,2),(20410,'note','page',18,1),(20411,'of','page',18,8),(20412,'and','page',18,13),(20413,'assign','page',18,4),(20414,'during','page',18,2),(20415,'processing','page',18,2),(20416,'simply','page',18,1),(20417,'next','page',18,3),(20418,'be','page',18,3),(20419,'shown','page',18,1),(20420,'after','page',18,3),(20421,'going','page',18,2),(20422,'over','page',18,2),(20423,'process','page',18,1),(20424,'Setting ','page',18,1),(20425,'2','page',18,2),(20426,'provide','page',18,2),(20427,'Before','page',18,1),(20428,'can','page',18,3),(20429,'one','page',18,1),(20430,'need','page',18,1),(20431,'know','page',18,1),(20432,'what','page',18,3),(20433,'subnets','page',18,3),(20434,'are','page',18,3),(20435,'available','page',18,2),(20436,'Geo-location','page',18,2),(20437,'previously','page',18,1),(20438,'selected','page',18,6),(20439,'Enter','page',18,1),(20440,'s','page',18,1),(20441,'at','page',18,4),(20442,'see','page',18,1),(20443,'list','page',18,6),(20444,'Below','page',18,3),(20445,'screenshot','page',18,2),(20446,'subnet','page',18,5),(20447,'view','page',18,2),(20448,'vary','page',18,1),(20449,'in','page',18,5),(20450,'size','page',18,1),(20451,'depending','page',18,1),(20452,'hit','page',18,3),(20453,'spacebar','page',18,1),(20454,'page','page',18,1),(20455,'down','page',18,1),(20456,'type','page',18,1),(20457,'q','page',18,2),(20458,'enter','page',18,4),(20459,'exit','page',18,2),(20460,'out','page',18,2),(20461,'thte','page',18,1),(20462,'get','page',18,2),(20463,'back','page',18,1),(20464,'input','page',18,1),(20465,'95','page',18,2),(20466,'213','page',18,2),(20467,'0','page',18,1),(20468,'1/22','page',18,1),(20469,'our','page',18,3),(20470,'30','page',18,1),(20471,'Type','page',18,1),(20472,'that','page',18,5),(20473,'falls','page',18,1),(20474,'within','page',18,1),(20475,'do','page',18,1),(20476,'not','page',18,1),(20477,'actual','page',18,1),(20478,'listed','page',18,1),(20479,'from','page',18,3),(20480,'At','page',18,2),(20481,'point','page',18,2),(20482,'have','page',18,7),(20483,'screen','page',18,2),(20484,'asks','page',18,1),(20485,'how','page',18,1),(20486,'Domain','page',18,3),(20487,'name','page',18,4),(20488,'Again','page',18,1),(20489,'done','page',18,1),(20490,'Assigning','page',18,2),(20491,'names','page',18,3),(20492,'- ','page',18,1),(20493,'one/s','page',18,1),(20494,'move','page',18,1),(20495,'We','page',18,1),(20496,'cover','page',18,1),(20497,'manual','page',18,1),(20498,'Manually','page',18,1),(20499,'create','page',18,1),(20500,'name/s','page',18,1),(20501,'  ','page',18,1),(20502,'Selecting','page',18,1),(20503,'up ','page',18,1),(20504,'It','page',18,1),(20505,'goatfarmer','page',18,1),(20506,'com','page',18,2),(20507,'either','page',18,1),(20508,'Tag','page',18,1),(20509,'your','page',18,9),(20510,'DNS','page',18,3),(20511,'tag','page',18,1),(20512,'used','page',18,4),(20513,'identify','page',18,1),(20514,'later','page',18,1),(20515,'like','page',18,1),(20516,'say','page',18,1),(20517,'engagement','page',18,1),(20518,'remove','page',18,1),(20519,'records','page',18,1),(20520,'test-DNS','page',18,1),(20521,'Finally','page',18,1),(20522,'has','page',18,1),(20523,'all','page',18,1),(20524,'information','page',18,2),(20525,'needs','page',18,3),(20526,'Press','page',18,1),(20527,'preparation','page',18,1),(20528,'edits','page',18,1),(20529,'postfix','page',18,1),(20530,'configuration','page',18,1),(20531,'match','page',18,2),(20532,'ve','page',18,1),(20533,'register','page',18,1),(20534,'rootDNS','page',18,1),(20535,'address','page',18,5),(20536,'After','page',18,1),(20537,'scripts','page',18,3),(20538,'/root/scripts/phish','page',18,2),(20539,'send','page',18,4),(20540,'In','page',18,1),(20541,'directory','page',18,1),(20542,'there','page',18,1),(20543,'two','page',18,1),(20544,'attacks','page',18,1),(20545,'They','page',18,1),(20546,'spam','page',18,1),(20547,'some','page',18,1),(20548,'modify','page',18,1),(20549,'these','page',18,1),(20550,'/root/scripts/phish/phish','page',18,1),(20551,'single','page',18,1),(20552,'email','page',18,6),(20553,'modified','page',18,1),(20554,' \r','page',18,3),(20555,'vi','page',18,1),(20556,'top','page',18,1),(20557,'lines','page',18,1),(20558,'From','page',18,1),(20559,'Edit','page',18,1),(20560,'realname','page',18,1),(20561,'prior','page',18,1),(20562,'whatever','page',18,1),(20563,'username','page',18,1),(20564,'Then','page',18,2),(20565,'last','page',18,1),(20566,'line','page',18,2),(20567,'Place','page',18,1),(20568,'subject','page',18,1),(20569,'edit','page',18,1),(20570,'/root/scripts/phish/body','page',18,1),(20571,'txt','page',18,2),(20572,'body','page',18,1),(20573,'attachment','page',18,3),(20574,'replace','page',18,2),(20575,'/root/scripts/phish/bad','page',18,1),(20576,'exe','page',18,1),(20577,'with','page',18,2),(20578,'If','page',18,1),(20579,'don','page',18,2),(20580,'delete','page',18,1),(20581,'-a','page',18,1),(20582,'/path','page',18,1),(20583,'end','page',18,1),(20584,'target@domain','page',18,1),(20585,'/root/scripts/phish/spam','page',18,1),(20586,'addresses','page',18,2),(20587,'edited','page',18,1),(20588,'change','page',18,1),(20589,'similar','page',18,1),(20590,'above','page',18,1),(20591,'instructions','page',18,1),(20592,'only','page',18,1),(20593,'difference','page',18,1),(20594,'here','page',18,1),(20595,'add','page',18,2),(20596,'target','page',18,2),(20597,'/root/scripts/phish/emaillist','page',18,1),(20598,'Managing','page',19,40),(20599,'Services','page',19,40),(20600,'buildredteam','page',19,40),(20601,'sh','page',19,42),(20602,'Then','page',19,2),(20603,'NRTS','page',19,5),(20604,'builds','page',19,1),(20605,'red','page',19,2),(20606,'team','page',19,2),(20607,'infrastructure','page',19,2),(20608,'in','page',19,3),(20609,'docker','page',19,2),(20610,'containers','page',19,3),(20611,' ','page',19,15),(20612,'These','page',19,1),(20613,'and','page',19,5),(20614,'services','page',19,1),(20615,'can','page',19,5),(20616,'be','page',19,3),(20617,'managed','page',19,1),(20618,'using','page',19,1),(20619,'the','page',19,23),(20620,'/root/scripts/buildredteam','page',19,2),(20621,'NOTE','page',19,2),(20622,'phishing','page',19,5),(20623,'is','page',19,6),(20624,'currently','page',19,2),(20625,'only','page',19,1),(20626,'service','page',19,8),(20627,'not','page',19,2),(20628,'build','page',19,1),(20629,'a','page',19,10),(20630,'container','page',19,9),(20631,'but','page',19,1),(20632,'script','page',19,1),(20633,'will','page',19,6),(20634,'set','page',19,4),(20635,'up','page',19,4),(20636,'host','page',19,4),(20637,'to','page',19,8),(20638,'able','page',19,1),(20639,'mimic','page',19,1),(20640,'domain','page',19,1),(20641,'of','page',19,3),(20642,'your','page',19,1),(20643,'choosing','page',19,1),(20644,'for','page',19,3),(20645,'attacks','page',19,5),(20646,'To','page',19,1),(20647,'View','page',19,3),(20648,'restart','page',19,1),(20649,'or','page',19,5),(20650,'delete','page',19,5),(20651,'run','page',19,1),(20652,'get','page',19,1),(20653,'menu','page',19,4),(20654,'below','page',19,2),(20655,'\r','page',19,30),(20656,'select','page',19,3),(20657,'option','page',19,3),(20658,'6','page',19,1),(20659,'-','page',19,3),(20660,'Container','page',19,5),(20661,'management','page',19,1),(20662,'From','page',19,3),(20663,'this','page',19,1),(20664,'you','page',19,6),(20665,'view','page',19,2),(20666,'start','page',19,2),(20667,'stop','page',19,3),(20668,'saved','page',19,1),(20669,'The','page',19,2),(20670,'Menu','page',19,3),(20671,'show','page',19,4),(20672,'status','page',19,2),(20673,'various','page',19,1),(20674,'Below','page',19,1),(20675,'example','page',19,1),(20676,'This','page',19,4),(20677,'if','page',19,1),(20678,'running','page',19,4),(20679,'stopped','page',19,3),(20680,'You','page',19,1),(20681,'ll','page',19,1),(20682,'also','page',19,1),(20683,'notice','page',19,1),(20684,'phish','page',19,4),(20685,'doesn','page',19,2),(20686,'t','page',19,2),(20687,'because','page',19,1),(20688,'create','page',19,1),(20689,'Instead','page',19,1),(20690,'it','page',19,5),(20691,'prep','page',19,1),(20692,'s','page',19,2),(20693,'sending','page',19,1),(20694,'then','page',19,1),(20695,'are','page',19,1),(20696,'done','page',19,1),(20697,'from','page',19,1),(20698,'other','page',19,1),(20699,'scripts','page',19,1),(20700,'at','page',19,2),(20701,'/root/scripts/phish','page',19,1),(20702,'For','page',19,1),(20703,'more','page',19,2),(20704,'on','page',19,2),(20705,'goto','page',19,1),(20706,'Using','page',19,1),(20707,'Setting','page',19,1),(20708,'Phishing','page',19,1),(20709,'see','page',19,1),(20710,'information','page',19,3),(20711,'about','page',19,1),(20712,'It','page',19,1),(20713,'all','page',19,1),(20714,'relevant','page',19,1),(20715,'examples','page',19,1),(20716,'looking','page',19,1),(20717,'page','page',19,1),(20718,'each','page',19,1),(20719,'type','page',19,1),(20720,' payload','page',19,1),(20721,'P1','page',19,1),(20722,'redirector','page',19,1),(20723,'RD1','page',19,1),(20724,'Cobalt','page',19,1),(20725,'strike','page',19,1),(20726,'teamserver','page',19,1),(20727,'TS1','page',19,1),(20728,'Delete','page',19,1),(20729,'shows','page',19,1),(20730,'following','page',19,1),(20731,'whether','page',19,1),(20732,'remove','page',19,3),(20733,'any','page',19,1),(20734,'IP','page',19,1),(20735,'out','page',19,1),(20736,'/root/services/','page',19,1),(20737,'servicetag','page',19,1),(20738,'directory','page',19,1),(20739,'The Start','page',19,1),(20740,'allows','page',19,2),(20741,'The Stop','page',19,1),(20742,'menu option','page',19,1),(20743,'just','page',19,1),(20744,'kill','page',19,1),(20745,'restarted','page',19,1),(20746,'later','page',19,1),(20747,'with','page',19,1),(20748,'no','page',19,1),(20749,'lose','page',19,1),(20750,'functionality','page',19,1),(20751,'Reverting','page',21,40),(20752,'the','page',21,41),(20753,'NRTS','page',21,42),(20754,'If','page',21,1),(20755,'you','page',21,4),(20756,'want','page',21,2),(20757,'to','page',21,3),(20758,'wipe','page',21,1),(20759,'out','page',21,1),(20760,'all','page',21,1),(20761,'containers/services/configurations','page',21,1),(20762,'on','page',21,2),(20763,'an','page',21,1),(20764,'there','page',21,1),(20765,'is','page',21,2),(20766,'a','page',21,1),(20767,'revert','page',21,1),(20768,'sh','page',21,3),(20769,'script','page',21,1),(20770,'do','page',21,1),(20771,'this','page',21,2),(20772,' ','page',21,1),(20773,'It','page',21,1),(20774,'s','page',21,1),(20775,'located','page',21,1),(20776,'at','page',21,1),(20777,'/root/scripts/revert','page',21,1),(20778,'below','page',21,1),(20779,'usage','page',21,1),(20780,'cd','page',21,1),(20781,'/root/scripts\r','page',21,1),(20782,'/revert','page',21,1),(20783,'When','page',21,1),(20784,'run','page',21,1),(20785,'it','page',21,1),(20786,'will','page',21,1),(20787,'make','page',21,1),(20788,'sure','page',21,1),(20789,'by','page',21,1),(20790,'making','page',21,1),(20791,'confirm','page',21,1),(20912,'Proxy','page',11,48),(20913,'All','page',11,40),(20914,'the','page',11,58),(20915,'things','page',11,40),(20916,'NOTE','page',11,1),(20917,'The','page',11,2),(20918,'proxy','page',11,17),(20919,'is','page',11,2),(20920,'at','page',11,1),(20921,'http','page',11,6),(20922,'//172','page',11,13),(20923,'30','page',11,15),(20924,'0','page',11,15),(20925,'2','page',11,15),(20926,'9999','page',11,8),(20927,'Setting','page',11,3),(20928,'up','page',11,3),(20929,'Docker','page',11,3),(20930,'in','page',11,7),(20931,'linux','page',11,5),(20932,'Add','page',11,7),(20933,'folder','page',11,1),(20934,'for','page',11,5),(20935,'docker','page',11,5),(20936,'service','page',11,4),(20937,'if','page',11,1),(20938,'it','page',11,2),(20939,'doesn','page',11,1),(20940,'t','page',11,1),(20941,'exist','page',11,1),(20942,'and','page',11,6),(20943,'add','page',11,4),(20944,'a','page',11,6),(20945,'conf','page',11,8),(20946,'file ','page',11,1),(20947,' ','page',11,5),(20948,'  ','page',11,1),(20949,'cd','page',11,3),(20950,'/etc/systemd/system\r','page',11,1),(20951,'mkdir','page',11,1),(20952,'d\r','page',11,3),(20953,'vi','page',11,2),(20954,'http-proxy','page',11,2),(20955,'Put','page',11,2),(20956,'following','page',11,6),(20957,'Service','page',11,1),(20958,'\r','page',11,4),(20959,'Environment=','page',11,2),(20960,'HTTP_PROXY=http','page',11,1),(20961,'HTTPS_PROXY=http','page',11,1),(20962,'Lastly','page',11,1),(20963,'reload','page',11,1),(20964,'daemon','page',11,1),(20965,'restart','page',11,2),(20966,'systemctl','page',11,2),(20967,'daemon-reload\r','page',11,1),(20968,'Adding','page',11,3),(20969,'to','page',11,16),(20970,'Dockerfile','page',11,3),(20971,'edit','page',11,2),(20972,'your','page',11,3),(20973,'dockerfile','page',11,1),(20974,'favorite','page',11,1),(20975,'text','page',11,1),(20976,'editor','page',11,1),(20977,'these','page',11,1),(20978,'variables','page',11,3),(20979,'ENV','page',11,2),(20980,'http_proxy','page',11,2),(20981,'9999\r','page',11,5),(20982,'https_proxy','page',11,2),(20983,'Apt','page',11,3),(20984,'Go','page',11,1),(20985,'apt','page',11,2),(20986,'d','page',11,1),(20987,'directory','page',11,1),(20988,'create','page',11,1),(20989,'file','page',11,3),(20990,'/etc/apt/apt','page',11,1),(20991,'Acquire','page',11,2),(20992,'https','page',11,2),(20993,'wget','page',11,4),(20994,'Edit','page',11,1),(20995,'/etc/wgetrc','page',11,1),(20996,'Find','page',11,1),(20997,'lines','page',11,1),(20998,'use_proxy','page',11,1),(20999,'them','page',11,1),(21000,'match','page',11,1),(21001,'use_proxy=yes\r','page',11,1),(21002,'http_proxy=http','page',11,3),(21003,'https_proxy=http','page',11,3),(21004,'Cobalt','page',11,4),(21005,'Strike','page',11,4),(21006,'Update','page',11,3),(21007,'script','page',11,5),(21008,'In','page',11,1),(21009,'order','page',11,1),(21010,'run','page',11,1),(21011,'update','page',11,2),(21012,'you','page',11,2),(21013,'need','page',11,2),(21014,'modify','page',11,1),(21015,'information','page',11,1),(21016,'java','page',11,2),(21017,'command','page',11,2),(21018,'Below','page',11,1),(21019,'additional','page',11,1),(21020,'flags','page',11,1),(21021,'-Dhttp','page',11,2),(21022,'proxyHost=172','page',11,1),(21023,'proxyPort=9999','page',11,2),(21024,'-Dhttps','page',11,2),(21025,'proxyhost=172','page',11,1),(21026,'Using','page',11,3),(21027,'git','page',11,5),(21028,'via','page',11,6),(21029,'can','page',11,2),(21030,'use','page',11,3),(21031,'environment','page',11,2),(21032,'depending','page',11,1),(21033,'on','page',11,2),(21034,'version','page',11,1),(21035,'of','page',11,1),(21036,'To','page',11,1),(21037,'through','page',11,1),(21038,'set','page',11,1),(21039,'with','page',11,1),(21040,'export','page',11,4),(21041,'PIP3','page',11,3),(21042,'install','page',11,3),(21043,'On','page',11,1),(21044,'occasion','page',11,1),(21045,'pip3','page',11,1),(21046,'installs','page',11,1),(21047,'ubuntu','page',11,1),(21048,'runs','page',11,1),(21049,'into','page',11,1),(21050,'issues','page',11,1),(21051,'has','page',11,1),(21052,'worked','page',11,1),(21053,'resolve','page',11,1),(21054,'remove','page',11,1),(21055,'--purge','page',11,1),(21056,'python3-pip','page',11,1),(21057,'-y\r','page',11,1),(21058,'curl','page',11,1),(21059,'//bootstrap','page',11,1),(21060,'pypa','page',11,1),(21061,'io/get-pip','page',11,1),(21062,'py','page',11,3),(21063,'-o','page',11,1),(21064,'install-pip2-ubuntu','page',11,1),(21065,'python3','page',11,1),(21066,'install-pip3-ubuntu','page',11,1),(26325,'Target','book',8,48),(26326,'Domain','book',8,48),(26327,'Planning','book',8,48),(26328,'Guide','book',8,48),(26329,'The','book',8,2),(26330,'target','book',8,1),(26331,'domain','book',8,1),(26332,'is','book',8,2),(26333,'the','book',8,3),(26334,'enterprise','book',8,1),(26335,'network','book',8,1),(26336,'that','book',8,1),(26337,'you','book',8,1),(26338,'can','book',8,1),(26339,'attach','book',8,1),(26340,'to','book',8,4),(26341,'cyber','book',8,2),(26342,'range','book',8,2),(26343,'This','book',8,1),(26344,'also','book',8,1),(26345,'commonly','book',8,1),(26346,'referred','book',8,1),(26347,'as','book',8,1),(26348,'blue','book',8,1),(26349,'space','book',8,1),(26350,'doesn','book',8,1),(26351,'t','book',8,1),(26352,'come','book',8,1),(26353,'with','book',8,2),(26354,'one','book',8,1),(26355,'due','book',8,1),(26356,'issues','book',8,1),(26357,'windows','book',8,1),(26358,'licensing','book',8,1),(26359,'but','book',8,1),(26360,'this','book',8,1),(26361,'guide','book',8,1),(26362,'will','book',8,1),(26363,'provide','book',8,1),(26364,'some','book',8,1),(26365,'lessons','book',8,1),(26366,'learned','book',8,1),(26367,'when','book',8,1),(26368,'building','book',8,1),(26369,'these','book',8,1),(26370,'operate','book',8,1),(26371,'in','book',8,1),(26372,'a','book',8,1),(26373,'fake','book',8,1),(26374,'internet','book',8,1),(26375,'environment','book',8,1),(36157,'Cyber','bookshelf',2,48),(36158,'Range','bookshelf',2,48),(36159,'Documentation','bookshelf',2,48),(38313,'Web-Services','page',5,40),(38314,'The','page',5,3),(38315,'web','page',5,1),(38316,'services','page',5,2),(38317,'VM','page',5,2),(38318,'adds','page',5,1),(38319,'the','page',5,10),(38320,'following','page',5,2),(38321,'webservers','page',5,1),(38322,'to','page',5,6),(38323,'Cyber','page',5,2),(38324,'Range','page',5,2),(38325,'environment','page',5,1),(38326,'pastebin','page',5,2),(38327,'com','page',5,7),(38328,'-','page',5,4),(38329,'this','page',5,4),(38330,'is','page',5,5),(38331,'a','page',5,11),(38332,'hastebin','page',5,1),(38333,'server','page',5,3),(38334,'running','page',5,5),(38335,'in','page',5,6),(38336,'docker','page',5,15),(38337,'container','page',5,6),(38338,'that','page',5,2),(38339,'simulates','page',5,1),(38340,'com\r','page',5,1),(38341,'redbook','page',5,5),(38342,'bookstack','page',5,6),(38343,'used','page',5,4),(38344,'for','page',5,8),(38345,'documentation','page',5,1),(38346,'you','page',5,4),(38347,'are','page',5,1),(38348,'using','page',5,1),(38349,'it','page',5,3),(38350,'right','page',5,1),(38351,'now','page',5,1),(38352,'\r','page',5,17),(38353,'dropbox','page',5,4),(38354,'owncloud','page',5,4),(38355,'file','page',5,3),(38356,'share','page',5,1),(38357,'simulate','page',5,1),(38358,'cloud','page',5,1),(38359,'sharing','page',5,1),(38360,'service','page',5,1),(38361,' ','page',5,6),(38362,'This','page',5,1),(38363,'can','page',5,2),(38364,'be','page',5,1),(38365,'range','page',5,1),(38366,'management','page',5,1),(38367,'like','page',5,1),(38368,'hosting','page',5,2),(38369,'various','page',5,2),(38370,'apps','page',5,1),(38371,'want','page',5,2),(38372,'install','page',5,1),(38373,'on','page',5,4),(38374,'target','page',5,1),(38375,'domains','page',5,1),(38376,'but','page',5,1),(38377,'mostly','page',5,1),(38378,'s','page',5,1),(38379,'there','page',5,1),(38380,'payload','page',5,1),(38381,'or','page',5,1),(38382,'as','page',5,1),(38383,'an','page',5,1),(38384,'exfiltration','page',5,1),(38385,'point','page',5,1),(38386,'OPFOR','page',5,1),(38387,'diagrams','page',5,2),(38388,'net','page',5,1),(38389,'draw','page',5,1),(38390,'io','page',5,1),(38391,'creating','page',5,2),(38392,'above','page',5,1),(38393,'reside','page',5,1),(38394,'folders','page',5,1),(38395,'web-services','page',5,1),(38396,'/root/pastebin ','page',5,1),(38397,'/root/redbook\r','page',5,1),(38398,'/root/owncloud\r','page',5,1),(38399,'/root/drawio','page',5,1),(38400,'These','page',5,1),(38401,'directories','page',5,1),(38402,'contain','page',5,1),(38403,'config','page',5,1),(38404,'files','page',5,1),(38405,'needed','page',5,1),(38406,'along','page',5,1),(38407,'with','page',5,1),(38408,'docker-compose','page',5,1),(38409,'containers','page',5,2),(38410,'should','page',5,1),(38411,'all','page',5,1),(38412,'start','page',5,1),(38413,'up','page',5,1),(38414,'automatically','page',5,1),(38415,'reboot','page',5,1),(38416,'To','page',5,1),(38417,'check','page',5,2),(38418,'status','page',5,1),(38419,'of','page',5,1),(38420,'I','page',5,1),(38421,'d','page',5,1),(38422,'advise','page',5,1),(38423,'googling','page',5,1),(38424,'see','page',5,1),(38425,'how','page',5,1),(38426,'interact','page',5,1),(38427,'and','page',5,4),(38428,'do','page',5,1),(38429,'things','page',5,1),(38430,'For','page',5,1),(38431,'quick','page',5,1),(38432,'run','page',5,1),(38433,'ps','page',5,1),(38434,'will','page',5,1),(38435,'list','page',5,1),(38436,'NOTE','page',5,1),(38437,'both','page',5,1),(38438,'use','page',5,1),(38439,'mysql','page',5,3),(38440,'database','page',5,1),(38441,'If','page',5,1),(38442,'make','page',5,2),(38443,'backups','page',5,3),(38444,'below','page',5,1),(38445,'syntax','page',5,1),(38446,'restoring','page',5,1),(38447,'from','page',5,1),(38448,'these','page',5,1),(38449,'BACKING','page',5,1),(38450,'UP','page',5,1),(38451,'FOR','page',5,4),(38452,'BOOKSTACK','page',5,2),(38453,'exec','page',5,4),(38454,'-i','page',5,4),(38455,'bookstack_db','page',5,2),(38456,'mysqldump','page',5,2),(38457,'-uroot','page',5,2),(38458,'-pbookstack','page',5,2),(38459,'bookstackapp','page',5,2),(38460,'bookstackbackup','page',5,2),(38461,'sql\r','page',5,2),(38462,'cp','page',5,4),(38463,'/app/www/public/uploads/images','page',5,1),(38464,'/config/files','page',5,1),(38465,'tar','page',5,8),(38466,'-czvf','page',5,2),(38467,'redbook-images-backup','page',5,1),(38468,'gz','page',5,2),(38469,'images\r','page',5,1),(38470,'redbook-files-backup','page',5,3),(38471,'uploads\r','page',5,1),(38472,'OWNCLOUD','page',5,2),(38473,'owncloud_db','page',5,2),(38474,'-uowncloud','page',5,2),(38475,'-powncloud','page',5,2),(38476,'owncloudbackup','page',5,2),(38477,'sql','page',5,2),(38478,'RESTORING','page',5,1),(38479,'-xzvf','page',5,2),(38480,'gz\r','page',5,2),(38481,'images','page',5,1),(38482,'/app/www/public/uploads/\r','page',5,1),(38483,'files ','page',5,1),(38484,'/config/www/\r','page',5,1),(38485,'CA-Server','page',6,40),(38486,'The','page',6,4),(38487,'CA','page',6,2),(38488,'server','page',6,3),(38489,'is','page',6,6),(38490,'built','page',6,1),(38491,'on','page',6,4),(38492,'Ubuntu','page',6,1),(38493,'22','page',6,1),(38494,'01','page',6,1),(38495,'and','page',6,5),(38496,'uses','page',6,1),(38497,'openSSL','page',6,1),(38498,'to','page',6,6),(38499,'create','page',6,3),(38500,'a','page',6,3),(38501,'Certificate','page',6,2),(38502,'Authority','page',6,2),(38503,'intermediate','page',6,3),(38504,'for','page',6,4),(38505,'signing','page',6,1),(38506,'SSL','page',6,4),(38507,'certs','page',6,5),(38508,' ','page',6,7),(38509,'have','page',6,1),(38510,'already','page',6,1),(38511,'been','page',6,1),(38512,'created','page',6,2),(38513,'using','page',6,1),(38514,'the','page',6,6),(38515,'domain','page',6,1),(38516,'of','page',6,2),(38517,'globalcert','page',6,1),(38518,'com','page',6,4),(38519,'To','page',6,1),(38520,'new','page',6,1),(38521,'signed','page',6,1),(38522,'or','page',6,1),(38523,'sign','page',6,3),(38524,'binaries','page',6,1),(38525,'you','page',6,2),(38526,'can','page',6,1),(38527,'use','page',6,2),(38528,'scripts','page',6,3),(38529,'this','page',6,2),(38530,'NRTS','page',6,2),(38531,'will','page',6,1),(38532,'also','page',6,1),(38533,'these','page',6,3),(38534,'automatically','page',6,1),(38535,'redirectors','page',6,1),(38536,'payload','page',6,1),(38537,'hosts','page',6,1),(38538,'services','page',6,1),(38539,'it','page',6,1),(38540,'builds','page',6,1),(38541,'For','page',6,1),(38542,'more','page',6,1),(38543,'information','page',6,1),(38544,'go','page',6,1),(38545,'-','page',6,2),(38546,'Cyber','page',6,1),(38547,'Range','page',6,1),(38548,'Systems','page',6,1),(38549,'Overview','page',6,1),(38550,'That','page',6,1),(38551,'said','page',6,1),(38552,'if','page',6,1),(38553,'want','page',6,1),(38554,'generate','page',6,1),(38555,'manually','page',6,1),(38556,'below','page',6,2),(38557,'an','page',6,2),(38558,'overview','page',6,1),(38559,'CA-server','page',6,1),(38560,'/root/certmaker','page',6,1),(38561,'sh\r','page',6,2),(38562,'\r','page',6,6),(38563,'This','page',6,1),(38564,'used','page',6,1),(38565,'HTTPS','page',6,1),(38566,'then','page',6,1),(38567,'with','page',6,1),(38568,'cert','page',6,2),(38569,'script','page',6,1),(38570,'has','page',6,1),(38571,'help','page',6,2),(38572,'menu','page',6,2),(38573,'that','page',6,2),(38574,'pretty','page',6,1),(38575,'self','page',6,1),(38576,'explanatory','page',6,1),(38577,'lists','page',6,1),(38578,'various','page',6,1),(38579,'flags','page',6,1),(38580,'Below','page',6,1),(38581,'example','page',6,1),(38582,'humanzoo','page',6,6),(38583,'com\r','page',6,2),(38584,'/certmaker','page',6,1),(38585,'sh','page',6,2),(38586,'-d','page',6,1),(38587,'-C','page',6,1),(38588,'US','page',6,1),(38589,'-ST','page',6,1),(38590,'NY','page',6,1),(38591,'-L','page',6,1),(38592,'New','page',6,1),(38593,'York','page',6,1),(38594,'City','page',6,1),(38595,'-O','page',6,1),(38596,'Human','page',6,1),(38597,'Zoo','page',6,1),(38598,'foundation','page',6,1),(38599,'-CN','page',6,1),(38600,'-A','page',6,1),(38601,'-DNS1','page',6,1),(38602,'www','page',6,1),(38603,'-DNS2','page',6,1),(38604,'login','page',6,1),(38605,'/root/codesigncertmaker','page',6,1),(38606,'/root/cs_codesigncertmaker','page',6,1),(39283,'Adding','page',32,40),(39284,'a','page',32,92),(39285,'Internet','page',32,40),(39286,'Access','page',32,40),(39287,'Proxy','page',32,40),(39288,'for','page',32,41),(39289,'Target','page',32,45),(39290,'Domain','page',32,44),(39291,'Having','page',32,1),(39292,'way','page',32,2),(39293,'to','page',32,13),(39294,'access','page',32,1),(39295,'the','page',32,11),(39296,'real','page',32,2),(39297,'internet','page',32,2),(39298,'from','page',32,2),(39299,'target','page',32,4),(39300,'domain','page',32,3),(39301,'is','page',32,6),(39302,'very','page',32,1),(39303,'useful','page',32,1),(39304,' ','page',32,11),(39305,'There','page',32,1),(39306,'are','page',32,1),(39307,'couple','page',32,1),(39308,'of','page',32,4),(39309,'ways','page',32,1),(39310,'do','page',32,1),(39311,'this','page',32,7),(39312,'One','page',32,1),(39313,'would','page',32,4),(39314,'be','page',32,3),(39315,'install','page',32,1),(39316,'secondary','page',32,3),(39317,'NIC','page',32,2),(39318,'on','page',32,4),(39319,'all','page',32,3),(39320,'your','page',32,4),(39321,'and','page',32,3),(39322,'then','page',32,1),(39323,'interconnect','page',32,1),(39324,'that','page',32,7),(39325,'Cyber','page',32,3),(39326,'Range','page',32,3),(39327,'AdminNet','page',32,3),(39328,'It','page',32,1),(39329,'get','page',32,1),(39330,'DHCP','page',32,1),(39331,'lease','page',32,1),(39332,'AdminNet-DHCP','page',32,1),(39333,'server','page',32,2),(39334,'able','page',32,1),(39335,'use','page',32,3),(39336,'same','page',32,1),(39337,'https','page',32,1),(39338,'//172','page',32,1),(39339,'30','page',32,1),(39340,'0','page',32,1),(39341,'2','page',32,1),(39342,'9999','page',32,1),(39343,'proxy','page',32,2),(39344,'uses','page',32,1),(39345,'However','page',32,1),(39346,'also','page',32,1),(39347,'creates','page',32,1),(39348,'unwanted','page',32,1),(39349,'artifact','page',32,1),(39350,'systems','page',32,1),(39351,'you','page',32,3),(39352,'ll','page',32,1),(39353,'have','page',32,1),(39354,'tell','page',32,1),(39355,'cyber','page',32,1),(39356,'defenders','page',32,1),(39357,'it','page',32,5),(39358,'training','page',32,1),(39359,'just','page',32,1),(39360,'ignore','page',32,1),(39361,'The','page',32,3),(39362,'bigger','page',32,1),(39363,'concern','page',32,1),(39364,'flat','page',32,1),(39365,'network','page',32,1),(39366,'connecting','page',32,1),(39367,'say','page',32,1),(39368,'multiple','page',32,1),(39369,'domains','page',32,1),(39370,'could','page',32,1),(39371,'lead','page',32,1),(39372,'inadvertent','page',32,1),(39373,'propagation','page',32,1),(39374,'For','page',32,1),(39375,'example','page',32,2),(39376,'if','page',32,1),(39377,'red','page',32,1),(39378,'teamer','page',32,1),(39379,'drops','page',32,1),(39380,'wormable','page',32,1),(39381,'malware','page',32,2),(39382,'1','page',32,1),(39383,'unless','page',32,1),(39384,'added','page',32,1),(39385,'appropriate','page',32,1),(39386,'firewall','page',32,1),(39387,'rules','page',32,1),(39388,'interface','page',32,1),(39389,'likely','page',32,1),(39390,'propagate','page',32,1),(39391,'other','page',32,2),(39392,'Domains','page',32,1),(39393,'via','page',32,1),(39394,'That','page',32,1),(39395,'said','page',32,1),(39396,'method','page',32,3),(39397,'not','page',32,2),(39398,'advisable','page',32,1),(39399,'but','page',32,2),(39400,'an','page',32,2),(39401,'end','page',32,1),(39402,'user','page',32,1),(39403,'might','page',32,1),(39404,'consider','page',32,1),(39405,'so','page',32,1),(39406,'worth','page',32,1),(39407,'explaining','page',32,1),(39408,'why','page',32,1),(39409,'s','page',32,1),(39410,'good','page',32,1),(39411,'idea','page',32,1),(39412,'preferred','page',32,1),(39413,'add','page',32,1),(39414,'squid','page',32,1),(39415,'in','page',32,1),(39416,'DMZ','page',32,2),(39417,'Give','page',32,1),(39418,'two','page',32,1),(39419,'NICs','page',32,1),(39420,'one','page',32,1),(39421,'connected','page',32,2),(39422,'connection','page',32,1),(39423,'configuration','page',32,2),(39424,'will','page',32,1),(39425,'depend','page',32,1),(39426,'how','page',32,1),(39427,'built','page',32,1),(39428,'can','page',32,1),(39429,'IA-proxy','page',32,1),(39430,'as','page',32,1),(39431,'Cyber','page',2,52),(39432,'Range','page',2,51),(39433,'Network','page',2,44),(39434,'Diagram','page',2,44),(39435,'Notes','page',2,4),(39436,'SI-Router','page',2,2),(39437,'-','page',2,33),(39438,'This','page',2,19),(39439,'is','page',2,18),(39440,'a','page',2,25),(39441,'vyos','page',2,1),(39442,'router','page',2,3),(39443,'that','page',2,9),(39444,'handles','page',2,1),(39445,'all','page',2,5),(39446,'the','page',2,43),(39447,'routing','page',2,1),(39448,'within','page',2,1),(39449,'and','page',2,19),(39450,'to','page',2,49),(39451,'your','page',2,8),(39452,'target','page',2,14),(39453,'domains','page',2,5),(39454,' ','page',2,31),(39455,'It','page',2,2),(39456,'has','page',2,4),(39457,'4','page',2,1),(39458,'interfaces','page',2,1),(39459,'connect','page',2,4),(39460,'following','page',2,2),(39461,'ESXI','page',2,4),(39462,'virtual','page',2,5),(39463,'switches','page',2,1),(39464,'ServicesNet ','page',2,1),(39465,'\r','page',2,17),(39466,'Grayspace ','page',2,1),(39467,'AdminNet','page',2,2),(39468,'RangeWAN','page',2,3),(39469,'ServicesNet','page',2,1),(39470,'switch','page',2,3),(39471,'connects','page',2,2),(39472,'SI','page',2,2),(39473,'as','page',2,6),(39474,'well','page',2,2),(39475,'RootDNS','page',2,3),(39476,'Web-services','page',2,1),(39477,'CA-Server','page',2,4),(39478,'Traffic-Gen','page',2,6),(39479,'Traffic-Web','page',2,1),(39480,'host','page',2,3),(39481,'servers','page',2,4),(39482,'Grayspaces','page',2,1),(39483,'DNS','page',2,6),(39484,'server','page',2,16),(39485,'it','page',2,4),(39486,'been','page',2,1),(39487,'IP','page',2,3),(39488,'ed','page',2,1),(39489,'with','page',2,5),(39490,'of','page',2,7),(39491,'real','page',2,8),(39492,'world','page',2,7),(39493,'root','page',2,1),(39494,'IPs','page',2,2),(39495,'meaning','page',2,1),(39496,'A-root','page',2,1),(39497,'through','page',2,1),(39498,'M-root','page',2,1),(39499,'Additionally','page',2,2),(39500,'Googles','page',2,1),(39501,'recursive','page',2,1),(39502,'8','page',2,4),(39503,'used','page',2,8),(39504,'for','page',2,20),(39505,'managing','page',2,1),(39506,'grayspace','page',2,2),(39507,'You','page',2,2),(39508,'can','page',2,6),(39509,'register','page',2,1),(39510,'manually','page',2,1),(39511,'or','page',2,3),(39512,'use','page',2,2),(39513,'automation','page',2,1),(39514,'scripts','page',2,1),(39515,'build','page',2,6),(39516,'on','page',2,10),(39517,'NRTS','page',2,6),(39518,'For','page',2,5),(39519,'more','page',2,3),(39520,'details','page',2,2),(39521,'configuration','page',2,1),(39522,'go','page',2,6),(39523,'Systems','page',2,4),(39524,'Overview','page',2,4),(39525,'rootDNS','page',2,1),(39526,'Web-Services','page',2,1),(39527,'provides','page',2,2),(39528,'few','page',2,1),(39529,'simulated','page',2,4),(39530,'services','page',2,3),(39531,'be','page',2,4),(39532,'OPFOR','page',2,4),(39533,'and/or','page',2,2),(39534,'range','page',2,7),(39535,'management','page',2,1),(39536,'These','page',2,1),(39537,'are','page',2,3),(39538,'in','page',2,11),(39539,'docker','page',2,3),(39540,'containers','page',2,3),(39541,'provide','page',2,3),(39542,'redbook','page',2,2),(39543,'com','page',2,5),(39544,'bookstack','page',2,2),(39545,'app','page',2,1),(39546,'you','page',2,8),(39547,'currently','page',2,1),(39548,'looking','page',2,1),(39549,'at','page',2,3),(39550,'documentation','page',2,3),(39551,'environment','page',2,2),(39552,'also','page',2,1),(39553,'expand','page',2,1),(39554,'upon','page',2,1),(39555,'this','page',2,9),(39556,'own','page',2,1),(39557,'whatever','page',2,4),(39558,'dropbox','page',2,1),(39559,'an','page',2,6),(39560,'owncloud','page',2,1),(39561,'cloud','page',2,1),(39562,'based','page',2,1),(39563,'file','page',2,1),(39564,'hosting','page',2,3),(39565,'service','page',2,1),(39566,'web','page',2,1),(39567,'Dav','page',2,1),(39568,'API','page',2,1),(39569,'s','page',2,5),(39570,'additional','page',2,1),(39571,'ways','page',2,1),(39572,'payloads','page',2,1),(39573,'exfil','page',2,1),(39574,'data','page',2,1),(39575,'pastebin','page',2,2),(39576,'hastebin','page',2,1),(39577,'code','page',2,2),(39578,'snippets','page',2,1),(39579,'pulled','page',2,1),(39580,'from','page',2,2),(39581,'needs','page',2,1),(39582,'diagrams','page',2,2),(39583,'net','page',2,1),(39584,'draw','page',2,1),(39585,'io','page',2,1),(39586,'generating','page',2,1),(39587,'diagram','page',2,1),(39588,'want','page',2,3),(39589,'Its','page',2,1),(39590,'integrated','page',2,1),(39591,'into','page',2,2),(39592,'was','page',2,1),(39593,'make','page',2,2),(39594,'network','page',2,3),(39595,'found','page',2,1),(39596,'Ubuntu','page',2,5),(39597,'openSSL','page',2,1),(39598,'implementation','page',2,1),(39599,'certificate','page',2,2),(39600,'authority','page',2,2),(39601,'intermediate','page',2,1),(39602,'simulate','page',2,1),(39603,'CA','page',2,2),(39604,'signed','page',2,2),(39605,'SSL','page',2,2),(39606,'certificates','page',2,1),(39607,'In','page',2,1),(39608,'order','page',2,1),(39609,'these','page',2,1),(39610,'certs','page',2,4),(39611,'trusted','page',2,2),(39612,'domain','page',2,9),(39613,'environments','page',2,1),(39614,'will','page',2,5),(39615,'need','page',2,1),(39616,'copy','page',2,1),(39617,'ca','page',2,1),(39618,'globalcert','page',2,2),(39619,'crt','page',2,2),(39620,'pem','page',2,2),(39621,'int','page',2,1),(39622,'over','page',2,1),(39623,'add','page',2,5),(39624,'them','page',2,1),(39625,'trust','page',2,1),(39626,'stores','page',2,1),(39627,'via','page',2,1),(39628,'GPO','page',2,1),(39629,'how','page',2,5),(39630,'do','page',2,1),(39631,'Target','page',2,6),(39632,'Domain','page',2,6),(39633,'Planning','page',2,3),(39634,'Guide','page',2,3),(39635,'Importing','page',2,1),(39636,'Int','page',2,1),(39637,'Once','page',2,2),(39638,'done','page',2,1),(39639,'any','page',2,3),(39640,'create','page',2,2),(39641,'appear','page',2,1),(39642,'generate','page',2,1),(39643,'binary','page',2,1),(39644,'running','page',2,3),(39645,'customizable','page',2,1),(39646,'send','page',2,1),(39647,'emails','page',2,1),(39648,'users','page',2,1),(39649,'external','page',2,1),(39650,'SMTP','page',2,1),(39651,'traffic','page',2,3),(39652,'information','page',2,2),(39653,'about','page',2,1),(39654,'set','page',2,2),(39655,'up','page',2,2),(39656,'instructions','page',2,3),(39657,'setting','page',2,1),(39658,'using','page',2,2),(39659,'How','page',2,1),(39660,'Guides','page',2,1),(39661,'Setting','page',2,1),(39662,'Traffic-WebHost','page',2,1),(39663,'Apache','page',2,1),(39664,'several','page',2,1),(39665,'websites','page',2,2),(39666,'exists','page',2,1),(39667,'allow ','page',2,1),(39668,'generation','page',2,2),(39669,'agents','page',2,1),(39670,'workstations','page',2,1),(39671,'able','page',2,1),(39672,'open','page',2,1),(39673,'browsers','page',2,1),(39674,'hit','page',2,1),(39675,'various','page',2,2),(39676,'purposes','page',2,1),(39677,'Grayspace','page',2,1),(39678,'infrastructure','page',2,3),(39679,'systems','page',2,3),(39680,'By','page',2,1),(39681,'default','page',2,1),(39682,'installation','page',2,1),(39683,'out','page',2,3),(39684,'Kali','page',2,2),(39685,'FlareVM','page',2,2),(39686,'Feel','page',2,1),(39687,'free','page',2,1),(39688,'else','page',2,1),(39689,'To','page',2,2),(39690,'get','page',2,2),(39691,'list','page',2,1),(39692,'routable','page',2,1),(39693,'system','page',2,1),(39694,'look','page',2,2),(39695,'/root/backbonerouters','page',2,1),(39696,'folder','page',2,1),(39697,'console','page',2,1),(39698,'Eth2','page',2,1),(39699,'Not','page',2,1),(39700,'Red','page',2,1),(39701,'Team','page',2,1),(39702,'Server','page',2,1),(39703,'customized','page',2,1),(39704,'red','page',2,2),(39705,'team','page',2,2),(39706,'Go','page',2,3),(39707,'its','page',2,2),(39708,'built','page',2,1),(39709,'Using','page',2,1),(39710,'basic','page',2,1),(39711,'kali','page',2,1),(39712,'tools','page',2,1),(39713,'Windows','page',2,1),(39714,'VM','page',2,4),(39715,'Switch','page',2,1),(39716,'enable','page',2,1),(39717,'internet','page',2,4),(39718,'access','page',2,3),(39719,'There','page',2,1),(39720,'two','page',2,1),(39721,'AdminNet-DHCP','page',2,2),(39722,'IA-Proxy','page',2,2),(39723,'VMs','page',2,1),(39724,'cyber','page',2,4),(39725,'have','page',2,1),(39726,'secondary','page',2,1),(39727,'NIC','page',2,1),(39728,'DHCP','page',2,2),(39729,'lease','page',2,1),(39730,'172','page',2,1),(39731,'30','page',2,2),(39732,'0','page',2,2),(39733,'0/21','page',2,1),(39734,'subnet','page',2,1),(39735,'Provides','page',2,1),(39736,'exception','page',2,1),(39737,'preferable','page',2,1),(39738,'proxy','page',2,4),(39739,'verses','page',2,1),(39740,'reason','page',2,1),(39741,'better','page',2,1),(39742,'explained','page',2,1),(39743,'planning','page',2,1),(39744,'section','page',2,1),(39745,'Adding','page',2,1),(39746,'Internet','page',2,1),(39747,'Access','page',2,1),(39748,'Proxy','page',2,1),(39749,'squid','page',2,1),(39750,'allow','page',2,1),(39751,'just','page',2,1),(39752,'http','page',2,1),(39753,'//172','page',2,1),(39754,'2','page',2,1),(39755,'9999','page',2,1),(39756,'connection','page',2,2),(39757,'one','page',2,1),(39758,'ve','page',2,1),(39759,'pick','page',2,1),(39760,'public','page',2,1),(39761,'address','page',2,1),(39762,'WAN','page',2,1),(39763,'point','page',2,1),(39764,'Then','page',2,1),(39765,'edit','page',2,1),(39766,'interface','page',2,1),(39767,'complete','page',2,1),(39768,'More','page',2,1),(39769,'specific','page',2,1),(39770,'building','page',2,1),(39771,'connecting','page',2,1),(39772,'Connecting','page',2,1),(39773,'RootDNS','page',4,43),(39774,'The','page',4,9),(39775,'server','page',4,27),(39776,'is','page',4,17),(39777,'built','page',4,2),(39778,'on','page',4,5),(39779,'Ubuntu','page',4,1),(39780,'22','page',4,1),(39781,'01','page',4,1),(39782,'and','page',4,25),(39783,'runs','page',4,2),(39784,'a','page',4,30),(39785,'recursive','page',4,3),(39786,'bind9','page',4,9),(39787,' ','page',4,37),(39788,'To','page',4,5),(39789,'simulate','page',4,1),(39790,'real','page',4,3),(39791,'world','page',4,3),(39792,'DNS','page',4,26),(39793,'the','page',4,90),(39794,'configured','page',4,1),(39795,'with','page',4,7),(39796,'following','page',4,1),(39797,'IP','page',4,2),(39798,'addresses','page',4,1),(39799,'8','page',4,5),(39800,'-','page',4,27),(39801,'Googles','page',4,1),(39802,'\r','page',4,58),(39803,'198','page',4,1),(39804,'41','page',4,1),(39805,'0','page',4,4),(39806,'4','page',4,3),(39807,'A-root','page',4,1),(39808,'192','page',4,6),(39809,'228','page',4,1),(39810,'79','page',4,1),(39811,'59','page',4,1),(39812,'B-root','page',4,1),(39813,'33','page',4,2),(39814,'12','page',4,2),(39815,'C-root','page',4,1),(39816,'128','page',4,3),(39817,'10','page',4,2),(39818,'90','page',4,1),(39819,'D-root','page',4,1),(39820,'203','page',4,1),(39821,'230','page',4,1),(39822,'E-root','page',4,1),(39823,'195','page',4,1),(39824,'5','page',4,2),(39825,'241','page',4,1),(39826,'F-root','page',4,1),(39827,'112','page',4,1),(39828,'36','page',4,2),(39829,'G-root','page',4,1),(39830,'63','page',4,1),(39831,'2','page',4,1),(39832,'53','page',4,1),(39833,'H-root','page',4,1),(39834,'148','page',4,1),(39835,'17','page',4,1),(39836,'I-root','page',4,1),(39837,'58','page',4,1),(39838,'30','page',4,1),(39839,'J-root','page',4,1),(39840,'193','page',4,1),(39841,'15','page',4,1),(39842,'129','page',4,1),(39843,'K-root','page',4,1),(39844,'199','page',4,1),(39845,'7','page',4,1),(39846,'83','page',4,1),(39847,'42','page',4,1),(39848,'L-root','page',4,1),(39849,'202','page',4,1),(39850,'27','page',4,1),(39851,'M-root','page',4,1),(39852,'handles','page',4,1),(39853,'all','page',4,11),(39854,'grayspace','page',4,1),(39855,'keep','page',4,1),(39856,'this','page',4,11),(39857,'bit','page',4,1),(39858,'organized','page',4,2),(39859,'configuration','page',4,2),(39860,'for','page',4,17),(39861,'has','page',4,3),(39862,'been','page',4,2),(39863,'broken','page',4,1),(39864,'up','page',4,1),(39865,'into','page',4,1),(39866,'functional','page',4,1),(39867,'sections','page',4,1),(39868,'Below','page',4,1),(39869,'listing','page',4,1),(39870,'of','page',4,15),(39871,'file/folder','page',4,1),(39872,'structure','page',4,1),(39873,'along','page',4,2),(39874,'brief','page',4,1),(39875,'explanation','page',4,2),(39876,'its','page',4,2),(39877,'purpose','page',4,1),(39878,'BIND9','page',4,1),(39879,'CONFIGURATION','page',4,1),(39880,'Overview','page',4,2),(39881,'Configuration','page',4,1),(39882,'Files\r','page',4,1),(39883,'/etc/bind/named','page',4,8),(39884,'conf ','page',4,1),(39885,' -','page',4,1),(39886,'Contains','page',4,2),(39887,'includes','page',4,1),(39888,'segmented','page',4,1),(39889,'out','page',4,2),(39890,'named','page',4,11),(39891,'conf','page',4,19),(39892,'files','page',4,7),(39893,'options ','page',4,1),(39894,'options','page',4,1),(39895,'that','page',4,12),(39896,'make','page',4,5),(39897,'it','page',4,19),(39898,'This','page',4,16),(39899,'file','page',4,30),(39900,'also','page',4,1),(39901,'specifies','page',4,1),(39902,'IPs','page',4,3),(39903,'listens','page',4,1),(39904,'default-zones','page',4,1),(39905,'default','page',4,1),(39906,'zone','page',4,20),(39907,'created','page',4,2),(39908,'by','page',4,7),(39909,'unmodified','page',4,1),(39910,'OPFOR','page',4,15),(39911,'contains','page',4,5),(39912,'domain','page',4,18),(39913,'references','page',4,5),(39914,'entries','page',4,4),(39915,'For','page',4,2),(39916,'most','page',4,1),(39917,'part','page',4,1),(39918,'here','page',4,3),(39919,'are','page',4,4),(39920,'managed','page',4,1),(39921,'via','page',4,1),(39922,'scripts','page',4,3),(39923,'NRTS','page',4,7),(39924,'servers','page',4,1),(39925,'RANGE','page',4,7),(39926,'needed','page',4,1),(39927,'ServicesNet','page',4,1),(39928,'systems','page',4,2),(39929,'target','page',4,2),(39930,'domains','page',4,11),(39931,'exception','page',4,1),(39932,'traffic-gen','page',4,1),(39933,'traffic-webhost','page',4,1),(39934,'servers\r','page',4,1),(39935,'TRAFFIC','page',4,5),(39936,'traffic','page',4,1),(39937,'gen','page',4,1),(39938,'FOLDERS\r','page',4,1),(39939,'/etc/bind/OPFOR','page',4,3),(39940,'Stores','page',4,3),(39941,'referenced','page',4,4),(39942,'in','page',4,20),(39943,'config','page',4,5),(39944,'/etc/bind/RANGE','page',4,3),(39945,'/etc/bind/TRAFFIC','page',4,1),(39946,'/etc/bind/blackhole','page',4,1),(39947,'two','page',4,1),(39948,'db','page',4,3),(39949,'blackhole','page',4,2),(39950,'points','page',4,1),(39951,'to','page',4,33),(39952,'127','page',4,1),(39953,'1\r','page',4,1),(39954,'Rangism','page',4,1),(39955,'several','page',4,1),(39956,'pointing','page',4,1),(39957,'them','page',4,1),(39958,'used','page',4,3),(39959,'capture','page',4,1),(39960,'various','page',4,1),(39961,'auto','page',4,1),(39962,'generated','page',4,3),(39963,'OS','page',4,1),(39964,'application','page',4,1),(39965,'requests','page',4,2),(39966,'can','page',4,2),(39967,'t','page',4,4),(39968,'be','page',4,5),(39969,'reached','page',4,1),(39970,'or','page',4,3),(39971,'replicated','page',4,1),(39972,'environment','page',4,1),(39973,'Things','page',4,1),(39974,'like','page',4,1),(39975,'updateapi','page',4,1),(39976,'google','page',4,1),(39977,'com','page',4,5),(39978,'etc','page',4,1),(39979,'AUTOMATION','page',4,1),(39980,'root','page',4,1),(39981,'some','page',4,1),(39982,'automation','page',4,1),(39983,'automate','page',4,1),(39984,'registration','page',4,4),(39985,'path','page',4,1),(39986,'adding/removing','page',4,1),(39987,'listed','page',4,2),(39988,'below','page',4,1),(39989,'an','page',4,7),(39990,'their','page',4,2),(39991,'functionality','page',4,1),(39992,'/root/scripts/add-REDTEAM-DNS','page',4,1),(39993,'sh\r','page',4,4),(39994,'script','page',4,12),(39995,'will','page',4,16),(39996,'create','page',4,2),(39997,'PID','page',4,1),(39998,'lock','page',4,1),(39999,'when','page',4,5),(40000,'s','page',4,4),(40001,'executed','page',4,1),(40002,'prevent','page',4,2),(40003,'from','page',4,9),(40004,'running','page',4,2),(40005,'more','page',4,2),(40006,'than','page',4,1),(40007,'one','page',4,2),(40008,'instance','page',4,1),(40009,'If','page',4,3),(40010,'was','page',4,2),(40011,'ran','page',4,1),(40012,'concurrently','page',4,1),(40013,'would','page',4,2),(40014,'likely','page',4,1),(40015,'result','page',4,1),(40016,'corruption','page',4,1),(40017,'bind','page',4,1),(40018,'way','page',4,2),(40019,'works','page',4,2),(40020,'section','page',4,2),(40021,'/root/scripts/buildredteam','page',4,1),(40022,'sh','page',4,8),(40023,'SCP','page',4,1),(40024,'containing','page',4,1),(40025,'names','page',4,4),(40026,'using','page',4,2),(40027,'SSH','page',4,1),(40028,'key','page',4,1),(40029,'then','page',4,3),(40030,'remotely','page',4,1),(40031,'run','page',4,5),(40032,'add-REDTEAM-DNS','page',4,3),(40033,'feed','page',4,2),(40034,'as','page',4,6),(40035,'argument','page',4,1),(40036,'take','page',4,1),(40037,'list','page',4,6),(40038,'check','page',4,5),(40039,'if','page',4,4),(40040,'already','page',4,2),(40041,'exists','page',4,3),(40042,'any','page',4,2),(40043,'locations','page',4,1),(40044,'aka','page',4,1),(40045,'folders','page',4,1),(40046,'folder','page',4,2),(40047,'skip','page',4,1),(40048,'request','page',4,1),(40049,'assume','page',4,1),(40050,'user','page',4,5),(40051,'wants','page',4,1),(40052,'update','page',4,1),(40053,'record','page',4,1),(40054,'process','page',4,1),(40055,'It','page',4,4),(40056,'creates','page',4,2),(40057,'each','page',4,2),(40058,'adds','page',4,1),(40059,'directory','page',4,4),(40060,'copy','page',4,4),(40061,'appends','page',4,1),(40062,'reference','page',4,6),(40063,'didn','page',4,1),(40064,'exist','page',4,1),(40065,'named-checkconf','page',4,1),(40066,'against','page',4,1),(40067,'passed','page',4,1),(40068,'replace','page',4,2),(40069,'restart','page',4,4),(40070,'service','page',4,5),(40071,'read','page',4,2),(40072,'new','page',4,3),(40073,'configurations','page',4,1),(40074,'/root/scripts/delete-REDTEAM-DNS','page',4,1),(40075,'remove','page',4,3),(40076,'well','page',4,2),(40077,'originally','page',4,1),(40078,'added','page',4,3),(40079,'tag','page',4,3),(40080,'add','page',4,5),(40081,'tags','page',4,2),(40082,'value','page',4,1),(40083,'entered','page',4,1),(40084,'On','page',4,1),(40085,'there','page',4,1),(40086,'managing','page',4,1),(40087,'at','page',4,1),(40088,'/root/scripts/ManageDNS','page',4,1),(40089,'connect','page',4,1),(40090,'rootDNS','page',4,2),(40091,'get','page',4,1),(40092,'A','page',4,1),(40093,'select','page',4,2),(40094,'removed','page',4,1),(40095,'selecting','page',4,1),(40096,'associated','page',4,1),(40097,'those','page',4,1),(40098,'records','page',4,2),(40099,'/root/scripts/autoredirector/makednsfile','page',4,1),(40100,'generate','page',4,1),(40101,'elects','page',4,1),(40102,'randomly','page',4,2),(40103,'In','page',4,1),(40104,'case','page',4,1),(40105,'send','page',4,1),(40106,'available','page',4,3),(40107,'masterdomainlist','page',4,3),(40108,'txt','page',4,2),(40109,'pair','page',4,1),(40110,'When','page',4,1),(40111,'selects','page',4,1),(40112,'edit','page',4,1),(40113,'adding','page',4,2),(40114,'#','page',4,2),(40115,'front','page',4,2),(40116,'being','page',4,1),(40117,'reused','page',4,1),(40118,'/root/scripts/autoredirector/masterdomainlist','page',4,1),(40119,'txt\r','page',4,1),(40120,'roughly','page',4,1),(40121,'11000','page',4,1),(40122,'scrapping','page',4,1),(40123,'website','page',4,1),(40124,'expired','page',4,1),(40125,'goal','page',4,1),(40126,'have','page',4,2),(40127,'large','page',4,1),(40128,'pool','page',4,1),(40129,'aren','page',4,1),(40130,'owned','page',4,1),(40131,'concept','page',4,1),(40132,'these','page',4,1),(40133,'purchased','page',4,1),(40134,'adversary','page',4,2),(40135,'wouldn','page',4,1),(40136,'sense','page',4,1),(40137,'able','page',4,1),(40138,'use','page',4,2),(40139,'www','page',4,1),(40140,'microsoft','page',4,1),(40141,'C2','page',4,1),(40142,'/root/scripts/autoredirector/resetmasterdomainlist','page',4,1),(40143,'you','page',4,6),(40144,'ve','page',4,1),(40145,'deleted','page',4,1),(40146,'red','page',4,1),(40147,'team','page',4,1),(40148,'want','page',4,1),(40149,'previously','page',4,1),(40150,'again','page',4,2),(40151,'NOTE','page',4,2),(40152,'information','page',4,1),(40153,'above','page',4,1),(40154,'reside','page',4,1),(40155,'buildredteam','page',4,1),(40156,'ManageDNS','page',4,1),(40157,'RegisterDNS','page',4,1),(40158,'go','page',4,1),(40159,'Using','page',4,1),(40160,'HOW','page',4,1),(40161,'TO','page',4,1),(40162,'MANUALLY','page',4,1),(40163,'ADD','page',4,1),(40164,'need','page',4,2),(40165,'modify','page',4,1),(40166,'There','page',4,1),(40167,'example','page',4,2),(40168,'called','page',4,1),(40169,'Then','page',4,2),(40170,'simply','page',4,1),(40171,'follow','page',4,2),(40172,'syntax','page',4,3),(40173,'other','page',4,1),(40174,'Once','page',4,2),(40175,'However','page',4,1),(40176,'before','page',4,1),(40177,'doing','page',4,1),(40178,'good','page',4,1),(40179,'idea','page',4,1),(40180,'your','page',4,5),(40181,'first','page',4,1),(40182,'test','page',4,1),(40183,'run\r','page',4,1),(40184,'named-checkzone','page',4,1),(40185,'mydomain','page',4,3),(40186,'/etc/bind/RANGE/db','page',4,1),(40187,'com ','page',4,1),(40188,'modification','page',4,1),(40189,'named-checkconfig','page',4,1),(40190,'RANGE\r','page',4,1),(40191,'either','page',4,2),(40192,'errors','page',4,1),(40193,'corrections','page',4,1),(40194,'try','page',4,1),(40195,'they','page',4,1),(40196,'both','page',4,1),(40197,'pass','page',4,1),(40198,'manually','page',4,1),(40199,'same','page',4,1),(40200,'steps','page',4,1),(40201,'just','page',4,1),(40202,'sure','page',4,1),(40203,'correct','page',4,2),(40204,'modifying','page',4,1),(40205,'xxxx','page',4,1),(40206,'You','page',4,1),(40207,'should','page',4,1),(40208,'always','page',4,1),(40209,'status','page',4,1),(40210,'after','page',4,1),(40211,'ensure','page',4,1),(40212,'Traffic-Gen','page',7,42),(40213,'The','page',7,9),(40214,'Traffic-gen','page',7,1),(40215,'server','page',7,3),(40216,'was','page',7,4),(40217,'built','page',7,1),(40218,'on','page',7,3),(40219,'Ubuntu','page',7,1),(40220,'22','page',7,1),(40221,'01','page',7,1),(40222,'and','page',7,14),(40223,'uses','page',7,1),(40224,'a','page',7,22),(40225,'customized','page',7,1),(40226,'docker','page',7,3),(40227,'container','page',7,6),(40228,'that','page',7,14),(40229,'will','page',7,15),(40230,'use','page',7,7),(40231,'Postfix','page',7,1),(40232,'mutt','page',7,1),(40233,'to','page',7,28),(40234,'send','page',7,6),(40235,'emails','page',7,10),(40236,'given','page',7,1),(40237,'list','page',7,5),(40238,'of','page',7,14),(40239,'users','page',7,2),(40240,' ','page',7,29),(40241,'email','page',7,17),(40242,'corpus','page',7,1),(40243,'pulled','page',7,1),(40244,'using','page',7,1),(40245,'the','page',7,50),(40246,'Enron','page',7,3),(40247,'data','page',7,2),(40248,'dump','page',7,1),(40249,'About','page',7,1),(40250,'20','page',7,1),(40251,'years','page',7,1),(40252,'ago','page',7,1),(40253,'FCC','page',7,1),(40254,'forced','page',7,1),(40255,'make','page',7,3),(40256,'it','page',7,4),(40257,'s','page',7,4),(40258,'corporate','page',7,1),(40259,'public','page',7,1),(40260,'Since','page',7,1),(40261,'then','page',7,2),(40262,'several','page',7,1),(40263,'projects','page',7,1),(40264,'have','page',7,3),(40265,'organized','page',7,1),(40266,'these','page',7,3),(40267,'into','page',7,1),(40268,'databases','page',7,2),(40269,'It','page',7,2),(40270,'decent','page',7,1),(40271,'source','page',7,1),(40272,'for','page',7,14),(40273,'pulling','page',7,1),(40274,'out','page',7,1),(40275,'human','page',7,1),(40276,'readable','page',7,1),(40277,'subject','page',7,3),(40278,'body','page',7,3),(40279,'content','page',7,4),(40280,'script','page',7,9),(40281,'randomly','page',7,2),(40282,'pull','page',7,1),(40283,'from','page',7,6),(40284,'CSV','page',7,2),(40285,'file','page',7,13),(40286,'select','page',7,1),(40287,'address','page',7,2),(40288,'user','page',7,4),(40289,'provided','page',7,1),(40290,'an','page',7,3),(40291,'functionality','page',7,1),(40292,'this','page',7,6),(40293,'is','page',7,14),(40294,'very','page',7,1),(40295,'customizable','page',7,2),(40296,'Here','page',7,1),(40297,'overview','page',7,1),(40298,'how','page',7,1),(40299,'used','page',7,3),(40300,'generate','page',7,2),(40301,'traffic','page',7,7),(40302,'FILE','page',7,1),(40303,'STRUCTURE','page',7,1),(40304,'Email','page',7,1),(40305,'Traffic','page',7,1),(40306,'generation','page',7,1),(40307,'scripts\r','page',7,1),(40308,'\r','page',7,35),(40309,' /root/buildcompose','page',7,1),(40310,'sh\r','page',7,4),(40311,'This','page',7,12),(40312,'modify','page',7,3),(40313,'docker-compose','page',7,5),(40314,'based','page',7,1),(40315,'input','page',7,1),(40316,'/root/starttrafficgen','page',7,1),(40317,'Simple','page',7,2),(40318,'basically','page',7,2),(40319,'up','page',7,3),(40320,'-d','page',7,1),(40321,'/root/stoptrafficgen','page',7,1),(40322,'down','page',7,1),(40323,'Folder','page',7,1),(40324,'structure','page',7,1),(40325,'generator','page',7,5),(40326,'  ','page',7,1),(40327,'/root/emailerlist','page',7,1),(40328,'txt\r','page',7,3),(40329,'contains','page',7,3),(40330,'domains','page',7,3),(40331,'IPs','page',7,1),(40332,'be','page',7,3),(40333,'by','page',7,3),(40334,'read','page',7,1),(40335,'in','page',7,12),(40336,'build-compose','page',7,1),(40337,'configure','page',7,1),(40338,'each','page',7,6),(40339,'one','page',7,1),(40340,'Then','page',7,2),(40341,'contents','page',7,1),(40342,'/root/TG','page',7,1),(40343,'folder','page',7,3),(40344,'composing','page',7,1),(40345,'sending','page',7,2),(40346,'NOTE','page',7,1),(40347,'You','page',7,1),(40348,'can','page',7,4),(40349,'however','page',7,1),(40350,'you','page',7,17),(40351,'add','page',7,7),(40352,'domain','page',7,9),(40353,'zone','page',7,1),(40354,'files','page',7,3),(40355,'any','page',7,1),(40356,'new','page',7,1),(40357,'want','page',7,4),(40358,'RootDNS','page',7,2),(40359,'DNS','page',7,1),(40360,'system','page',7,1),(40361,'/etc/bind/TRAFFIC','page',7,1),(40362,'directory','page',7,5),(40363,'reference','page',7,1),(40364,'servers','page',7,1),(40365,'/etc/bind/named','page',7,1),(40366,'conf','page',7,1),(40367,'TRAFFIC','page',7,1),(40368,'Additionally','page',7,1),(40369,'ll','page',7,1),(40370,'IP','page',7,4),(40371,'Also','page',7,1),(40372,'if','page',7,2),(40373,'isn','page',7,1),(40374,'t','page',7,1),(40375,'already','page',7,1),(40376,'listed','page',7,1),(40377,'SI-Router','page',7,2),(40378,'ServicesNet','page',7,2),(40379,'interface','page',7,2),(40380,'need','page',7,1),(40381,'gateway','page',7,1),(40382,'same','page',7,1),(40383,'subnet','page',7,1),(40384,' /root/TG\r','page',7,1),(40385,'/root/TG/Content/EmailContent','page',7,1),(40386,'csv\r','page',7,1),(40387,'extracted','page',7,1),(40388,'publicly','page',7,1),(40389,'available','page',7,1),(40390,'mentioned','page',7,1),(40391,'earlier','page',7,1),(40392,'/root/TG/RandomFiles/\r','page',7,1),(40393,'108','page',7,1),(40394,'random','page',7,1),(40395,'types','page',7,1),(40396,'doc','page',7,1),(40397,'docx','page',7,1),(40398,'ppt','page',7,1),(40399,'pptx','page',7,1),(40400,'pdf','page',7,1),(40401,'xlsx','page',7,1),(40402,'These','page',7,2),(40403,'are','page',7,1),(40404,'as','page',7,2),(40405,'attachments','page',7,2),(40406,'/root/TG/SendTo/','page',7,1),(40407,'defined','page',7,2),(40408,'dir','page',7,2),(40409,'/sendto','page',7,1),(40410,'sendto','page',7,4),(40411,'txt','page',7,5),(40412,'should','page',7,2),(40413,'contain','page',7,1),(40414,'addresses','page',7,3),(40415,'designed','page',7,1),(40416,'support','page',7,1),(40417,'multiple','page',7,1),(40418,'target','page',7,5),(40419,'way','page',7,1),(40420,'works','page',7,1),(40421,'create','page',7,2),(40422,'connect','page',7,1),(40423,'Cyber','page',7,1),(40424,'Range','page',7,1),(40425,'When','page',7,1),(40426,'run','page',7,1),(40427,'buildcompose','page',7,1),(40428,'sh','page',7,1),(40429,'first','page',7,1),(40430,'ask','page',7,1),(40431,'which','page',7,1),(40432,'directories','page',7,1),(40433,'build','page',7,1),(40434,'For','page',7,2),(40435,'example','page',7,1),(40436,'made','page',7,1),(40437,'called','page',7,2),(40438,'widgets','page',7,1),(40439,'com','page',7,1),(40440,'would','page',7,2),(40441,'at','page',7,1),(40442,'/root/TG/SendTo/widgets','page',7,1),(40443,'fill','page',7,1),(40444,'with','page',7,2),(40445,'widget','page',7,1),(40446,'Always','page',7,1),(40447,'name','page',7,3),(40448,'-','page',7,3),(40449,'hard-coded','page',7,1),(40450,'more','page',7,1),(40451,'information','page',7,1),(40452,'setting','page',7,2),(40453,'traffic-gen','page',7,1),(40454,'your','page',7,1),(40455,'go','page',7,1),(40456,'How','page',7,1),(40457,'Guides','page',7,1),(40458,'Setting','page',7,1),(40459,'Target','page',7,1),(40460,'Domain','page',7,1),(40461,'/root/TG/Senders/senders','page',7,1),(40462,'names','page',7,1),(40463,'firstname','page',7,1),(40464,'lastname','page',7,1),(40465,'format','page',7,1),(40466,'combination','page',7,1),(40467,'containers','page',7,2),(40468,'emailerlist','page',7,1),(40469,' /root/TG/Scripts/StartEmail','page',7,1),(40470,'entrypoint','page',7,2),(40471,'runs','page',7,1),(40472,'endless','page',7,1),(40473,'loop','page',7,1),(40474,'where','page',7,2),(40475,'adjust','page',7,1),(40476,'time','page',7,3),(40477,'interval','page',7,1),(40478,'between','page',7,1),(40479,'sent','page',7,3),(40480,'jitter','page',7,1),(40481,'internal','page',7,1),(40482,'set','page',7,3),(40483,'max','page',7,2),(40484,'number','page',7,2),(40485,'recipients','page',7,1),(40486,'settings','page',7,1),(40487,'modified','page',7,1),(40488,'two','page',7,1),(40489,'ways','page',7,1),(40490,'First','page',7,1),(40491,'edit','page',7,1),(40492,'change','page',7,1),(40493,'default','page',7,1),(40494,'values','page',7,1),(40495,'or','page',7,1),(40496,'could','page',7,1),(40497,'appropriate','page',7,1),(40498,'flags','page',7,1),(40499,' \r','page',7,1),(40500,'/root/TrafficLog\r','page',7,1),(40501,'log','page',7,3),(40502,'log_','page',7,1),(40503,'senderdomain','page',7,1),(40504,'track','page',7,1),(40505,'count','page',7,1),(40506,'who','page',7,1),(40507,'NRTS','page',9,52),(40508,'The','page',9,2),(40509,'Not','page',9,1),(40510,'Red','page',9,1),(40511,'Team','page',9,1),(40512,'Server','page',9,1),(40513,'is','page',9,19),(40514,'built','page',9,1),(40515,'on','page',9,12),(40516,'Ubuntu','page',9,1),(40517,'22','page',9,1),(40518,'01','page',9,1),(40519,'and','page',9,9),(40520,'used','page',9,8),(40521,'to','page',9,33),(40522,'quickly','page',9,1),(40523,'build','page',9,5),(40524,'out','page',9,1),(40525,'OPFOR','page',9,6),(40526,'infrastructure','page',9,5),(40527,' ','page',9,17),(40528,'It','page',9,1),(40529,'uses','page',9,1),(40530,'docker','page',9,2),(40531,'containerize','page',9,1),(40532,'each','page',9,3),(40533,'individual','page',9,1),(40534,'system','page',9,3),(40535,'so','page',9,2),(40536,'that','page',9,8),(40537,'one','page',9,1),(40538,'can','page',9,5),(40539,'support','page',9,1),(40540,'multiple','page',9,1),(40541,'services','page',9,2),(40542,'such','page',9,1),(40543,'as','page',9,3),(40544,'a','page',9,16),(40545,'redirector','page',9,2),(40546,'Cobalt','page',9,9),(40547,'Strike','page',9,9),(40548,'teamserver','page',9,4),(40549,'payload','page',9,2),(40550,'host','page',9,2),(40551,'or','page',9,2),(40552,'multiples','page',9,1),(40553,'of','page',9,11),(40554,'I','page',9,1),(40555,'haven','page',9,1),(40556,'t','page',9,4),(40557,'tested','page',9,1),(40558,'the','page',9,35),(40559,'bounds','page',9,1),(40560,'this','page',9,15),(40561,'not','page',9,1),(40562,'sure','page',9,1),(40563,'what','page',9,2),(40564,'maximum','page',9,1),(40565,'In','page',9,1),(40566,'testing','page',9,1),(40567,'has','page',9,1),(40568,'supported','page',9,1),(40569,'3','page',9,3),(40570,'teamservers','page',9,4),(40571,'redirectors','page',9,2),(40572,'payloads','page',9,1),(40573,'running','page',9,1),(40574,'simultaneously','page',9,1),(40575,'However','page',9,1),(40576,'server','page',9,5),(40577,'isn','page',9,1),(40578,'meant','page',9,1),(40579,'be','page',9,2),(40580,'single','page',9,2),(40581,'for','page',9,19),(40582,'all','page',9,4),(40583,'needs','page',9,1),(40584,'You','page',9,1),(40585,'clone','page',9,1),(40586,'VM','page',9,3),(40587,'make','page',9,2),(40588,'many','page',9,1),(40589,'you','page',9,8),(40590,'would','page',9,3),(40591,'like','page',9,1),(40592,'This','page',9,12),(40593,'do','page',9,1),(40594,'several','page',9,1),(40595,'things','page',9,1),(40596,'will','page',9,7),(40597,'greatly','page',9,1),(40598,'reduce','page',9,1),(40599,'time','page',9,1),(40600,'required','page',9,1),(40601,'deploy','page',9,1),(40602,'systems','page',9,3),(40603,'There','page',9,1),(40604,'lot','page',9,1),(40605,'going','page',9,1),(40606,'in','page',9,5),(40607,'below','page',9,2),(40608,'description','page',9,1),(40609,'folder','page',9,5),(40610,'structure','page',9,4),(40611,'more','page',9,1),(40612,'detailed','page',9,1),(40613,'guides','page',9,3),(40614,'how','page',9,3),(40615,'use','page',9,4),(40616,'go','page',9,3),(40617,'-','page',9,12),(40618,'Using','page',9,6),(40619,'Folder','page',9,1),(40620,'Structure','page',9,1),(40621,'/root/backbonerouters\r','page',9,1),(40622,'\r','page',9,53),(40623,'directory','page',9,3),(40624,'contains','page',9,2),(40625,'list','page',9,3),(40626,'IP','page',9,3),(40627,'subnets','page',9,1),(40628,'SI-router','page',9,1),(40629,'route','page',9,1),(40630,'connected','page',9,1),(40631,'grayspace','page',9,2),(40632,'ESXI','page',9,1),(40633,'switch','page',9,2),(40634,'Its','page',9,1),(40635,'structured','page',9,1),(40636,'by','page',9,2),(40637,'Geo-location','page',9,1),(40638,'following','page',9,1),(40639,'format','page',9,1),(40640,'/root/backbonerouters/','page',9,1),(40641,'country','page',9,1),(40642,'/','page',9,1),(40643,'city','page',9,1),(40644,'txt','page',9,1),(40645,' This','page',9,1),(40646,'other','page',9,2),(40647,'scripts','page',9,5),(40648,'generator','page',9,1),(40649,'addresses','page',9,1),(40650,'NOTE','page',9,2),(40651,'various','page',9,1),(40652,'create','page',9,3),(40653,'menu','page',9,1),(40654,'items','page',9,1),(40655,'a ','page',9,1),(40656,'text-based','page',9,1),(40657,'GUI','page',9,1),(40658,'shouldn','page',9,1),(40659,'place','page',9,1),(40660,'anything','page',9,1),(40661,'outside','page',9,1),(40662,'already','page',9,1),(40663,'there','page',9,1),(40664,'Additionally','page',9,1),(40665,'want','page',9,2),(40666,'add','page',9,1),(40667,'attach','page',9,1),(40668,'pick','page',9,1),(40669,'an','page',9,2),(40670,'/root/C2concealer\r','page',9,1),(40671,'tool','page',9,2),(40672,'generating','page',9,2),(40673,'C2','page',9,6),(40674,'profiles','page',9,4),(40675,'guide','page',9,3),(40676,'Creating','page',9,2),(40677,'Profiles','page',9,2),(40678,'/root/SourcePoint\r','page',9,1),(40679,'another','page',9,1),(40680,'Cobalt Strike','page',9,1),(40681,'/root/cobaltstrike-local\r','page',9,1),(40682,'copy','page',9,3),(40683,'clean','page',9,1),(40684,'when','page',9,2),(40685,'using','page',9,1),(40686,'buildredteam','page',9,4),(40687,'sh','page',9,4),(40688,'it','page',9,3),(40689,'don','page',9,1),(40690,'launch','page',9,1),(40691,'directly','page',9,1),(40692,'from','page',9,1),(40693,'artifacts','page',9,1),(40694,'data','page',9,1),(40695,'generate','page',9,1),(40696,'get','page',9,4),(40697,'populated','page',9,1),(40698,'into','page',9,1),(40699,'cobalt','page',9,1),(40700,'strike','page',9,1),(40701,'via','page',9,1),(40702,'/root/go\r','page',9,1),(40703,'Golang','page',9,1),(40704,'install','page',9,1),(40705,'whatever','page',9,1),(40706,'Go','page',9,5),(40707,'projects','page',9,1),(40708,'mess','page',9,1),(40709,'with','page',9,1),(40710,'/root/Profiles\r','page',9,1),(40711,'where','page',9,3),(40712,'put','page',9,1),(40713,'your','page',9,1),(40714,'look','page',9,1),(40715,'s','page',9,1),(40716,'setting','page',9,1),(40717,'up','page',9,4),(40718,'if','page',9,1),(40719,'are','page',9,1),(40720,'building','page',9,1),(40721,'HAProxy','page',9,1),(40722,'profile','page',9,2),(40723,'set','page',9,3),(40724,'ACLs','page',9,1),(40725,'based','page',9,1),(40726,'/root/scripts\r','page',9,1),(40727,'most','page',9,1),(40728,'custom','page',9,1),(40729,'reside','page',9,1),(40730,'/root/scripts/buildredteam','page',9,1),(40731,'sh\r','page',9,5),(40732,'script','page',9,7),(40733,'automate','page',9,1),(40734,'hosts','page',9,1),(40735,'containers','page',9,2),(40736,'also','page',9,1),(40737,'phishing','page',9,3),(40738,'attacks','page',9,2),(40739,'these','page',9,1),(40740,'/root/scripts/ManageDNS','page',9,1),(40741,'manage','page',9,1),(40742,'DNS','page',9,3),(40743,'records','page',9,2),(40744,'added','page',9,2),(40745,'rootDNS','page',9,2),(40746,'Managing','page',9,1),(40747,'/root/scripts/RegisterDNS','page',9,1),(40748,'new','page',9,1),(40749,'How','page',9,1),(40750,'Manual','page',9,1),(40751,'Domain','page',9,1),(40752,'Registration','page',9,1),(40753,'instructions','page',9,2),(40754,'/root/scripts/phish\r','page',9,1),(40755,'sending','page',9,1),(40756,'emails','page',9,1),(40757,'Phishing','page',9,1),(40758,'Attack','page',9,1),(40759,'/root/scripts/phish/phish','page',9,1),(40760,'Used','page',9,2),(40761,'send','page',9,2),(40762,'phish','page',9,1),(40763,'target','page',9,1),(40764,'/root/scripts/phish/spam','page',9,1),(40765,'targets','page',9,1),(40766,'/root/services\r','page',9,1),(40767,'storing','page',9,1),(40768,'information','page',9,1),(40769,'regarding','page',9,1),(40770,'creates','page',9,1),(40771,'OPFOR','page',10,41),(40772,'Domain','page',10,40),(40773,'Registration','page',10,40),(40774,'outside','page',10,40),(40775,'of','page',10,43),(40776,'NRTS','page',10,46),(40777,'Automation','page',10,40),(40778,'Add','page',10,5),(40779,'Domains','page',10,5),(40780,'based','page',10,6),(40781,'on','page',10,8),(40782,'user','page',10,6),(40783,'created','page',10,6),(40784,'file','page',10,8),(40785,'Step','page',10,5),(40786,'1','page',10,1),(40787,'Obtain','page',10,1),(40788,'the','page',10,17),(40789,'RegisterDNS','page',10,4),(40790,'sh','page',10,7),(40791,'script','page',10,5),(40792,'This','page',10,1),(40793,'can','page',10,3),(40794,'be','page',10,1),(40795,'found','page',10,1),(40796,'any','page',10,1),(40797,'server','page',10,3),(40798,'at','page',10,3),(40799,'/root/scripts','page',10,2),(40800,'You','page',10,1),(40801,'use','page',10,1),(40802,'it','page',10,3),(40803,'from','page',10,2),(40804,'or','page',10,5),(40805,'SCP','page',10,1),(40806,'over','page',10,1),(40807,'to','page',10,5),(40808,'Kali','page',10,1),(40809,'most','page',10,1),(40810,'Linux','page',10,1),(40811,'systems','page',10,1),(40812,'2','page',10,1),(40813,'Set','page',10,1),(40814,'up','page',10,2),(40815,'ssh','page',10,2),(40816,'keys','page',10,2),(40817,'between','page',10,1),(40818,'system','page',10,1),(40819,'you','page',10,3),(40820,'are','page',10,3),(40821,'and','page',10,1),(40822,'rootDNS','page',10,1),(40823,'198','page',10,1),(40824,'41','page',10,2),(40825,'0','page',10,2),(40826,'4','page',10,3),(40827,' ','page',10,4),(40828,'If','page',10,1),(40829,'doing','page',10,1),(40830,'this','page',10,4),(40831,'an','page',10,3),(40832,'skip','page',10,1),(40833,'step','page',10,1),(40834,'since','page',10,1),(40835,'set','page',10,1),(40836,'during','page',10,1),(40837,'initial','page',10,1),(40838,'build','page',10,1),(40839,'ssh-copy-id','page',10,1),(40840,'root@198','page',10,1),(40841,'##','page',10,1),(40842,'password','page',10,1),(40843,'is','page',10,4),(40844,'toor','page',10,1),(40845,'3','page',10,1),(40846,'Look','page',10,1),(40847,'s','page',10,2),(40848,'usage','page',10,2),(40849,'Run','page',10,2),(40850,'without','page',10,1),(40851,'passing','page',10,1),(40852,'a','page',10,3),(40853,'argument','page',10,1),(40854,'Create','page',10,1),(40855,'DNS','page',10,9),(40856,'according','page',10,1),(40857,'scripts','page',10,1),(40858,'Below','page',10,1),(40859,'example','page',10,1),(40860,'5','page',10,1),(40861,'with','page',10,1),(40862,'path','page',10,1),(40863,'your','page',10,1),(40864,'ex','page',10,1),(40865,'\\RegisterDNS','page',10,1),(40866,'mydns','page',10,1),(40867,'txt','page',10,1),(40868,'Managing','page',10,5),(40869,'On','page',10,1),(40870,'in','page',10,1),(40871,'directory','page',10,1),(40872,'called','page',10,1),(40873,'ManageDNS','page',10,1),(40874,'  ','page',10,1),(40875,'Use','page',10,1),(40876,'View','page',10,1),(40877,'Delete','page',10,1),(40878,'registrations','page',10,1),(40879,'tagged','page',10,1),(40880,'by','page',10,2),(40881,'when','page',10,1),(40882,'either','page',10,1),(40883,'as','page',10,1),(40884,'part','page',10,1),(40885,'process','page',10,1),(40886,'buildredteam','page',10,1),(40887,'For','page',10,1),(40888,'more','page',10,1),(40889,'information','page',10,1),(40890,'go','page',10,1),(40891,'-','page',10,2),(40892,'Using','page',10,1),(40893,'Code','page',12,40),(40894,'Signing','page',12,40),(40895,'Binaries','page',12,40),(40896,'Using','page',12,1),(40897,'the','page',12,1),(40898,'CA-server','page',12,1),(40899,'to','page',12,1),(40900,'sign','page',12,1),(40901,'binaries','page',12,1),(40902,'SSH','page',12,1),(40903,'into','page',12,1),(40904,'globalcerts','page',12,1),(40905,'com','page',12,1),(40906,'  ','page',12,1),(40907,'Creds','page',12,1),(40908,'root ','page',12,1),(40909,'password','page',12,1),(40910,'toor','page',12,1),(40911,'Setting','page',30,41),(40912,'up','page',30,42),(40913,'the','page',30,104),(40914,'Traffic-Gen','page',30,52),(40915,'for','page',30,49),(40916,'a','page',30,65),(40917,'Target','page',30,48),(40918,'Domain','page',30,48),(40919,'The','page',30,7),(40920,'is','page',30,18),(40921,'designed','page',30,1),(40922,'to','page',30,40),(40923,'send','page',30,8),(40924,'emails','page',30,14),(40925,'from','page',30,9),(40926,'external','page',30,1),(40927,'sources','page',30,1),(40928,'users','page',30,2),(40929,' ','page',30,30),(40930,'It','page',30,1),(40931,'does','page',30,1),(40932,'this','page',30,14),(40933,'by','page',30,2),(40934,'creating','page',30,2),(40935,'docker','page',30,2),(40936,'container','page',30,3),(40937,'each','page',30,3),(40938,'domain','page',30,14),(40939,'that','page',30,13),(40940,'it','page',30,20),(40941,'will','page',30,9),(40942,'use','page',30,5),(40943,'Then','page',30,3),(40944,'script','page',30,8),(40945,'runs','page',30,2),(40946,'in','page',30,10),(40947,'generate','page',30,2),(40948,'randomized','page',30,1),(40949,'list','page',30,12),(40950,'of','page',30,14),(40951,'email','page',30,7),(40952,'address','page',30,5),(40953,'you','page',30,24),(40954,'provide','page',30,1),(40955,'takes','page',30,1),(40956,'little','page',30,1),(40957,'bit','page',30,1),(40958,'effort','page',30,1),(40959,'but','page',30,2),(40960,'s','page',30,4),(40961,'not','page',30,1),(40962,'too','page',30,1),(40963,'bad','page',30,1),(40964,'Step','page',30,5),(40965,'1','page',30,2),(40966,'Make','page',30,1),(40967,'sure','page',30,3),(40968,'your','page',30,13),(40969,'target','page',30,15),(40970,'connected','page',30,3),(40971,'Cyber','page',30,6),(40972,'Range','page',30,6),(40973,'See','page',30,2),(40974,'Planning','page',30,2),(40975,'Guide','page',30,2),(40976,'-','page',30,3),(40977,'Connecting','page',30,1),(40978,'  ','page',30,2),(40979,'Once','page',30,3),(40980,'make','page',30,2),(40981,'add','page',30,2),(40982,'DNS','page',30,5),(40983,'record','page',30,2),(40984,'rootDNS','page',30,2),(40985,'server','page',30,7),(40986,'Adding','page',30,1),(40987,'and','page',30,15),(40988,'configured','page',30,1),(40989,'exchange','page',30,9),(40990,'reachable','page',30,3),(40991,'You','page',30,4),(40992,'can','page',30,7),(40993,'do','page',30,3),(40994,'running','page',30,2),(40995,'telnet','page',30,4),(40996,'test','page',30,3),(40997,'any','page',30,1),(40998,'system','page',30,2),(40999,'below','page',30,2),(41000,'an','page',30,5),(41001,'example','page',30,5),(41002,'using','page',30,2),(41003,'NRTS','page',30,1),(41004,'reach','page',30,1),(41005,'at','page',30,5),(41006,'galfed','page',30,4),(41007,'com','page',30,3),(41008,'25\r','page',30,1),(41009,'\r','page',30,6),(41010,'##','page',30,2),(41011,'When','page',30,2),(41012,'run','page',30,3),(41013,'above','page',30,3),(41014,'command','page',30,2),(41015,'should','page',30,6),(41016,'get','page',30,4),(41017,'response','page',30,2),(41018,'looks','page',30,1),(41019,'something','page',30,1),(41020,'like','page',30,5),(41021,'following','page',30,6),(41022,'Trying','page',30,1),(41023,'8','page',30,1),(41024,'21','page',30,1),(41025,'10','page',30,1),(41026,'19','page',30,1),(41027,'Connected','page',30,1),(41028,'com\r','page',30,1),(41029,'Escape','page',30,1),(41030,'Character','page',30,1),(41031,'^','page',30,1),(41032,'220','page',30,1),(41033,'GF-exch01','page',30,1),(41034,'Microsoft','page',30,1),(41035,'ESMTP','page',30,1),(41036,'MAIL','page',30,1),(41037,'Service','page',30,1),(41038,'ready','page',30,1),(41039,'If','page',30,4),(41040,'connection','page',30,2),(41041,'works','page',30,1),(41042,'proceed','page',30,2),(41043,'2','page',30,3),(41044,'Otherwise','page',30,1),(41045,'troubleshoot','page',30,1),(41046,'and/or','page',30,1),(41047,'on','page',30,2),(41048,'fix','page',30,1),(41049,'issue','page',30,1),(41050,'don','page',30,1),(41051,'t','page',30,1),(41052,'step','page',30,2),(41053,'until','page',30,1),(41054,'ve','page',30,2),(41055,'had','page',30,1),(41056,'successful','page',30,1),(41057,'At','page',30,4),(41058,'point','page',30,4),(41059,'have','page',30,8),(41060,'validated','page',30,2),(41061,'next','page',30,1),(41062,'compiling','page',30,1),(41063,'would','page',30,4),(41064,'user','page',30,1),(41065,'csv','page',30,1),(41066,'made','page',30,2),(41067,'if','page',30,3),(41068,'used','page',30,1),(41069,'CreateADusers','page',30,1),(41070,'ps1','page',30,1),(41071,'or','page',30,1),(41072,'powershell','page',30,1),(41073,'via','page',30,2),(41074,'management','page',30,1),(41075,'console','page',30,1),(41076,'want','page',30,2),(41077,'need','page',30,2),(41078,'over','page',30,2),(41079,'SCP','page',30,2),(41080,'Below','page',30,3),(41081,'SCPing','page',30,1),(41082,'For','page',30,1),(41083,'galfedemails','page',30,4),(41084,'txt','page',30,9),(41085,'my','page',30,1),(41086,'be','page',30,3),(41087,'format','page',30,1),(41088,'one','page',30,1),(41089,'per','page',30,1),(41090,'line','page',30,1),(41091,'no','page',30,2),(41092,'spaces','page',30,1),(41093,'commas','page',30,1),(41094,'we','page',30,6),(41095,'ll','page',30,3),(41096,'IP','page',30,3),(41097,'92','page',30,1),(41098,'107','page',30,2),(41099,'127','page',30,2),(41100,'12','page',30,2),(41101,'file','page',30,6),(41102,'scp','page',30,1),(41103,'root@92','page',30,1),(41104,'/root','page',30,1),(41105,'3','page',30,1),(41106,'transfer','page',30,1),(41107,'Next','page',30,1),(41108,'folder','page',30,2),(41109,'dos2unix','page',30,2),(41110,'against','page',30,1),(41111,'renaming','page',30,2),(41112,'sends','page',30,1),(41113,'needs','page',30,2),(41114,'named','page',30,2),(41115,'sendto','page',30,3),(41116,'build-compose','page',30,2),(41117,'sh','page',30,6),(41118,'specific','page',30,1),(41119,'directory','page',30,4),(41120,'making','page',30,1),(41121,'dos2unixing','page',30,1),(41122,'cd','page',30,4),(41123,'/root\r','page',30,3),(41124,'txt\r','page',30,1),(41125,'mkdir','page',30,1),(41126,'/root/TG/SendTo/GALFED\r','page',30,1),(41127,'mv','page',30,1),(41128,'/root/TG/SendTo/GALFED/sendto','page',30,1),(41129,'4','page',30,1),(41130,'Now','page',30,1),(41131,'our','page',30,1),(41132,'transferred','page',30,1),(41133,'re-named','page',30,1),(41134,'as','page',30,3),(41135,'placed','page',30,1),(41136,'custom','page',30,1),(41137,'/root/TG/SendTo','page',30,1),(41138,'build','page',30,1),(41139,'docker-compose','page',30,2),(41140,'yml','page',30,2),(41141,'how','page',30,2),(41142,'launch','page',30,1),(41143,'buildcompose','page',30,1),(41144,'root\r','page',30,1),(41145,'/buidcompose','page',30,1),(41146,'first','page',30,1),(41147,'preforms','page',30,1),(41148,'some','page',30,1),(41149,'checks','page',30,3),(41150,'/root/emailerlist','page',30,1),(41151,'contains','page',30,1),(41152,'domains','page',30,8),(41153,'associated','page',30,1),(41154,'IPs','page',30,1),(41155,'sender','page',30,1),(41156,'read','page',30,1),(41157,'validate','page',30,1),(41158,'has','page',30,1),(41159,'those','page',30,2),(41160,'assigned','page',30,1),(41161,'lookup','page',30,1),(41162,'resolve','page',30,2),(41163,'listed','page',30,1),(41164,'emailerlist','page',30,1),(41165,'what','page',30,1),(41166,'see','page',30,1),(41167,'everything','page',30,2),(41168,'out','page',30,1),(41169,'errors','page',30,1),(41170,'display','page',30,1),(41171,'issues','page',30,1),(41172,'before','page',30,1),(41173,'proceeding','page',30,1),(41174,'are','page',30,2),(41175,'good','page',30,1),(41176,'pop','page',30,1),(41177,'text-based','page',30,1),(41178,'GUI','page',30,1),(41179,'show','page',30,1),(41180,'sending','page',30,2),(41181,'then','page',30,1),(41182,'select','page',30,2),(41183,'In','page',30,1),(41184,'case','page',30,1),(41185,'GALFED','page',30,2),(41186,'only','page',30,1),(41187,'option','page',30,3),(41188,'multiple','page',30,1),(41189,'gone','page',30,1),(41190,'through','page',30,1),(41191,'steps','page',30,1),(41192,'create','page',30,1),(41193,'with','page',30,2),(41194,'automatically','page',30,1),(41195,'another','page',30,1),(41196,'That','page',30,1),(41197,'said','page',30,1),(41198,'press','page',30,1),(41199,'enter','page',30,1),(41200,'builds','page',30,1),(41201,'tells','page',30,1),(41202,'start','page',30,1),(41203,'kick','page',30,1),(41204,'off','page',30,1),(41205,'just','page',30,1),(41206,'/starttrafficgen','page',30,1),(41207,'went','page',30,1),(41208,'well','page',30,1),(41209,'traffic','page',30,2),(41210,'now','page',30,1),(41211,'being','page',30,1),(41212,'sent','page',30,1),(41213,'output','page',30,3),(41214,'look','page',30,2),(41215,'check','page',30,1),(41216,'logs','page',30,2),(41217,'these','page',30,1),(41218,'located','page',30,1),(41219,'/root/TG/TrafficLog','page',30,1),(41220,'There','page',30,1),(41221,'log','page',30,1),(41222,'emailing','page',30,1),(41223,'tail','page',30,2),(41224,'all','page',30,1),(41225,'once','page',30,1),(41226,'-f','page',30,1),(41227,'/root/TG/TrafficLog/*','page',30,1),(41228,'Here','page',30,1),(41229,'sample','page',30,1),(41230,'To','page',30,1),(41231,'stop','page',30,1),(41232,'/stoptrafficgen','page',30,1),(41233,'Creating','page',13,40),(41234,'Cobalt','page',13,50),(41235,'Strike','page',13,49),(41236,'C2','page',13,47),(41237,'Profiles','page',13,44),(41238,'Script','page',13,4),(41239,'generated','page',13,6),(41240,'There','page',13,2),(41241,'are','page',13,7),(41242,'two','page',13,3),(41243,'different','page',13,1),(41244,'solutions','page',13,1),(41245,'installed','page',13,1),(41246,'on','page',13,10),(41247,'the','page',13,41),(41248,'NRTS','page',13,6),(41249,'by','page',13,4),(41250,'default','page',13,2),(41251,' ','page',13,20),(41252,'These','page',13,1),(41253,'Forty','page',13,1),(41254,'North','page',13,1),(41255,'Securities','page',13,1),(41256,'C2Concealer','page',13,1),(41257,'and','page',13,15),(41258,'Tylous','page',13,1),(41259,'s','page',13,5),(41260,'Github','page',13,1),(41261,'SourcePoint','page',13,7),(41262,'You','page',13,1),(41263,'should','page',13,3),(41264,'test','page',13,7),(41265,'these','page',13,3),(41266,'out','page',13,2),(41267,'prior','page',13,1),(41268,'to','page',13,29),(41269,'building','page',13,2),(41270,'an','page',13,5),(41271,'engagement','page',13,2),(41272,'worth','page',13,1),(41273,'of','page',13,8),(41274,'payloads','page',13,1),(41275,'there','page',13,1),(41276,'some','page',13,2),(41277,'issues','page',13,2),(41278,'especially','page',13,1),(41279,'since','page',13,1),(41280,'updates','page',13,1),(41281,'have','page',13,1),(41282,'a','page',13,26),(41283,'tendency','page',13,1),(41284,'mess','page',13,1),(41285,'around','page',13,1),(41286,'with','page',13,5),(41287,'profile','page',13,19),(41288,'syntax','page',13,1),(41289,'One','page',13,1),(41290,'more','page',13,4),(41291,'common','page',13,1),(41292,'seen','page',13,1),(41293,'is','page',13,16),(41294,'very','page',13,1),(41295,'slow','page',13,1),(41296,'download','page',13,2),(41297,'transfer','page',13,1),(41298,'rates','page',13,1),(41299,'through','page',13,3),(41300,'beacon','page',13,2),(41301,'After','page',13,1),(41302,'you','page',13,23),(41303,'build','page',13,1),(41304,'I','page',13,1),(41305,'d','page',13,2),(41306,'advice','page',13,1),(41307,'generating','page',13,1),(41308,'payload','page',13,1),(41309,'dropping','page',13,1),(41310,'it','page',13,14),(41311,'target','page',13,2),(41312,'trying','page',13,2),(41313,'50mb','page',13,1),(41314,'or','page',13,3),(41315,'larger','page',13,2),(41316,'file','page',13,1),(41317,'see','page',13,3),(41318,'how','page',13,2),(41319,'long','page',13,1),(41320,'takes','page',13,1),(41321,'Another','page',13,1),(41322,'issue','page',13,1),(41323,'involves','page',13,1),(41324,'processes','page',13,1),(41325,'used','page',13,1),(41326,'for','page',13,6),(41327,'fork','page',13,1),(41328,'run','page',13,3),(41329,'actions','page',13,1),(41330,'like','page',13,2),(41331,'spawning','page',13,1),(41332,'running','page',13,1),(41333,'execute-assembly','page',13,1),(41334,'So','page',13,2),(41335,'also','page',13,1),(41336,'testing','page',13,1),(41337,'this','page',13,6),(41338,'functionality','page',13,1),(41339,'your','page',13,2),(41340,'as','page',13,3),(41341,'well','page',13,1),(41342,'Using','page',13,6),(41343,'C2concealer','page',13,9),(41344,'NOTE','page',13,2),(41345,'added','page',13,2),(41346,'path','page',13,3),(41347,'so','page',13,3),(41348,'don','page',13,1),(41349,'t','page',13,3),(41350,'need','page',13,2),(41351,'be','page',13,2),(41352,'in','page',13,10),(41353,'directory','page',13,5),(41354,'use','page',13,4),(41355,'\r','page',13,36),(41356,'arguments','page',13,5),(41357,'that','page',13,6),(41358,'accepts','page',13,1),(41359,'--variants','page',13,2),(41360,'--hostname','page',13,2),(41361,'The','page',13,6),(41362,'script','page',13,9),(41363,'will','page',13,12),(41364,'generate','page',13,2),(41365,'based','page',13,3),(41366,'off','page',13,1),(41367,'hostname','page',13,1),(41368,'provide','page',13,3),(41369,'add','page',13,3),(41370,'variants','page',13,4),(41371,'number','page',13,3),(41372,'set','page',13,3),(41373,'max','page',13,1),(41374,'10','page',13,1),(41375,'but','page',13,2),(41376,'good','page',13,2),(41377,'idea','page',13,2),(41378,'0','page',13,2),(41379,'generates','page',13,1),(41380,'against','page',13,1),(41381,'Strikes','page',13,1),(41382,'c2lint','page',13,3),(41383,'great','page',13,2),(41384,'chances','page',13,1),(41385,'fail','page',13,2),(41386,'built','page',13,1),(41387,'comes','page',13,1),(41388,'designed','page',13,1),(41389,'test/validate','page',13,1),(41390,'Below','page',13,3),(41391,'usage','page',13,1),(41392,'example','page',13,2),(41393,'humanzoo','page',13,4),(41394,'com','page',13,2),(41395,'ask','page',13,1),(41396,'SSL','page',13,7),(41397,'option','page',13,3),(41398,'options','page',13,1),(41399,'Self-signed','page',13,1),(41400,'cert\r','page',13,2),(41401,'LetsEncrypt','page',13,2),(41402,'Existing','page',13,1),(41403,'Keystore\r','page',13,1),(41404,'No','page',13,2),(41405,'SSL\r','page',13,1),(41406,'If','page',13,2),(41407,'plan','page',13,1),(41408,'using','page',13,2),(41409,'redirector','page',13,3),(41410,'can','page',13,3),(41411,'select','page',13,3),(41412,'handle','page',13,1),(41413,'certs','page',13,3),(41414,'all','page',13,1),(41415,'domains','page',13,1),(41416,'aren','page',13,1),(41417,'generator','page',13,1),(41418,'CA-server','page',13,1),(41419,'then','page',13,1),(41420,'those','page',13,2),(41421,'keystore','page',13,1),(41422,'Or','page',13,1),(41423,'self-signed','page',13,3),(41424,'not','page',13,2),(41425,'solution','page',13,1),(41426,'unless','page',13,1),(41427,'indicator','page',13,1),(41428,'want','page',13,1),(41429,'emulate','page',13,1),(41430,'cert','page',13,1),(41431,'closed','page',13,1),(41432,'grayspace','page',13,1),(41433,'environment','page',13,1),(41434,'Once','page',13,1),(41435,'ve','page',13,1),(41436,'made','page',13,1),(41437,'selection','page',13,1),(41438,'tool','page',13,2),(41439,'get','page',13,2),(41440,'output','page',13,1),(41441,'scroll','page',13,1),(41442,'C2lint','page',13,2),(41443,'check','page',13,1),(41444,'finish','page',13,1),(41445,'following','page',13,1),(41446,'############################################################\r','page',13,1),(41447,'#','page',13,3),(41448,'Profile','page',13,5),(41449,'successfully','page',13,1),(41450,'passed','page',13,1),(41451,'C2lintcheck','page',13,1),(41452,'#\r','page',13,3),(41453,'name','page',13,3),(41454,'ba3e5732','page',13,2),(41455,'Generated','page',13,2),(41456,'FortyNorthSecurity','page',13,1),(41457,'############################################################','page',13,1),(41458,'It','page',13,1),(41459,'saves','page',13,1),(41460,'randomly','page',13,1),(41461,'named','page',13,1),(41462,'ran','page',13,2),(41463,'from','page',13,1),(41464,'next','page',13,1),(41465,'step','page',13,1),(41466,'rename','page',13,1),(41467,'something','page',13,1),(41468,'meaningful','page',13,1),(41469,'moving','page',13,1),(41470,'buildredteam','page',13,1),(41471,'sh','page',13,1),(41472,'look','page',13,2),(41473,'when','page',13,2),(41474,'teamserver','page',13,2),(41475,'This','page',13,4),(41476,'/root/Profiles','page',13,1),(41477,'modify','page',13,1),(41478,'needed','page',13,1),(41479,'where','page',13,1),(41480,'created','page',13,1),(41481,'what','page',13,1),(41482,'regards','page',13,1),(41483,'randomized','page',13,1),(41484,'mv','page',13,2),(41485,'profile\r','page',13,3),(41486,'/root/Profiles/','page',13,1),(41487,'At','page',13,1),(41488,'point','page',13,1),(41489,'ready','page',13,1),(41490,'go','page',13,1),(41491,'up','page',13,1),(41492,'give','page',13,1),(41493,'isn','page',13,1),(41494,'full','page',13,2),(41495,'navigate','page',13,1),(41496,'Path','page',13,1),(41497,'executable','page',13,1),(41498,'/root/SourcePoint/SourcePoint\r','page',13,1),(41499,'SourePoint','page',13,1),(41500,'has','page',13,1),(41501,'gives','page',13,1),(41502,'lot','page',13,1),(41503,'control','page',13,1),(41504,'For','page',13,1),(41505,'guide','page',13,1),(41506,'we','page',13,1),(41507,'ll','page',13,1),(41508,'cover','page',13,1),(41509,'just','page',13,1),(41510,'required','page',13,1),(41511,'list','page',13,1),(41512,'/SourcePoint','page',13,2),(41513,'-h','page',13,1),(41514,'Required','page',13,1),(41515,'-host  \r','page',13,1),(41516,'host','page',13,1),(41517,'server','page',13,1),(41518,'variable','page',13,1),(41519,'-Outfile\r','page',13,1),(41520,'name/path','page',13,1),(41521,'save','page',13,1),(41522,'as\r','page',13,1),(41523,'-Injector\r','page',13,1),(41524,'process','page',13,1),(41525,'injection','page',13,1),(41526,'method','page',13,1),(41527,'provides','page',13,1),(41528,'options \r','page',13,1),(41529,'VirtualAllocEx','page',13,3),(41530,'Great','page',13,1),(41531,'cross','page',13,1),(41532,'architecture','page',13,1),(41533,'i','page',13,1),(41534,'e','page',13,1),(41535,'x86','page',13,2),(41536,'-','page',13,2),(41537,'x64','page',13,1),(41538,'x64-','page',13,1),(41539,'NtMapViewOfSection','page',13,1),(41540,'A','page',13,1),(41541,'stealthy','page',13,1),(41542,'however','page',13,1),(41543,'fails','page',13,1),(41544,'over','page',13,1),(41545,'Example','page',13,1),(41546,'Usage','page',13,1),(41547,'cd','page',13,2),(41548,'/root/SourcePoint\r','page',13,1),(41549,'-Host','page',13,1),(41550,'-Outfile','page',13,1),(41551,'/root/Profiles/humanzoo2','page',13,3),(41552,'-Injector','page',13,1),(41553,'Output','page',13,1),(41554,'_____','page',13,1),(41555,'____','page',13,1),(41556,'_','page',13,3),(41557,'__','page',13,6),(41558,'/','page',13,18),(41559,'___/____','page',13,1),(41560,'_______________','page',13,1),(41561,'\\____','page',13,1),(41562,'___','page',13,1),(41563,'/_\r','page',13,1),(41564,'\\__','page',13,1),(41565,'\\/','page',13,5),(41566,'___/','page',13,3),(41567,'/_/','page',13,4),(41568,'__/\r','page',13,1),(41569,'/__/','page',13,1),(41570,'__/','page',13,1),(41571,'____/','page',13,1),(41572,'/_','page',13,1),(41573,'/____/\\____/\\__','page',13,1),(41574,'_/_/','page',13,1),(41575,'\\___/\\___/_/','page',13,1),(41576,'\\____/_/_/','page',13,1),(41577,'/_/\\__/','page',13,1),(41578,'@Tyl0us','page',13,1),(41579,'*','page',13,5),(41580,'Preparing','page',13,1),(41581,'Varibles','page',13,1),(41582,'Building','page',13,1),(41583,'Host','page',13,1),(41584,'Staging','page',13,1),(41585,'Is','page',13,2),(41586,'Disabled','page',13,1),(41587,'Staged','page',13,1),(41588,'Payloads','page',13,1),(41589,'Are','page',13,1),(41590,'Not','page',13,2),(41591,'Available','page',13,2),(41592,'But','page',13,1),(41593,'Your','page',13,1),(41594,'Beacon','page',13,4),(41595,'Payload','page',13,1),(41596,'To','page',13,2),(41597,'Anyone','page',13,1),(41598,'That','page',13,1),(41599,'Connects\r','page',13,1),(41600,'DLL','page',13,1),(41601,'Spoofed','page',13,1),(41602,'audioeng','page',13,1),(41603,'dll\r','page',13,1),(41604,'Post-Ex','page',13,1),(41605,'Process','page',13,1),(41606,'Name','page',13,1),(41607,'gpupdate','page',13,1),(41608,'exe\r','page',13,1),(41609,'Shellcode','page',13,1),(41610,'Will','page',13,1),(41611,'Obfuscate','page',13,1),(41612,'Memory','page',13,1),(41613,'Prior','page',13,1),(41614,'Sleeping\r','page',13,1),(41615,'Seleted','page',13,1),(41616,'+','page',13,2),(41617,'Happy','page',13,1),(41618,'Hacking\r','page',13,1),(41619,'root@nrts','page',13,1),(41620,'~/Source','page',13,1),(41621,'profiles','page',13,2),(41622,'via','page',13,1),(41623,'before','page',13,1),(41624,'them','page',13,1),(41625,'/root/cobaltstrike-local\r','page',13,1),(41626,'/c2lint','page',13,1),(41627,'Starting','page',14,40),(41628,'a','page',14,63),(41629,'Cobalt','page',14,50),(41630,'Strike','page',14,50),(41631,'Teamserver','page',14,40),(41632,'buildredteam','page',14,41),(41633,'sh','page',14,41),(41634,'NOTE','page',14,2),(41635,'The','page',14,3),(41636,'NRTS','page',14,5),(41637,'is','page',14,15),(41638,'designed','page',14,2),(41639,'to','page',14,28),(41640,'run','page',14,2),(41641,'red','page',14,1),(41642,'team','page',14,1),(41643,'infrastructure','page',14,1),(41644,'using','page',14,3),(41645,'docker','page',14,4),(41646,'containers','page',14,1),(41647,' ','page',14,34),(41648,'Building','page',14,1),(41649,'these','page',14,2),(41650,'out','page',14,2),(41651,'and','page',14,16),(41652,'managing','page',14,1),(41653,'the','page',14,49),(41654,'network','page',14,1),(41655,'for','page',14,7),(41656,'this','page',14,18),(41657,'best','page',14,1),(41658,'left','page',14,1),(41659,'up','page',14,6),(41660,'script','page',14,8),(41661,'do','page',14,1),(41662,'so','page',14,5),(41663,'On','page',14,1),(41664,'root','page',14,1),(41665,'folder','page',14,3),(41666,'of','page',14,10),(41667,'copy','page',14,1),(41668,'listed','page',14,3),(41669,'as','page',14,3),(41670,'cobaltstrike-local','page',14,1),(41671,'This','page',14,6),(41672,'clean','page',14,1),(41673,'template','page',14,1),(41674,'you','page',14,31),(41675,'shouldn','page',14,1),(41676,'t','page',14,2),(41677,'use','page',14,10),(41678,'start','page',14,5),(41679,'teamserver','page',14,8),(41680,'directly','page',14,1),(41681,'Doing','page',14,1),(41682,'would','page',14,1),(41683,'create','page',14,3),(41684,'artifacts','page',14,1),(41685,'on','page',14,7),(41686,'any','page',14,2),(41687,'build','page',14,5),(41688,'That','page',14,1),(41689,'said','page',14,1),(41690,'instructions','page',14,2),(41691,'are','page',14,2),(41692,'Also','page',14,1),(41693,'guide','page',14,3),(41694,'assuming','page',14,1),(41695,'that','page',14,5),(41696,'have','page',14,3),(41697,'already','page',14,2),(41698,'created','page',14,2),(41699,'C2','page',14,3),(41700,'profile','page',14,5),(41701,'want','page',14,5),(41702,'For','page',14,9),(41703,'example','page',14,7),(41704,'we','page',14,8),(41705,'will','page',14,22),(41706,'humanzoo','page',14,1),(41707,'how','page',14,1),(41708,'profiles','page',14,2),(41709,'go','page',14,1),(41710,'-','page',14,4),(41711,'Using','page',14,1),(41712,'Creating','page',14,1),(41713,'Profiles','page',14,1),(41714,'Use','page',14,2),(41715,'following','page',14,1),(41716,'an','page',14,4),(41717,'server','page',14,1),(41718,'\r','page',14,11),(41719,'/root/scripts/buildredteam','page',14,1),(41720,'sh\r','page',14,2),(41721,'Example','page',14,1),(41722,'usage','page',14,1),(41723,'cd','page',14,1),(41724,'/root/scripts\r','page',14,1),(41725,'/buildredteam','page',14,1),(41726,'pop','page',14,1),(41727,'text-based','page',14,1),(41728,'menu','page',14,6),(41729,'At','page',14,5),(41730,'screen','page',14,3),(41731,'below','page',14,2),(41732,'select','page',14,7),(41733,'option','page',14,7),(41734,'3','page',14,1),(41735,'Set','page',14,3),(41736,'Next','page',14,4),(41737,'it','page',14,17),(41738,'ask','page',14,5),(41739,'service','page',14,2),(41740,'tag','page',14,1),(41741,'by','page',14,1),(41742,'default','page',14,4),(41743,'give','page',14,3),(41744,'TS1','page',14,2),(41745,'or','page',14,6),(41746,'if','page',14,4),(41747,'there','page',14,1),(41748,'TS2','page',14,1),(41749,'You','page',14,1),(41750,'can','page',14,4),(41751,'keep','page',14,1),(41752,'name','page',14,3),(41753,'add','page',14,2),(41754,'your','page',14,4),(41755,'own','page',14,1),(41756,'be','page',14,4),(41757,'creates','page',14,1),(41758,'in','page',14,7),(41759,'/root/services','page',14,1),(41760,'its','page',14,1),(41761,'container','page',14,4),(41762,'also','page',14,2),(41763,'itself','page',14,1),(41764,'ll','page',14,6),(41765,'leave','page',14,1),(41766,' \r','page',14,1),(41767,'set','page',14,8),(41768,'IPs','page',14,5),(41769,'has','page',14,2),(41770,'list','page',14,5),(41771,'IP','page',14,17),(41772,'subnets','page',14,3),(41773,'stored','page',14,1),(41774,'Geo-location','page',14,3),(41775,'based','page',14,1),(41776,'structure','page',14,1),(41777,'at','page',14,1),(41778,'/root/backbonerouters','page',14,1),(41779,'Here','page',14,1),(41780,'what','page',14,6),(41781,'Geo-based','page',14,1),(41782,'with','page',14,3),(41783,'26 ','page',14,1),(41784,'USA','page',14,2),(41785,'drill','page',14,1),(41786,'down','page',14,3),(41787,'further','page',14,1),(41788,'City','page',14,1),(41789,'location','page',14,1),(41790,'some','page',14,1),(41791,'only','page',14,1),(41792,'one','page',14,4),(41793,'but','page',14,2),(41794,'several','page',14,1),(41795,'12','page',14,1),(41796,'Seattle','page',14,1),(41797,'Then','page',14,2),(41798,'randomly','page',14,4),(41799,'generated','page',14,1),(41800,'manually','page',14,3),(41801,'walk','page',14,1),(41802,'through','page',14,1),(41803,'both','page',14,1),(41804,'options','page',14,1),(41805,'from','page',14,5),(41806,'selected','page',14,5),(41807,'during','page',14,2),(41808,'processing','page',14,2),(41809,'move','page',14,2),(41810,'next','page',14,3),(41811,'manual','page',14,3),(41812,'need','page',14,1),(41813,'put','page',14,1),(41814,'yourself','page',14,1),(41815,'view','page',14,3),(41816,'available','page',14,1),(41817,'which','page',14,1),(41818,'show','page',14,1),(41819,'It','page',14,2),(41820,'then','page',14,4),(41821,'validates','page',14,1),(41822,'enter','page',14,6),(41823,'correct','page',14,1),(41824,'before','page',14,1),(41825,'proceeding','page',14,1),(41826,'s','page',14,3),(41827,'not','page',14,1),(41828,'validate','page',14,1),(41829,'try','page',14,1),(41830,'again','page',14,1),(41831,'Setting','page',14,2),(41832,'Option','page',14,2),(41833,'1','page',14,3),(41834,'random','page',14,2),(41835,'When','page',14,1),(41836,'step','page',14,1),(41837,'shown','page',14,1),(41838,'after','page',14,1),(41839,'going','page',14,1),(41840,'over','page',14,2),(41841,'process','page',14,4),(41842,'2','page',14,2),(41843,'few','page',14,1),(41844,'screenshots','page',14,1),(41845,'shows','page',14,2),(41846,'  ','page',14,2),(41847,'Below','page',14,3),(41848,'when','page',14,2),(41849,'press','page',14,4),(41850,'see','page',14,2),(41851,'long','page',14,1),(41852,'short','page',14,1),(41853,'depending','page',14,1),(41854,'space','page',14,1),(41855,'bar','page',14,1),(41856,'page','page',14,1),(41857,'q','page',14,2),(41858,'exit','page',14,2),(41859,'get','page',14,1),(41860,'back','page',14,2),(41861,'previous','page',14,2),(41862,'After','page',14,1),(41863,'ve','page',14,3),(41864,'decided','page',14,1),(41865,'subnet','page',14,3),(41866,'above','page',14,2),(41867,'write','page',14,1),(41868,'memorize','page',14,1),(41869,'take','page',14,1),(41870,'From','page',14,1),(41871,'54','page',14,3),(41872,'88','page',14,3),(41873,'220','page',14,3),(41874,'10','page',14,1),(41875,'1/22','page',14,1),(41876,'Never','page',14,1),(41877,'actual','page',14,1),(41878,'wouldn','page',14,1),(41879,'case','page',14,1),(41880,'gateway','page',14,1),(41881,'resides','page',14,1),(41882,'SI-router','page',14,1),(41883,'point','page',14,3),(41884,'either','page',14,1),(41885,'pulls','page',14,1),(41886,'files','page',14,1),(41887,'/root/Profiles','page',14,1),(41888,'make','page',14,1),(41889,'sure','page',14,1),(41890,'where','page',14,1),(41891,'save','page',14,1),(41892,'humanzoo2','page',14,1),(41893,'password','page',14,2),(41894,'toor','page',14,1),(41895,'all','page',14,1),(41896,'settings','page',14,1),(41897,'needed','page',14,1),(41898,'once','page',14,1),(41899,'happy','page',14,1),(41900,'looks','page',14,1),(41901,'like','page',14,1),(41902,'exits','page',14,1),(41903,'should','page',14,1),(41904,'running','page',14,1),(41905,'Information','page',14,1),(41906,'about','page',14,1),(41907,'placed','page',14,1),(41908,'/root/services/TS1/','page',14,1),(41909,'directory','page',14,1),(41910,'To','page',14,1),(41911,'check','page',14,1),(41912,'ps','page',14,1),(41913,'screenshot','page',14,1),(41914,'Making','page',15,40),(41915,'a','page',15,68),(41916,'HAProxy','page',15,44),(41917,'Redirector','page',15,40),(41918,'buildredteam','page',15,40),(41919,'sh','page',15,40),(41920,'NOTE','page',15,4),(41921,'The','page',15,8),(41922,'NRTS','page',15,4),(41923,'is','page',15,21),(41924,'designed','page',15,2),(41925,'to','page',15,52),(41926,'run','page',15,1),(41927,'red','page',15,1),(41928,'team','page',15,2),(41929,'infrastructure','page',15,1),(41930,'using','page',15,5),(41931,'docker','page',15,5),(41932,'containers','page',15,1),(41933,' ','page',15,120),(41934,'Building','page',15,1),(41935,'these','page',15,7),(41936,'out','page',15,4),(41937,'and','page',15,19),(41938,'managing','page',15,1),(41939,'the','page',15,88),(41940,'network','page',15,1),(41941,'for','page',15,27),(41942,'this','page',15,26),(41943,'best','page',15,1),(41944,'left','page',15,1),(41945,'up','page',15,4),(41946,'script','page',15,10),(41947,'do','page',15,3),(41948,'so','page',15,6),(41949,'redirector','page',15,12),(41950,'only','page',15,5),(41951,'compatible','page',15,1),(41952,'with','page',15,3),(41953,'Cobalt','page',15,13),(41954,'Strike','page',15,13),(41955,'teamserver','page',15,5),(41956,'due','page',15,1),(41957,'information','page',15,5),(41958,'from','page',15,10),(41959,'teamservers','page',15,1),(41960,'C2','page',15,6),(41961,'profile','page',15,9),(41962,'add','page',15,6),(41963,'ACLs','page',15,3),(41964,'detect','page',15,1),(41965,'traffic','page',15,6),(41966,'if','page',15,9),(41967,'hitting','page',15,2),(41968,'one','page',15,3),(41969,'of','page',15,17),(41970,'redirect','page',15,3),(41971,'domains','page',15,8),(41972,'it','page',15,30),(41973,'doesn','page',15,2),(41974,'t','page',15,5),(41975,'match','page',15,2),(41976,'will','page',15,42),(41977,'forward','page',15,1),(41978,'decoy','page',15,2),(41979,'website','page',15,2),(41980,'This','page',15,13),(41981,'guide','page',15,3),(41982,'assuming','page',15,1),(41983,'you','page',15,42),(41984,'already','page',15,2),(41985,'have','page',15,10),(41986,'server','page',15,2),(41987,'running','page',15,4),(41988,'For','page',15,11),(41989,'example','page',15,13),(41990,'we','page',15,14),(41991,'ll','page',15,13),(41992,'assume','page',15,1),(41993,'at','page',15,6),(41994,'54','page',15,2),(41995,'88','page',15,2),(41996,'220','page',15,2),(41997,'10','page',15,2),(41998,'that','page',15,8),(41999,'humanzoo2','page',15,2),(42000,'Use','page',15,2),(42001,'following','page',15,1),(42002,'start','page',15,3),(42003,'on','page',15,10),(42004,'an','page',15,7),(42005,'\r','page',15,7),(42006,'/root/scripts/buildredteam','page',15,1),(42007,'sh\r','page',15,1),(42008,'bring','page',15,1),(42009,'text-based','page',15,1),(42010,'menu','page',15,12),(42011,'seen','page',15,1),(42012,'below','page',15,4),(42013,'select','page',15,12),(42014,'option','page',15,8),(42015,'2','page',15,5),(42016,'Set','page',15,4),(42017,'http','page',15,1),(42018,'and/or','page',15,2),(42019,'https','page',15,1),(42020,'Next','page',15,6),(42021,'ask','page',15,12),(42022,'service','page',15,1),(42023,'tag','page',15,2),(42024,'by','page',15,3),(42025,'default','page',15,8),(42026,'give','page',15,2),(42027,'RD1','page',15,4),(42028,'or','page',15,7),(42029,'there','page',15,2),(42030,'RD2','page',15,1),(42031,'You','page',15,6),(42032,'can','page',15,7),(42033,'keep','page',15,2),(42034,'name','page',15,6),(42035,'own','page',15,2),(42036,'be','page',15,10),(42037,'folder','page',15,3),(42038,'creates','page',15,1),(42039,'in','page',15,9),(42040,'/root/services','page',15,1),(42041,'its','page',15,2),(42042,'container','page',15,2),(42043,'build','page',15,7),(42044,'also','page',15,1),(42045,'itself','page',15,1),(42046,'leave','page',15,3),(42047,'as','page',15,6),(42048,'  \r','page',15,1),(42049,'number','page',15,1),(42050,'IPs','page',15,18),(42051,'limits','page',15,1),(42052,'20','page',15,1),(42053,'sanity','page',15,1),(42054,'reasons','page',15,1),(42055,'use','page',15,12),(42056,'5','page',15,2),(42057,'Then','page',15,5),(42058,'Geo-location','page',15,3),(42059,'pull','page',15,1),(42060,'IP','page',15,22),(42061,'addresses','page',15,1),(42062,'has','page',15,4),(42063,'list','page',15,5),(42064,'subnets','page',15,6),(42065,'stored','page',15,1),(42066,'based','page',15,3),(42067,'structure','page',15,1),(42068,'/root/backbonerouters','page',15,1),(42069,'25','page',15,1),(42070,'UK','page',15,1),(42071,'city','page',15,1),(42072,'some','page',15,2),(42073,'few','page',15,2),(42074,'but','page',15,3),(42075,'lot','page',15,1),(42076,'Option','page',15,5),(42077,'London','page',15,1),(42078,'want','page',15,4),(42079,'set','page',15,3),(42080,'randomly','page',15,4),(42081,'manually','page',15,5),(42082,'walk','page',15,2),(42083,'through','page',15,2),(42084,'both','page',15,2),(42085,'processes','page',15,1),(42086,'Setting','page',15,2),(42087,'-','page',15,6),(42088,'1','page',15,5),(42089,'random','page',15,3),(42090,'When','page',15,2),(42091,'during','page',15,2),(42092,'processing','page',15,2),(42093,'move','page',15,2),(42094,'next','page',15,6),(42095,'step','page',15,2),(42096,'shown','page',15,3),(42097,'after','page',15,3),(42098,'going','page',15,2),(42099,'over','page',15,2),(42100,'manual','page',15,4),(42101,'process','page',15,6),(42102,'screenshots','page',15,1),(42103,'shows','page',15,2),(42104,'Below','page',15,2),(42105,'when','page',15,2),(42106,'At','page',15,3),(42107,'screen','page',15,2),(42108,'enter','page',15,8),(42109,'s','page',15,4),(42110,'see','page',15,5),(42111,'blank','page',15,1),(42112,'items','page',15,1),(42113,'store','page',15,1),(42114,'them','page',15,3),(42115,'available','page',15,2),(42116,'selections','page',15,1),(42117,'made','page',15,1),(42118,'previously','page',15,1),(42119,'typically','page',15,1),(42120,'long','page',15,2),(42121,'hit','page',15,1),(42122,'spacebar','page',15,1),(42123,'page','page',15,1),(42124,'down','page',15,1),(42125,'press','page',15,4),(42126,'q','page',15,2),(42127,'then','page',15,4),(42128,'exit','page',15,1),(42129,'subnet','page',15,2),(42130,'view','page',15,1),(42131,'go','page',15,1),(42132,'back','page',15,4),(42133,'previous','page',15,2),(42134,'pick','page',15,3),(42135,'any','page',15,2),(42136,'12','page',15,2),(42137,'9','page',15,2),(42138,'80','page',15,2),(42139,'150','page',15,1),(42140,'129/25','page',15,1),(42141,'Note','page',15,2),(42142,'multiple','page',15,1),(42143,'After','page',15,1),(42144,'pressing','page',15,1),(42145,'Enter','page',15,1),(42146,'get','page',15,3),(42147,'put','page',15,2),(42148,'first','page',15,1),(42149,'slot','page',15,1),(42150,'Once','page',15,4),(42151,'take','page',15,4),(42152,'time','page',15,1),(42153,'validate','page',15,2),(42154,'original','page',15,2),(42155,'should','page',15,5),(42156,'now','page',15,3),(42157,'entered','page',15,3),(42158,'continue','page',15,2),(42159,'steps','page',15,1),(42160,'until','page',15,1),(42161,'ve','page',15,2),(42162,'added','page',15,3),(42163,'all','page',15,5),(42164,'empty','page',15,2),(42165,'slots','page',15,2),(42166,'If','page',15,5),(42167,'don','page',15,1),(42168,'fill','page',15,1),(42169,'just','page',15,3),(42170,'say','page',15,2),(42171,'asked','page',15,1),(42172,'3','page',15,1),(42173,'our','page',15,1),(42174,'those','page',15,1),(42175,'three','page',15,1),(42176,'point','page',15,2),(42177,'either','page',15,2),(42178,'Here','page',15,2),(42179,'asks','page',15,1),(42180,'what','page',15,3),(42181,'ports','page',15,1),(42182,'HTTP','page',15,2),(42183,'HTTPS','page',15,3),(42184,'selected','page',15,3),(42185,'change','page',15,2),(42186,'port','page',15,3),(42187,'8443','page',15,2),(42188,'instead','page',15,1),(42189,'443','page',15,2),(42190,'changes','page',15,1),(42191,'bind','page',15,2),(42192,'your','page',15,8),(42193,'payload','page',15,1),(42194,'still','page',15,1),(42195,'call','page',15,1),(42196,'listener','page',15,2),(42197,'listening','page',15,1),(42198,'least','page',15,1),(42199,'configure','page',15,1),(42200,'Listener','page',15,1),(42201,'Bind','page',15,1),(42202,'address','page',15,1),(42203,'However','page',15,1),(42204,'redirectors','page',15,2),(42205,'residing','page',15,1),(42206,'same','page',15,2),(42207,'isn','page',15,2),(42208,'really','page',15,1),(42209,'necessary','page',15,1),(42210,'To','page',15,1),(42211,'accept','page',15,1),(42212,'about','page',15,1),(42213,'changing','page',15,1),(42214,'again','page',15,1),(42215,'Just','page',15,1),(42216,'mind','page',15,1),(42217,'need','page',15,3),(42218,'accordingly','page',15,1),(42219,'redirecting','page',15,2),(42220,'Teamserver','page',15,1),(42221,'which','page',15,1),(42222,'needs','page',15,2),(42223,'used','page',15,4),(42224,'These','page',15,1),(42225,'are','page',15,4),(42226,'identify','page',15,2),(42227,'other','page',15,2),(42228,'things','page',15,1),(42229,'domain','page',15,10),(42230,'wrong','page',15,1),(42231,'not','page',15,1),(42232,'work','page',15,1),(42233,'where','page',15,2),(42234,'HAproxy','page',15,2),(42235,'hits','page',15,1),(42236,'ACL','page',15,1),(42237,'created','page',15,3),(42238,'site','page',15,1),(42239,'exist','page',15,1),(42240,'range','page',15,1),(42241,'reachable','page',15,2),(42242,'stop','page',15,1),(42243,'working','page',15,2),(42244,'redbook','page',15,1),(42245,'com','page',15,2),(42246,'We','page',15,2),(42247,'create','page',15,3),(42248,'generated','page',15,2),(42249,'order','page',15,1),(42250,'SSL','page',15,3),(42251,'certificates','page',15,1),(42252,'options','page',15,1),(42253,'Assigning','page',15,2),(42254,'Domains','page',15,2),(42255,'one/s','page',15,1),(42256,'cover','page',15,1),(42257,'Manually','page',15,1),(42258,'name/s','page',15,1),(42259,'and ','page',15,1),(42260,'entering','page',15,1),(42261,'1 ','page',15,1),(42262,'208','page',15,2),(42263,'82','page',15,2),(42264,'7','page',15,2),(42265,'57','page',15,2),(42266,'make','page',15,1),(42267,'called','page',15,1),(42268,'goatfarmer','page',15,1),(42269,'named','page',15,1),(42270,'pressed','page',15,1),(42271,'takes','page',15,1),(42272,'populated','page',15,1),(42273,'Repeat','page',15,1),(42274,'d','page',15,1),(42275,'done','page',15,1),(42276,'finished','page',15,1),(42277,'generation','page',15,1),(42278,'names','page',15,1),(42279,'thing','page',15,1),(42280,'Tag','page',15,1),(42281,'scripts','page',15,1),(42282,'who','page',15,1),(42283,'purpose','page',15,1),(42284,'allow','page',15,1),(42285,'deleted','page',15,1),(42286,'later','page',15,1),(42287,'like','page',15,1),(42288,'engagement','page',15,1),(42289,'no','page',15,1),(42290,'longer','page',15,1),(42291,'I','page',15,1),(42292,'test-DNS','page',15,1),(42293,'Finally','page',15,1),(42294,'everything','page',15,1),(42295,'look','page',15,1),(42296,'settings','page',15,1),(42297,'good','page',15,1),(42298,'screenshot','page',15,1),(42299,'regarding','page',15,1),(42300,'located','page',15,1),(42301,'/root/services/RD1','page',15,1),(42302,'directory','page',15,1),(42303,'DNS','page',15,1),(42304,'containing','page',15,1),(42305,'signed','page',15,1),(42306,'certs ','page',15,1),(42307,'looking','page',15,1),(42308,'Run','page',15,1),(42309,'ps','page',15,1),(42310,'Building','page',17,41),(42311,'a','page',17,60),(42312,'Payload','page',17,41),(42313,'Host','page',17,41),(42314,'buildredteam','page',17,40),(42315,'sh','page',17,40),(42316,'NOTE','page',17,1),(42317,'The','page',17,2),(42318,'NRTS','page',17,4),(42319,'is','page',17,9),(42320,'designed','page',17,2),(42321,'to','page',17,33),(42322,'run','page',17,1),(42323,'red','page',17,1),(42324,'team','page',17,1),(42325,'infrastructure','page',17,1),(42326,'using','page',17,1),(42327,'docker','page',17,3),(42328,'containers','page',17,1),(42329,' ','page',17,37),(42330,'these','page',17,2),(42331,'out','page',17,2),(42332,'and','page',17,14),(42333,'managing','page',17,1),(42334,'the','page',17,50),(42335,'network','page',17,1),(42336,'for','page',17,14),(42337,'this','page',17,15),(42338,'best','page',17,1),(42339,'left','page',17,1),(42340,'up','page',17,4),(42341,'script','page',17,6),(42342,'do','page',17,1),(42343,'so','page',17,5),(42344,'Use','page',17,1),(42345,'following','page',17,1),(42346,'start','page',17,2),(42347,'on','page',17,6),(42348,'an','page',17,4),(42349,'server','page',17,2),(42350,'\r','page',17,7),(42351,'/root/scripts/buildredteam','page',17,1),(42352,'sh\r','page',17,1),(42353,'This','page',17,8),(42354,'will','page',17,26),(42355,'bring','page',17,2),(42356,'text-based','page',17,1),(42357,'menu','page',17,10),(42358,'seen','page',17,1),(42359,'below','page',17,3),(42360,'select','page',17,10),(42361,'option','page',17,11),(42362,'4','page',17,1),(42363,'Set','page',17,3),(42364,'payload','page',17,5),(42365,'host','page',17,6),(42366,'Next','page',17,5),(42367,'it','page',17,19),(42368,'ask','page',17,7),(42369,'service','page',17,4),(42370,'tag','page',17,5),(42371,'by','page',17,3),(42372,'default','page',17,4),(42373,'give','page',17,2),(42374,'you','page',17,29),(42375,'P1','page',17,4),(42376,'or','page',17,7),(42377,'if','page',17,4),(42378,'there','page',17,3),(42379,'already','page',17,1),(42380,'of','page',17,11),(42381,'P2','page',17,1),(42382,'You','page',17,6),(42383,'can','page',17,7),(42384,'keep','page',17,1),(42385,'name','page',17,8),(42386,'add','page',17,3),(42387,'your','page',17,3),(42388,'own','page',17,1),(42389,'be','page',17,4),(42390,'folder','page',17,2),(42391,'creates','page',17,1),(42392,'at','page',17,6),(42393,'/root/services','page',17,1),(42394,'its','page',17,2),(42395,'container','page',17,4),(42396,'build','page',17,4),(42397,'also','page',17,1),(42398,'itself','page',17,1),(42399,'For','page',17,6),(42400,'example','page',17,6),(42401,'we','page',17,15),(42402,'ll','page',17,10),(42403,'leave','page',17,1),(42404,'as','page',17,2),(42405,'number','page',17,1),(42406,'IPs','page',17,11),(42407,'set','page',17,6),(42408,'several','page',17,1),(42409,'they','page',17,1),(42410,'all','page',17,3),(42411,'whatever','page',17,2),(42412,'place','page',17,2),(42413,'use','page',17,10),(42414,'5','page',17,1),(42415,'Then','page',17,3),(42416,'Geo-location','page',17,3),(42417,'has','page',17,3),(42418,'list','page',17,4),(42419,'IP','page',17,19),(42420,'subnets','page',17,6),(42421,'stored','page',17,1),(42422,'in','page',17,4),(42423,'structure','page',17,1),(42424,'/root/backbonerouters','page',17,1),(42425,'our','page',17,1),(42426,'7','page',17,1),(42427,'-','page',17,4),(42428,'France','page',17,2),(42429,'city','page',17,1),(42430,'some','page',17,2),(42431,'options','page',17,2),(42432,'have','page',17,7),(42433,'few','page',17,1),(42434,'only','page',17,3),(42435,'one','page',17,2),(42436,'1','page',17,7),(42437,'-Paris','page',17,1),(42438,'since','page',17,1),(42439,'isn','page',17,1),(42440,'t','page',17,1),(42441,'another','page',17,1),(42442,'want','page',17,3),(42443,'s','page',17,6),(42444,'randomly','page',17,2),(42445,'manually','page',17,4),(42446,'guide','page',17,2),(42447,'walk','page',17,2),(42448,'through','page',17,3),(42449,'both','page',17,2),(42450,'paths','page',17,2),(42451,'Setting','page',17,2),(42452,'Option','page',17,4),(42453,'random','page',17,4),(42454,'When','page',17,3),(42455,'during','page',17,2),(42456,'processing','page',17,2),(42457,'move','page',17,2),(42458,'next','page',17,4),(42459,'step','page',17,2),(42460,'We','page',17,1),(42461,'cover','page',17,1),(42462,'that','page',17,7),(42463,'after','page',17,3),(42464,'going','page',17,1),(42465,'over','page',17,1),(42466,'manual','page',17,7),(42467,'process','page',17,5),(42468,'2','page',17,2),(42469,'get','page',17,3),(42470,'screen','page',17,2),(42471,'showing','page',17,1),(42472,'blank','page',17,4),(42473,'blanks','page',17,2),(42474,'need','page',17,2),(42475,'filled','page',17,1),(42476,'with','page',17,3),(42477,'entered','page',17,3),(42478,'Select','page',17,1),(42479,'input','page',17,1),(42480,'First','page',17,1),(42481,'see','page',17,4),(42482,'what','page',17,2),(42483,'are','page',17,3),(42484,'available','page',17,3),(42485,'show','page',17,2),(42486,'Below','page',17,2),(42487,'screenshot','page',17,2),(42488,'long','page',17,1),(42489,'spacebar','page',17,1),(42490,'page','page',17,1),(42491,'down','page',17,1),(42492,'then ','page',17,1),(42493,'press','page',17,4),(42494,'q','page',17,1),(42495,'followed','page',17,1),(42496,'enter','page',17,5),(42497,'exit','page',17,1),(42498,'subnet','page',17,1),(42499,'view','page',17,1),(42500,'back','page',17,3),(42501,'previous','page',17,1),(42502,'Now','page',17,1),(42503,'know','page',17,1),(42504,'184','page',17,3),(42505,'84','page',17,3),(42506,'181','page',17,2),(42507,'201','page',17,2),(42508,'from','page',17,3),(42509,'180','page',17,1),(42510,'1/22','page',17,1),(42511,'any','page',17,1),(42512,'pull','page',17,1),(42513,'multiple','page',17,1),(42514,'Back','page',17,1),(42515,'first','page',17,1),(42516,'spot','page',17,1),(42517,' Then','page',17,1),(42518,'entry','page',17,2),(42519,'ll ','page',17,1),(42520,'put','page',17,1),(42521,'Once','page',17,2),(42522,'ve','page',17,1),(42523,'pressed','page',17,1),(42524,'take','page',17,3),(42525,'populated','page',17,2),(42526,'just','page',17,1),(42527,'Repeat','page',17,2),(42528,'then','page',17,2),(42529,'d','page',17,2),(42530,'when','page',17,2),(42531,'done','page',17,1),(42532,'At','page',17,3),(42533,'point','page',17,3),(42534,'either','page',17,2),(42535,'selected','page',17,3),(42536,'Randomly','page',17,2),(42537,'completed','page',17,2),(42538,'entering','page',17,1),(42539,'brings','page',17,1),(42540,'Here','page',17,2),(42541,'asks','page',17,1),(42542,'how','page',17,1),(42543,'assign','page',17,1),(42544,'DNS','page',17,6),(42545,'Assigning','page',17,2),(42546,'Domains','page',17,2),(42547,'- ','page',17,2),(42548,'generated','page',17,1),(42549,'one/s','page',17,1),(42550,'generate','page',17,1),(42551,'domains','page',17,1),(42552,'covered','page',17,1),(42553,'walking','page',17,1),(42554,'Manually','page',17,1),(42555,'create','page',17,1),(42556,'domain','page',17,7),(42557,'name/s','page',17,1),(42558,'new','page',17,1),(42559,'shows','page',17,1),(42560,'199','page',17,1),(42561,'101','page',17,1),(42562,'132','page',17,1),(42563,'203','page',17,1),(42564,'goatfarmer','page',17,1),(42565,'com','page',17,1),(42566,'now','page',17,1),(42567,'should','page',17,2),(42568,'complete','page',17,2),(42569,'names','page',17,1),(42570,'created','page',17,1),(42571,'used','page',17,1),(42572,'identify','page',17,1),(42573,'register','page',17,1),(42574,'later','page',17,1),(42575,'like','page',17,1),(42576,'say','page',17,1),(42577,'engagement','page',17,1),(42578,'remove','page',17,1),(42579,'those','page',17,1),(42580,'records','page',17,1),(42581,'test-DNS','page',17,1),(42582,'everything','page',17,1),(42583,'needs','page',17,1),(42584,'check','page',17,2),(42585,'settings','page',17,1),(42586,'happy','page',17,1),(42587,'After','page',17,1),(42588,'information','page',17,1),(42589,'about','page',17,1),(42590,'located','page',17,1),(42591,'/root/services/P1','page',17,1),(42592,'running','page',17,2),(42593,'ps','page',17,1),(42594,'named','page',17,1),(42595,'Docker','page',17,1),(42596,'Service','page',17,1),(42597,'Tag','page',17,1),(42598,'payloads','page',17,2),(42599,'transfer','page',17,1),(42600,'them','page',17,1),(42601,'/root/services/P1/WWW','page',17,1),(42602,'directory','page',17,1),(42603,'Note','page',17,1),(42604,'custom','page',17,1),(42605,'go','page',17,1),(42606,'ex','page',17,1),(42607,'/root/services/','page',17,1),(42608,'/WWW','page',17,1),(46531,'General','page',25,40),(46532,'Guidance','page',25,40),(46533,'Active','page',25,10),(46534,'Directory','page',25,7),(46535,'Server','page',25,6),(46536,'User','page',25,1),(46537,'accounts-','page',25,1),(46538,'Create','page',25,1),(46539,'several','page',25,2),(46540,'users','page',25,4),(46541,'and','page',25,50),(46542,'give','page',25,1),(46543,'the','page',25,98),(46544,'context','page',25,1),(46545,' ','page',25,60),(46546,'Have','page',25,1),(46547,'employees','page',25,2),(46548,'Users','page',25,1),(46549,'that','page',25,26),(46550,'work','page',25,5),(46551,'for','page',25,36),(46552,'Target','page',25,7),(46553,'Domain','page',25,7),(46554,'have','page',25,15),(46555,'some','page',25,10),(46556,'sort','page',25,2),(46557,'of','page',25,25),(46558,'job','page',25,1),(46559,'or','page',25,2),(46560,'role','page',25,1),(46561,'in','page',25,18),(46562,'company','page',25,1),(46563,'things','page',25,3),(46564,'like','page',25,6),(46565,'HR','page',25,1),(46566,'finance','page',25,1),(46567,'IT','page',25,1),(46568,'etc','page',25,2),(46569,'This','page',25,13),(46570,'documentation','page',25,4),(46571,'includes','page',25,2),(46572,'PowerShell','page',25,3),(46573,'script','page',25,9),(46574,'CreateADUsers','page',25,1),(46575,'ps1','page',25,4),(46576,'is','page',25,22),(46577,'just','page',25,4),(46578,'an','page',25,10),(46579,'example','page',25,5),(46580,'using','page',25,3),(46581,'a','page',25,65),(46582,'fictional','page',25,1),(46583,'blue','page',25,18),(46584,'space','page',25,21),(46585,'organization','page',25,1),(46586,'called','page',25,4),(46587,'Galactic','page',25,1),(46588,'Federation','page',25,1),(46589,'with','page',25,12),(46590,'domain','page',25,5),(46591,'galfed','page',25,1),(46592,'com','page',25,1),(46593,'It','page',25,3),(46594,'s','page',25,4),(46595,'fairly','page',25,4),(46596,'basic','page',25,1),(46597,'can','page',25,16),(46598,'be','page',25,11),(46599,'edited','page',25,1),(46600,'to','page',25,115),(46601,'match','page',25,1),(46602,'whatever','page',25,8),(46603,'you','page',25,47),(46604,'want','page',25,12),(46605,'do','page',25,5),(46606,'Currently','page',25,1),(46607,'it','page',25,20),(46608,'set','page',25,18),(46609,'up','page',25,14),(46610,'read','page',25,1),(46611,'CSV','page',25,2),(46612,'user','page',25,11),(46613,'information','page',25,2),(46614,'where','page',25,2),(46615,'provide','page',25,1),(46616,'First','page',25,1),(46617,'name','page',25,1),(46618,'middle','page',25,1),(46619,'Initial','page',25,1),(46620,'Last','page',25,1),(46621,'Name','page',25,1),(46622,'occupation','page',25,1),(46623,'will','page',25,13),(46624,'create','page',25,9),(46625,'AD','page',25,13),(46626,'each','page',25,4),(46627,'line','page',25,1),(46628,'login','page',25,6),(46629,'looks','page',25,1),(46630,'FirstName','page',25,1),(46631,'Lastname','page',25,1),(46632,'sets','page',25,2),(46633,'password','page',25,9),(46634,'following','page',25,2),(46635,'format','page',25,1),(46636,'LastnamePass','page',25,1),(46637,'For','page',25,2),(46638,'if','page',25,7),(46639,'added','page',25,1),(46640,'Will','page',25,4),(46641,'Smith','page',25,3),(46642,'their','page',25,3),(46643,'would','page',25,7),(46644,'SmithPass','page',25,1),(46645,'If','page',25,4),(46646,'add','page',25,2),(46647,'another','page',25,2),(46648,'column','page',25,2),(46649,'csv','page',25,1),(46650,'file','page',25,5),(46651,'insert','page',25,1),(46652,'randomly','page',25,1),(46653,'generated','page',25,1),(46654,'passwords','page',25,2),(46655,'then','page',25,8),(46656,'modify','page',25,3),(46657,'use','page',25,10),(46658,'this','page',25,15),(46659,'instead','page',25,1),(46660,'Keep','page',25,1),(46661,'mind','page',25,1),(46662,'useful','page',25,2),(46663,'standardized','page',25,1),(46664,'easy','page',25,2),(46665,'remember','page',25,1),(46666,'so','page',25,5),(46667,'while','page',25,1),(46668,'are','page',25,15),(46669,'working','page',25,3),(46670,'easily','page',25,2),(46671,'as','page',25,9),(46672,'any','page',25,5),(46673,'without','page',25,1),(46674,'referencing','page',25,1),(46675,'complex','page',25,1),(46676,'sheet','page',25,1),(46677,'However','page',25,3),(46678,'before','page',25,2),(46679,'policies','page',25,2),(46680,'allow','page',25,1),(46681,'simple','page',25,2),(46682,'also','page',25,4),(46683,'good','page',25,7),(46684,'idea','page',25,4),(46685,'avoided','page',25,1),(46686,'exact','page',25,1),(46687,'same','page',25,1),(46688,'every','page',25,1),(46689,'account','page',25,5),(46690,'hashes','page',25,1),(46691,'aren’t','page',25,3),(46692,'all','page',25,7),(46693,'identical','page',25,1),(46694,'The','page',25,6),(46695,'CreateADAccounts','page',25,1),(46696,'PS1','page',25,1),(46697,'custom','page',25,1),(46698,'organizational','page',25,1),(46699,'Units','page',25,1),(46700,'directory','page',25,3),(46701,'accounts','page',25,4),(46702,'different','page',25,3),(46703,'one','page',25,6),(46704,'admin','page',25,4),(46705,'uses','page',25,1),(46706,'Occupation','page',25,1),(46707,'from','page',25,9),(46708,'data','page',25,1),(46709,'groups','page',25,4),(46710,'assigns','page',25,1),(46711,'group','page',25,3),(46712,'Having','page',25,1),(46713,'unique','page',25,1),(46714,'assignments ','page',25,1),(46715,'assign','page',25,1),(46716,'folder','page',25,3),(46717,'permissions','page',25,3),(46718,'on','page',25,21),(46719,'server','page',25,20),(46720,'make','page',25,7),(46721,'more','page',25,3),(46722,'realistic','page',25,2),(46723,'Additionally','page',25,2),(46724,'two','page',25,4),(46725,'them','page',25,1),(46726,'regular','page',25,1),(46727,'they','page',25,8),(46728,'day','page',25,2),(46729,'email','page',25,2),(46730,'Then','page',25,7),(46731,'creates','page',25,1),(46732,'separate','page',25,1),(46733,'Admin','page',25,1),(46734,'system','page',25,1),(46735,'administration','page',25,1),(46736,'second','page',25,1),(46737,'has','page',25,3),(46738,'Going','page',25,1),(46739,'back','page',25,2),(46740,'smith','page',25,1),(46741,'was','page',25,1),(46742,'build','page',25,8),(46743,'secondary','page',25,1),(46744,'adm ','page',25,1),(46745,'SmithAdmin','page',25,1),(46746,' \r','page',25,3),(46747,'DNS','page',25,7),(46748,'-','page',25,14),(46749,'Its','page',25,4),(46750,'very','page',25,2),(46751,'common','page',25,1),(46752,'manage','page',25,6),(46753,'Typically','page',25,3),(46754,'workstations','page',25,3),(46755,'configured','page',25,1),(46756,'point','page',25,3),(46757,'IP','page',25,1),(46758,'Forward','page',25,1),(46759,'recursive','page',25,1),(46760,'Cyber','page',25,6),(46761,'Range','page',25,6),(46762,'aka','page',25,5),(46763,'rootDNS','page',25,2),(46764,'Alternatively','page',25,1),(46765,'DMZ','page',25,4),(46766,'forwarder','page',25,1),(46767,'Email','page',25,1),(46768,'support','page',25,3),(46769,'There','page',25,5),(46770,'need','page',25,5),(46771,'done','page',25,1),(46772,'prepare','page',25,1),(46773,'Microsoft','page',25,2),(46774,'Exchange','page',25,6),(46775,'online','page',25,1),(46776,'guides','page',25,1),(46777,'configuring','page',25,1),(46778,'exchange','page',25,9),(46779,'follow','page',25,1),(46780,'these','page',25,1),(46781,'version','page',25,1),(46782,'snapshot','page',25,8),(46783,'both','page',25,1),(46784,'starting','page',25,1),(46785,'something','page',25,2),(46786,'goes','page',25,2),(46787,'wrong','page',25,2),(46788,'it’s','page',25,2),(46789,'hard','page',25,5),(46790,'reverse','page',25,3),(46791,'modifications','page',25,2),(46792,'made','page',25,1),(46793,'during','page',25,1),(46794,'installation','page',25,1),(46795,'process','page',25,1),(46796,'\r','page',25,8),(46797,'Group','page',25,2),(46798,'Policies','page',25,1),(46799,'guide','page',25,1),(46800,'won’t','page',25,1),(46801,'get','page',25,5),(46802,'into','page',25,2),(46803,'details','page',25,1),(46804,'setting','page',25,2),(46805,'list','page',25,1),(46806,'ones','page',25,2),(46807,'advisable','page',25,1),(46808,'that ','page',25,1),(46809,'connected','page',25,2),(46810,'fake','page',25,3),(46811,'internet','page',25,4),(46812,'environment','page',25,4),(46813,'Disable','page',25,2),(46814,'Cortana','page',25,1),(46815,'Applied','page',25,4),(46816,'Computer','page',25,3),(46817,'Configurations','page',25,3),(46818,'Cortana\r','page',25,1),(46819,'Prevent','page',25,1),(46820,'Sleep','page',25,1),(46821,'prevent','page',25,2),(46822,'Windows','page',25,1),(46823,'VMs','page',25,2),(46824,'hibernating','page',25,1),(46825,'basically','page',25,2),(46826,'“Turn','page',25,1),(46827,'Off','page',25,4),(46828,'disk','page',25,1),(46829,'plugged','page',25,3),(46830,'disabled','page',25,3),(46831,'Allow','page',25,1),(46832,'standby','page',25,1),(46833,'states','page',25,1),(46834,'S1-S3','page',25,1),(46835,'when','page',25,4),(46836,'sleeping','page',25,1),(46837,'Specify','page',25,1),(46838,'unattended','page',25,1),(46839,'sleep','page',25,2),(46840,'timeout','page',25,1),(46841,'Enable','page',25,1),(46842,'PSRemoting','page',25,1),(46843,'enabling','page',25,1),(46844,'WinRM','page',25,1),(46845,'Client','page',25,1),(46846,'Service\r','page',25,1),(46847,'MapNetworkDrives','page',25,1),(46848,'Once','page',25,2),(46849,'you’ve','page',25,1),(46850,'based','page',25,6),(46851,'occupations','page',25,1),(46852,'automatically','page',25,1),(46853,'Map','page',25,1),(46854,'network','page',25,2),(46855,'drive','page',25,4),(46856,'NTP','page',25,3),(46857,'DC','page',25,3),(46858,'computer','page',25,1),(46859,'configurations','page',25,1),(46860,'clients','page',25,1),(46861,'InstallCA','page',25,1),(46862,'Certs','page',25,1),(46863,'since','page',25,1),(46864,'we','page',25,1),(46865,'real','page',25,1),(46866,'provides','page',25,2),(46867,'its','page',25,1),(46868,'own','page',25,1),(46869,'Certificate','page',25,1),(46870,'Authority','page',25,1),(46871,'CA-Server','page',25,1),(46872,'GPO','page',25,2),(46873,'used','page',25,2),(46874,'import','page',25,1),(46875,'root','page',25,1),(46876,'intermediary','page',25,1),(46877,'Certificates','page',25,1),(46878,'trust','page',25,1),(46879,'store','page',25,1),(46880,'workstation','page',25,3),(46881,'allows','page',25,2),(46882,'go','page',25,3),(46883,'various','page',25,2),(46884,'sites','page',25,1),(46885,'valid','page',25,1),(46886,'SSL','page',25,1),(46887,'certificates','page',25,1),(46888,'avoid','page',25,1),(46889,'untrusted','page',25,1),(46890,'warning','page',25,1),(46891,'popups','page',25,1),(46892,'Policy','page',25,1),(46893,'great','page',25,1),(46894,'way','page',25,4),(46895,'your','page',25,13),(46896,'Making','page',25,1),(46897,'sure','page',25,4),(46898,'VM’s','page',25,1),(46899,'don’t','page',25,2),(46900,'ensuring','page',25,1),(46901,'being','page',25,1),(46902,'able','page',25,2),(46903,'remote','page',25,1),(46904,'everything','page',25,2),(46905,'bigger','page',25,1),(46906,'tips','page',25,1),(46907,'help','page',25,2),(46908,'File','page',25,3),(46909,'Just','page',25,1),(46910,'install','page',25,4),(46911,'windows','page',25,4),(46912,'shared','page',25,1),(46913,'file/folder','page',25,1),(46914,'structure','page',25,1),(46915,'makes','page',25,3),(46916,'sense','page',25,3),(46917,'Set','page',25,1),(46918,'created','page',25,1),(46919,'Red','page',25,1),(46920,'Team','page',25,1),(46921,'lateral','page',25,1),(46922,'movement','page',25,1),(46923,'order','page',25,3),(46924,'files','page',25,1),(46925,'trying','page',25,1),(46926,'reach','page',25,1),(46927,'Plus','page',25,1),(46928,'mapped','page',25,1),(46929,'drives','page',25,2),(46930,'log','page',25,1),(46931,'probably','page',25,1),(46932,'toughest','page',25,1),(46933,'thing','page',25,3),(46934,'You','page',25,3),(46935,'first','page',25,3),(46936,'Next','page',25,1),(46937,'power','page',25,3),(46938,'off','page',25,7),(46939,'revert','page',25,2),(46940,'start','page',25,1),(46941,'over','page',25,1),(46942,'building','page',25,3),(46943,'part','page',25,1),(46944,'clean','page',25,1),(46945,'up/or','page',25,1),(46946,'Side','page',25,1),(46947,'note','page',25,1),(46948,'take','page',25,3),(46949,'snapshots','page',25,6),(46950,'VM','page',25,3),(46951,'powered','page',25,3),(46952,'otherwise','page',25,1),(46953,'include','page',25,2),(46954,'complete','page',25,1),(46955,'copy','page',25,1),(46956,'running','page',25,3),(46957,'memory','page',25,1),(46958,'So','page',25,1),(46959,'gave','page',25,1),(46960,'16','page',25,3),(46961,'GB','page',25,3),(46962,'RAM','page',25,3),(46963,'increase','page',25,1),(46964,'size','page',25,1),(46965,'by','page',25,2),(46966,'When','page',25,1),(46967,'should','page',25,2),(46968,'helpful','page',25,1),(46969,'One','page',25,1),(46970,'that’s','page',25,2),(46971,'80GB','page',25,2),(46972,'100GB','page',25,2),(46973,'logs','page',25,2),(46974,'database','page',25,1),(46975,'Depending','page',25,1),(46976,'what','page',25,1),(46977,'traffic','page',25,3),(46978,'generation','page',25,1),(46979,'tends','page',25,1),(46980,'fill','page',25,1),(46981,'fast','page',25,2),(46982,'run','page',25,2),(46983,'out','page',25,6),(46984,'extremely','page',25,1),(46985,'difficult','page',25,1),(46986,'recover','page',25,1),(46987,'clear','page',25,1),(46988,'emails','page',25,4),(46989,'between','page',25,2),(46990,'engagements/exercises','page',25,1),(46991,'scripts','page',25,3),(46992,'included','page',25,1),(46993,'but','page',25,3),(46994,'modified','page',25,1),(46995,'These','page',25,1),(46996,'CleanLogs','page',25,1),(46997,'DeleteAllEmails','page',25,1),(46998,'Workstations','page',25,3),(46999,'Make','page',25,1),(47000,'additional','page',25,2),(47001,'software','page',25,7),(47002,'It’s','page',25,3),(47003,'not','page',25,2),(47004,'base','page',25,1),(47005,'installs','page',25,1),(47006,'10','page',25,1),(47007,'Add','page',25,2),(47008,'browsers','page',25,1),(47009,'firefox','page',25,1),(47010,'chrome','page',25,1),(47011,'Office','page',25,1),(47012,'Adobe','page',25,1),(47013,'Reader','page',25,1),(47014,'else','page',25,1),(47015,'A','page',25,2),(47016,'technique','page',25,1),(47017,'providing','page',25,1),(47018,'red','page',25,1),(47019,'team','page',25,1),(47020,'vectors','page',25,1),(47021,'exploitation','page',25,2),(47022,'look','page',25,1),(47023,'at','page',25,3),(47024,'recently','page',25,1),(47025,'exploited','page',25,1),(47026,'third','page',25,1),(47027,'party','page',25,1),(47028,'privilege','page',25,1),(47029,'vulnerabilities','page',25,1),(47030,'Ideally','page',25,1),(47031,'find','page',25,1),(47032,'current','page',25,1),(47033,'exploits','page',25,1),(47034,'meaning','page',25,1),(47035,'less','page',25,1),(47036,'than','page',25,2),(47037,'year','page',25,1),(47038,'old','page',25,1),(47039,'Also','page',25,1),(47040,'ll','page',25,1),(47041,'there','page',25,2),(47042,'metasploit','page',25,1),(47043,'module','page',25,1),(47044,'better','page',25,1),(47045,'yet','page',25,1),(47046,'Proof','page',25,1),(47047,'Concept','page',25,1),(47048,'exploit','page',25,1),(47049,'available','page',25,1),(47050,'advantage','page',25,1),(47051,'exploitable','page',25,1),(47052,'firewall','page',25,3),(47053,'services','page',25,2),(47054,'management','page',25,1),(47055,'“blue','page',25,1),(47056,'space”','page',25,1),(47057,'admins','page',25,1),(47058,'few','page',25,2),(47059,'provided','page',25,1),(47060,'management/health','page',25,1),(47061,'checks','page',25,1),(47062,'require','page',25,2),(47063,'powershell','page',25,1),(47064,'remoting','page',25,1),(47065,'settings','page',25,1),(47066,'baseline','page',25,2),(47067,'installed','page',25,3),(47068,'clone','page',25,2),(47069,'many','page',25,2),(47070,'times','page',25,1),(47071,'one-off','page',25,1),(47072,'master','page',25,1),(47073,'cloning','page',25,1),(47074,'join','page',25,2),(47075,'clones','page',25,1),(47076,'Firewalls','page',25,3),(47077,'PFSense','page',25,1),(47078,'decent','page',25,2),(47079,'freeware','page',25,2),(47080,'solution','page',25,3),(47081,'three','page',25,1),(47082,'interfaces','page',25,1),(47083,'WAN','page',25,1),(47084,'connection','page',25,4),(47085,'SI-Router','page',25,1),(47086,'LAN','page',25,1),(47087,'connect','page',25,1),(47088,'workstations/servers','page',25,1),(47089,'public','page',25,1),(47090,'facing','page',25,1),(47091,'web','page',25,1),(47092,'OWA','page',25,1),(47093,'don','page',25,1),(47094,'t','page',25,1),(47095,'feel','page',25,1),(47096,'limited','page',25,1),(47097,'Routers','page',25,3),(47098,'Vyos','page',25,1),(47099,'routing','page',25,2),(47100,'requirements','page',25,1),(47101,'routers','page',25,2),(47102,'internal','page',25,1),(47103,'subnets','page',25,1),(47104,'SNAPSHOTS','page',25,3),(47105,'practice','page',25,1),(47106,'always','page',25,2),(47107,'eats','page',25,1),(47108,'lot','page',25,1),(47109,'solid','page',25,1),(47110,'range','page',25,4),(47111,'down','page',25,1),(47112,'entire','page',25,2),(47113,'whole','page',25,1),(47114,'prior','page',25,2),(47115,'attacks','page',25,2),(47116,'against','page',25,1),(47117,'artifacts','page',25,1),(47118,'NOTE','page',25,1),(47119,'Don’t','page',25,1),(47120,'kick','page',25,1),(47121,'once','page',25,1),(47122,'sometimes','page',25,1),(47123,'cause','page',25,1),(47124,'failure','page',25,1),(47125,'As','page',25,1),(47126,'rule','page',25,1),(47127,'typically','page',25,1),(47128,'no','page',25,1),(47129,'3','page',25,1),(47130,'going','page',25,1),(47131,'time','page',25,1),(47132,'Reverting','page',25,2),(47133,'Powering','page',25,3),(47134,'On','page',25,3),(47135,'regards','page',25,1),(47136,'sequence','page',25,1),(47137,'powering','page',25,4),(47138,'networking','page',25,1),(47139,'devices','page',25,1),(47140,'move','page',25,1),(47141,'other','page',25,1),(47142,'servers','page',25,1),(47143,'lastly','page',25,1),(47144,'ESXI','page',25,2),(47145,'license','page',25,1),(47146,'come','page',25,1),(47147,'PowerCLI','page',25,4),(47148,'GUI','page',25,2),(47149,'sequencing','page',25,1),(47150,'well','page',25,3),(47151,'scripting','page',25,1),(47152,'builds','page',25,1),(47153,'on/off','page',25,1),(47154,'reverting','page',25,1),(47155,'latest','page',25,1),(47156,'You’ll','page',25,1),(47157,'variables','page',25,1),(47158,'documented','page',25,1),(47159,' Range-Management','page',25,1),(47160,'Internal','page',25,3),(47161,'Traffic','page',25,7),(47162,'Generation','page',25,7),(47163,'Carnegie','page',25,1),(47164,'Mellon','page',25,1),(47165,'open','page',25,1),(47166,'source','page',25,1),(47167,'Ghosts','page',25,2),(47168,'github','page',25,1),(47169,'here','page',25,1),(47170,'https','page',25,2),(47171,'//github','page',25,1),(47172,'com/cmu-sei/GHOSTS','page',25,1),(47173,'variety','page',25,1),(47174,'operating','page',25,1),(47175,'systems','page',25,1),(47176,'configuration','page',25,1),(47177,'browse','page',25,1),(47178,'websites','page',25,1),(47179,'word','page',25,1),(47180,'documents/powerpoints/excels','page',25,1),(47181,'save','page',25,1),(47182,'those','page',25,1),(47183,'share','page',25,1),(47184,'send','page',25,2),(47185,'pretty','page',25,1),(47186,'much','page',25,1),(47187,'command-line','page',25,1),(47188,'In','page',25,1),(47189,'purchase','page',25,1),(47190,'special','page',25,1),(47191,'driver','page',25,2),(47192,'outlook','page',25,1),(47193,'redemption','page',25,2),(47194,'dll','page',25,2),(47195,'bypasses','page',25,1),(47196,'security','page',25,1),(47197,'features','page',25,1),(47198,'Outlook','page',25,1),(47199,'scripted','page',25,1),(47200,'//www','page',25,1),(47201,'dimastr','page',25,1),(47202,'com/redemption/download','page',25,1),(47203,'htm','page',25,1),(47204,'Building','page',25,1),(47205,'managing','page',25,1),(47206,'ghost','page',25,1),(47207,'long','page',25,1),(47208,'try','page',25,1),(47209,'capture','page',25,1),(47210,'“how','page',25,1),(47211,'to”','page',25,1),(47212,'best','page',25,1),(47213,'bet','page',25,1),(47214,'figure','page',25,1),(47215,'bad','page',25,1),(47216,'WIKI','page',25,1),(47217,'Planning','page',25,1),(47218,'Guide','page',25,1),(47219,'Ghost','page',25,1),(47220,'External','page',25,4),(47221,'hits','page',25,1),(47222,'comes','page',25,1),(47223,'designed','page',25,1),(47224,'purpose','page',25,1),(47225,'Traffic-Gen','page',25,1),(47226,'Go','page',25,1),(47227,'Systems','page',25,1),(47228,'Overview','page',25,1),(47229,' Traffic-Gen','page',25,1),(47230,'overview','page',25,1),(47231,'how','page',25,2),(47232,'works','page',25,1),(47233,'Ghost','page',26,51),(47234,'Traffic','page',26,40),(47235,'Generation','page',26,40),(47236,'is','page',26,12),(47237,'a','page',26,16),(47238,'traffic','page',26,3),(47239,'generator','page',26,1),(47240,'created','page',26,1),(47241,'by','page',26,3),(47242,'Carnegie','page',26,1),(47243,'Mellon','page',26,1),(47244,'they','page',26,1),(47245,'offer','page',26,1),(47246,'their','page',26,3),(47247,'source','page',26,1),(47248,'code','page',26,1),(47249,'on','page',26,12),(47250,'github','page',26,2),(47251,'but','page',26,1),(47252,'also','page',26,1),(47253,'provide','page',26,1),(47254,'pre-combiled','page',26,1),(47255,'binaries','page',26,1),(47256,'If','page',26,4),(47257,'you','page',26,29),(47258,'just','page',26,6),(47259,'want','page',26,8),(47260,'to','page',26,25),(47261,'download','page',26,3),(47262,'and','page',26,9),(47263,'go','page',26,1),(47264,'links','page',26,1),(47265,'releases','page',26,1),(47266,'located','page',26,1),(47267,'at','page',26,4),(47268,'https','page',26,2),(47269,'//github','page',26,1),(47270,'com/cmu-sei/GHOSTS','page',26,1),(47271,'The','page',26,3),(47272,'Releases','page',26,1),(47273,'link','page',26,1),(47274,'the','page',26,36),(47275,'right','page',26,1),(47276,'hand','page',26,1),(47277,'side','page',26,1),(47278,'Click','page',26,1),(47279,'that','page',26,7),(47280,'get','page',26,3),(47281,'page','page',26,1),(47282,'where','page',26,3),(47283,'can','page',26,11),(47284,'ghost','page',26,12),(47285,'distribution','page',26,1),(47286,'in','page',26,8),(47287,'zip','page',26,2),(47288,'file','page',26,5),(47289,'set','page',26,8),(47290,'up','page',26,8),(47291,'You','page',26,5),(47292,'need','page',26,5),(47293,'put','page',26,2),(47294,'entire','page',26,1),(47295,'folder','page',26,5),(47296,'from','page',26,1),(47297,'each','page',26,1),(47298,'client/workstation','page',26,1),(47299,'generate','page',26,1),(47300,' ','page',26,14),(47301,'it','page',26,10),(47302,'anywhere','page',26,1),(47303,'placing','page',26,1),(47304,'c','page',26,1),(47305,'\\Ghosts','page',26,1),(47306,'isn','page',26,3),(47307,'t','page',26,4),(47308,'bad','page',26,1),(47309,'choice','page',26,1),(47310,'included','page',26,2),(47311,'powershell','page',26,2),(47312,'script','page',26,1),(47313,'GhostManagement','page',26,1),(47314,'ps1','page',26,1),(47315,'help','page',26,1),(47316,'with','page',26,3),(47317,'management','page',26,2),(47318,'deployment','page',26,1),(47319,'Configuring','page',26,3),(47320,'Config','page',26,1),(47321,'files','page',26,1),(47322,'Ghosts/config','page',26,1),(47323,'\r','page',26,29),(47324,'Application','page',26,1),(47325,'json','page',26,11),(47326,'-','page',26,13),(47327,'Used','page',26,1),(47328,'for','page',26,13),(47329,'general','page',26,1),(47330,'application','page',26,4),(47331,'variables','page',26,2),(47332,'settings','page',26,1),(47333,'Change','page',26,1),(47334,'following','page',26,2),(47335,'false\r','page',26,1),(47336,'IdEnabled','page',26,1),(47337,'top\r','page',26,1),(47338,'IsEnabled','page',26,2),(47339,'under','page',26,5),(47340,'ClientResults\r','page',26,1),(47341,'IsEnabled ','page',26,1),(47342,'ClientUpdates\r','page',26,1),(47343,'Survey','page',26,1),(47344,'Health\r','page',26,1),(47345,'IsEnabled\r','page',26,1),(47346,'Make','page',26,2),(47347,'sure','page',26,4),(47348,'variable','page',26,1),(47349,'true\r','page',26,1),(47350,'HandlersIsEnabled\r','page',26,1),(47351,'Remove','page',26,1),(47352,'URLs','page',26,1),(47353,'every','page',26,2),(47354,'see','page',26,1),(47355,'default','page',26,2),(47356,'looks','page',26,1),(47357,'like','page',26,2),(47358,'http','page',26,1),(47359,'//ghosts-c2/api/','page',26,1),(47360,'Set','page',26,1),(47361,'these','page',26,5),(47362,'which','page',26,2),(47363,'are','page',26,4),(47364,'typically','page',26,1),(47365,'“PostURL” ','page',26,1),(47366,'“”\r','page',26,1),(47367,'Then','page',26,2),(47368,'“OfficeDocsMaxAgeInHours”','page',26,1),(47369,'this','page',26,11),(47370,'-1\r','page',26,1),(47371,'“Email”','page',26,1),(47372,'options','page',26,1),(47373,'self','page',26,1),(47374,'explanatory','page',26,1),(47375,'however','page',26,1),(47376,'run\r','page',26,1),(47377,'There','page',26,1),(47378,'“EmailDomainSearchString”','page',26,1),(47379,'match','page',26,1),(47380,'your','page',26,6),(47381,'target','page',26,3),(47382,'domain','page',26,4),(47383,'test','page',26,1),(47384,'command','page',26,1),(47385,'Target','page',26,1),(47386,'Domain','page',26,1),(47387,'DC','page',26,1),(47388,'make','page',26,4),(47389,'works','page',26,1),(47390,'Here’s','page',26,1),(47391,'example','page',26,2),(47392,'of','page',26,10),(47393,'galfed','page',26,1),(47394,'com','page',26,6),(47395,'Get-ADUser','page',26,1),(47396,'-Filter','page',26,1),(47397,'*','page',26,1),(47398,'-SearchBase','page',26,1),(47399,'‘OU=Users','page',26,1),(47400,'DC=galfed','page',26,1),(47401,'DC=com’','page',26,1),(47402,'-properties','page',26,1),(47403,'mail','page',26,1),(47404,'|','page',26,1),(47405,'Select','page',26,1),(47406,'-expand','page',26,1),(47407,'mail”\r','page',26,1),(47408,'Dictionary','page',26,1),(47409,'Not','page',26,1),(47410,'what','page',26,1),(47411,'used','page',26,1),(47412,'very','page',26,1),(47413,'well','page',26,1),(47414,'documented','page',26,1),(47415,' \r','page',26,2),(47416,'Email-content','page',26,1),(47417,'csv','page',26,2),(47418,'This','page',26,4),(47419,'contains','page',26,1),(47420,'email','page',26,6),(47421,'content','page',26,1),(47422,'leave','page',26,2),(47423,'alone','page',26,2),(47424,'or','page',26,2),(47425,'if','page',26,4),(47426,'re','page',26,1),(47427,'ambitious','page',26,2),(47428,'create','page',26,2),(47429,'own','page',26,1),(47430,'Email-reply','page',26,1),(47431,'list','page',26,2),(47432,'replays','page',26,1),(47433,'you’re','page',26,2),(47434,'own\r','page',26,1),(47435,'Emails-domain','page',26,1),(47436,'all','page',26,1),(47437,'users','page',26,1),(47438,'emails','page',26,5),(47439,'have','page',26,3),(47440,'Emails-outside','page',26,1),(47441,'List','page',26,2),(47442,'external','page',26,1),(47443,'addresses','page',26,1),(47444,'domains','page',26,5),(47445,'Traffic-Gen','page',26,3),(47446,'sets','page',26,1),(47447,'msn','page',26,1),(47448,'gmail','page',26,1),(47449,'facebook','page',26,1),(47450,'linkdin','page',26,1),(47451,'salesforce','page',26,1),(47452,'net','page',26,1),(47453,'use','page',26,7),(47454,'anything','page',26,1),(47455,'name','page',26,2),(47456,'john','page',26,1),(47457,'smith@gmail','page',26,1),(47458,'However','page',26,1),(47459,'will','page',26,8),(47460,'running','page',26,4),(47461,'otherwise','page',26,1),(47462,'any','page',26,3),(47463,'sent','page',26,1),(47464,'via','page',26,1),(47465,'returned','page',26,1),(47466,'as','page',26,2),(47467,'undeliverables','page',26,1),(47468,'When','page',26,2),(47469,'stands','page',26,1),(47470,'Postfix','page',26,1),(47471,'mailserver','page',26,2),(47472,'aforementioned','page',26,1),(47473,'user','page',26,3),(47474,'be','page',26,4),(47475,'accepted','page',26,1),(47476,'postfix','page',26,1),(47477,'then','page',26,1),(47478,'sends','page',26,1),(47479,'/dev/null','page',26,1),(47480,'Filenames','page',26,1),(47481,'creating','page',26,1),(47482,'Office','page',26,1),(47483,'filenames','page',26,1),(47484,'rather','page',26,1),(47485,'large','page',26,1),(47486,'doesn’t','page',26,1),(47487,'repeat','page',26,1),(47488,'so','page',26,2),(47489,'when','page',26,2),(47490,'hits','page',26,1),(47491,'end','page',26,2),(47492,'stops','page',26,1),(47493,'working','page',26,3),(47494,'Health','page',26,1),(47495,'It','page',26,2),(47496,'check','page',26,1),(47497,'URL','page',26,1),(47498,'reporting','page',26,1),(47499,'health','page',26,2),(47500,'status','page',26,1),(47501,'don’t','page',26,1),(47502,'site','page',26,1),(47503,'provides','page',26,2),(47504,'disable','page',26,1),(47505,'Timeline','page',26,1),(47506,'ghosts','page',26,5),(47507,'preform','page',26,1),(47508,'activities','page',26,1),(47509,'Look','page',26,1),(47510,'sample','page',26,1),(47511,'config','page',26,1),(47512,'timeline','page',26,3),(47513,'BrowserChrome','page',26,1),(47514,'handler','page',26,2),(47515,'chrome','page',26,1),(47516,'driver','page',26,2),(47517,'version','page',26,3),(47518,'Chrome','page',26,1),(47519,'installed','page',26,1),(47520,'system','page',26,1),(47521,'place','page',26,2),(47522,'Outlook','page',26,1),(47523,'needed','page',26,1),(47524,'copy','page',26,1),(47525,'redemption','page',26,3),(47526,'dll','page',26,3),(47527,'it’s','page',26,1),(47528,'special','page',26,1),(47529,'circumvents','page',26,1),(47530,'outlook’s','page',26,1),(47531,'internal','page',26,1),(47532,'security','page',26,1),(47533,'automated','page',26,1),(47534,'It’s','page',26,1),(47535,'available','page',26,1),(47536,'here','page',26,1),(47537,'//www','page',26,1),(47538,'dimastr','page',26,1),(47539,'com/redemption/download','page',26,1),(47540,'htm','page',26,1),(47541,'costs','page',26,1),(47542,'$300','page',26,1),(47543,'00','page',26,1),(47544,'outlook','page',26,1),(47545,'install','page',26,1),(47546,'clients','page',26,1),(47547,'supported','page',26,1),(47548,'whatever','page',26,1),(47549,'getting','page',26,1),(47550,'Ghosts/lib','page',26,1),(47551,'NOTE','page',26,1),(47552,'latest','page',26,1),(47553,'binary','page',26,1),(47554,'release','page',26,1),(47555,'7','page',26,1),(47556,'0','page',26,1),(47557,'Logs','page',26,1),(47558,'ghosts/logs','page',26,1),(47559,'Provides','page',26,1),(47560,'information','page',26,1),(47561,'troubleshoot','page',26,1),(47562,'something','page',26,1),(47563,'isn’t','page',26,1),(47564,'entries','page',26,1),(47565,'action','page',26,1),(47566,'makes','page',26,1),(47567,'validate','page',26,1),(47568,'things','page',26,1),(47569,'App','page',26,1),(47570,'log\r','page',26,1),(47571,'Clientupdates','page',26,1),(47572,'log','page',26,1),(47573,'STARTING','page',26,3),(47574,'AND','page',26,3),(47575,'STOPPING','page',26,3),(47576,'GHOSTS','page',26,3),(47577,'To','page',26,2),(47578,'start','page',26,2),(47579,'click','page',26,2),(47580,'exe','page',26,1),(47581,'root','page',26,2),(47582,'stop','page',26,1),(47583,'kill-ghosts','page',26,1),(47584,'bat','page',26,1),(47585,'NOTES','page',26,3),(47586,'resource','page',26,1),(47587,'intensive','page',26,1),(47588,'handlers','page',26,1),(47589,'should','page',26,1),(47590,'reasonable','page',26,1),(47591,'choices','page',26,1),(47592,'normal','page',26,1),(47593,'generating','page',26,1),(47594,'new','page',26,2),(47595,'word','page',26,1),(47596,'document','page',26,1),(47597,'once','page',26,1),(47598,'minute','page',26,1),(47599,'update','page',26,1),(47600,'while','page',26,1),(47601,'automatically','page',26,1),(47602,'using','page',26,1),(47603,'don','page',26,1),(47604,'restart','page',26,1),(47605,'Blue','page',27,40),(47606,'Space','page',27,40),(47607,'Set','page',27,40),(47608,'up','page',27,40),(47609,'and','page',27,45),(47610,'Management','page',27,40),(47611,'Scripts','page',27,40),(47612,'CleanLogs','page',27,3),(47613,'ps1','page',27,8),(47614,'is','page',27,9),(47615,'designed','page',27,5),(47616,'to','page',27,21),(47617,'remove','page',27,4),(47618,'Exchange','page',27,2),(47619,'logs','page',27,1),(47620,'from','page',27,3),(47621,'your','page',27,5),(47622,'blue','page',27,2),(47623,'space','page',27,4),(47624,'Server','page',27,1),(47625,' ','page',27,9),(47626,'This','page',27,7),(47627,'done','page',27,2),(47628,'post-engagement/exercise','page',27,2),(47629,'any','page',27,4),(47630,'prior','page',27,2),(47631,'artifacts','page',27,2),(47632,'or','page',27,2),(47633,'time','page',27,2),(47634,'you','page',27,4),(47635,'need','page',27,4),(47636,'do','page',27,2),(47637,'this','page',27,2),(47638,'It','page',27,2),(47639,'s','page',27,3),(47640,'also','page',27,3),(47641,'helpful','page',27,2),(47642,'reduce','page',27,2),(47643,'drive','page',27,2),(47644,'on','page',27,3),(47645,'the','page',27,11),(47646,'exchange','page',27,3),(47647,'script','page',27,4),(47648,'will','page',27,2),(47649,'be','page',27,3),(47650,'modify','page',27,2),(47651,'based','page',27,1),(47652,'how','page',27,1),(47653,'was','page',27,1),(47654,'built/configured','page',27,1),(47655,'ensure','page',27,1),(47656,'it','page',27,1),(47657,'pointing','page',27,1),(47658,'correct','page',27,1),(47659,'log','page',27,1),(47660,'path','page',27,1),(47661,'\r','page',27,19),(47662,'ps1\r','page',27,3),(47663,'DeleteAllEmails','page',27,2),(47664,'emails','page',27,1),(47665,'server','page',27,1),(47666,'size','page',27,1),(47667,'of','page',27,3),(47668,'edb','page',27,1),(47669,'mail','page',27,1),(47670,'database','page',27,1),(47671,'ussually','page',27,1),(47672,'ran','page',27,2),(47673,'in','page',27,1),(47674,'conjunction','page',27,1),(47675,'with','page',27,1),(47676,'CreateADUsers','page',27,2),(47677,'take','page',27,1),(47678,'a','page',27,4),(47679,'user','page',27,6),(47680,'generated','page',27,1),(47681,'CSV','page',27,2),(47682,'for','page',27,2),(47683,'accounts','page',27,1),(47684,'then','page',27,1),(47685,'create','page',27,2),(47686,'AD','page',27,2),(47687,'account','page',27,2),(47688,'defined','page',27,1),(47689,'groups','page',27,2),(47690,'assign','page',27,1),(47691,'new','page',27,1),(47692,'these','page',27,1),(47693,'template','page',27,1),(47694,'feel','page',27,1),(47695,'free','page',27,1),(47696,'meet','page',27,1),(47697,'needs','page',27,2),(47698,'have','page',27,2),(47699,'environment','page',27,1),(47700,'CreateMailboxes','page',27,2),(47701,'enable/add','page',27,1),(47702,'mailboxes','page',27,1),(47703,'using','page',27,1),(47704,'file','page',27,1),(47705,'Range-Management','page',27,1),(47706,'PowerCLI','page',27,2),(47707,'manage','page',27,1),(47708,'turning','page',27,1),(47709,'off','page',27,1),(47710,'as','page',27,2),(47711,'well','page',27,1),(47712,'reverting','page',27,1),(47713,'VMs','page',27,1),(47714,'management','page',27,1),(47715,'network','page',27,2),(47716,'meaning','page',27,1),(47717,'where','page',27,1),(47718,'ESXI','page',27,2),(47719,'Host','page',27,1),(47720,'IP','page',27,1),(47721,'resides','page',27,1),(47722,'licensed','page',27,1),(47723,'copy','page',27,1),(47724,'able','page',27,1),(47725,'use','page',27,1),(47726,'full','page',27,1),(47727,'feature','page',27,1),(47728,'set','page',27,1),(47729,' Range-Management','page',27,1),(47730,'Importing','page',28,40),(47731,'CA','page',28,43),(47732,'and','page',28,51),(47733,'Int','page',28,40),(47734,'Certs','page',28,40),(47735,'to','page',28,55),(47736,'your','page',28,46),(47737,'Target','page',28,41),(47738,'Domain','page',28,41),(47739,'The','page',28,2),(47740,'Cyber','page',28,2),(47741,'Range','page',28,2),(47742,'environment','page',28,1),(47743,'will','page',28,2),(47744,'create','page',28,3),(47745,'a','page',28,4),(47746,'intermediate','page',28,3),(47747,'Authority','page',28,1),(47748,' ','page',28,15),(47749,'This','page',28,1),(47750,'is','page',28,1),(47751,'used','page',28,2),(47752,'simulate','page',28,1),(47753,'real','page',28,1),(47754,'world','page',28,1),(47755,'SSL','page',28,3),(47756,'signing','page',28,2),(47757,'services','page',28,1),(47758,'like','page',28,2),(47759,'Digicert','page',28,1),(47760,'or','page',28,1),(47761,'Verisign','page',28,1),(47762,'By','page',28,1),(47763,'default','page',28,1),(47764,'the','page',28,19),(47765,'installation','page',28,1),(47766,'one','page',28,1),(47767,'called','page',28,1),(47768,'globalcert','page',28,8),(47769,'com','page',28,9),(47770,'cert','page',28,1),(47771,'for','page',28,2),(47772,'certs','page',28,5),(47773,'are','page',28,2),(47774,'generated','page',28,1),(47775,'during','page',28,1),(47776,'initial','page',28,1),(47777,'build','page',28,1),(47778,'of','page',28,3),(47779,'CA-server','page',28,2),(47780,'These','page',28,1),(47781,'need','page',28,1),(47782,'be','page',28,1),(47783,'imported','page',28,1),(47784,'into','page',28,1),(47785,'trust','page',28,2),(47786,'stores','page',28,1),(47787,'windows','page',28,2),(47788,'based','page',28,2),(47789,'target','page',28,3),(47790,'systems','page',28,2),(47791,'Below','page',28,1),(47792,'instructions','page',28,3),(47793,'doing','page',28,1),(47794,'so','page',28,1),(47795,'Step','page',28,3),(47796,'1','page',28,5),(47797,'Obtain','page',28,1),(47798,'from','page',28,2),(47799,'CA-Server','page',28,1),(47800,'From','page',28,1),(47801,'domain','page',28,3),(47802,'scp','page',28,3),(47803,'these','page',28,3),(47804,'off','page',28,1),(47805,'\r','page',28,13),(47806,'root@180','page',28,2),(47807,'50','page',28,2),(47808,'/root/ca/certs/ca','page',28,1),(47809,'crt','page',28,6),(47810,'pem ','page',28,1),(47811,'ca','page',28,2),(47812,'pem\r','page',28,1),(47813,'/root/ca/intermediate/certs/int','page',28,1),(47814,'pem','page',28,4),(47815,'int','page',28,2),(47816,'2','page',28,1),(47817,'Move','page',28,1),(47818,'Active','page',28,1),(47819,'Directory','page',28,1),(47820,'server','page',28,1),(47821,'GPO','page',28,3),(47822,'add','page',28,3),(47823,'store','page',28,1),(47824,'On','page',28,1),(47825,'DC','page',28,1),(47826,'open','page',28,1),(47827,'Group','page',28,2),(47828,'Policy','page',28,2),(47829,'Management','page',28,1),(47830,'Creeat','page',28,1),(47831,'new','page',28,1),(47832,'linked','page',28,1),(47833,'name','page',28,1),(47834,'it','page',28,5),(47835,'something','page',28,1),(47836,'Import_CA','page',28,1),(47837,'Edit','page',28,1),(47838,'this','page',28,1),(47839,'then','page',28,2),(47840,'certificates','page',28,1),(47841,'First','page',28,1),(47842,'well','page',28,1),(47843,'certificate','page',28,2),(47844,'Go','page',28,2),(47845,'Computer','page',28,2),(47846,'Configuration','page',28,2),(47847,'-','page',28,10),(47848,'Policies','page',28,4),(47849,'Windows','page',28,2),(47850,'Settings','page',28,4),(47851,'Security','page',28,2),(47852,'Public','page',28,2),(47853,'Key','page',28,2),(47854,'Trusted','page',28,1),(47855,'Root','page',28,1),(47856,'Certificate','page',28,1),(47857,'Authorities','page',28,2),(47858,'Then','page',28,5),(47859,'right','page',28,4),(47860,'click','page',28,2),(47861,'in','page',28,2),(47862,'window','page',28,4),(47863,'select','page',28,4),(47864,'import','page',28,5),(47865,'follow','page',28,2),(47866,'browse','page',28,3),(47867,'where','page',28,2),(47868,'you','page',28,4),(47869,'stored','page',28,2),(47870,'If','page',28,2),(47871,'don','page',28,2),(47872,'t','page',28,3),(47873,'see','page',28,2),(47874,'change','page',28,2),(47875,'file','page',28,2),(47876,'types','page',28,2),(47877,'all','page',28,3),(47878,'Next','page',28,1),(47879,'Intermediate','page',28,1),(47880,'Certification','page',28,1),(47881,'3','page',28,1),(47882,'Close','page',28,1),(47883,'Manager','page',28,1),(47884,'run','page',28,1),(47885,'gpupdate','page',28,1),(47886,'/force','page',28,1),(47887,'on','page',28,1),(47888,'connected','page',28,1),(47889,'VM','page',28,1),(47890,'https','page',28,1),(47891,'//redbook','page',28,1),(47892,'validate','page',28,1),(47893,'there','page',28,1),(47894,'isn','page',28,1),(47895,'an','page',28,1),(47896,'error/warning','page',28,1),(47897,'Connecting','page',29,41),(47898,'a','page',29,65),(47899,'Target','page',29,48),(47900,'Domain','page',29,46),(47901,'to','page',29,78),(47902,'the','page',29,96),(47903,'Cyber','page',29,46),(47904,'Range','page',29,46),(47905,'blue','page',29,7),(47906,'space','page',29,7),(47907,'is','page',29,10),(47908,'fairly','page',29,1),(47909,'straight','page',29,1),(47910,'forward','page',29,1),(47911,' ','page',29,30),(47912,'You','page',29,5),(47913,'can','page',29,6),(47914,'have','page',29,6),(47915,'single','page',29,3),(47916,'WAN','page',29,10),(47917,'point','page',29,2),(47918,'for','page',29,14),(47919,'or','page',29,2),(47920,'as','page',29,5),(47921,'many','page',29,2),(47922,'you','page',29,19),(47923,'would','page',29,3),(47924,'like','page',29,6),(47925,'just','page',29,7),(47926,'add','page',29,5),(47927,'gateway','page',29,6),(47928,'IP','page',29,19),(47929,'connection','page',29,5),(47930,'on','page',29,13),(47931,'SI-Router','page',29,4),(47932,'s','page',29,3),(47933,'RangeWAN','page',29,4),(47934,'interface','page',29,4),(47935,'and','page',29,7),(47936,'then','page',29,3),(47937,'connect','page',29,4),(47938,'edge','page',29,1),(47939,'ESXI','page',29,5),(47940,'switch','page',29,6),(47941,'Since','page',29,1),(47942,'there','page',29,1),(47943,'are','page',29,5),(47944,'too','page',29,1),(47945,'possibilities','page',29,1),(47946,'what','page',29,1),(47947,'could','page',29,1),(47948,'look','page',29,3),(47949,'this','page',29,11),(47950,'guide','page',29,1),(47951,'will','page',29,4),(47952,'use','page',29,8),(47953,'simple','page',29,2),(47954,'example','page',29,5),(47955,'of','page',29,10),(47956,'basic','page',29,1),(47957,'explain','page',29,1),(47958,'process','page',29,1),(47959,'connecting','page',29,1),(47960,'cyber','page',29,2),(47961,'range','page',29,2),(47962,'Below','page',29,4),(47963,'In','page',29,1),(47964,'diagram','page',29,2),(47965,'above','page',29,2),(47966,'your','page',29,8),(47967,'built','page',29,1),(47968,'another','page',29,2),(47969,'server','page',29,7),(47970,'On','page',29,1),(47971,'ll','page',29,10),(47972,'need','page',29,9),(47973,'create','page',29,1),(47974,'virtual','page',29,5),(47975,'Then','page',29,7),(47976,'an','page',29,3),(47977,'uplink','page',29,4),(47978,'that','page',29,10),(47979,'connects','page',29,1),(47980,'physical','page',29,4),(47981,'NIC','page',29,2),(47982,'host','page',29,1),(47983,'running','page',29,1),(47984,'environment','page',29,1),(47985,'maps','page',29,1),(47986,'line','page',29,1),(47987,'between','page',29,2),(47988,'the ','page',29,1),(47989,'NICs','page',29,1),(47990,'those','page',29,1),(47991,'two','page',29,2),(47992,'servers','page',29,1),(47993,'  ','page',29,2),(47994,'Next','page',29,1),(47995,'pick','page',29,1),(47996,'almost','page',29,1),(47997,'whatever','page',29,2),(47998,'want','page',29,5),(47999,'target','page',29,8),(48000,'domain','page',29,6),(48001,'network','page',29,1),(48002,'however','page',29,1),(48003,'make','page',29,3),(48004,'sure','page',29,3),(48005,'select','page',29,1),(48006,'isn','page',29,2),(48007,'t','page',29,4),(48008,'already','page',29,3),(48009,'routed','page',29,2),(48010,'SI-router','page',29,2),(48011,'A','page',29,1),(48012,'good','page',29,2),(48013,'way','page',29,1),(48014,'check','page',29,1),(48015,'available','page',29,4),(48016,'grep','page',29,3),(48017,'against','page',29,2),(48018,'Geo-Location','page',29,1),(48019,'folder','page',29,1),(48020,'structure','page',29,1),(48021,'NRTS','page',29,3),(48022,'some','page',29,2),(48023,'suggestions','page',29,1),(48024,'validating','page',29,1),(48025,'Domains','page',29,2),(48026,' From','page',29,1),(48027,'cd','page',29,1),(48028,'/root/backbonerouters\r','page',29,1),(48029,'44','page',29,16),(48030,'22','page',29,12),(48031,'1','page',29,2),(48032,'*/*','page',29,1),(48033,'Above','page',29,1),(48034,'we','page',29,11),(48035,'grepping','page',29,1),(48036,'first','page',29,3),(48037,'octets','page',29,1),(48038,'part','page',29,1),(48039,'third','page',29,1),(48040,'octet','page',29,1),(48041,'all','page',29,2),(48042,'files','page',29,1),(48043,'in','page',29,5),(48044,'/root/backbonerouters','page',29,1),(48045,'directory','page',29,1),(48046,'This','page',29,1),(48047,'find','page',29,1),(48048,'possible','page',29,1),(48049,'matches','page',29,1),(48050,'IP/subnet','page',29,2),(48051,'doesn','page',29,2),(48052,'fall','page',29,1),(48053,'into','page',29,2),(48054,'existing','page',29,1),(48055,'If','page',29,1),(48056,'comes','page',29,1),(48057,'back','page',29,2),(48058,'empty','page',29,1),(48059,'go','page',29,1),(48060,'with','page',29,4),(48061,'selected','page',29,1),(48062,'Typically','page',29,1),(48063,'/29','page',29,1),(48064,'subnet','page',29,3),(48065,'reasonable','page',29,1),(48066,'choice','page',29,1),(48067,'For','page',29,3),(48068,'11','page',29,17),(48069,'10/29','page',29,3),(48070,'IPs','page',29,1),(48071,'ranges','page',29,1),(48072,'from','page',29,2),(48073,'9','page',29,2),(48074,'14','page',29,2),(48075,'We','page',29,1),(48076,'our','page',29,2),(48077,'so','page',29,1),(48078,'configure','page',29,2),(48079,'still','page',29,1),(48080,'set','page',29,11),(48081,'up','page',29,2),(48082,'OWA','page',29,1),(48083,'Once','page',29,2),(48084,'ve','page',29,2),(48085,'be','page',29,4),(48086,'it','page',29,4),(48087,'instructions','page',29,1),(48088,'Console','page',29,1),(48089,'\r','page',29,5),(48090,'edit','page',29,1),(48091,'following','page',29,3),(48092,'script','page',29,5),(48093,'/home/vyos/Scripts/Eth3RangeWAN','page',29,2),(48094,'sh','page',29,4),(48095,'#','page',29,2),(48096,'/bin/vbash\r','page',29,2),(48097,'source','page',29,2),(48098,'/opt/vyatta/etc/functions/script-template\r','page',29,2),(48099,'configure\r','page',29,2),(48100,'interfaces','page',29,7),(48101,'ethernet','page',29,7),(48102,'eth3','page',29,7),(48103,'address','page',29,3),(48104,'10/29\r','page',29,2),(48105,'duplex','page',29,2),(48106,'auto\r','page',29,4),(48107,'speed','page',29,2),(48108,'commit\r','page',29,2),(48109,'exit','page',29,2),(48110,'save','page',29,1),(48111,'run','page',29,2),(48112,'/Eth3RangeWAN','page',29,1),(48113,'That','page',29,1),(48114,'should','page',29,1),(48115,'able','page',29,1),(48116,'ping','page',29,1),(48117,'forth','page',29,1),(48118,'firewall','page',29,2),(48119,'rules','page',29,1),(48120,'allow','page',29,1),(48121,'ICMP','page',29,1),(48122,'else','page',29,1),(48123,'enabled','page',29,1),(48124,'Adding','page',29,1),(48125,'additional','page',29,2),(48126,'domains','page',29,1),(48127,'basically','page',29,1),(48128,'same','page',29,1),(48129,'say','page',29,1),(48130,'using','page',29,1),(48131,'55','page',29,3),(48132,'2/29','page',29,1),(48133,'added','page',29,1),(48134,'shown','page',29,1),(48135,'second','page',29,2),(48136,'modify','page',29,1),(48137,'new','page',29,1),(48138,'one','page',29,2),(48139,'again','page',29,2),(48140,'case','page',29,1),(48141,'1/29','page',29,1),(48142,'The','page',29,1),(48143,'Eth3RangeWAN','page',29,1),(48144,'get','page',29,1),(48145,'errors','page',29,1),(48146,'saying','page',29,1),(48147,'previous','page',29,1),(48148,'exists','page',29,1),(48149,'but','page',29,2),(48150,'hurt','page',29,1),(48151,'anything','page',29,1),(48152,'move','page',29,1),(48153,'33','page',29,1),(48154,'1/29\r','page',29,1),(48155,'NOTE','page',29,1),(48156,'more','page',29,1),(48157,'than','page',29,1),(48158,'switches','page',29,1),(48159,'limited','page',29,1),(48160,'Technically','page',29,1),(48161,'4','page',29,1),(48162,'uplinks','page',29,2),(48163,'Virtual','page',29,1),(48164,'Switch','page',29,1),(48165,'these','page',29,1),(48166,'only','page',29,1),(48167,'configured','page',29,1),(48168,'teamed','page',29,1),(48169,'fail','page',29,1),(48170,'over','page',29,1),(48171,'ports','page',29,1),(48172,'So','page',29,2),(48173,'essentially','page',29,1),(48174,'its','page',29,1),(48175,'logical','page',29,1),(48176,'port','page',29,2),(48177,'multiple','page',29,1),(48178,'put','page',29,1),(48179,'connections','page',29,1),(48180,'from ','page',29,1),(48181,'domain ','page',29,1),(48182,'WANs','page',29,1),(48183,'really','page',29,1),(48184,'poorly','page',29,1),(48185,'made','page',29,1),(48186,'Adding','page',31,41),(48187,'DNS','page',31,54),(48188,'for','page',31,60),(48189,'your','page',31,49),(48190,'Target','page',31,49),(48191,'Domain','page',31,49),(48192,'You','page',31,2),(48193,'will','page',31,8),(48194,'most','page',31,1),(48195,'likely','page',31,1),(48196,'want','page',31,1),(48197,'the','page',31,59),(48198,'target','page',31,7),(48199,'domains','page',31,4),(48200,'you','page',31,11),(48201,'connect','page',31,1),(48202,'to','page',31,42),(48203,'Cyber','page',31,5),(48204,'Range','page',31,5),(48205,'have','page',31,6),(48206,'publicly','page',31,1),(48207,'available','page',31,1),(48208,'services','page',31,5),(48209,'example','page',31,5),(48210,'maybe','page',31,1),(48211,'a','page',31,26),(48212,'public','page',31,5),(48213,'facing','page',31,3),(48214,'website','page',31,4),(48215,'and/or','page',31,1),(48216,'email','page',31,2),(48217,' ','page',31,39),(48218,'For','page',31,4),(48219,'systems','page',31,1),(48220,'in','page',31,10),(48221,'reach','page',31,1),(48222,'these','page',31,1),(48223,'it','page',31,7),(48224,'need','page',31,4),(48225,'its','page',31,1),(48226,'domain','page',31,14),(48227,'registered','page',31,1),(48228,'on','page',31,7),(48229,'rootDNS','page',31,3),(48230,'server','page',31,15),(48231,'Since','page',31,1),(48232,'and','page',31,11),(48233,'subdomains','page',31,1),(48234,'user','page',31,1),(48235,'created','page',31,3),(48236,'tends','page',31,1),(48237,'be','page',31,6),(48238,'very','page',31,1),(48239,'dynamic','page',31,1),(48240,'not','page',31,1),(48241,'frequently','page',31,1),(48242,'required','page',31,1),(48243,'task','page',31,1),(48244,'there','page',31,3),(48245,'is','page',31,19),(48246,'no','page',31,3),(48247,'script','page',31,1),(48248,'setting','page',31,5),(48249,'this','page',31,12),(48250,'up','page',31,7),(48251,'RootDNS','page',31,5),(48252,'purely','page',31,1),(48253,'manual','page',31,1),(48254,'process','page',31,1),(48255,'This','page',31,12),(48256,'guide','page',31,2),(48257,'help','page',31,1),(48258,'get','page',31,4),(48259,'that','page',31,7),(48260,'set','page',31,7),(48261,'with','page',31,4),(48262,'few','page',31,1),(48263,'examples','page',31,1),(48264,'Example','page',31,2),(48265,'1','page',31,3),(48266,'-','page',31,3),(48267,'Your','page',31,1),(48268,'called','page',31,1),(48269,'widgets','page',31,19),(48270,'com','page',31,18),(48271,'has','page',31,1),(48272,'mail','page',31,4),(48273,'purpose','page',31,1),(48274,'of','page',31,11),(48275,'we','page',31,20),(48276,'ll','page',31,4),(48277,'assume','page',31,2),(48278,'already','page',31,1),(48279,'completed','page',31,2),(48280,'Planning','page',31,1),(48281,'Guide','page',31,1),(48282,'Connecting','page',31,1),(48283,'  ','page',31,5),(48284,'Additionally','page',31,1),(48285,'decided','page',31,1),(48286,'use','page',31,3),(48287,'44','page',31,16),(48288,'22','page',31,16),(48289,'11','page',31,20),(48290,'10/29','page',31,1),(48291,'domain ','page',31,1),(48292,'firewall','page',31,4),(48293,'WAN','page',31,2),(48294,'connection','page',31,2),(48295,'Then','page',31,5),(48296,'enable','page',31,1),(48297,'our','page',31,13),(48298,'reachable','page',31,1),(48299,'through','page',31,2),(48300,'Firewall','page',31,2),(48301,'port','page',31,7),(48302,'forward','page',31,4),(48303,'10','page',31,6),(48304,'send','page',31,2),(48305,'80','page',31,1),(48306,'443','page',31,3),(48307,'web','page',31,1),(48308,'then','page',31,1),(48309,'virtual','page',31,1),(48310,'IP','page',31,8),(48311,'at','page',31,3),(48312,'forwarded','page',31,1),(48313,'ports','page',31,1),(48314,'25','page',31,2),(48315,'exchange','page',31,1),(48316,'   ','page',31,2),(48317,'Therefore','page',31,1),(48318,'OWA','page',31,1),(48319,'over','page',31,1),(48320,'SMTP','page',31,1),(48321,'Step','page',31,6),(48322,'Log','page',31,2),(48323,'into','page',31,2),(48324,'create','page',31,2),(48325,'zone','page',31,9),(48326,'file','page',31,14),(48327,'/etc/bind/RANGE','page',31,1),(48328,'directory','page',31,1),(48329,'cd','page',31,4),(48330,'/etc/bind/RANGE\r','page',31,1),(48331,'vi','page',31,3),(48332,'db','page',31,2),(48333,'Next','page',31,3),(48334,'put','page',31,1),(48335,'following','page',31,6),(48336,'Widgets','page',31,2),(48337,'blue','page',31,2),(48338,'space','page',31,3),(48339,'DNS\r','page',31,1),(48340,'$TTL','page',31,1),(48341,'88640\r','page',31,1),(48342,'@','page',31,6),(48343,'IN','page',31,8),(48344,'SOA','page',31,2),(48345,'ns','page',31,7),(48346,'42','page',31,3),(48347,'3H','page',31,3),(48348,'15M','page',31,3),(48349,'1W','page',31,3),(48350,'1D\r','page',31,1),(48351,'NS','page',31,1),(48352,'\r','page',31,24),(48353,'MX','page',31,2),(48354,'A','page',31,6),(48355,'11\r','page',31,2),(48356,'www','page',31,2),(48357,'10\r','page',31,1),(48358,'owa','page',31,2),(48359,'198','page',31,4),(48360,'41','page',31,4),(48361,'0','page',31,4),(48362,'4','page',31,5),(48363,'So','page',31,1),(48364,'lets','page',31,1),(48365,'explain','page',31,1),(48366,'line','page',31,2),(48367,'by','page',31,2),(48368,'Line','page',31,9),(48369,'1 ','page',31,1),(48370,'       ','page',31,1),(48371,'just','page',31,1),(48372,'comment','page',31,1),(48373,'can','page',31,5),(48374,'add','page',31,2),(48375,'comments','page',31,2),(48376,'using','page',31,8),(48377,'NOTE','page',31,1),(48378,'bind','page',31,2),(48379,'reference','page',31,3),(48380,'aka','page',31,1),(48381,'named','page',31,7),(48382,'conf','page',31,10),(48383,'xxx','page',31,1),(48384,'//','page',31,1),(48385,'2 ','page',31,1),(48386,'$TTL    ','page',31,1),(48387,'88640','page',31,1),(48388,'time','page',31,2),(48389,'seconds','page',31,1),(48390,'caching','page',31,2),(48391,'servers','page',31,1),(48392,'should','page',31,3),(48393,'cache','page',31,1),(48394,'record','page',31,1),(48395,'3','page',31,2),(48396,'@    ','page',31,1),(48397,'IN  ','page',31,5),(48398,'SOA   ','page',31,1),(48399,'@  ','page',31,2),(48400,'1D','page',31,2),(48401,'Start','page',31,1),(48402,'Authority','page',31,1),(48403,'The','page',31,4),(48404,'serial','page',31,1),(48405,'#','page',31,1),(48406,'refresh','page',31,1),(48407,'retry','page',31,1),(48408,'expire','page',31,1),(48409,'negative','page',31,1),(48410,'TTL\r','page',31,1),(48411,'@   ','page',31,2),(48412,'NS     ','page',31,1),(48413,'NameServer','page',31,1),(48414,'com\r','page',31,1),(48415,'5','page',31,1),(48416,'IN   ','page',31,1),(48417,'MX  ','page',31,1),(48418,'10   ','page',31,1),(48419,'priority','page',31,2),(48420,'say','page',31,3),(48421,'if','page',31,3),(48422,'had','page',31,1),(48423,'more','page',31,1),(48424,'than','page',31,1),(48425,'one','page',31,2),(48426,'could','page',31,1),(48427,'make','page',31,4),(48428,'higher','page',31,1),(48429,'6','page',31,1),(48430,'IN    ','page',31,1),(48431,'A   ','page',31,1),(48432,'indicates','page',31,1),(48433,'applies','page',31,1),(48434,'Top','page',31,1),(48435,'Level','page',31,1),(48436,'TLD','page',31,1),(48437,'meaning','page',31,1),(48438,'sets','page',31,4),(48439,'which','page',31,3),(48440,'what','page',31,2),(48441,'are','page',31,5),(48442,'7','page',31,1),(48443,'www  ','page',31,1),(48444,'A ','page',31,1),(48445,'subdomain','page',31,3),(48446,'via','page',31,1),(48447,'go','page',31,1),(48448,'8','page',31,1),(48449,'owa ','page',31,1),(48450,'A  ','page',31,1),(48451,'allow','page',31,1),(48452,'reaching','page',31,1),(48453,'mailserver','page',31,1),(48454,'from','page',31,4),(48455,'https','page',31,1),(48456,'//owa','page',31,1),(48457,'9','page',31,1),(48458,'ns   ','page',31,1),(48459,'also','page',31,2),(48460,'listed','page',31,1),(48461,'as','page',31,2),(48462,'nameserver','page',31,5),(48463,'an','page',31,6),(48464,'itself','page',31,1),(48465,'prevents','page',31,1),(48466,'looking','page',31,1),(48467,'additional','page',31,2),(48468,'information','page',31,1),(48469,'some','page',31,1),(48470,'other','page',31,1),(48471,'like','page',31,3),(48472,'something','page',31,2),(48473,'wanted','page',31,1),(48474,'IPv6','page',31,5),(48475,'address','page',31,3),(48476,'records','page',31,1),(48477,'AAAA','page',31,1),(48478,'verse','page',31,1),(48479,'nslookup','page',31,3),(48480,'attempt','page',31,1),(48481,'retrieve','page',31,1),(48482,'was','page',31,1),(48483,'arbitrary','page',31,1),(48484,'or','page',31,3),(48485,'would','page',31,1),(48486,'query','page',31,1),(48487,'won','page',31,2),(48488,'t','page',31,2),(48489,'response','page',31,1),(48490,'means','page',31,1),(48491,'lookups','page',31,1),(48492,'slow','page',31,1),(48493,'waits','page',31,1),(48494,'queries','page',31,1),(48495,'out','page',31,1),(48496,'2','page',31,5),(48497,'Now','page',31,2),(48498,'test','page',31,2),(48499,'sure','page',31,2),(48500,'syntax','page',31,3),(48501,'errors','page',31,3),(48502,'do','page',31,1),(48503,'command','page',31,1),(48504,'named-checkzone','page',31,1),(48505,'domainname','page',31,1),(48506,'zonefile','page',31,1),(48507,'below','page',31,2),(48508,'Once','page',31,1),(48509,'Zone','page',31,1),(48510,'/etc/bind/named','page',31,3),(48511,'RANGE','page',31,9),(48512,'/etc/bind\r','page',31,3),(48513,'append','page',31,2),(48514,'type','page',31,2),(48515,'master','page',31,1),(48516,'RANGE/db','page',31,1),(48517,'allow-query','page',31,1),(48518,'any','page',31,1),(48519,'allow-update','page',31,1),(48520,'none','page',31,1),(48521,'validate','page',31,2),(48522,'edits','page',31,1),(48523,'made','page',31,1),(48524,'named-checkconf','page',31,2),(48525,'If','page',31,2),(48526,'nothing','page',31,1),(48527,'back','page',31,1),(48528,'output','page',31,1),(48529,'good','page',31,1),(48530,'check','page',31,1),(48531,'added','page',31,1),(48532,'restart','page',31,1),(48533,'read','page',31,1),(48534,'new','page',31,1),(48535,'config','page',31,1),(48536,'Do','page',31,1),(48537,'service','page',31,4),(48538,'bind9','page',31,4),(48539,'restart\r','page',31,2),(48540,'status','page',31,2),(48541,'Output','page',31,1),(48542,'look','page',31,1),(48543,'run','page',31,3),(48544,'works','page',31,1),(48545,'running','page',31,2),(48546,'within','page',31,2),(48547,'Again','page',31,1),(48548,'connecting','page',31,1),(48549,'portion','page',31,1),(48550,'33','page',31,2),(48551,'2/29','page',31,1),(48552,'s','page',31,1),(48553,'We','page',31,1),(48554,'In','page',31,1),(48555,'case','page',31,1),(48556,'managing','page',31,1),(48557,'own','page',31,1),(48558,'so','page',31,1),(48559,'Instead','page',31,1),(48560,'adding','page',31,1),(48561,'forwarder','page',31,1),(48562,'s ','page',31,1),(48563,'Just','page',31,1),(48564,'forwarding','page',31,1),(48565,'53','page',31,1),(48566,'internal','page',31,1),(48567,'edit','page',31,1),(48568,'forwarders','page',31,1),(48569,'Check','page',31,1),(48570,'passes','page',31,1),(48571,'again','page',31,1),(48572,'What','page',31,1),(48573,'looks','page',31,1),(48574,'depends','page',31,1),(48575,'how','page',31,1),(48576,'configured','page',31,1);
/*!40000 ALTER TABLE `search_terms` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `sessions`
--

DROP TABLE IF EXISTS `sessions`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `sessions` (
  `id` varchar(191) NOT NULL,
  `user_id` int(11) DEFAULT NULL,
  `ip_address` varchar(45) DEFAULT NULL,
  `user_agent` text DEFAULT NULL,
  `payload` text NOT NULL,
  `last_activity` int(11) NOT NULL,
  UNIQUE KEY `sessions_id_unique` (`id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `sessions`
--

LOCK TABLES `sessions` WRITE;
/*!40000 ALTER TABLE `sessions` DISABLE KEYS */;
/*!40000 ALTER TABLE `sessions` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `settings`
--

DROP TABLE IF EXISTS `settings`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `settings` (
  `setting_key` varchar(191) NOT NULL,
  `value` text NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `type` varchar(50) NOT NULL DEFAULT 'string',
  PRIMARY KEY (`setting_key`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `settings`
--

LOCK TABLES `settings` WRITE;
/*!40000 ALTER TABLE `settings` DISABLE KEYS */;
INSERT INTO `settings` VALUES ('app-color','#206ea7','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('app-color-dark','#3584e4','2023-04-05 16:49:46','2023-04-06 17:02:28','string'),('app-color-light','rgba(32,110,167,0.15)','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('app-color-light-dark','rgba(53,132,228,0.15)','2023-04-05 16:49:46','2023-04-06 17:02:28','string'),('app-custom-head','','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('app-disable-comments','false','2023-04-05 01:00:52','2023-04-05 01:00:52','string'),('app-editor','wysiwyg','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('app-footer-links','[]','2023-04-05 16:49:46','2023-04-05 16:49:46','array'),('app-homepage','','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('app-homepage-type','bookshelves','2023-04-05 16:49:46','2023-04-05 16:51:45','string'),('app-icon','https://redbook.com/uploads/images/system/2023-04/cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46','string'),('app-icon-128','https://redbook.com/uploads/images/system/2023-04/ML7cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46','string'),('app-icon-180','https://redbook.com/uploads/images/system/2023-04/Zx6cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46','string'),('app-icon-32','https://redbook.com/uploads/images/system/2023-04/QV0cricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46','string'),('app-icon-64','https://redbook.com/uploads/images/system/2023-04/6qWcricon.png','2023-04-05 16:51:46','2023-04-05 16:51:46','string'),('app-logo','https://redbook.com/uploads/images/system/2023-04/cyber-range-low-resolution-logo-color-on-transparent-background.png','2023-04-05 16:51:46','2023-04-06 17:01:33','string'),('app-name','BookStack','2023-04-05 16:49:46','2023-04-05 16:49:52','string'),('app-name-header','false','2023-04-05 16:49:46','2023-04-05 16:49:52','string'),('app-public','true','2023-04-05 01:00:52','2023-04-05 01:00:52','string'),('app-secure-images','false','2023-04-05 01:00:52','2023-04-05 01:00:52','string'),('book-color','#077b70','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('book-color-dark','#389f60','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('bookshelf-color','#a94747','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('bookshelf-color-dark','#ff5454','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('chapter-color','#af4d0d','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('chapter-color-dark','#ee7a2d','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('link-color','#206ea7','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('link-color-dark','#429fe3','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('page-color','#206ea7','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('page-color-dark','#429fe3','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('page-draft-color','#7e50b1','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('page-draft-color-dark','#a66ce8','2023-04-05 16:49:46','2023-04-05 16:49:46','string'),('user:1:dark-mode-enabled','true','2023-03-30 17:46:44','2023-04-12 17:26:04','string'),('user:1:language','en','2023-04-05 00:45:35','2023-04-05 00:45:35','string');
/*!40000 ALTER TABLE `settings` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `social_accounts`
--

DROP TABLE IF EXISTS `social_accounts`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `social_accounts` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `driver` varchar(191) NOT NULL,
  `driver_id` varchar(191) NOT NULL,
  `avatar` varchar(191) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `social_accounts_user_id_index` (`user_id`),
  KEY `social_accounts_driver_index` (`driver`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `social_accounts`
--

LOCK TABLES `social_accounts` WRITE;
/*!40000 ALTER TABLE `social_accounts` DISABLE KEYS */;
/*!40000 ALTER TABLE `social_accounts` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `tags`
--

DROP TABLE IF EXISTS `tags`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `tags` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `entity_id` int(11) NOT NULL,
  `entity_type` varchar(100) NOT NULL,
  `name` varchar(191) NOT NULL,
  `value` varchar(191) NOT NULL,
  `order` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `tags_name_index` (`name`),
  KEY `tags_value_index` (`value`),
  KEY `tags_order_index` (`order`),
  KEY `tags_entity_id_entity_type_index` (`entity_id`,`entity_type`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `tags`
--

LOCK TABLES `tags` WRITE;
/*!40000 ALTER TABLE `tags` DISABLE KEYS */;
/*!40000 ALTER TABLE `tags` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `user_invites`
--

DROP TABLE IF EXISTS `user_invites`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `user_invites` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `token` varchar(191) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `user_invites_user_id_index` (`user_id`),
  KEY `user_invites_token_index` (`token`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `user_invites`
--

LOCK TABLES `user_invites` WRITE;
/*!40000 ALTER TABLE `user_invites` DISABLE KEYS */;
/*!40000 ALTER TABLE `user_invites` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `users`
--

DROP TABLE IF EXISTS `users`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `users` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(191) NOT NULL,
  `email` varchar(191) NOT NULL,
  `password` varchar(60) NOT NULL,
  `remember_token` varchar(100) DEFAULT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `email_confirmed` tinyint(1) NOT NULL DEFAULT 1,
  `image_id` int(11) NOT NULL DEFAULT 0,
  `external_auth_id` varchar(191) NOT NULL,
  `system_name` varchar(191) DEFAULT NULL,
  `slug` varchar(180) NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `users_email_unique` (`email`),
  UNIQUE KEY `users_slug_unique` (`slug`),
  KEY `users_external_auth_id_index` (`external_auth_id`),
  KEY `users_system_name_index` (`system_name`)
) ENGINE=InnoDB AUTO_INCREMENT=3 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `users`
--

LOCK TABLES `users` WRITE;
/*!40000 ALTER TABLE `users` DISABLE KEYS */;
INSERT INTO `users` VALUES (1,'Admin','admin@admin.com','$2y$10$JpOfpVhGBFe9A7QprhmjJumk8fcET5AVZZY3TofQYDcsqkc3zH/D.',NULL,'2023-03-28 22:04:38','2023-04-05 00:45:35',1,0,'',NULL,'admin'),(2,'Guest','guest@example.com','',NULL,'2023-03-28 22:04:38','2023-03-28 22:04:38',1,0,'','public','guest');
/*!40000 ALTER TABLE `users` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `views`
--

DROP TABLE IF EXISTS `views`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `views` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `user_id` int(11) NOT NULL,
  `viewable_id` int(11) NOT NULL,
  `viewable_type` varchar(191) NOT NULL,
  `views` int(11) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `views_user_id_index` (`user_id`),
  KEY `views_viewable_id_index` (`viewable_id`)
) ENGINE=InnoDB AUTO_INCREMENT=44 DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `views`
--

LOCK TABLES `views` WRITE;
/*!40000 ALTER TABLE `views` DISABLE KEYS */;
INSERT INTO `views` VALUES (1,1,1,'book',4,'2023-03-28 22:06:48','2023-03-28 23:24:28'),(2,1,1,'page',3,'2023-03-28 22:07:12','2023-03-28 22:10:42'),(3,1,1,'bookshelf',1,'2023-03-28 22:35:13','2023-03-28 22:35:13'),(4,1,2,'bookshelf',147,'2023-03-28 22:35:57','2023-04-13 16:53:42'),(5,1,2,'book',50,'2023-03-28 22:36:18','2023-04-13 16:53:46'),(6,1,2,'page',56,'2023-03-28 22:58:26','2023-04-13 20:15:19'),(7,1,3,'page',11,'2023-03-28 23:25:21','2023-04-04 20:31:06'),(8,1,3,'book',86,'2023-03-28 23:58:23','2023-04-12 22:50:29'),(9,1,4,'page',29,'2023-03-29 00:43:27','2023-04-12 21:34:21'),(10,1,5,'page',19,'2023-03-29 01:21:11','2023-04-12 21:34:25'),(11,1,6,'page',17,'2023-03-29 01:21:22','2023-04-12 21:35:10'),(12,1,7,'page',18,'2023-03-29 01:39:47','2023-04-12 21:43:33'),(13,1,8,'page',5,'2023-03-29 01:41:20','2023-04-12 21:43:38'),(14,1,9,'page',13,'2023-03-29 01:41:30','2023-04-12 21:52:15'),(15,1,4,'book',54,'2023-03-30 16:36:37','2023-04-12 22:50:34'),(16,1,5,'book',7,'2023-03-30 17:46:16','2023-03-30 20:02:28'),(17,1,10,'page',28,'2023-03-30 17:48:43','2023-04-12 21:54:32'),(18,1,11,'page',7,'2023-04-03 19:54:51','2023-04-12 21:54:35'),(19,1,12,'page',8,'2023-04-03 20:18:59','2023-04-12 21:55:36'),(20,1,13,'page',24,'2023-04-03 21:31:36','2023-04-12 22:08:18'),(21,1,1,'chapter',1,'2023-04-03 21:32:05','2023-04-03 21:32:05'),(22,1,6,'book',92,'2023-04-03 21:33:04','2023-04-12 22:50:58'),(23,1,14,'page',18,'2023-04-03 21:36:18','2023-04-12 22:15:39'),(24,1,15,'page',22,'2023-04-03 22:23:22','2023-04-12 22:50:47'),(25,1,16,'page',10,'2023-04-04 00:13:48','2023-04-12 22:27:05'),(26,1,17,'page',13,'2023-04-04 01:12:48','2023-04-12 22:30:32'),(27,1,18,'page',14,'2023-04-04 01:53:10','2023-04-12 22:30:40'),(28,1,19,'page',9,'2023-04-04 17:42:40','2023-04-12 22:32:51'),(29,1,20,'page',9,'2023-04-05 00:09:09','2023-04-11 18:25:39'),(30,1,21,'page',4,'2023-04-05 00:42:16','2023-04-12 22:33:35'),(31,1,7,'book',14,'2023-04-05 00:46:20','2023-04-12 22:51:04'),(32,1,22,'page',10,'2023-04-05 00:47:39','2023-04-12 22:51:06'),(33,1,23,'page',1,'2023-04-05 19:31:07','2023-04-05 19:31:07'),(34,1,24,'page',1,'2023-04-05 19:31:22','2023-04-05 19:31:22'),(35,1,8,'book',50,'2023-04-06 16:17:26','2023-04-13 22:40:22'),(36,1,25,'page',29,'2023-04-10 17:00:14','2023-04-13 20:27:12'),(37,1,26,'page',15,'2023-04-10 19:23:07','2023-04-13 20:35:31'),(38,1,27,'page',13,'2023-04-10 22:08:06','2023-04-13 20:37:54'),(39,1,28,'page',5,'2023-04-10 23:46:25','2023-04-13 20:41:22'),(40,1,29,'page',9,'2023-04-11 01:08:34','2023-04-13 22:40:20'),(41,1,30,'page',9,'2023-04-11 19:55:18','2023-04-12 22:03:06'),(42,1,31,'page',5,'2023-04-12 00:29:14','2023-04-13 22:46:22'),(43,1,32,'page',2,'2023-04-12 20:49:06','2023-04-12 21:29:55');
/*!40000 ALTER TABLE `views` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `webhook_tracked_events`
--

DROP TABLE IF EXISTS `webhook_tracked_events`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `webhook_tracked_events` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `webhook_id` int(11) NOT NULL,
  `event` varchar(50) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `webhook_tracked_events_event_index` (`event`),
  KEY `webhook_tracked_events_webhook_id_index` (`webhook_id`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `webhook_tracked_events`
--

LOCK TABLES `webhook_tracked_events` WRITE;
/*!40000 ALTER TABLE `webhook_tracked_events` DISABLE KEYS */;
/*!40000 ALTER TABLE `webhook_tracked_events` ENABLE KEYS */;
UNLOCK TABLES;

--
-- Table structure for table `webhooks`
--

DROP TABLE IF EXISTS `webhooks`;
/*!40101 SET @saved_cs_client     = @@character_set_client */;
/*!40101 SET character_set_client = utf8 */;
CREATE TABLE `webhooks` (
  `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name` varchar(150) NOT NULL,
  `active` tinyint(1) NOT NULL,
  `endpoint` varchar(500) NOT NULL,
  `created_at` timestamp NULL DEFAULT NULL,
  `updated_at` timestamp NULL DEFAULT NULL,
  `timeout` int(10) unsigned NOT NULL DEFAULT 3,
  `last_error` text NOT NULL DEFAULT '',
  `last_called_at` timestamp NULL DEFAULT NULL,
  `last_errored_at` timestamp NULL DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `webhooks_name_index` (`name`),
  KEY `webhooks_active_index` (`active`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
/*!40101 SET character_set_client = @saved_cs_client */;

--
-- Dumping data for table `webhooks`
--

LOCK TABLES `webhooks` WRITE;
/*!40000 ALTER TABLE `webhooks` DISABLE KEYS */;
/*!40000 ALTER TABLE `webhooks` ENABLE KEYS */;
UNLOCK TABLES;
/*!40103 SET TIME_ZONE=@OLD_TIME_ZONE */;

/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40014 SET UNIQUE_CHECKS=@OLD_UNIQUE_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;

-- Dump completed on 2023-04-13 15:00:32
